Draw.loadPlugin(function(d){mxResources.parse("exploreFromHere=Explore from here...");var b=20;var c=d.menus.createPopupMenu;d.menus.createPopupMenu=function(h,e,f){c.apply(this,arguments);var g=d.editor.graph;if(g.model.isVertex(g.getSelectionCell())){this.addMenuItems(h,["-","exploreFromHere"],null,f)}};function a(h){var n=d.editor.graph;var f=document.createElement("div");f.style.position="absolute";f.style.display="block";f.style.background="#ffffff";f.style.width="100%";f.style.height="100%";f.style.left="0px";f.style.top="0px";f.style.zIndex=2;var m=document.createElement("img");m.setAttribute("src",IMAGE_PATH+"/delete.png");m.style.position="absolute";m.style.cursor="pointer";m.style.right="10px";m.style.top="10px";f.appendChild(m);var k=document.createElement("div");k.style.position="absolute";k.style.cursor="pointer";k.style.right="38px";k.style.top="14px";k.style.textAlign="right";k.style.verticalAlign="top";mxUtils.write(k,mxResources.get("close"));f.appendChild(k);document.body.appendChild(f);var j=function(o){if(o.keyCode==27){m.click()}};mxEvent.addListener(document,"keydown",j);var g=0;function i(q){if(!mxClient.isBrowserSupported()){mxUtils.error("Browser is not supported!",200,false)}else{var t=new Graph(q);t.keepEdgesInBackground=true;t.isCellResizable=function(){return false};t.isCellRotatable=function(){return false};t.getCursorForCell=function(v){if(this.model.isVertex(v)){return"pointer"}return null};t.getFoldingImage=function(){return null};var s=function(){mxEvent.removeListener(document,"keydown",j);q.parentNode.removeChild(q);n.scrollCellToVisible(h)};mxEvent.addListener(m,"click",s);mxEvent.addListener(k,"click",s);t.setEnabled(false);t.click=function(x){var w=x.getEvent();var v=x.getCell();if(v!=null&&v!=t.rootCell){l(t,v)}};var r=t.getDefaultParent();var p=t.container.scrollWidth/2;var u=t.container.scrollHeight/3;t.model.beginUpdate();var o=t.importCells([h])[0];o.sourceCellId=h.id;o.geometry.x=p-o.geometry.width/2;o.geometry.y=u-o.geometry.height/2;t.model.endUpdate();t.getModel().addListener(mxEvent.CHANGE,function(w,v){var x=v.getProperty("edit").changes;var y=mxText.prototype.enableBoundingBox;mxText.prototype.enableBoundingBox=false;t.labelsVisible=false;mxEffects.animateChanges(t,x,function(){mxText.prototype.prev=true;t.labelsVisible=true;t.refresh();t.tooltipHandler.hide()})});l(t,o)}}function l(C,B){if(C.getModel().isVertex(B)){var q=C.container.scrollWidth/2;var p=C.container.scrollHeight/3;var z=C.getDefaultParent();C.rootCell=B.referenceCell||B;C.getModel().beginUpdate();try{var D=e(C,B);for(var A in C.getModel().cells){var u=C.getModel().getCell(A);if(u!=C.rootCell&&C.getModel().isVertex(u)){C.removeCells([u])}}C.addCells(D);var t=C.getModel().getGeometry(C.rootCell);if(t!=null){t=t.clone();t.x=q-t.width/2;t.y=p-t.height/3;C.getModel().setGeometry(C.rootCell,t)}var x=[];for(var A in C.getModel().cells){var u=C.getModel().getCell(A);if(u!=C.rootCell&&C.getModel().isVertex(u)&&C.getModel().getParent(u)==C.getDefaultParent()){x.push(u);var t=C.getModel().getGeometry(u);if(t!=null){t.x=q-t.width/2;t.y=p-t.height/2}}}var y=x.length;var w=2*Math.PI/y;var o=Math.min(C.container.scrollWidth/3-80,C.container.scrollHeight/3-80);for(var s=0;s<y;s++){var t=C.getModel().getGeometry(x[s]);if(t!=null){t=t.clone();t.x+=o*Math.sin(s*w);t.y+=o*Math.cos(s*w);C.getModel().setGeometry(x[s],t)}}var v=new mxParallelEdgeLayout(C);v.spacing=60;v.execute(C.getDefaultParent())}finally{C.getModel().endUpdate()}}}function e(y,v){var w=v.referenceCell||v;var x=n.model.getCell(w.sourceCellId);var q=n.getEdges(x,null,true,true,false,true);var A=q;if(v.startIndex!=null||(b>0&&q.length>b)){var o=v.startIndex||0;A=q.slice(Math.max(0,o),Math.min(q.length,o+b))}A=A.concat(n.getOpposites(A,x));var u=y.cloneCells(A);var s=";curved=1;noEdgeStyle=1;entryX=none;entryY=none;exitX=none;exitY=none;";var t="fillColor=green;fontColor=white;strokeColor=green;";for(var r=0;r<A.length;r++){u[r].sourceCellId=A[r].id;if(y.model.isEdge(u[r])){u[r].geometry.x=0;u[r].geometry.y=0;u[r].geometry.points=null;u[r].setStyle(u[r].getStyle()+s);u[r].setTerminal(w,u[r].getTerminal(true)==null)}}if(v.startIndex>0){var p=y.createVertex(null,null,"Back...",0,0,80,30,t);p.referenceCell=w;p.startIndex=Math.max(0,(v.startIndex||0)-b);u.splice(0,0,p)}if(q.length>(v.startIndex||0)+b){var z=y.createVertex(null,null,"More...",0,0,80,30,t);z.referenceCell=w;z.startIndex=(v.startIndex||0)+b;u.splice(0,0,z)}return u}i(f)}d.actions.addAction("exploreFromHere",function(){a(d.editor.graph.getSelectionCell())});if(d.editor.chromeless){d.editor.graph.click=function(e){if(d.editor.graph.model.isVertex(e.getCell())&&d.editor.graph.model.getEdgeCount(e.getCell())>0){a(e.getCell())}}}});