function mxSvgCanvas2D(a,e){mxAbstractCanvas2D.call(this);this.root=a;this.gradients=[];this.defs=null;this.styleEnabled=(e!=null)?e:false;var b=null;if(a.ownerDocument!=document){var d=a;while(d!=null&&d.nodeName!="svg"){d=d.parentNode}b=d}if(b!=null){var c=b.getElementsByTagName("defs");if(c.length>0){this.defs=b.getElementsByTagName("defs")[0]}if(this.defs==null){this.defs=this.createElement("defs");if(b.firstChild!=null){b.insertBefore(this.defs,b.firstChild)}else{b.appendChild(this.defs)}}if(this.styleEnabled){this.defs.appendChild(this.createStyle())}}}mxUtils.extend(mxSvgCanvas2D,mxAbstractCanvas2D);(function(){mxSvgCanvas2D.prototype.useDomParser=!mxClient.IS_IE&&typeof DOMParser==="function"&&typeof XMLSerializer==="function";if(mxSvgCanvas2D.prototype.useDomParser){try{var b=new DOMParser().parseFromString("test text","text/html");mxSvgCanvas2D.prototype.useDomParser=b!=null}catch(a){mxSvgCanvas2D.prototype.useDomParser=false}}})();mxSvgCanvas2D.prototype.node=null;mxSvgCanvas2D.prototype.matchHtmlAlignment=true;mxSvgCanvas2D.prototype.textEnabled=true;mxSvgCanvas2D.prototype.foEnabled=true;mxSvgCanvas2D.prototype.foAltText="[Object]";mxSvgCanvas2D.prototype.foOffset=0;mxSvgCanvas2D.prototype.textOffset=0;mxSvgCanvas2D.prototype.imageOffset=0;mxSvgCanvas2D.prototype.strokeTolerance=0;mxSvgCanvas2D.prototype.refCount=0;mxSvgCanvas2D.prototype.blockImagePointerEvents=false;mxSvgCanvas2D.prototype.lineHeightCorrection=1;mxSvgCanvas2D.prototype.pointerEventsValue="all";mxSvgCanvas2D.prototype.fontMetricsPadding=10;mxSvgCanvas2D.prototype.cacheOffsetSize=true;mxSvgCanvas2D.prototype.format=function(a){return parseFloat(parseFloat(a).toFixed(2))};mxSvgCanvas2D.prototype.getBaseUrl=function(){var a=window.location.href;var b=a.lastIndexOf("#");if(b>0){a=a.substring(0,b)}return a};mxSvgCanvas2D.prototype.reset=function(){mxAbstractCanvas2D.prototype.reset.apply(this,arguments);this.gradients=[]};mxSvgCanvas2D.prototype.createStyle=function(a){var b=this.createElement("style");b.setAttribute("type","text/css");mxUtils.write(b,"svg{font-family:"+mxConstants.DEFAULT_FONTFAMILY+";font-size:"+mxConstants.DEFAULT_FONTSIZE+";fill:none;stroke-miterlimit:10}");return b};mxSvgCanvas2D.prototype.createElement=function(b,c){if(this.root.ownerDocument.createElementNS!=null){return this.root.ownerDocument.createElementNS(c||mxConstants.NS_SVG,b)}else{var a=this.root.ownerDocument.createElement(b);if(c!=null){a.setAttribute("xmlns",c)}return a}};mxSvgCanvas2D.prototype.createAlternateContent=function(i,l,j,n,e,g,f,k,a,m,c,b,o){if(this.foAltText!=null){var p=this.state;var d=this.createElement("text");d.setAttribute("x",Math.round(n/2));d.setAttribute("y",Math.round((e+p.fontSize)/2));d.setAttribute("fill",p.fontColor||"black");d.setAttribute("text-anchor","middle");d.setAttribute("font-size",p.fontSize+"px");d.setAttribute("font-family",p.fontFamily);if((p.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD){d.setAttribute("font-weight","bold")}if((p.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC){d.setAttribute("font-style","italic")}if((p.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE){d.setAttribute("text-decoration","underline")}mxUtils.write(d,this.foAltText);return d}else{return null}};mxSvgCanvas2D.prototype.createGradientId=function(g,b,a,f,e){if(g.charAt(0)=="#"){g=g.substring(1)}if(b.charAt(0)=="#"){b=b.substring(1)}g=g.toLowerCase()+"-"+a;b=b.toLowerCase()+"-"+f;var c=null;if(e==null||e==mxConstants.DIRECTION_SOUTH){c="s"}else{if(e==mxConstants.DIRECTION_EAST){c="e"}else{var d=g;g=b;b=d;if(e==mxConstants.DIRECTION_NORTH){c="s"}else{if(e==mxConstants.DIRECTION_WEST){c="e"}}}}return"mx-gradient-"+g+"-"+b+"-"+c};mxSvgCanvas2D.prototype.getSvgGradient=function(c,e,j,i,g){var d=this.createGradientId(c,e,j,i,g);var h=this.gradients[d];if(h==null){var f=this.root.ownerSVGElement;var a=0;var b=d+"-"+a;if(f!=null){h=f.ownerDocument.getElementById(b);while(h!=null&&h.ownerSVGElement!=f){b=d+"-"+a++;h=f.ownerDocument.getElementById(b)}}else{b="id"+(++this.refCount)}if(h==null){h=this.createSvgGradient(c,e,j,i,g);h.setAttribute("id",b);if(this.defs!=null){this.defs.appendChild(h)}else{f.appendChild(h)}}this.gradients[d]=h}return h.getAttribute("id")};mxSvgCanvas2D.prototype.createSvgGradient=function(h,b,a,g,e){var d=this.createElement("linearGradient");d.setAttribute("x1","0%");d.setAttribute("y1","0%");d.setAttribute("x2","0%");d.setAttribute("y2","0%");if(e==null||e==mxConstants.DIRECTION_SOUTH){d.setAttribute("y2","100%")}else{if(e==mxConstants.DIRECTION_EAST){d.setAttribute("x2","100%")}else{if(e==mxConstants.DIRECTION_NORTH){d.setAttribute("y1","100%")}else{if(e==mxConstants.DIRECTION_WEST){d.setAttribute("x1","100%")}}}}var f=(a<1)?";stop-opacity:"+a:"";var c=this.createElement("stop");c.setAttribute("offset","0%");c.setAttribute("style","stop-color:"+h+f);d.appendChild(c);f=(g<1)?";stop-opacity:"+g:"";c=this.createElement("stop");c.setAttribute("offset","100%");c.setAttribute("style","stop-color:"+b+f);d.appendChild(c);return d};mxSvgCanvas2D.prototype.addNode=function(d,b){var c=this.node;var a=this.state;if(c!=null){if(c.nodeName=="path"){if(this.path!=null&&this.path.length>0){c.setAttribute("d",this.path.join(" "))}else{return}}if(d&&a.fillColor!=null){this.updateFill()}else{if(!this.styleEnabled){if(c.nodeName=="ellipse"&&mxClient.IS_FF){c.setAttribute("fill","transparent")}else{c.setAttribute("fill","none")}d=false}}if(b&&a.strokeColor!=null){this.updateStroke()}else{if(!this.styleEnabled){c.setAttribute("stroke","none")}}if(a.transform!=null&&a.transform.length>0){c.setAttribute("transform",a.transform)}if(a.shadow){this.root.appendChild(this.createShadow(c))}if(this.strokeTolerance>0&&!d){this.root.appendChild(this.createTolerance(c))}if(this.pointerEvents&&(c.nodeName!="path"||this.path[this.path.length-1]==this.closeOp)){c.setAttribute("pointer-events",this.pointerEventsValue)}else{if(!this.pointerEvents&&this.originalRoot==null){c.setAttribute("pointer-events","none")}}if((c.nodeName!="rect"&&c.nodeName!="path"&&c.nodeName!="ellipse")||(c.getAttribute("fill")!="none"&&c.getAttribute("fill")!="transparent")||c.getAttribute("stroke")!="none"||c.getAttribute("pointer-events")!="none"){this.root.appendChild(c)}this.node=null}};mxSvgCanvas2D.prototype.updateFill=function(){var a=this.state;if(a.alpha<1||a.fillAlpha<1){this.node.setAttribute("fill-opacity",a.alpha*a.fillAlpha)}if(a.fillColor!=null){if(a.gradientColor!=null){var c=this.getSvgGradient(a.fillColor,a.gradientColor,a.gradientFillAlpha,a.gradientAlpha,a.gradientDirection);if(!mxClient.IS_CHROME_APP&&!mxClient.IS_IE&&!mxClient.IS_IE11&&!mxClient.IS_EDGE&&this.root.ownerDocument==document){var b=this.getBaseUrl().replace(/([\(\)])/g,"\\$1");this.node.setAttribute("fill","url("+b+"#"+c+")")}else{this.node.setAttribute("fill","url(#"+c+")")}}else{this.node.setAttribute("fill",a.fillColor.toLowerCase())}}};mxSvgCanvas2D.prototype.getCurrentStrokeWidth=function(){return Math.max(1,this.format(this.state.strokeWidth*this.state.scale))};mxSvgCanvas2D.prototype.updateStroke=function(){var b=this.state;this.node.setAttribute("stroke",b.strokeColor.toLowerCase());if(b.alpha<1||b.strokeAlpha<1){this.node.setAttribute("stroke-opacity",b.alpha*b.strokeAlpha)}var a=this.getCurrentStrokeWidth();if(a!=1){this.node.setAttribute("stroke-width",a)}if(this.node.nodeName=="path"){this.updateStrokeAttributes()}if(b.dashed){this.node.setAttribute("stroke-dasharray",this.createDashPattern(b.strokeWidth*b.scale))}};mxSvgCanvas2D.prototype.updateStrokeAttributes=function(){var a=this.state;if(a.lineJoin!=null&&a.lineJoin!="miter"){this.node.setAttribute("stroke-linejoin",a.lineJoin)}if(a.lineCap!=null){var b=a.lineCap;if(b=="flat"){b="butt"}if(b!="butt"){this.node.setAttribute("stroke-linecap",b)}}if(a.miterLimit!=null&&(!this.styleEnabled||a.miterLimit!=10)){this.node.setAttribute("stroke-miterlimit",a.miterLimit)}};mxSvgCanvas2D.prototype.createDashPattern=function(d){var a=[];if(typeof(this.state.dashPattern)==="string"){var c=this.state.dashPattern.split(" ");if(c.length>0){for(var b=0;b<c.length;b++){a[b]=Number(c[b])*d}}}return a.join(" ")};mxSvgCanvas2D.prototype.createTolerance=function(c){var b=c.cloneNode(true);var a=parseFloat(b.getAttribute("stroke-width")||1)+this.strokeTolerance;b.setAttribute("pointer-events","stroke");b.setAttribute("visibility","hidden");b.removeAttribute("stroke-dasharray");b.setAttribute("stroke-width",a);b.setAttribute("fill","none");b.setAttribute("stroke",(mxClient.IS_OT)?"none":"white");return b};mxSvgCanvas2D.prototype.createShadow=function(b){var c=b.cloneNode(true);var a=this.state;if(c.getAttribute("fill")!="none"&&(!mxClient.IS_FF||c.getAttribute("fill")!="transparent")){c.setAttribute("fill",a.shadowColor)}if(c.getAttribute("stroke")!="none"){c.setAttribute("stroke",a.shadowColor)}c.setAttribute("transform","translate("+this.format(a.shadowDx*a.scale)+","+this.format(a.shadowDy*a.scale)+")"+(a.transform||""));c.setAttribute("opacity",a.shadowAlpha);return c};mxSvgCanvas2D.prototype.setLink=function(b){if(b==null){this.root=this.originalRoot}else{this.originalRoot=this.root;var a=this.createElement("a");if(a.setAttributeNS==null||(this.root.ownerDocument!=document&&document.documentMode==null)){a.setAttribute("xlink:href",b)}else{a.setAttributeNS(mxConstants.NS_XLINK,"xlink:href",b)}this.root.appendChild(a);this.root=a}};mxSvgCanvas2D.prototype.rotate=function(b,g,a,d,c){if(b!=0||g||a){var j=this.state;d+=j.dx;c+=j.dy;d*=j.scale;c*=j.scale;j.transform=j.transform||"";if(g&&a){b+=180}else{if(g!=a){var f=(g)?d:0;var i=(g)?-1:1;var e=(a)?c:0;var h=(a)?-1:1;j.transform+="translate("+this.format(f)+","+this.format(e)+")scale("+this.format(i)+","+this.format(h)+")translate("+this.format(-f)+","+this.format(-e)+")"}}if(g?!a:a){b*=-1}if(b!=0){j.transform+="rotate("+this.format(b)+","+this.format(d)+","+this.format(c)+")"}j.rotation=j.rotation+b;j.rotationCx=d;j.rotationCy=c}};mxSvgCanvas2D.prototype.begin=function(){mxAbstractCanvas2D.prototype.begin.apply(this,arguments);this.node=this.createElement("path")};mxSvgCanvas2D.prototype.rect=function(a,f,b,d){var c=this.state;var e=this.createElement("rect");e.setAttribute("x",this.format((a+c.dx)*c.scale));e.setAttribute("y",this.format((f+c.dy)*c.scale));e.setAttribute("width",this.format(b*c.scale));e.setAttribute("height",this.format(d*c.scale));this.node=e};mxSvgCanvas2D.prototype.roundrect=function(a,f,c,e,d,b){this.rect(a,f,c,e);if(d>0){this.node.setAttribute("rx",this.format(d*this.state.scale))}if(b>0){this.node.setAttribute("ry",this.format(b*this.state.scale))}};mxSvgCanvas2D.prototype.ellipse=function(a,f,b,d){var c=this.state;var e=this.createElement("ellipse");e.setAttribute("cx",Math.round((a+b/2+c.dx)*c.scale));e.setAttribute("cy",Math.round((f+d/2+c.dy)*c.scale));e.setAttribute("rx",b/2*c.scale);e.setAttribute("ry",d/2*c.scale);this.node=e};mxSvgCanvas2D.prototype.image=function(l,j,m,e,a,b,g,c){a=this.converter.convert(a);b=(b!=null)?b:true;g=(g!=null)?g:false;c=(c!=null)?c:false;var p=this.state;l+=p.dx;j+=p.dy;var d=this.createElement("image");d.setAttribute("x",this.format(l*p.scale)+this.imageOffset);d.setAttribute("y",this.format(j*p.scale)+this.imageOffset);d.setAttribute("width",this.format(m*p.scale));d.setAttribute("height",this.format(e*p.scale));if(d.setAttributeNS==null){d.setAttribute("xlink:href",a)}else{d.setAttributeNS(mxConstants.NS_XLINK,"xlink:href",a)}if(!b){d.setAttribute("preserveAspectRatio","none")}if(p.alpha<1||p.fillAlpha<1){d.setAttribute("opacity",p.alpha*p.fillAlpha)}var f=this.state.transform||"";if(g||c){var k=1;var i=1;var o=0;var n=0;if(g){k=-1;o=-m-2*l}if(c){i=-1;n=-e-2*j}f+="scale("+k+","+i+")translate("+(o*p.scale)+","+(n*p.scale)+")"}if(f.length>0){d.setAttribute("transform",f)}if(!this.pointerEvents){d.setAttribute("pointer-events","none")}this.root.appendChild(d);if(this.blockImagePointerEvents){d.setAttribute("style","pointer-events:none");d=this.createElement("rect");d.setAttribute("visibility","hidden");d.setAttribute("pointer-events","fill");d.setAttribute("x",this.format(l*p.scale));d.setAttribute("y",this.format(j*p.scale));d.setAttribute("width",this.format(m*p.scale));d.setAttribute("height",this.format(e*p.scale));this.root.appendChild(d)}};mxSvgCanvas2D.prototype.convertHtml=function(f){if(this.useDomParser){var d=new DOMParser().parseFromString(f,"text/html");if(d!=null){f=new XMLSerializer().serializeToString(d.body);if(f.substring(0,5)=="<body"){f=f.substring(f.indexOf(">",5)+1)}if(f.substring(f.length-7,f.length)=="</body>"){f=f.substring(0,f.length-7)}}}else{if(document.implementation!=null&&document.implementation.createDocument!=null){var c=document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",null);var e=c.createElement("body");c.documentElement.appendChild(e);var h=document.createElement("div");h.innerHTML=f;var g=h.firstChild;while(g!=null){var b=g.nextSibling;e.appendChild(c.adoptNode(g));g=b}return e.innerHTML}else{var a=document.createElement("textarea");a.innerHTML=f.replace(/&amp;/g,"&amp;amp;").replace(/&#60;/g,"&amp;lt;").replace(/&#62;/g,"&amp;gt;").replace(/&lt;/g,"&amp;lt;").replace(/&gt;/g,"&amp;gt;").replace(/</g,"&lt;").replace(/>/g,"&gt;");f=a.value.replace(/&/g,"&amp;").replace(/&amp;lt;/g,"&lt;").replace(/&amp;gt;/g,"&gt;").replace(/&amp;amp;/g,"&amp;").replace(/<br>/g,"<br />").replace(/<hr>/g,"<hr />").replace(/(<img[^>]+)>/gm,"$1 />")}}return f};mxSvgCanvas2D.prototype.createDiv=function(g,f,h,b,d){var j=this.state;var i=(mxConstants.ABSOLUTE_LINE_HEIGHT)?(j.fontSize*mxConstants.LINE_HEIGHT)+"px":(mxConstants.LINE_HEIGHT*this.lineHeightCorrection);b="display:inline-block;font-size:"+j.fontSize+"px;font-family:"+j.fontFamily+";color:"+j.fontColor+";line-height:"+i+";"+b;if((j.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD){b+="font-weight:bold;"}if((j.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC){b+="font-style:italic;"}if((j.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE){b+="text-decoration:underline;"}if(f==mxConstants.ALIGN_CENTER){b+="text-align:center;"}else{if(f==mxConstants.ALIGN_RIGHT){b+="text-align:right;"}}var e="";if(j.fontBackgroundColor!=null){e+="background-color:"+j.fontBackgroundColor+";"}if(j.fontBorderColor!=null){e+="border:1px solid "+j.fontBorderColor+";"}var c=g;if(!mxUtils.isNode(c)){c=this.convertHtml(c);if(d!="fill"&&d!="width"){c='<div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;'+e+'">'+c+"</div>"}else{b+=e}}if(!mxClient.IS_IE&&document.createElementNS){var a=document.createElementNS("http://www.w3.org/1999/xhtml","div");a.setAttribute("style",b);if(mxUtils.isNode(c)){if(this.root.ownerDocument!=document){a.appendChild(c.cloneNode(true))}else{a.appendChild(c)}}else{a.innerHTML=c}return a}else{if(mxUtils.isNode(c)&&this.root.ownerDocument!=document){c=c.outerHTML}return mxUtils.parseXml('<div xmlns="http://www.w3.org/1999/xhtml" style="'+b+'">'+c+"</div>").documentElement}};mxSvgCanvas2D.prototype.invalidateCachedOffsetSize=function(a){delete a.firstChild.mxCachedOffsetWidth;delete a.firstChild.mxCachedFinalOffsetWidth;delete a.firstChild.mxCachedFinalOffsetHeight};mxSvgCanvas2D.prototype.updateText=function(j,g,l,B,A,c,i,u,C,z,v){if(v!=null&&v.firstChild!=null&&v.firstChild.firstChild!=null&&v.firstChild.firstChild.firstChild!=null){var f=v.firstChild;var e=f.firstChild;var q=e.firstChild;z=(z!=null)?z:0;var p=this.state;j+=p.dx;g+=p.dy;if(C){q.style.maxHeight=Math.round(B)+"px";q.style.maxWidth=Math.round(l)+"px"}else{if(u=="fill"){q.style.width=Math.round(l+1)+"px";q.style.height=Math.round(B+1)+"px"}else{if(u=="width"){q.style.width=Math.round(l+1)+"px";if(B>0){q.style.maxHeight=Math.round(B)+"px"}}}}if(i&&l>0){q.style.width=Math.round(l+1)+"px"}var d=0;var r=0;var o=2;var n=2;var b=q;if(b.firstChild!=null&&b.firstChild.nodeName=="DIV"){b=b.firstChild}var D=(f.mxCachedOffsetWidth!=null)?f.mxCachedOffsetWidth:b.offsetWidth;d=D+o;if(i&&u!="fill"){if(C){d=Math.min(d,l)}q.style.width=d+"px"}d=((f.mxCachedFinalOffsetWidth!=null)?f.mxCachedFinalOffsetWidth:b.offsetWidth)+o;r=((f.mxCachedFinalOffsetHeight!=null)?f.mxCachedFinalOffsetHeight:b.offsetHeight)-2;if(C){r=Math.min(r,B);d=Math.min(d,l)}if(u=="width"){B=r}else{if(u!="fill"){l=d;B=r}}var m=0;var k=0;if(A==mxConstants.ALIGN_CENTER){m-=l/2}else{if(A==mxConstants.ALIGN_RIGHT){m-=l}}j+=m;if(c==mxConstants.ALIGN_MIDDLE){k-=B/2}else{if(c==mxConstants.ALIGN_BOTTOM){k-=B}}if(u!="fill"&&mxClient.IS_FF&&mxClient.IS_WIN){k-=2}g+=k;var a=(p.scale!=1)?"scale("+p.scale+")":"";if(p.rotation!=0&&this.rotateHtml){a+="rotate("+(p.rotation)+","+(l/2)+","+(B/2)+")";var t=this.rotatePoint((j+l/2)*p.scale,(g+B/2)*p.scale,p.rotation,p.rotationCx,p.rotationCy);j=t.x-l*p.scale/2;g=t.y-B*p.scale/2}else{j*=p.scale;g*=p.scale}if(z!=0){a+="rotate("+(z)+","+(-m)+","+(-k)+")"}f.setAttribute("transform","translate("+Math.round(j)+","+Math.round(g)+")"+a);e.setAttribute("width",Math.round(Math.max(1,l)));e.setAttribute("height",Math.round(Math.max(1,B)))}};mxSvgCanvas2D.prototype.text=function(l,j,o,H,C,F,f,k,G,D,J,E,A){if(this.textEnabled&&C!=null){E=(E!=null)?E:0;var u=this.state;l+=u.dx;j+=u.dy;if(this.foEnabled&&G=="html"){var I="vertical-align:top;";if(J){I+="overflow:hidden;max-height:"+Math.round(H)+"px;max-width:"+Math.round(o)+"px;"}else{if(D=="fill"){I+="width:"+Math.round(o+1)+"px;height:"+Math.round(H+1)+"px;overflow:hidden;"}else{if(D=="width"){I+="width:"+Math.round(o+1)+"px;";if(H>0){I+="max-height:"+Math.round(H)+"px;overflow:hidden;"}}}}if(k&&o>0){I+="width:"+Math.round(o+1)+"px;white-space:normal;word-wrap:"+mxConstants.WORD_WRAP+";"}else{I+="white-space:nowrap;"}var i=this.createElement("g");if(u.alpha<1){i.setAttribute("opacity",u.alpha)}var g=this.createElement("foreignObject");g.setAttribute("style","overflow:visible;");g.setAttribute("pointer-events","all");var t=this.createDiv(C,F,f,I,D);if(t==null){return}else{if(A!=null){t.setAttribute("dir",A)}}i.appendChild(g);this.root.appendChild(i);var e=0;var v=0;var r=2;var q=2;if(mxClient.IS_IE&&(document.documentMode==9||!mxClient.IS_SVG)){var K=document.createElement("div");K.style.cssText=t.getAttribute("style");K.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block";K.style.position="absolute";K.style.visibility="hidden";var c=document.createElement("div");c.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block";c.style.wordWrap=mxConstants.WORD_WRAP;c.innerHTML=(mxUtils.isNode(C))?C.outerHTML:C;K.appendChild(c);document.body.appendChild(K);if(document.documentMode!=8&&document.documentMode!=9&&u.fontBorderColor!=null){r+=2;q+=2}if(k&&o>0){var L=c.offsetWidth;var n=0;if(!J&&k&&o>0&&this.root.ownerDocument!=document&&D!="fill"){var b=K.style.whiteSpace;c.style.whiteSpace="nowrap";if(L<c.offsetWidth){K.style.whiteSpace=b}}if(J){L=Math.min(L,o)}K.style.width=L+"px";e=c.offsetWidth+r+n;v=c.offsetHeight+q;K.style.display="inline-block";K.style.position="";K.style.visibility="";K.style.width=e+"px";t.setAttribute("style",K.style.cssText)}else{e=c.offsetWidth+r;v=c.offsetHeight+q}K.parentNode.removeChild(K);g.appendChild(t)}else{if(this.root.ownerDocument!=document){t.style.visibility="hidden";document.body.appendChild(t)}else{g.appendChild(t)}var d=t;if(d.firstChild!=null&&d.firstChild.nodeName=="DIV"){d=d.firstChild;if(k&&t.style.wordWrap=="break-word"){d.style.width="100%"}}var L=d.offsetWidth;if(L==0&&t.parentNode==g){t.style.visibility="hidden";document.body.appendChild(t);L=d.offsetWidth}if(this.cacheOffsetSize){i.mxCachedOffsetWidth=L}if(!J&&k&&o>0&&this.root.ownerDocument!=document&&D!="fill"&&D!="width"){var b=t.style.whiteSpace;t.style.whiteSpace="nowrap";if(L<d.offsetWidth){t.style.whiteSpace=b}}e=L+r-1;if(k&&D!="fill"&&D!="width"){if(J){e=Math.min(e,o)}t.style.width=e+"px"}e=d.offsetWidth;v=d.offsetHeight;if(this.cacheOffsetSize){i.mxCachedFinalOffsetWidth=e;i.mxCachedFinalOffsetHeight=v}v-=q;if(t.parentNode!=g){g.appendChild(t);t.style.visibility=""}}if(J){v=Math.min(v,H);e=Math.min(e,o)}if(D=="width"){H=v}else{if(D!="fill"){o=e;H=v}}if(u.alpha<1){i.setAttribute("opacity",u.alpha)}var p=0;var m=0;if(F==mxConstants.ALIGN_CENTER){p-=o/2}else{if(F==mxConstants.ALIGN_RIGHT){p-=o}}l+=p;if(f==mxConstants.ALIGN_MIDDLE){m-=H/2}else{if(f==mxConstants.ALIGN_BOTTOM){m-=H}}if(D!="fill"&&mxClient.IS_FF&&mxClient.IS_WIN){m-=2}j+=m;var a=(u.scale!=1)?"scale("+u.scale+")":"";if(u.rotation!=0&&this.rotateHtml){a+="rotate("+(u.rotation)+","+(o/2)+","+(H/2)+")";var B=this.rotatePoint((l+o/2)*u.scale,(j+H/2)*u.scale,u.rotation,u.rotationCx,u.rotationCy);l=B.x-o*u.scale/2;j=B.y-H*u.scale/2}else{l*=u.scale;j*=u.scale}if(E!=0){a+="rotate("+(E)+","+(-p)+","+(-m)+")"}i.setAttribute("transform","translate("+(Math.round(l)+this.foOffset)+","+(Math.round(j)+this.foOffset)+")"+a);g.setAttribute("width",Math.round(Math.max(1,o)));g.setAttribute("height",Math.round(Math.max(1,H)));if(this.root.ownerDocument!=document){var M=this.createAlternateContent(g,l,j,o,H,C,F,f,k,G,D,J,E);if(M!=null){g.setAttribute("requiredFeatures","http://www.w3.org/TR/SVG11/feature#Extensibility");var z=this.createElement("switch");z.appendChild(g);z.appendChild(M);i.appendChild(z)}}}else{this.plainText(l,j,o,H,C,F,f,k,D,J,E,A)}}};mxSvgCanvas2D.prototype.createClip=function(a,i,c,e){a=Math.round(a);i=Math.round(i);c=Math.round(c);e=Math.round(e);var g="mx-clip-"+a+"-"+i+"-"+c+"-"+e;var b=0;var d=g+"-"+b;while(document.getElementById(d)!=null){d=g+"-"+(++b)}clip=this.createElement("clipPath");clip.setAttribute("id",d);var f=this.createElement("rect");f.setAttribute("x",a);f.setAttribute("y",i);f.setAttribute("width",c);f.setAttribute("height",e);clip.appendChild(f);return clip};mxSvgCanvas2D.prototype.plainText=function(n,l,p,F,z,D,j,m,A,G,C,v){C=(C!=null)?C:0;var t=this.state;var u=t.fontSize;var B=this.createElement("g");var d=t.transform||"";this.updateFont(B);if(C!=0){d+="rotate("+C+","+this.format(n*t.scale)+","+this.format(l*t.scale)+")"}if(v!=null){B.setAttribute("direction",v)}if(G&&p>0&&F>0){var f=n;var e=l;if(D==mxConstants.ALIGN_CENTER){f-=p/2}else{if(D==mxConstants.ALIGN_RIGHT){f-=p}}if(A!="fill"){if(j==mxConstants.ALIGN_MIDDLE){e-=F/2}else{if(j==mxConstants.ALIGN_BOTTOM){e-=F}}}var H=this.createClip(f*t.scale-2,e*t.scale-2,p*t.scale+4,F*t.scale+4);if(this.defs!=null){this.defs.appendChild(H)}else{this.root.appendChild(H)}if(!mxClient.IS_CHROME_APP&&!mxClient.IS_IE&&!mxClient.IS_IE11&&!mxClient.IS_EDGE&&this.root.ownerDocument==document){var g=this.getBaseUrl().replace(/([\(\)])/g,"\\$1");B.setAttribute("clip-path","url("+g+"#"+H.getAttribute("id")+")")}else{B.setAttribute("clip-path","url(#"+H.getAttribute("id")+")")}}var k=(D==mxConstants.ALIGN_RIGHT)?"end":(D==mxConstants.ALIGN_CENTER)?"middle":"start";if(k!="start"){B.setAttribute("text-anchor",k)}if(!this.styleEnabled||u!=mxConstants.DEFAULT_FONTSIZE){B.setAttribute("font-size",(u*t.scale)+"px")}if(d.length>0){B.setAttribute("transform",d)}if(t.alpha<1){B.setAttribute("opacity",t.alpha)}var b=z.split("\n");var r=Math.round(u*mxConstants.LINE_HEIGHT);var a=u+(b.length-1)*r;var e=l+u-1;if(j==mxConstants.ALIGN_MIDDLE){if(A=="fill"){e-=F/2}else{var o=((this.matchHtmlAlignment&&G&&F>0)?Math.min(a,F):a)/2;e-=o+1}}else{if(j==mxConstants.ALIGN_BOTTOM){if(A=="fill"){e-=F}else{var o=(this.matchHtmlAlignment&&G&&F>0)?Math.min(a,F):a;e-=o+2}}}for(var E=0;E<b.length;E++){if(b[E].length>0&&mxUtils.trim(b[E]).length>0){var q=this.createElement("text");q.setAttribute("x",this.format(n*t.scale)+this.textOffset);q.setAttribute("y",this.format(e*t.scale)+this.textOffset);mxUtils.write(q,b[E]);B.appendChild(q)}e+=r}this.root.appendChild(B);this.addTextBackground(B,z,n,l,p,(A=="fill")?F:a,D,j,A)};mxSvgCanvas2D.prototype.updateFont=function(b){var a=this.state;b.setAttribute("fill",a.fontColor);if(!this.styleEnabled||a.fontFamily!=mxConstants.DEFAULT_FONTFAMILY){b.setAttribute("font-family",a.fontFamily)}if((a.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD){b.setAttribute("font-weight","bold")}if((a.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC){b.setAttribute("font-style","italic")}if((a.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE){b.setAttribute("text-decoration","underline")}};mxSvgCanvas2D.prototype.addTextBackground=function(d,k,o,l,q,g,j,m,f){var t=this.state;if(t.fontBackgroundColor!=null||t.fontBorderColor!=null){var r=null;if(f=="fill"||f=="width"){if(j==mxConstants.ALIGN_CENTER){o-=q/2}else{if(j==mxConstants.ALIGN_RIGHT){o-=q}}if(m==mxConstants.ALIGN_MIDDLE){l-=g/2}else{if(m==mxConstants.ALIGN_BOTTOM){l-=g}}r=new mxRectangle((o+1)*t.scale,l*t.scale,(q-2)*t.scale,(g+2)*t.scale)}else{if(d.getBBox!=null&&this.root.ownerDocument==document){try{r=d.getBBox();var b=mxClient.IS_IE&&mxClient.IS_SVG;r=new mxRectangle(r.x,r.y+((b)?0:1),r.width,r.height+((b)?1:0))}catch(i){}}else{var a=document.createElement("div");a.style.lineHeight=(mxConstants.ABSOLUTE_LINE_HEIGHT)?(t.fontSize*mxConstants.LINE_HEIGHT)+"px":mxConstants.LINE_HEIGHT;a.style.fontSize=t.fontSize+"px";a.style.fontFamily=t.fontFamily;a.style.whiteSpace="nowrap";a.style.position="absolute";a.style.visibility="hidden";a.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block";a.style.zoom="1";if((t.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD){a.style.fontWeight="bold"}if((t.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC){a.style.fontStyle="italic"}k=mxUtils.htmlEntities(k,false);a.innerHTML=k.replace(/\n/g,"<br/>");document.body.appendChild(a);var q=a.offsetWidth;var g=a.offsetHeight;a.parentNode.removeChild(a);if(j==mxConstants.ALIGN_CENTER){o-=q/2}else{if(j==mxConstants.ALIGN_RIGHT){o-=q}}if(m==mxConstants.ALIGN_MIDDLE){l-=g/2}else{if(m==mxConstants.ALIGN_BOTTOM){l-=g}}r=new mxRectangle((o+1)*t.scale,(l+2)*t.scale,q*t.scale,(g+1)*t.scale)}}if(r!=null){var c=this.createElement("rect");c.setAttribute("fill",t.fontBackgroundColor||"none");c.setAttribute("stroke",t.fontBorderColor||"none");c.setAttribute("x",Math.floor(r.x-1));c.setAttribute("y",Math.floor(r.y-1));c.setAttribute("width",Math.ceil(r.width+2));c.setAttribute("height",Math.ceil(r.height));var p=(t.fontBorderColor!=null)?Math.max(1,this.format(t.scale)):0;c.setAttribute("stroke-width",p);if(this.root.ownerDocument==document&&mxUtils.mod(p,2)==1){c.setAttribute("transform","translate(0.5, 0.5)")}d.insertBefore(c,d.firstChild)}}};mxSvgCanvas2D.prototype.stroke=function(){this.addNode(false,true)};mxSvgCanvas2D.prototype.fill=function(){this.addNode(true,false)};mxSvgCanvas2D.prototype.fillAndStroke=function(){this.addNode(true,true)};