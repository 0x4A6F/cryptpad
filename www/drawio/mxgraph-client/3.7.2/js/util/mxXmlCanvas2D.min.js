function mxXmlCanvas2D(a){mxAbstractCanvas2D.call(this);this.root=a;this.writeDefaults()}mxUtils.extend(mxXmlCanvas2D,mxAbstractCanvas2D);mxXmlCanvas2D.prototype.textEnabled=true;mxXmlCanvas2D.prototype.compressed=true;mxXmlCanvas2D.prototype.writeDefaults=function(){var a;a=this.createElement("fontfamily");a.setAttribute("family",mxConstants.DEFAULT_FONTFAMILY);this.root.appendChild(a);a=this.createElement("fontsize");a.setAttribute("size",mxConstants.DEFAULT_FONTSIZE);this.root.appendChild(a);a=this.createElement("shadowcolor");a.setAttribute("color",mxConstants.SHADOWCOLOR);this.root.appendChild(a);a=this.createElement("shadowalpha");a.setAttribute("alpha",mxConstants.SHADOW_OPACITY);this.root.appendChild(a);a=this.createElement("shadowoffset");a.setAttribute("dx",mxConstants.SHADOW_OFFSET_X);a.setAttribute("dy",mxConstants.SHADOW_OFFSET_Y);this.root.appendChild(a)};mxXmlCanvas2D.prototype.format=function(a){return parseFloat(parseFloat(a).toFixed(2))};mxXmlCanvas2D.prototype.createElement=function(a){return this.root.ownerDocument.createElement(a)};mxXmlCanvas2D.prototype.save=function(){if(this.compressed){mxAbstractCanvas2D.prototype.save.apply(this,arguments)}this.root.appendChild(this.createElement("save"))};mxXmlCanvas2D.prototype.restore=function(){if(this.compressed){mxAbstractCanvas2D.prototype.restore.apply(this,arguments)}this.root.appendChild(this.createElement("restore"))};mxXmlCanvas2D.prototype.scale=function(b){var a=this.createElement("scale");a.setAttribute("scale",b);this.root.appendChild(a)};mxXmlCanvas2D.prototype.translate=function(b,a){var c=this.createElement("translate");c.setAttribute("dx",this.format(b));c.setAttribute("dy",this.format(a));this.root.appendChild(c)};mxXmlCanvas2D.prototype.rotate=function(b,e,c,a,f){var d=this.createElement("rotate");if(b!=0||e||c){d.setAttribute("theta",this.format(b));d.setAttribute("flipH",(e)?"1":"0");d.setAttribute("flipV",(c)?"1":"0");d.setAttribute("cx",this.format(a));d.setAttribute("cy",this.format(f));this.root.appendChild(d)}};mxXmlCanvas2D.prototype.setAlpha=function(b){if(this.compressed){if(this.state.alpha==b){return}mxAbstractCanvas2D.prototype.setAlpha.apply(this,arguments)}var a=this.createElement("alpha");a.setAttribute("alpha",this.format(b));this.root.appendChild(a)};mxXmlCanvas2D.prototype.setFillAlpha=function(b){if(this.compressed){if(this.state.fillAlpha==b){return}mxAbstractCanvas2D.prototype.setFillAlpha.apply(this,arguments)}var a=this.createElement("fillalpha");a.setAttribute("alpha",this.format(b));this.root.appendChild(a)};mxXmlCanvas2D.prototype.setStrokeAlpha=function(b){if(this.compressed){if(this.state.strokeAlpha==b){return}mxAbstractCanvas2D.prototype.setStrokeAlpha.apply(this,arguments)}var a=this.createElement("strokealpha");a.setAttribute("alpha",this.format(b));this.root.appendChild(a)};mxXmlCanvas2D.prototype.setFillColor=function(b){if(b==mxConstants.NONE){b=null}if(this.compressed){if(this.state.fillColor==b){return}mxAbstractCanvas2D.prototype.setFillColor.apply(this,arguments)}var a=this.createElement("fillcolor");a.setAttribute("color",(b!=null)?b:mxConstants.NONE);this.root.appendChild(a)};mxXmlCanvas2D.prototype.setGradient=function(j,i,e,c,f,b,d,k,g){if(j!=null&&i!=null){mxAbstractCanvas2D.prototype.setGradient.apply(this,arguments);var a=this.createElement("gradient");a.setAttribute("c1",j);a.setAttribute("c2",i);a.setAttribute("x",this.format(e));a.setAttribute("y",this.format(c));a.setAttribute("w",this.format(f));a.setAttribute("h",this.format(b));if(d!=null){a.setAttribute("direction",d)}if(k!=null){a.setAttribute("alpha1",k)}if(g!=null){a.setAttribute("alpha2",g)}this.root.appendChild(a)}};mxXmlCanvas2D.prototype.setStrokeColor=function(b){if(b==mxConstants.NONE){b=null}if(this.compressed){if(this.state.strokeColor==b){return}mxAbstractCanvas2D.prototype.setStrokeColor.apply(this,arguments)}var a=this.createElement("strokecolor");a.setAttribute("color",(b!=null)?b:mxConstants.NONE);this.root.appendChild(a)};mxXmlCanvas2D.prototype.setStrokeWidth=function(b){if(this.compressed){if(this.state.strokeWidth==b){return}mxAbstractCanvas2D.prototype.setStrokeWidth.apply(this,arguments)}var a=this.createElement("strokewidth");a.setAttribute("width",this.format(b));this.root.appendChild(a)};mxXmlCanvas2D.prototype.setDashed=function(b){if(this.compressed){if(this.state.dashed==b){return}mxAbstractCanvas2D.prototype.setDashed.apply(this,arguments)}var a=this.createElement("dashed");a.setAttribute("dashed",(b)?"1":"0");this.root.appendChild(a)};mxXmlCanvas2D.prototype.setDashPattern=function(b){if(this.compressed){if(this.state.dashPattern==b){return}mxAbstractCanvas2D.prototype.setDashPattern.apply(this,arguments)}var a=this.createElement("dashpattern");a.setAttribute("pattern",b);this.root.appendChild(a)};mxXmlCanvas2D.prototype.setLineCap=function(b){if(this.compressed){if(this.state.lineCap==b){return}mxAbstractCanvas2D.prototype.setLineCap.apply(this,arguments)}var a=this.createElement("linecap");a.setAttribute("cap",b);this.root.appendChild(a)};mxXmlCanvas2D.prototype.setLineJoin=function(b){if(this.compressed){if(this.state.lineJoin==b){return}mxAbstractCanvas2D.prototype.setLineJoin.apply(this,arguments)}var a=this.createElement("linejoin");a.setAttribute("join",b);this.root.appendChild(a)};mxXmlCanvas2D.prototype.setMiterLimit=function(b){if(this.compressed){if(this.state.miterLimit==b){return}mxAbstractCanvas2D.prototype.setMiterLimit.apply(this,arguments)}var a=this.createElement("miterlimit");a.setAttribute("limit",b);this.root.appendChild(a)};mxXmlCanvas2D.prototype.setFontColor=function(b){if(this.textEnabled){if(b==mxConstants.NONE){b=null}if(this.compressed){if(this.state.fontColor==b){return}mxAbstractCanvas2D.prototype.setFontColor.apply(this,arguments)}var a=this.createElement("fontcolor");a.setAttribute("color",(b!=null)?b:mxConstants.NONE);this.root.appendChild(a)}};mxXmlCanvas2D.prototype.setFontBackgroundColor=function(b){if(this.textEnabled){if(b==mxConstants.NONE){b=null}if(this.compressed){if(this.state.fontBackgroundColor==b){return}mxAbstractCanvas2D.prototype.setFontBackgroundColor.apply(this,arguments)}var a=this.createElement("fontbackgroundcolor");a.setAttribute("color",(b!=null)?b:mxConstants.NONE);this.root.appendChild(a)}};mxXmlCanvas2D.prototype.setFontBorderColor=function(b){if(this.textEnabled){if(b==mxConstants.NONE){b=null}if(this.compressed){if(this.state.fontBorderColor==b){return}mxAbstractCanvas2D.prototype.setFontBorderColor.apply(this,arguments)}var a=this.createElement("fontbordercolor");a.setAttribute("color",(b!=null)?b:mxConstants.NONE);this.root.appendChild(a)}};mxXmlCanvas2D.prototype.setFontSize=function(b){if(this.textEnabled){if(this.compressed){if(this.state.fontSize==b){return}mxAbstractCanvas2D.prototype.setFontSize.apply(this,arguments)}var a=this.createElement("fontsize");a.setAttribute("size",b);this.root.appendChild(a)}};mxXmlCanvas2D.prototype.setFontFamily=function(b){if(this.textEnabled){if(this.compressed){if(this.state.fontFamily==b){return}mxAbstractCanvas2D.prototype.setFontFamily.apply(this,arguments)}var a=this.createElement("fontfamily");a.setAttribute("family",b);this.root.appendChild(a)}};mxXmlCanvas2D.prototype.setFontStyle=function(b){if(this.textEnabled){if(b==null){b=0}if(this.compressed){if(this.state.fontStyle==b){return}mxAbstractCanvas2D.prototype.setFontStyle.apply(this,arguments)}var a=this.createElement("fontstyle");a.setAttribute("style",b);this.root.appendChild(a)}};mxXmlCanvas2D.prototype.setShadow=function(b){if(this.compressed){if(this.state.shadow==b){return}mxAbstractCanvas2D.prototype.setShadow.apply(this,arguments)}var a=this.createElement("shadow");a.setAttribute("enabled",(b)?"1":"0");this.root.appendChild(a)};mxXmlCanvas2D.prototype.setShadowColor=function(b){if(this.compressed){if(b==mxConstants.NONE){b=null}if(this.state.shadowColor==b){return}mxAbstractCanvas2D.prototype.setShadowColor.apply(this,arguments)}var a=this.createElement("shadowcolor");a.setAttribute("color",(b!=null)?b:mxConstants.NONE);this.root.appendChild(a)};mxXmlCanvas2D.prototype.setShadowAlpha=function(b){if(this.compressed){if(this.state.shadowAlpha==b){return}mxAbstractCanvas2D.prototype.setShadowAlpha.apply(this,arguments)}var a=this.createElement("shadowalpha");a.setAttribute("alpha",b);this.root.appendChild(a)};mxXmlCanvas2D.prototype.setShadowOffset=function(b,a){if(this.compressed){if(this.state.shadowDx==b&&this.state.shadowDy==a){return}mxAbstractCanvas2D.prototype.setShadowOffset.apply(this,arguments)}var c=this.createElement("shadowoffset");c.setAttribute("dx",b);c.setAttribute("dy",a);this.root.appendChild(c)};mxXmlCanvas2D.prototype.rect=function(a,e,b,c){var d=this.createElement("rect");d.setAttribute("x",this.format(a));d.setAttribute("y",this.format(e));d.setAttribute("w",this.format(b));d.setAttribute("h",this.format(c));this.root.appendChild(d)};mxXmlCanvas2D.prototype.roundrect=function(a,g,c,e,d,b){var f=this.createElement("roundrect");f.setAttribute("x",this.format(a));f.setAttribute("y",this.format(g));f.setAttribute("w",this.format(c));f.setAttribute("h",this.format(e));f.setAttribute("dx",this.format(d));f.setAttribute("dy",this.format(b));this.root.appendChild(f)};mxXmlCanvas2D.prototype.ellipse=function(a,e,b,c){var d=this.createElement("ellipse");d.setAttribute("x",this.format(a));d.setAttribute("y",this.format(e));d.setAttribute("w",this.format(b));d.setAttribute("h",this.format(c));this.root.appendChild(d)};mxXmlCanvas2D.prototype.image=function(i,g,j,e,a,b,f,c){a=this.converter.convert(a);var d=this.createElement("image");d.setAttribute("x",this.format(i));d.setAttribute("y",this.format(g));d.setAttribute("w",this.format(j));d.setAttribute("h",this.format(e));d.setAttribute("src",a);d.setAttribute("aspect",(b)?"1":"0");d.setAttribute("flipH",(f)?"1":"0");d.setAttribute("flipV",(c)?"1":"0");this.root.appendChild(d)};mxXmlCanvas2D.prototype.begin=function(){this.root.appendChild(this.createElement("begin"));this.lastX=0;this.lastY=0};mxXmlCanvas2D.prototype.moveTo=function(a,c){var b=this.createElement("move");b.setAttribute("x",this.format(a));b.setAttribute("y",this.format(c));this.root.appendChild(b);this.lastX=a;this.lastY=c};mxXmlCanvas2D.prototype.lineTo=function(a,c){var b=this.createElement("line");b.setAttribute("x",this.format(a));b.setAttribute("y",this.format(c));this.root.appendChild(b);this.lastX=a;this.lastY=c};mxXmlCanvas2D.prototype.quadTo=function(b,d,a,c){var e=this.createElement("quad");e.setAttribute("x1",this.format(b));e.setAttribute("y1",this.format(d));e.setAttribute("x2",this.format(a));e.setAttribute("y2",this.format(c));this.root.appendChild(e);this.lastX=a;this.lastY=c};mxXmlCanvas2D.prototype.curveTo=function(d,f,b,e,a,c){var g=this.createElement("curve");g.setAttribute("x1",this.format(d));g.setAttribute("y1",this.format(f));g.setAttribute("x2",this.format(b));g.setAttribute("y2",this.format(e));g.setAttribute("x3",this.format(a));g.setAttribute("y3",this.format(c));this.root.appendChild(g);this.lastX=a;this.lastY=c};mxXmlCanvas2D.prototype.close=function(){this.root.appendChild(this.createElement("close"))};mxXmlCanvas2D.prototype.text=function(l,j,n,f,i,g,k,a,m,e,d,o,c){if(this.textEnabled&&i!=null){if(mxUtils.isNode(i)){i=mxUtils.getOuterHtml(i)}var b=this.createElement("text");b.setAttribute("x",this.format(l));b.setAttribute("y",this.format(j));b.setAttribute("w",this.format(n));b.setAttribute("h",this.format(f));b.setAttribute("str",i);if(g!=null){b.setAttribute("align",g)}if(k!=null){b.setAttribute("valign",k)}b.setAttribute("wrap",(a)?"1":"0");if(m==null){m=""}b.setAttribute("format",m);if(e!=null){b.setAttribute("overflow",e)}if(d!=null){b.setAttribute("clip",(d)?"1":"0")}if(o!=null){b.setAttribute("rotation",o)}if(c!=null){b.setAttribute("dir",c)}this.root.appendChild(b)}};mxXmlCanvas2D.prototype.stroke=function(){this.root.appendChild(this.createElement("stroke"))};mxXmlCanvas2D.prototype.fill=function(){this.root.appendChild(this.createElement("fill"))};mxXmlCanvas2D.prototype.fillAndStroke=function(){this.root.appendChild(this.createElement("fillstroke"))};