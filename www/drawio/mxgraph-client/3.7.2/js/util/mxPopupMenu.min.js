function mxPopupMenu(a){this.factoryMethod=a;if(a!=null){this.init()}}mxPopupMenu.prototype=new mxEventSource();mxPopupMenu.prototype.constructor=mxPopupMenu;mxPopupMenu.prototype.submenuImage=mxClient.imageBasePath+"/submenu.gif";mxPopupMenu.prototype.zIndex=10006;mxPopupMenu.prototype.factoryMethod=null;mxPopupMenu.prototype.useLeftButtonForPopup=false;mxPopupMenu.prototype.enabled=true;mxPopupMenu.prototype.itemCount=0;mxPopupMenu.prototype.autoExpand=false;mxPopupMenu.prototype.smartSeparators=false;mxPopupMenu.prototype.labels=true;mxPopupMenu.prototype.init=function(){this.table=document.createElement("table");this.table.className="mxPopupMenu";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.div=document.createElement("div");this.div.className="mxPopupMenu";this.div.style.display="inline";this.div.style.zIndex=this.zIndex;this.div.appendChild(this.table);mxEvent.disableContextMenu(this.div)};mxPopupMenu.prototype.isEnabled=function(){return this.enabled};mxPopupMenu.prototype.setEnabled=function(a){this.enabled=a};mxPopupMenu.prototype.isPopupTrigger=function(a){return a.isPopupTrigger()||(this.useLeftButtonForPopup&&mxEvent.isLeftMouseButton(a.getEvent()))};mxPopupMenu.prototype.addItem=function(l,c,a,m,n,j,d){m=m||this;this.itemCount++;if(m.willAddSeparator){if(m.containsItems){this.addSeparator(m,true)}m.willAddSeparator=false}m.containsItems=true;var k=document.createElement("tr");k.className="mxPopupMenuItem";var i=document.createElement("td");i.className="mxPopupMenuIcon";if(c!=null){var f=document.createElement("img");f.src=c;i.appendChild(f)}else{if(n!=null){var b=document.createElement("div");b.className=n;i.appendChild(b)}}k.appendChild(i);if(this.labels){var h=document.createElement("td");h.className="mxPopupMenuItem"+((j!=null&&!j)?" mxDisabled":"");mxUtils.write(h,l);h.align="left";k.appendChild(h);var g=document.createElement("td");g.className="mxPopupMenuItem"+((j!=null&&!j)?" mxDisabled":"");g.style.paddingRight="6px";g.style.textAlign="right";k.appendChild(g);if(m.div==null){this.createSubmenu(m)}}m.tbody.appendChild(k);if(d!=false&&j!=false){var e=null;mxEvent.addGestureListeners(k,mxUtils.bind(this,function(o){this.eventReceiver=k;if(m.activeRow!=k&&m.activeRow!=m){if(m.activeRow!=null&&m.activeRow.div.parentNode!=null){this.hideSubmenu(m)}if(k.div!=null){this.showSubmenu(m,k);m.activeRow=k}}if(mxClient.IS_QUIRKS||document.documentMode==8){e=document.selection.createRange()}mxEvent.consume(o)}),mxUtils.bind(this,function(o){if(m.activeRow!=k&&m.activeRow!=m){if(m.activeRow!=null&&m.activeRow.div.parentNode!=null){this.hideSubmenu(m)}if(this.autoExpand&&k.div!=null){this.showSubmenu(m,k);m.activeRow=k}}k.className="mxPopupMenuItemHover"}),mxUtils.bind(this,function(o){if(this.eventReceiver==k){if(m.activeRow!=k){this.hideMenu()}if(e!=null){try{e.select()}catch(p){}e=null}if(a!=null){a(o)}}this.eventReceiver=null;mxEvent.consume(o)}));mxEvent.addListener(k,"mouseout",mxUtils.bind(this,function(o){k.className="mxPopupMenuItem"}))}return k};mxPopupMenu.prototype.addCheckmark=function(b,a){var c=b.firstChild.nextSibling;c.style.backgroundImage="url('"+a+"')";c.style.backgroundRepeat="no-repeat";c.style.backgroundPosition="2px 50%"};mxPopupMenu.prototype.createSubmenu=function(b){b.table=document.createElement("table");b.table.className="mxPopupMenu";b.tbody=document.createElement("tbody");b.table.appendChild(b.tbody);b.div=document.createElement("div");b.div.className="mxPopupMenu";b.div.style.position="absolute";b.div.style.display="inline";b.div.style.zIndex=this.zIndex;b.div.appendChild(b.table);var a=document.createElement("img");a.setAttribute("src",this.submenuImage);td=b.firstChild.nextSibling.nextSibling;td.appendChild(a)};mxPopupMenu.prototype.showSubmenu=function(f,j){if(j.div!=null){j.div.style.left=(f.div.offsetLeft+j.offsetLeft+j.offsetWidth-1)+"px";j.div.style.top=(f.div.offsetTop+j.offsetTop)+"px";document.body.appendChild(j.div);var g=parseInt(j.div.offsetLeft);var e=parseInt(j.div.offsetWidth);var i=mxUtils.getDocumentScrollOrigin(document);var a=document.body;var h=document.documentElement;var c=i.x+(a.clientWidth||h.clientWidth);if(g+e>c){j.div.style.left=(f.div.offsetLeft-e+((mxClient.IS_IE)?6:-6))+"px"}mxUtils.fit(j.div)}};mxPopupMenu.prototype.addSeparator=function(b,e){b=b||this;if(this.smartSeparators&&!e){b.willAddSeparator=true}else{if(b.tbody!=null){b.willAddSeparator=false;var d=document.createElement("tr");var f=document.createElement("td");f.className="mxPopupMenuIcon";f.style.padding="0 0 0 0px";d.appendChild(f);var c=document.createElement("td");c.style.padding="0 0 0 0px";c.setAttribute("colSpan","2");var a=document.createElement("hr");a.setAttribute("size","1");c.appendChild(a);d.appendChild(c);b.tbody.appendChild(d)}}};mxPopupMenu.prototype.popup=function(b,d,a,c){if(this.div!=null&&this.tbody!=null&&this.factoryMethod!=null){this.div.style.left=b+"px";this.div.style.top=d+"px";while(this.tbody.firstChild!=null){mxEvent.release(this.tbody.firstChild);this.tbody.removeChild(this.tbody.firstChild)}this.itemCount=0;this.factoryMethod(this,a,c);if(this.itemCount>0){this.showMenu();this.fireEvent(new mxEventObject(mxEvent.SHOW))}}};mxPopupMenu.prototype.isMenuShowing=function(){return this.div!=null&&this.div.parentNode==document.body};mxPopupMenu.prototype.showMenu=function(){if(document.documentMode>=9){this.div.style.filter="none"}document.body.appendChild(this.div);mxUtils.fit(this.div)};mxPopupMenu.prototype.hideMenu=function(){if(this.div!=null){if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div)}this.hideSubmenu(this);this.containsItems=false;this.fireEvent(new mxEventObject(mxEvent.HIDE))}};mxPopupMenu.prototype.hideSubmenu=function(a){if(a.activeRow!=null){this.hideSubmenu(a.activeRow);if(a.activeRow.div.parentNode!=null){a.activeRow.div.parentNode.removeChild(a.activeRow.div)}a.activeRow=null}};mxPopupMenu.prototype.destroy=function(){if(this.div!=null){mxEvent.release(this.div);if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div)}this.div=null}};