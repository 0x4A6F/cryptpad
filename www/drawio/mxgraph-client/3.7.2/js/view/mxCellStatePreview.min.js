function mxCellStatePreview(a){this.deltas=new mxDictionary();this.graph=a}mxCellStatePreview.prototype.graph=null;mxCellStatePreview.prototype.deltas=null;mxCellStatePreview.prototype.count=0;mxCellStatePreview.prototype.isEmpty=function(){return this.count==0};mxCellStatePreview.prototype.moveState=function(d,b,a,e,c){e=(e!=null)?e:true;c=(c!=null)?c:true;var f=this.deltas.get(d.cell);if(f==null){f={point:new mxPoint(b,a),state:d};this.deltas.put(d.cell,f);this.count++}else{if(e){f.point.x+=b;f.point.y+=a}else{f.point.x=b;f.point.y=a}}if(c){this.addEdges(d)}return f.point};mxCellStatePreview.prototype.show=function(a){this.deltas.visit(mxUtils.bind(this,function(b,c){this.translateState(c.state,c.point.x,c.point.y)}));this.deltas.visit(mxUtils.bind(this,function(b,c){this.revalidateState(c.state,c.point.x,c.point.y,a)}))};mxCellStatePreview.prototype.translateState=function(f,c,a){if(f!=null){var d=this.graph.getModel();if(d.isVertex(f.cell)){f.view.updateCellState(f);var g=d.getGeometry(f.cell);if((c!=0||a!=0)&&g!=null&&(!g.relative||this.deltas.get(f.cell)!=null)){f.x+=c;f.y+=a}}var b=d.getChildCount(f.cell);for(var e=0;e<b;e++){this.translateState(f.view.getState(d.getChildAt(f.cell,e)),c,a)}}};mxCellStatePreview.prototype.revalidateState=function(a,j,h,g){if(a!=null){var f=this.graph.getModel();if(f.isEdge(a.cell)){a.view.updateCellState(a)}var e=this.graph.getCellGeometry(a.cell);var b=a.view.getState(f.getParent(a.cell));if((j!=0||h!=0)&&e!=null&&e.relative&&f.isVertex(a.cell)&&(b==null||f.isVertex(b.cell)||this.deltas.get(a.cell)!=null)){a.x+=j;a.y+=h}this.graph.cellRenderer.redraw(a);if(g!=null){g(a)}var c=f.getChildCount(a.cell);for(var d=0;d<c;d++){this.revalidateState(this.graph.view.getState(f.getChildAt(a.cell,d)),j,h,g)}}};mxCellStatePreview.prototype.addEdges=function(d){var a=this.graph.getModel();var e=a.getEdgeCount(d.cell);for(var b=0;b<e;b++){var c=d.view.getState(a.getEdgeAt(d.cell,b));if(c!=null){this.moveState(c,0,0)}}};