function mxLayoutManager(a){this.undoHandler=mxUtils.bind(this,function(c,b){if(this.isEnabled()){this.beforeUndo(b.getProperty("edit"))}});this.moveHandler=mxUtils.bind(this,function(c,b){if(this.isEnabled()){this.cellsMoved(b.getProperty("cells"),b.getProperty("event"))}});this.setGraph(a)}mxLayoutManager.prototype=new mxEventSource();mxLayoutManager.prototype.constructor=mxLayoutManager;mxLayoutManager.prototype.graph=null;mxLayoutManager.prototype.bubbling=true;mxLayoutManager.prototype.enabled=true;mxLayoutManager.prototype.updateHandler=null;mxLayoutManager.prototype.moveHandler=null;mxLayoutManager.prototype.isEnabled=function(){return this.enabled};mxLayoutManager.prototype.setEnabled=function(a){this.enabled=a};mxLayoutManager.prototype.isBubbling=function(){return this.bubbling};mxLayoutManager.prototype.setBubbling=function(a){this.bubbling=a};mxLayoutManager.prototype.getGraph=function(){return this.graph};mxLayoutManager.prototype.setGraph=function(b){if(this.graph!=null){var a=this.graph.getModel();a.removeListener(this.undoHandler);this.graph.removeListener(this.moveHandler)}this.graph=b;if(this.graph!=null){var a=this.graph.getModel();a.addListener(mxEvent.BEFORE_UNDO,this.undoHandler);this.graph.addListener(mxEvent.MOVE_CELLS,this.moveHandler)}};mxLayoutManager.prototype.getLayout=function(a){return null};mxLayoutManager.prototype.beforeUndo=function(c){var b=this.getCellsForChanges(c.changes);var a=this.getGraph().getModel();var e=[];for(var d=0;d<b.length;d++){e=e.concat(a.getDescendants(b[d]))}b=e;if(this.isBubbling()){e=a.getParents(b);while(e.length>0){b=b.concat(e);e=a.getParents(e)}}this.executeLayoutForCells(b)};mxLayoutManager.prototype.executeLayoutForCells=function(b){var a=mxUtils.sortCells(b,true);a=a.concat(a.slice().reverse());this.layoutCells(a)};mxLayoutManager.prototype.cellsMoved=function(d,b){if(d!=null&&b!=null){var a=mxUtils.convertPoint(this.getGraph().container,mxEvent.getClientX(b),mxEvent.getClientY(b));var c=this.getGraph().getModel();for(var e=0;e<d.length;e++){var f=c.getParent(d[e]);if(mxUtils.indexOf(d,f)<0){var g=this.getLayout(f);if(g!=null){g.moveCell(d[e],a.x,a.y)}}}}};mxLayoutManager.prototype.getCellsForChanges=function(e){var g=new mxDictionary();var a=[];for(var d=0;d<e.length;d++){var f=e[d];if(f instanceof mxRootChange){return[]}else{var c=this.getCellsForChange(f);for(var b=0;b<c.length;b++){if(c[b]!=null&&!g.get(c[b])){g.put(c[b],true);a.push(c[b])}}}}return a};mxLayoutManager.prototype.getCellsForChange=function(b){var a=this.getGraph().getModel();if(b instanceof mxChildChange){return[b.child,b.previous,a.getParent(b.child)]}else{if(b instanceof mxTerminalChange||b instanceof mxGeometryChange){return[b.cell,a.getParent(b.cell)]}else{if(b instanceof mxVisibleChange||b instanceof mxStyleChange){return[b.cell]}}}return[]};mxLayoutManager.prototype.layoutCells=function(b){if(b.length>0){var a=this.getGraph().getModel();a.beginUpdate();try{var d=null;for(var c=0;c<b.length;c++){if(b[c]!=a.getRoot()&&b[c]!=d){if(this.executeLayout(this.getLayout(b[c]),b[c])){d=b[c]}}}this.fireEvent(new mxEventObject(mxEvent.LAYOUT_CELLS,"cells",b))}finally{a.endUpdate()}}};mxLayoutManager.prototype.executeLayout=function(c,b){var a=false;if(c!=null&&b!=null){c.execute(b);a=true}return a};mxLayoutManager.prototype.destroy=function(){this.setGraph(null)};