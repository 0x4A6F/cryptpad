function mxGraph(a,b,d,c){this.mouseListeners=null;this.renderHint=d;if(mxClient.IS_SVG){this.dialect=mxConstants.DIALECT_SVG}else{if(d==mxConstants.RENDERING_HINT_EXACT&&mxClient.IS_VML){this.dialect=mxConstants.DIALECT_VML}else{if(d==mxConstants.RENDERING_HINT_FASTEST){this.dialect=mxConstants.DIALECT_STRICTHTML}else{if(d==mxConstants.RENDERING_HINT_FASTER){this.dialect=mxConstants.DIALECT_PREFERHTML}else{this.dialect=mxConstants.DIALECT_MIXEDHTML}}}}this.model=(b!=null)?b:new mxGraphModel();this.multiplicities=[];this.imageBundles=[];this.cellRenderer=this.createCellRenderer();this.setSelectionModel(this.createSelectionModel());this.setStylesheet((c!=null)?c:this.createStylesheet());this.view=this.createGraphView();this.graphModelChangeListener=mxUtils.bind(this,function(f,e){this.graphModelChanged(e.getProperty("edit").changes)});this.model.addListener(mxEvent.CHANGE,this.graphModelChangeListener);this.createHandlers();if(a!=null){this.init(a)}this.view.revalidate()}if(mxLoadResources){mxResources.add(mxClient.basePath+"/resources/graph")}mxGraph.prototype=new mxEventSource();mxGraph.prototype.constructor=mxGraph;mxGraph.prototype.EMPTY_ARRAY=[];mxGraph.prototype.mouseListeners=null;mxGraph.prototype.isMouseDown=false;mxGraph.prototype.model=null;mxGraph.prototype.view=null;mxGraph.prototype.stylesheet=null;mxGraph.prototype.selectionModel=null;mxGraph.prototype.cellEditor=null;mxGraph.prototype.cellRenderer=null;mxGraph.prototype.multiplicities=null;mxGraph.prototype.renderHint=null;mxGraph.prototype.dialect=null;mxGraph.prototype.gridSize=10;mxGraph.prototype.gridEnabled=true;mxGraph.prototype.portsEnabled=true;mxGraph.prototype.nativeDblClickEnabled=true;mxGraph.prototype.doubleTapEnabled=true;mxGraph.prototype.doubleTapTimeout=500;mxGraph.prototype.doubleTapTolerance=25;mxGraph.prototype.lastTouchY=0;mxGraph.prototype.lastTouchY=0;mxGraph.prototype.lastTouchTime=0;mxGraph.prototype.tapAndHoldEnabled=true;mxGraph.prototype.tapAndHoldDelay=500;mxGraph.prototype.tapAndHoldInProgress=false;mxGraph.prototype.tapAndHoldValid=false;mxGraph.prototype.initialTouchX=0;mxGraph.prototype.initialTouchY=0;mxGraph.prototype.tolerance=4;mxGraph.prototype.defaultOverlap=0.5;mxGraph.prototype.defaultParent=null;mxGraph.prototype.alternateEdgeStyle=null;mxGraph.prototype.backgroundImage=null;mxGraph.prototype.pageVisible=false;mxGraph.prototype.pageBreaksVisible=false;mxGraph.prototype.pageBreakColor="gray";mxGraph.prototype.pageBreakDashed=true;mxGraph.prototype.minPageBreakDist=20;mxGraph.prototype.preferPageSize=false;mxGraph.prototype.pageFormat=mxConstants.PAGE_FORMAT_A4_PORTRAIT;mxGraph.prototype.pageScale=1.5;mxGraph.prototype.enabled=true;mxGraph.prototype.escapeEnabled=true;mxGraph.prototype.invokesStopCellEditing=true;mxGraph.prototype.enterStopsCellEditing=false;mxGraph.prototype.useScrollbarsForPanning=true;mxGraph.prototype.exportEnabled=true;mxGraph.prototype.importEnabled=true;mxGraph.prototype.cellsLocked=false;mxGraph.prototype.cellsCloneable=true;mxGraph.prototype.foldingEnabled=true;mxGraph.prototype.cellsEditable=true;mxGraph.prototype.cellsDeletable=true;mxGraph.prototype.cellsMovable=true;mxGraph.prototype.edgeLabelsMovable=true;mxGraph.prototype.vertexLabelsMovable=false;mxGraph.prototype.dropEnabled=false;mxGraph.prototype.splitEnabled=true;mxGraph.prototype.cellsResizable=true;mxGraph.prototype.cellsBendable=true;mxGraph.prototype.cellsSelectable=true;mxGraph.prototype.cellsDisconnectable=true;mxGraph.prototype.autoSizeCells=false;mxGraph.prototype.autoSizeCellsOnAdd=false;mxGraph.prototype.autoScroll=true;mxGraph.prototype.ignoreScrollbars=false;mxGraph.prototype.translateToScrollPosition=false;mxGraph.prototype.timerAutoScroll=false;mxGraph.prototype.allowAutoPanning=false;mxGraph.prototype.autoExtend=true;mxGraph.prototype.maximumGraphBounds=null;mxGraph.prototype.minimumGraphSize=null;mxGraph.prototype.minimumContainerSize=null;mxGraph.prototype.maximumContainerSize=null;mxGraph.prototype.resizeContainer=false;mxGraph.prototype.border=0;mxGraph.prototype.keepEdgesInForeground=false;mxGraph.prototype.keepEdgesInBackground=false;mxGraph.prototype.allowNegativeCoordinates=true;mxGraph.prototype.constrainChildren=true;mxGraph.prototype.constrainRelativeChildren=false;mxGraph.prototype.extendParents=true;mxGraph.prototype.extendParentsOnAdd=true;mxGraph.prototype.extendParentsOnMove=false;mxGraph.prototype.recursiveResize=false;mxGraph.prototype.collapseToPreferredSize=true;mxGraph.prototype.zoomFactor=1.2;mxGraph.prototype.keepSelectionVisibleOnZoom=false;mxGraph.prototype.centerZoom=true;mxGraph.prototype.resetViewOnRootChange=true;mxGraph.prototype.resetEdgesOnResize=false;mxGraph.prototype.resetEdgesOnMove=false;mxGraph.prototype.resetEdgesOnConnect=true;mxGraph.prototype.allowLoops=false;mxGraph.prototype.defaultLoopStyle=mxEdgeStyle.Loop;mxGraph.prototype.multigraph=true;mxGraph.prototype.connectableEdges=false;mxGraph.prototype.allowDanglingEdges=true;mxGraph.prototype.cloneInvalidEdges=false;mxGraph.prototype.disconnectOnMove=true;mxGraph.prototype.labelsVisible=true;mxGraph.prototype.htmlLabels=false;mxGraph.prototype.swimlaneSelectionEnabled=true;mxGraph.prototype.swimlaneNesting=true;mxGraph.prototype.swimlaneIndicatorColorAttribute=mxConstants.STYLE_FILLCOLOR;mxGraph.prototype.imageBundles=null;mxGraph.prototype.minFitScale=0.1;mxGraph.prototype.maxFitScale=8;mxGraph.prototype.panDx=0;mxGraph.prototype.panDy=0;mxGraph.prototype.collapsedImage=new mxImage(mxClient.imageBasePath+"/collapsed.gif",9,9);mxGraph.prototype.expandedImage=new mxImage(mxClient.imageBasePath+"/expanded.gif",9,9);mxGraph.prototype.warningImage=new mxImage(mxClient.imageBasePath+"/warning"+((mxClient.IS_MAC)?".png":".gif"),16,16);mxGraph.prototype.alreadyConnectedResource=(mxClient.language!="none")?"alreadyConnected":"";mxGraph.prototype.containsValidationErrorsResource=(mxClient.language!="none")?"containsValidationErrors":"";mxGraph.prototype.collapseExpandResource=(mxClient.language!="none")?"collapse-expand":"";mxGraph.prototype.init=function(a){this.container=a;this.cellEditor=this.createCellEditor();this.view.init();this.sizeDidChange();mxEvent.addListener(a,"mouseleave",mxUtils.bind(this,function(){if(this.tooltipHandler!=null){this.tooltipHandler.hide()}}));if(mxClient.IS_IE){mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}));mxEvent.addListener(a,"selectstart",mxUtils.bind(this,function(b){return this.isEditing()||(!this.isMouseDown&&!mxEvent.isShiftDown(b))}))}if(document.documentMode==8){a.insertAdjacentHTML("beforeend","<"+mxClient.VML_PREFIX+':group style="DISPLAY: none;"></'+mxClient.VML_PREFIX+":group>")}};mxGraph.prototype.createHandlers=function(){this.tooltipHandler=this.createTooltipHandler();this.tooltipHandler.setEnabled(false);this.selectionCellsHandler=this.createSelectionCellsHandler();this.connectionHandler=this.createConnectionHandler();this.connectionHandler.setEnabled(false);this.graphHandler=this.createGraphHandler();this.panningHandler=this.createPanningHandler();this.panningHandler.panningEnabled=false;this.popupMenuHandler=this.createPopupMenuHandler()};mxGraph.prototype.createTooltipHandler=function(){return new mxTooltipHandler(this)};mxGraph.prototype.createSelectionCellsHandler=function(){return new mxSelectionCellsHandler(this)};mxGraph.prototype.createConnectionHandler=function(){return new mxConnectionHandler(this)};mxGraph.prototype.createGraphHandler=function(){return new mxGraphHandler(this)};mxGraph.prototype.createPanningHandler=function(){return new mxPanningHandler(this)};mxGraph.prototype.createPopupMenuHandler=function(){return new mxPopupMenuHandler(this)};mxGraph.prototype.createSelectionModel=function(){return new mxGraphSelectionModel(this)};mxGraph.prototype.createStylesheet=function(){return new mxStylesheet()};mxGraph.prototype.createGraphView=function(){return new mxGraphView(this)};mxGraph.prototype.createCellRenderer=function(){return new mxCellRenderer()};mxGraph.prototype.createCellEditor=function(){return new mxCellEditor(this)};mxGraph.prototype.getModel=function(){return this.model};mxGraph.prototype.getView=function(){return this.view};mxGraph.prototype.getStylesheet=function(){return this.stylesheet};mxGraph.prototype.setStylesheet=function(a){this.stylesheet=a};mxGraph.prototype.getSelectionModel=function(){return this.selectionModel};mxGraph.prototype.setSelectionModel=function(a){this.selectionModel=a};mxGraph.prototype.getSelectionCellsForChanges=function(d){var b=[];for(var c=0;c<d.length;c++){var e=d[c];if(e.constructor!=mxRootChange){var a=null;if(e instanceof mxChildChange&&e.previous==null){a=e.child}else{if(e.cell!=null&&e.cell instanceof mxCell){a=e.cell}}if(a!=null&&mxUtils.indexOf(b,a)<0){b.push(a)}}}return this.getModel().getTopmostCells(b)};mxGraph.prototype.graphModelChanged=function(b){for(var a=0;a<b.length;a++){this.processChange(b[a])}this.removeSelectionCells(this.getRemovedCellsForChanges(b));this.view.validate();this.sizeDidChange()};mxGraph.prototype.getRemovedCellsForChanges=function(c){var a=[];for(var b=0;b<c.length;b++){var d=c[b];if(d instanceof mxRootChange){break}else{if(d instanceof mxChildChange){if(d.previous!=null&&d.parent==null){a=a.concat(this.model.getDescendants(d.child))}}else{if(d instanceof mxVisibleChange){a=a.concat(this.model.getDescendants(d.cell))}}}}return a};mxGraph.prototype.processChange=function(c){if(c instanceof mxRootChange){this.clearSelection();this.setDefaultParent(null);this.removeStateForCell(c.previous);if(this.resetViewOnRootChange){this.view.scale=1;this.view.translate.x=0;this.view.translate.y=0}this.fireEvent(new mxEventObject(mxEvent.ROOT))}else{if(c instanceof mxChildChange){var a=this.model.getParent(c.child);this.view.invalidate(c.child,true,true);if(a==null||this.isCellCollapsed(a)){this.view.invalidate(c.child,true,true);this.removeStateForCell(c.child);if(this.view.currentRoot==c.child){this.home()}}if(a!=c.previous){if(a!=null){this.view.invalidate(a,false,false)}if(c.previous!=null){this.view.invalidate(c.previous,false,false)}}}else{if(c instanceof mxTerminalChange||c instanceof mxGeometryChange){if(c instanceof mxTerminalChange||((c.previous==null&&c.geometry!=null)||(c.previous!=null&&!c.previous.equals(c.geometry)))){this.view.invalidate(c.cell)}}else{if(c instanceof mxValueChange){this.view.invalidate(c.cell,false,false)}else{if(c instanceof mxStyleChange){this.view.invalidate(c.cell,true,true);var b=this.view.getState(c.cell);if(b!=null){b.style=null}}else{if(c.cell!=null&&c.cell instanceof mxCell){this.removeStateForCell(c.cell)}}}}}}};mxGraph.prototype.removeStateForCell=function(a){var b=this.model.getChildCount(a);for(var c=0;c<b;c++){this.removeStateForCell(this.model.getChildAt(a,c))}this.view.invalidate(a,false,true);this.view.removeState(a)};mxGraph.prototype.addCellOverlay=function(a,b){if(a.overlays==null){a.overlays=[]}a.overlays.push(b);var c=this.view.getState(a);if(c!=null){this.cellRenderer.redraw(c)}this.fireEvent(new mxEventObject(mxEvent.ADD_OVERLAY,"cell",a,"overlay",b));return b};mxGraph.prototype.getCellOverlays=function(a){return a.overlays};mxGraph.prototype.removeCellOverlay=function(a,c){if(c==null){this.removeCellOverlays(a)}else{var b=mxUtils.indexOf(a.overlays,c);if(b>=0){a.overlays.splice(b,1);if(a.overlays.length==0){a.overlays=null}var d=this.view.getState(a);if(d!=null){this.cellRenderer.redraw(d)}this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",a,"overlay",c))}else{c=null}}return c};mxGraph.prototype.removeCellOverlays=function(a){var c=a.overlays;if(c!=null){a.overlays=null;var d=this.view.getState(a);if(d!=null){this.cellRenderer.redraw(d)}for(var b=0;b<c.length;b++){this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",a,"overlay",c[b]))}}return c};mxGraph.prototype.clearCellOverlays=function(a){a=(a!=null)?a:this.model.getRoot();this.removeCellOverlays(a);var b=this.model.getChildCount(a);for(var c=0;c<b;c++){var d=this.model.getChildAt(a,c);this.clearCellOverlays(d)}};mxGraph.prototype.setCellWarning=function(a,d,b,e){if(d!=null&&d.length>0){b=(b!=null)?b:this.warningImage;var c=new mxCellOverlay(b,"<font color=red>"+d+"</font>");if(e){c.addListener(mxEvent.CLICK,mxUtils.bind(this,function(g,f){if(this.isEnabled()){this.setSelectionCell(a)}}))}return this.addCellOverlay(a,c)}else{this.removeCellOverlays(a)}return null};mxGraph.prototype.startEditing=function(a){this.startEditingAtCell(null,a)};mxGraph.prototype.startEditingAtCell=function(a,b){if(b==null||!mxEvent.isMultiTouchEvent(b)){if(a==null){a=this.getSelectionCell();if(a!=null&&!this.isCellEditable(a)){a=null}}if(a!=null){this.fireEvent(new mxEventObject(mxEvent.START_EDITING,"cell",a,"event",b));this.cellEditor.startEditing(a,b);this.fireEvent(new mxEventObject(mxEvent.EDITING_STARTED,"cell",a,"event",b))}}};mxGraph.prototype.getEditingValue=function(a,b){return this.convertValueToString(a)};mxGraph.prototype.stopEditing=function(a){this.cellEditor.stopEditing(a);this.fireEvent(new mxEventObject(mxEvent.EDITING_STOPPED,"cancel",a))};mxGraph.prototype.labelChanged=function(a,d,c){this.model.beginUpdate();try{var b=a.value;this.cellLabelChanged(a,d,this.isAutoSizeCell(a));this.fireEvent(new mxEventObject(mxEvent.LABEL_CHANGED,"cell",a,"value",d,"old",b,"event",c))}finally{this.model.endUpdate()}return a};mxGraph.prototype.cellLabelChanged=function(b,c,a){this.model.beginUpdate();try{this.model.setValue(b,c);if(a){this.cellSizeUpdated(b,false)}}finally{this.model.endUpdate()}};mxGraph.prototype.escape=function(a){this.fireEvent(new mxEventObject(mxEvent.ESCAPE,"event",a))};mxGraph.prototype.click=function(c){var b=c.getEvent();var a=c.getCell();var e=new mxEventObject(mxEvent.CLICK,"event",b,"cell",a);if(c.isConsumed()){e.consume()}this.fireEvent(e);if(this.isEnabled()&&!mxEvent.isConsumed(b)&&!e.isConsumed()){if(a!=null){this.selectCellForEvent(a,b)}else{var d=null;if(this.isSwimlaneSelectionEnabled()){d=this.getSwimlaneAt(c.getGraphX(),c.getGraphY())}if(d!=null){this.selectCellForEvent(d,b)}else{if(!this.isToggleEvent(b)){this.clearSelection()}}}}};mxGraph.prototype.dblClick=function(b,a){var c=new mxEventObject(mxEvent.DOUBLE_CLICK,"event",b,"cell",a);this.fireEvent(c);if(this.isEnabled()&&!mxEvent.isConsumed(b)&&!c.isConsumed()&&a!=null&&this.isCellEditable(a)&&!this.isEditing(a)){this.startEditingAtCell(a,b);mxEvent.consume(b)}};mxGraph.prototype.tapAndHold=function(b){var a=b.getEvent();var d=new mxEventObject(mxEvent.TAP_AND_HOLD,"event",a,"cell",b.getCell());this.fireEvent(d);if(d.isConsumed()){this.panningHandler.panningTrigger=false}if(this.isEnabled()&&!mxEvent.isConsumed(a)&&!d.isConsumed()&&this.connectionHandler.isEnabled()){var c=this.view.getState(this.connectionHandler.marker.getCell(b));if(c!=null){this.connectionHandler.marker.currentColor=this.connectionHandler.marker.validColor;this.connectionHandler.marker.markedState=c;this.connectionHandler.marker.mark();this.connectionHandler.first=new mxPoint(b.getGraphX(),b.getGraphY());this.connectionHandler.edgeState=this.connectionHandler.createEdgeState(b);this.connectionHandler.previous=c;this.connectionHandler.fireEvent(new mxEventObject(mxEvent.START,"state",this.connectionHandler.previous))}}};mxGraph.prototype.scrollPointToVisible=function(j,h,f,e){if(!this.timerAutoScroll&&(this.ignoreScrollbars||mxUtils.hasScrollbars(this.container))){var g=this.container;e=(e!=null)?e:20;if(j>=g.scrollLeft&&h>=g.scrollTop&&j<=g.scrollLeft+g.clientWidth&&h<=g.scrollTop+g.clientHeight){var m=g.scrollLeft+g.clientWidth-j;if(m<e){var d=g.scrollLeft;g.scrollLeft+=e-m;if(f&&d==g.scrollLeft){if(this.dialect==mxConstants.DIALECT_SVG){var i=this.view.getDrawPane().ownerSVGElement;var a=this.container.scrollWidth+e-m;i.style.width=a+"px"}else{var a=Math.max(g.clientWidth,g.scrollWidth)+e-m;var b=this.view.getCanvas();b.style.width=a+"px"}g.scrollLeft+=e-m}}else{m=j-g.scrollLeft;if(m<e){g.scrollLeft-=e-m}}var l=g.scrollTop+g.clientHeight-h;if(l<e){var d=g.scrollTop;g.scrollTop+=e-l;if(d==g.scrollTop&&f){if(this.dialect==mxConstants.DIALECT_SVG){var i=this.view.getDrawPane().ownerSVGElement;var k=this.container.scrollHeight+e-l;i.style.height=k+"px"}else{var k=Math.max(g.clientHeight,g.scrollHeight)+e-l;var b=this.view.getCanvas();b.style.height=k+"px"}g.scrollTop+=e-l}}else{l=h-g.scrollTop;if(l<e){g.scrollTop-=e-l}}}}else{if(this.allowAutoPanning&&!this.panningHandler.isActive()){if(this.panningManager==null){this.panningManager=this.createPanningManager()}this.panningManager.panTo(j+this.panDx,h+this.panDy)}}};mxGraph.prototype.createPanningManager=function(){return new mxPanningManager(this)};mxGraph.prototype.getBorderSizes=function(){var a=mxUtils.getCurrentStyle(this.container);return new mxRectangle(mxUtils.parseCssNumber(a.paddingLeft)+((a.borderLeftStyle!="none")?mxUtils.parseCssNumber(a.borderLeftWidth):0),mxUtils.parseCssNumber(a.paddingTop)+((a.borderTopStyle!="none")?mxUtils.parseCssNumber(a.borderTopWidth):0),mxUtils.parseCssNumber(a.paddingRight)+((a.borderRightStyle!="none")?mxUtils.parseCssNumber(a.borderRightWidth):0),mxUtils.parseCssNumber(a.paddingBottom)+((a.borderBottomStyle!="none")?mxUtils.parseCssNumber(a.borderBottomWidth):0))};mxGraph.prototype.getPreferredPageSize=function(b,c,j){var f=this.view.scale;var i=this.view.translate;var d=this.pageFormat;var a=this.pageScale;var h=new mxRectangle(0,0,Math.ceil(d.width*a),Math.ceil(d.height*a));var e=(this.pageBreaksVisible)?Math.ceil(c/h.width):1;var g=(this.pageBreaksVisible)?Math.ceil(j/h.height):1;return new mxRectangle(0,0,e*h.width+2+i.x,g*h.height+2+i.y)};mxGraph.prototype.fit=function(n,t,m,i,c,o){if(this.container!=null){n=(n!=null)?n:this.getBorder();t=(t!=null)?t:false;m=(m!=null)?m:0;i=(i!=null)?i:true;c=(c!=null)?c:false;o=(o!=null)?o:false;var p=this.getBorderSizes();var k=this.container.offsetWidth-p.x-p.width-1;var h=this.container.offsetHeight-p.y-p.height-1;var f=this.view.getGraphBounds();if(f.width>0&&f.height>0){if(t&&f.x!=null&&f.y!=null){f=f.clone();f.width+=f.x;f.height+=f.y;f.x=0;f.y=0}var l=this.view.scale;var j=f.width/l;var g=f.height/l;if(this.backgroundImage!=null){j=Math.max(j,this.backgroundImage.width-f.x/l);g=Math.max(g,this.backgroundImage.height-f.y/l)}var r=((t)?n:2*n)+m;k-=r;h-=r;var a=(((c)?h/g:(o)?k/j:Math.min(k/j,h/g)));if(this.minFitScale!=null){a=Math.max(a,this.minFitScale)}if(this.maxFitScale!=null){a=Math.min(a,this.maxFitScale)}if(i){if(!t){if(!mxUtils.hasScrollbars(this.container)){var q=(f.x!=null)?Math.floor(this.view.translate.x-f.x/l+n/a+m/2):n;var d=(f.y!=null)?Math.floor(this.view.translate.y-f.y/l+n/a+m/2):n;this.view.scaleAndTranslate(a,q,d)}else{this.view.setScale(a);var e=this.getGraphBounds();if(e.x!=null){this.container.scrollLeft=e.x}if(e.y!=null){this.container.scrollTop=e.y}}}else{if(this.view.scale!=a){this.view.setScale(a)}}}else{return a}}}return this.view.scale};mxGraph.prototype.sizeDidChange=function(){var f=this.getGraphBounds();if(this.container!=null){var c=this.getBorder();var e=Math.max(0,f.x+f.width+c);var a=Math.max(0,f.y+f.height+c);if(this.minimumContainerSize!=null){e=Math.max(e,this.minimumContainerSize.width);a=Math.max(a,this.minimumContainerSize.height)}if(this.resizeContainer){this.doResizeContainer(e,a)}if(this.preferPageSize||(!mxClient.IS_IE&&this.pageVisible)){var d=this.getPreferredPageSize(f,Math.max(1,e),Math.max(1,a));if(d!=null){e=d.width*this.view.scale;a=d.height*this.view.scale}}if(this.minimumGraphSize!=null){e=Math.max(e,this.minimumGraphSize.width*this.view.scale);a=Math.max(a,this.minimumGraphSize.height*this.view.scale)}e=Math.ceil(e);a=Math.ceil(a);if(this.dialect==mxConstants.DIALECT_SVG){var b=this.view.getDrawPane().ownerSVGElement;b.style.minWidth=Math.max(1,e)+"px";b.style.minHeight=Math.max(1,a)+"px";b.style.width="100%";b.style.height="100%"}else{if(mxClient.IS_QUIRKS){this.view.updateHtmlCanvasSize(Math.max(1,e),Math.max(1,a))}else{this.view.canvas.style.minWidth=Math.max(1,e)+"px";this.view.canvas.style.minHeight=Math.max(1,a)+"px"}}this.updatePageBreaks(this.pageBreaksVisible,e,a)}this.fireEvent(new mxEventObject(mxEvent.SIZE,"bounds",f))};mxGraph.prototype.doResizeContainer=function(b,a){if(this.maximumContainerSize!=null){b=Math.min(this.maximumContainerSize.width,b);a=Math.min(this.maximumContainerSize.height,a)}this.container.style.width=Math.ceil(b)+"px";this.container.style.height=Math.ceil(a)+"px"};mxGraph.prototype.updatePageBreaks=function(i,e,n){var j=this.view.scale;var k=this.view.translate;var g=this.pageFormat;var b=j*this.pageScale;var c=new mxRectangle(0,0,g.width*b,g.height*b);var m=mxRectangle.fromRectangle(this.getGraphBounds());m.width=Math.max(1,m.width);m.height=Math.max(1,m.height);c.x=Math.floor((m.x-k.x*j)/c.width)*c.width+k.x*j;c.y=Math.floor((m.y-k.y*j)/c.height)*c.height+k.y*j;m.width=Math.ceil((m.width+(m.x-c.x))/c.width)*c.width;m.height=Math.ceil((m.height+(m.y-c.y))/c.height)*c.height;i=i&&Math.min(c.width,c.height)>this.minPageBreakDist;var d=(i)?Math.ceil(m.height/c.height)+1:0;var f=(i)?Math.ceil(m.width/c.width)+1:0;var l=(f-1)*c.width;var a=(d-1)*c.height;if(this.horizontalPageBreaks==null&&d>0){this.horizontalPageBreaks=[]}if(this.verticalPageBreaks==null&&f>0){this.verticalPageBreaks=[]}var h=mxUtils.bind(this,function(r){if(r!=null){var q=(r==this.horizontalPageBreaks)?d:f;for(var p=0;p<=q;p++){var s=(r==this.horizontalPageBreaks)?[new mxPoint(Math.round(c.x),Math.round(c.y+p*c.height)),new mxPoint(Math.round(c.x+l),Math.round(c.y+p*c.height))]:[new mxPoint(Math.round(c.x+p*c.width),Math.round(c.y)),new mxPoint(Math.round(c.x+p*c.width),Math.round(c.y+a))];if(r[p]!=null){r[p].points=s;r[p].redraw()}else{var o=new mxPolyline(s,this.pageBreakColor);o.dialect=this.dialect;o.pointerEvents=false;o.isDashed=this.pageBreakDashed;o.init(this.view.backgroundPane);o.redraw();r[p]=o}}for(var p=q;p<r.length;p++){r[p].destroy()}r.splice(q,r.length-q)}});h(this.horizontalPageBreaks);h(this.verticalPageBreaks)};mxGraph.prototype.getCellStyle=function(a){var c=this.model.getStyle(a);var b=null;if(this.model.isEdge(a)){b=this.stylesheet.getDefaultEdgeStyle()}else{b=this.stylesheet.getDefaultVertexStyle()}if(c!=null){b=this.postProcessCellStyle(this.stylesheet.getCellStyle(c,b))}if(b==null){b=mxGraph.prototype.EMPTY_ARRAY}return b};mxGraph.prototype.postProcessCellStyle=function(c){if(c!=null){var b=c[mxConstants.STYLE_IMAGE];var d=this.getImageFromBundles(b);if(d!=null){c[mxConstants.STYLE_IMAGE]=d}else{d=b}if(d!=null&&d.substring(0,11)=="data:image/"){if(d.substring(0,20)=="data:image/svg+xml,<"){d=d.substring(0,19)+encodeURIComponent(d.substring(19))}else{if(d.substring(0,22)!="data:image/svg+xml,%3C"){var a=d.indexOf(",");if(a>0&&d.substring(a-7,a+1)!=";base64,"){d=d.substring(0,a)+";base64,"+d.substring(a+1)}}}c[mxConstants.STYLE_IMAGE]=d}}return c};mxGraph.prototype.setCellStyle=function(c,a){a=a||this.getSelectionCells();if(a!=null){this.model.beginUpdate();try{for(var b=0;b<a.length;b++){this.model.setStyle(a[b],c)}}finally{this.model.endUpdate()}}};mxGraph.prototype.toggleCellStyle=function(c,b,a){a=a||this.getSelectionCell();return this.toggleCellStyles(c,b,[a])};mxGraph.prototype.toggleCellStyles=function(c,a,b){a=(a!=null)?a:false;b=b||this.getSelectionCells();var f=null;if(b!=null&&b.length>0){var e=this.view.getState(b[0]);var d=(e!=null)?e.style:this.getCellStyle(b[0]);if(d!=null){f=(mxUtils.getValue(d,c,a))?0:1;this.setCellStyles(c,f,b)}}return f};mxGraph.prototype.setCellStyles=function(b,c,a){a=a||this.getSelectionCells();mxUtils.setCellStyles(this.model,a,b,c)};mxGraph.prototype.toggleCellStyleFlags=function(c,a,b){this.setCellStyleFlags(c,a,null,b)};mxGraph.prototype.setCellStyleFlags=function(c,a,f,b){b=b||this.getSelectionCells();if(b!=null&&b.length>0){if(f==null){var e=this.view.getState(b[0]);var d=(e!=null)?e.style:this.getCellStyle(b[0]);if(d!=null){var g=parseInt(d[c]||0);f=!((g&a)==a)}}mxUtils.setCellStyleFlags(this.model,b,c,a,f)}};mxGraph.prototype.alignCells=function(g,a,f){if(a==null){a=this.getSelectionCells()}if(a!=null&&a.length>1){if(f==null){for(var b=0;b<a.length;b++){var d=this.view.getState(a[b]);if(d!=null&&!this.model.isEdge(a[b])){if(f==null){if(g==mxConstants.ALIGN_CENTER){f=d.x+d.width/2;break}else{if(g==mxConstants.ALIGN_RIGHT){f=d.x+d.width}else{if(g==mxConstants.ALIGN_TOP){f=d.y}else{if(g==mxConstants.ALIGN_MIDDLE){f=d.y+d.height/2;break}else{if(g==mxConstants.ALIGN_BOTTOM){f=d.y+d.height}else{f=d.x}}}}}}else{if(g==mxConstants.ALIGN_RIGHT){f=Math.max(f,d.x+d.width)}else{if(g==mxConstants.ALIGN_TOP){f=Math.min(f,d.y)}else{if(g==mxConstants.ALIGN_BOTTOM){f=Math.max(f,d.y+d.height)}else{f=Math.min(f,d.x)}}}}}}}if(f!=null){var c=this.view.scale;this.model.beginUpdate();try{for(var b=0;b<a.length;b++){var d=this.view.getState(a[b]);if(d!=null){var e=this.getCellGeometry(a[b]);if(e!=null&&!this.model.isEdge(a[b])){e=e.clone();if(g==mxConstants.ALIGN_CENTER){e.x+=(f-d.x-d.width/2)/c}else{if(g==mxConstants.ALIGN_RIGHT){e.x+=(f-d.x-d.width)/c}else{if(g==mxConstants.ALIGN_TOP){e.y+=(f-d.y)/c}else{if(g==mxConstants.ALIGN_MIDDLE){e.y+=(f-d.y-d.height/2)/c}else{if(g==mxConstants.ALIGN_BOTTOM){e.y+=(f-d.y-d.height)/c}else{e.x+=(f-d.x)/c}}}}}this.resizeCell(a[b],e)}}}this.fireEvent(new mxEventObject(mxEvent.ALIGN_CELLS,"align",g,"cells",a))}finally{this.model.endUpdate()}}}return a};mxGraph.prototype.flipEdge=function(b){if(b!=null&&this.alternateEdgeStyle!=null){this.model.beginUpdate();try{var a=this.model.getStyle(b);if(a==null||a.length==0){this.model.setStyle(b,this.alternateEdgeStyle)}else{this.model.setStyle(b,null)}this.resetEdge(b);this.fireEvent(new mxEventObject(mxEvent.FLIP_EDGE,"edge",b))}finally{this.model.endUpdate()}}return b};mxGraph.prototype.addImageBundle=function(a){this.imageBundles.push(a)};mxGraph.prototype.removeImageBundle=function(a){var c=[];for(var b=0;b<this.imageBundles.length;b++){if(this.imageBundles[b]!=a){c.push(this.imageBundles[b])}}this.imageBundles=c};mxGraph.prototype.getImageFromBundles=function(b){if(b!=null){for(var a=0;a<this.imageBundles.length;a++){var c=this.imageBundles[a].getImage(b);if(c!=null){return c}}}return null};mxGraph.prototype.orderCells=function(a,b){if(b==null){b=mxUtils.sortCells(this.getSelectionCells(),true)}this.model.beginUpdate();try{this.cellsOrdered(b,a);this.fireEvent(new mxEventObject(mxEvent.ORDER_CELLS,"back",a,"cells",b))}finally{this.model.endUpdate()}return b};mxGraph.prototype.cellsOrdered=function(b,a){if(b!=null){this.model.beginUpdate();try{for(var c=0;c<b.length;c++){var d=this.model.getParent(b[c]);if(a){this.model.add(d,b[c],c)}else{this.model.add(d,b[c],this.model.getChildCount(d)-1)}}this.fireEvent(new mxEventObject(mxEvent.CELLS_ORDERED,"back",a,"cells",b))}finally{this.model.endUpdate()}}};mxGraph.prototype.groupCells=function(f,c,b){if(b==null){b=mxUtils.sortCells(this.getSelectionCells(),true)}b=this.getCellsForGroup(b);if(f==null){f=this.createGroupCell(b)}var e=this.getBoundsForGroup(f,b,c);if(b.length>0&&e!=null){var d=this.model.getParent(f);if(d==null){d=this.model.getParent(b[0])}this.model.beginUpdate();try{if(this.getCellGeometry(f)==null){this.model.setGeometry(f,new mxGeometry())}var a=this.model.getChildCount(d);this.cellsAdded([f],d,a,null,null,false,false,false);a=this.model.getChildCount(f);this.cellsAdded(b,f,a,null,null,false,false,false);this.cellsMoved(b,-e.x,-e.y,false,false,false);this.cellsResized([f],[e],false);this.fireEvent(new mxEventObject(mxEvent.GROUP_CELLS,"group",f,"border",c,"cells",b))}finally{this.model.endUpdate()}}return f};mxGraph.prototype.getCellsForGroup=function(b){var a=[];if(b!=null&&b.length>0){var d=this.model.getParent(b[0]);a.push(b[0]);for(var c=1;c<b.length;c++){if(this.model.getParent(b[c])==d){a.push(b[c])}}}return a};mxGraph.prototype.getBoundsForGroup=function(e,d,b){var a=this.getBoundingBoxFromGeometry(d,true);if(a!=null){if(this.isSwimlane(e)){var c=this.getStartSize(e);a.x-=c.width;a.y-=c.height;a.width+=c.width;a.height+=c.height}if(b!=null){a.x-=b;a.y-=b;a.width+=2*b;a.height+=2*b}}return a};mxGraph.prototype.createGroupCell=function(a){var b=new mxCell("");b.setVertex(true);b.setConnectable(false);return b};mxGraph.prototype.ungroupCells=function(c){var a=[];if(c==null){c=this.getSelectionCells();var f=[];for(var e=0;e<c.length;e++){if(this.model.getChildCount(c[e])>0){f.push(c[e])}}c=f}if(c!=null&&c.length>0){this.model.beginUpdate();try{for(var e=0;e<c.length;e++){var d=this.model.getChildren(c[e]);if(d!=null&&d.length>0){d=d.slice();var g=this.model.getParent(c[e]);var b=this.model.getChildCount(g);this.cellsAdded(d,g,b,null,null,true);a=a.concat(d)}}this.removeCellsAfterUngroup(c);this.fireEvent(new mxEventObject(mxEvent.UNGROUP_CELLS,"cells",c))}finally{this.model.endUpdate()}}return a};mxGraph.prototype.removeCellsAfterUngroup=function(a){this.cellsRemoved(this.addAllEdges(a))};mxGraph.prototype.removeCellsFromParent=function(b){if(b==null){b=this.getSelectionCells()}this.model.beginUpdate();try{var c=this.getDefaultParent();var a=this.model.getChildCount(c);this.cellsAdded(b,c,a,null,null,true);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS_FROM_PARENT,"cells",b))}finally{this.model.endUpdate()}return b};mxGraph.prototype.updateGroupBounds=function(n,f,m,h,k,c,b){if(n==null){n=this.getSelectionCells()}f=(f!=null)?f:0;m=(m!=null)?m:false;h=(h!=null)?h:0;k=(k!=null)?k:0;c=(c!=null)?c:0;b=(b!=null)?b:0;this.model.beginUpdate();try{for(var j=n.length-1;j>=0;j--){var g=this.getCellGeometry(n[j]);if(g!=null){var d=this.getChildCells(n[j]);if(d!=null&&d.length>0){var a=this.getBoundingBoxFromGeometry(d,true);if(a!=null&&a.width>0&&a.height>0){var e=0;var l=0;if(this.isSwimlane(n[j])){var o=this.getStartSize(n[j]);e=o.width;l=o.height}g=g.clone();if(m){g.x=Math.round(g.x+a.x-f-e-b);g.y=Math.round(g.y+a.y-f-l-h)}g.width=Math.round(a.width+2*f+e+b+k);g.height=Math.round(a.height+2*f+l+h+c);this.model.setGeometry(n[j],g);this.moveCells(d,f+e-a.x+b,f+l-a.y+h)}}}}}finally{this.model.endUpdate()}return n};mxGraph.prototype.getBoundingBox=function(b){var a=null;if(b!=null&&b.length>0){for(var c=0;c<b.length;c++){if(this.model.isVertex(b[c])||this.model.isEdge(b[c])){var d=this.view.getBoundingBox(this.view.getState(b[c]),true);if(d!=null){if(a==null){a=mxRectangle.fromRectangle(d)}else{a.add(d)}}}}}return a};mxGraph.prototype.cloneCells=function(b,t,h){t=(t!=null)?t:true;var a=null;if(b!=null){var d=new mxDictionary();var u=[];for(var q=0;q<b.length;q++){d.put(b[q],true);u.push(b[q])}if(u.length>0){var w=this.view.scale;var c=this.view.translate;a=this.model.cloneCells(b,true,h);for(var q=0;q<b.length;q++){if(!t&&this.model.isEdge(a[q])&&this.getEdgeValidationError(a[q],this.model.getTerminal(a[q],true),this.model.getTerminal(a[q],false))!=null){a[q]=null}else{var s=this.model.getGeometry(a[q]);if(s!=null){var e=this.view.getState(b[q]);var v=this.view.getState(this.model.getParent(b[q]));if(e!=null&&v!=null){var l=v.origin.x;var k=v.origin.y;if(this.model.isEdge(a[q])){var x=e.absolutePoints;var f=this.model.getTerminal(b[q],true);while(f!=null&&!d.get(f)){f=this.model.getParent(f)}if(f==null){s.setTerminalPoint(new mxPoint(x[0].x/w-c.x,x[0].y/w-c.y),true)}var r=this.model.getTerminal(b[q],false);while(r!=null&&!d.get(r)){r=this.model.getParent(r)}if(r==null){var m=x.length-1;s.setTerminalPoint(new mxPoint(x[m].x/w-c.x,x[m].y/w-c.y),false)}var p=s.points;if(p!=null){for(var o=0;o<p.length;o++){p[o].x+=l;p[o].y+=k}}}else{s.translate(l,k)}}}}}}else{a=[]}}return a};mxGraph.prototype.insertVertex=function(i,c,h,g,f,d,j,b,a){var e=this.createVertex(i,c,h,g,f,d,j,b,a);return this.addCell(e,i)};mxGraph.prototype.createVertex=function(j,c,i,h,g,d,k,b,a){var f=new mxGeometry(h,g,d,k);f.relative=(a!=null)?a:false;var e=new mxCell(i,f,b);e.setId(c);e.setVertex(true);e.setConnectable(true);return e};mxGraph.prototype.insertEdge=function(b,g,e,d,f,a){var c=this.createEdge(b,g,e,d,f,a);return this.addEdge(c,b,d,f)};mxGraph.prototype.createEdge=function(b,g,e,d,f,a){var c=new mxCell(e,new mxGeometry(),a);c.setId(g);c.setEdge(true);c.geometry.relative=true;return c};mxGraph.prototype.addEdge=function(c,b,d,e,a){return this.addCell(c,b,a,d,e)};mxGraph.prototype.addCell=function(a,c,b,d,e){return this.addCells([a],c,b,d,e)[0]};mxGraph.prototype.addCells=function(b,c,a,d,e){if(c==null){c=this.getDefaultParent()}if(a==null){a=this.model.getChildCount(c)}this.model.beginUpdate();try{this.cellsAdded(b,c,a,d,e,false,true);this.fireEvent(new mxEventObject(mxEvent.ADD_CELLS,"cells",b,"parent",c,"index",a,"source",d,"target",e))}finally{this.model.endUpdate()}return b};mxGraph.prototype.cellsAdded=function(d,f,e,k,r,q,l,p){if(d!=null&&f!=null&&e!=null){this.model.beginUpdate();try{var a=(q)?this.view.getState(f):null;var n=(a!=null)?a.origin:null;var j=new mxPoint(0,0);for(var o=0;o<d.length;o++){if(d[o]==null){e--}else{var b=this.model.getParent(d[o]);if(n!=null&&d[o]!=f&&f!=b){var c=this.view.getState(b);var m=(c!=null)?c.origin:j;var s=this.model.getGeometry(d[o]);if(s!=null){var h=m.x-n.x;var g=m.y-n.y;s=s.clone();s.translate(h,g);if(!s.relative&&this.model.isVertex(d[o])&&!this.isAllowNegativeCoordinates()){s.x=Math.max(0,s.x);s.y=Math.max(0,s.y)}this.model.setGeometry(d[o],s)}}if(f==b&&e+o>this.model.getChildCount(f)){e--}this.model.add(f,d[o],e+o);if(this.autoSizeCellsOnAdd){this.autoSizeCell(d[o],true)}if((p==null||p)&&this.isExtendParentsOnAdd(d[o])&&this.isExtendParent(d[o])){this.extendParent(d[o])}if(l==null||l){this.constrainChild(d[o])}if(k!=null){this.cellConnected(d[o],k,true)}if(r!=null){this.cellConnected(d[o],r,false)}}}this.fireEvent(new mxEventObject(mxEvent.CELLS_ADDED,"cells",d,"parent",f,"index",e,"source",k,"target",r,"absolute",q))}finally{this.model.endUpdate()}}};mxGraph.prototype.autoSizeCell=function(a,d){d=(d!=null)?d:true;if(d){var b=this.model.getChildCount(a);for(var c=0;c<b;c++){this.autoSizeCell(this.model.getChildAt(a,c))}}if(this.getModel().isVertex(a)&&this.isAutoSizeCell(a)){this.updateCellSize(a)}};mxGraph.prototype.removeCells=function(a,b){b=(b!=null)?b:true;if(a==null){a=this.getDeletableCells(this.getSelectionCells())}if(b){a=this.getDeletableCells(this.addAllEdges(a))}this.model.beginUpdate();try{this.cellsRemoved(a);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS,"cells",a,"includeEdges",b))}finally{this.model.endUpdate()}return a};mxGraph.prototype.cellsRemoved=function(d){if(d!=null&&d.length>0){var g=this.view.scale;var f=this.view.translate;this.model.beginUpdate();try{var h=new mxDictionary();for(var e=0;e<d.length;e++){h.put(d[e],true)}for(var e=0;e<d.length;e++){var b=this.getAllEdges([d[e]]);var a=mxUtils.bind(this,function(k,i){var o=this.model.getGeometry(k);if(o!=null){var j=this.view.getState(k);if(j!=null){var p=j.getVisibleTerminal(i);var m=false;while(p!=null){if(d[e]==p){m=true;break}p=this.model.getParent(p)}if(m){var t=f.x;var r=f.y;var q=this.view.getState(this.model.getParent(k));if(q!=null&&this.model.isVertex(q.cell)){t=q.x/g;r=q.y/g}o=o.clone();var s=j.absolutePoints;var l=(i)?0:s.length-1;o.setTerminalPoint(new mxPoint(s[l].x/g-t,s[l].y/g-r),i);this.model.setTerminal(b[c],null,i);this.model.setGeometry(b[c],o)}}}});for(var c=0;c<b.length;c++){if(!h.get(b[c])){a(b[c],true);a(b[c],false)}}this.model.remove(d[e])}this.fireEvent(new mxEventObject(mxEvent.CELLS_REMOVED,"cells",d))}finally{this.model.endUpdate()}}};mxGraph.prototype.splitEdge=function(c,i,e,l,j){l=l||0;j=j||0;var g=this.model.getParent(c);var a=this.model.getTerminal(c,true);this.model.beginUpdate();try{if(e==null){e=this.cloneCells([c])[0];this.setCellStyles(mxConstants.STYLE_ENDARROW,mxConstants.NONE,[e]);this.setCellStyles(mxConstants.STYLE_STARTARROW,mxConstants.NONE,[c]);var b=this.view.getState(c);var d=this.getCellGeometry(e);if(d!=null&&d.points!=null&&b!=null){var h=this.view.translate;var k=this.view.scale;var f=mxUtils.findNearestSegment(b,(l+h.x)*k,(j+h.y)*k);d.points=d.points.slice(0,f);d=this.getCellGeometry(c);if(d!=null&&d.points!=null){d=d.clone();d.points=d.points.slice(f);this.model.setGeometry(c,d)}}}this.cellsMoved(i,l,j,false,false);this.cellsAdded(i,g,this.model.getChildCount(g),null,null,true);this.cellsAdded([e],g,this.model.getChildCount(g),a,i[0],false);this.cellConnected(c,i[0],true);this.fireEvent(new mxEventObject(mxEvent.SPLIT_EDGE,"edge",c,"cells",i,"newEdge",e,"dx",l,"dy",j))}finally{this.model.endUpdate()}return e};mxGraph.prototype.toggleCells=function(a,b,c){if(b==null){b=this.getSelectionCells()}if(c){b=this.addAllEdges(b)}this.model.beginUpdate();try{this.cellsToggled(b,a);this.fireEvent(new mxEventObject(mxEvent.TOGGLE_CELLS,"show",a,"cells",b,"includeEdges",c))}finally{this.model.endUpdate()}return b};mxGraph.prototype.cellsToggled=function(b,a){if(b!=null&&b.length>0){this.model.beginUpdate();try{for(var c=0;c<b.length;c++){this.model.setVisible(b[c],a)}}finally{this.model.endUpdate()}}};mxGraph.prototype.foldCells=function(e,d,c,b,a){d=(d!=null)?d:false;if(c==null){c=this.getFoldableCells(this.getSelectionCells(),e)}this.stopEditing(false);this.model.beginUpdate();try{this.cellsFolded(c,e,d,b);this.fireEvent(new mxEventObject(mxEvent.FOLD_CELLS,"collapse",e,"recurse",d,"cells",c))}finally{this.model.endUpdate()}return c};mxGraph.prototype.cellsFolded=function(b,f,e,a){if(b!=null&&b.length>0){this.model.beginUpdate();try{for(var d=0;d<b.length;d++){if((!a||this.isCellFoldable(b[d],f))&&f!=this.isCellCollapsed(b[d])){this.model.setCollapsed(b[d],f);this.swapBounds(b[d],f);if(this.isExtendParent(b[d])){this.extendParent(b[d])}if(e){var c=this.model.getChildren(b[d]);this.foldCells(c,f,e)}this.constrainChild(b[d])}}this.fireEvent(new mxEventObject(mxEvent.CELLS_FOLDED,"cells",b,"collapse",f,"recurse",e))}finally{this.model.endUpdate()}}};mxGraph.prototype.swapBounds=function(a,b){if(a!=null){var c=this.model.getGeometry(a);if(c!=null){c=c.clone();this.updateAlternateBounds(a,c,b);c.swap();this.model.setGeometry(a,c)}}};mxGraph.prototype.updateAlternateBounds=function(k,e,h){if(k!=null&&e!=null){var b=this.view.getState(k);var c=(b!=null)?b.style:this.getCellStyle(k);if(e.alternateBounds==null){var a=e;if(this.collapseToPreferredSize){var f=this.getPreferredSizeForCell(k);if(f!=null){a=f;var m=mxUtils.getValue(c,mxConstants.STYLE_STARTSIZE);if(m>0){a.height=Math.max(a.height,m)}}}e.alternateBounds=new mxRectangle(0,0,a.width,a.height)}if(e.alternateBounds!=null){e.alternateBounds.x=e.x;e.alternateBounds.y=e.y;var d=mxUtils.toRadians(c[mxConstants.STYLE_ROTATION]||0);if(d!=0){var o=e.alternateBounds.getCenterX()-e.getCenterX();var n=e.alternateBounds.getCenterY()-e.getCenterY();var l=Math.cos(d);var i=Math.sin(d);var j=l*o-i*n;var g=i*o+l*n;e.alternateBounds.x+=j-o;e.alternateBounds.y+=g-n}}}};mxGraph.prototype.addAllEdges=function(a){var b=a.slice();return mxUtils.removeDuplicates(b.concat(this.getAllEdges(a)))};mxGraph.prototype.getAllEdges=function(c){var a=[];if(c!=null){for(var e=0;e<c.length;e++){var f=this.model.getEdgeCount(c[e]);for(var b=0;b<f;b++){a.push(this.model.getEdgeAt(c[e],b))}var d=this.model.getChildren(c[e]);a=a.concat(this.getAllEdges(d))}}return a};mxGraph.prototype.updateCellSize=function(b,a){a=(a!=null)?a:false;this.model.beginUpdate();try{this.cellSizeUpdated(b,a);this.fireEvent(new mxEventObject(mxEvent.UPDATE_CELL_SIZE,"cell",b,"ignoreChildren",a))}finally{this.model.endUpdate()}return b};mxGraph.prototype.cellSizeUpdated=function(k,f){if(k!=null){this.model.beginUpdate();try{var m=this.getPreferredSizeForCell(k);var i=this.model.getGeometry(k);if(m!=null&&i!=null){var h=this.isCellCollapsed(k);i=i.clone();if(this.isSwimlane(k)){var b=this.view.getState(k);var c=(b!=null)?b.style:this.getCellStyle(k);var e=this.model.getStyle(k);if(e==null){e=""}if(mxUtils.getValue(c,mxConstants.STYLE_HORIZONTAL,true)){e=mxUtils.setStyle(e,mxConstants.STYLE_STARTSIZE,m.height+8);if(h){i.height=m.height+8}i.width=m.width}else{e=mxUtils.setStyle(e,mxConstants.STYLE_STARTSIZE,m.width+8);if(h){i.width=m.width+8}i.height=m.height}this.model.setStyle(k,e)}else{i.width=m.width;i.height=m.height}if(!f&&!h){var a=this.view.getBounds(this.model.getChildren(k));if(a!=null){var j=this.view.translate;var g=this.view.scale;var d=(a.x+a.width)/g-i.x-j.x;var l=(a.y+a.height)/g-i.y-j.y;i.width=Math.max(i.width,d);i.height=Math.max(i.height,l)}}this.cellsResized([k],[i],false)}}finally{this.model.endUpdate()}}};mxGraph.prototype.getPreferredSizeForCell=function(h){var n=null;if(h!=null){var a=this.view.getState(h)||this.view.createState(h);var b=a.style;if(!this.model.isEdge(h)){var l=b[mxConstants.STYLE_FONTSIZE]||mxConstants.DEFAULT_FONTSIZE;var m=0;var j=0;if(this.getImage(a)!=null||b[mxConstants.STYLE_IMAGE]!=null){if(b[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_LABEL){if(b[mxConstants.STYLE_VERTICAL_ALIGN]==mxConstants.ALIGN_MIDDLE){m+=parseFloat(b[mxConstants.STYLE_IMAGE_WIDTH])||mxLabel.prototype.imageSize}if(b[mxConstants.STYLE_ALIGN]!=mxConstants.ALIGN_CENTER){j+=parseFloat(b[mxConstants.STYLE_IMAGE_HEIGHT])||mxLabel.prototype.imageSize}}}m+=2*(b[mxConstants.STYLE_SPACING]||0);m+=b[mxConstants.STYLE_SPACING_LEFT]||0;m+=b[mxConstants.STYLE_SPACING_RIGHT]||0;j+=2*(b[mxConstants.STYLE_SPACING]||0);j+=b[mxConstants.STYLE_SPACING_TOP]||0;j+=b[mxConstants.STYLE_SPACING_BOTTOM]||0;var e=this.getFoldingImage(a);if(e!=null){m+=e.width+8}var g=this.cellRenderer.getLabelValue(a);if(g!=null&&g.length>0){if(!this.isHtmlLabel(a.cell)){g=mxUtils.htmlEntities(g)}g=g.replace(/\n/g,"<br>");var k=mxUtils.getSizeForString(g,l,b[mxConstants.STYLE_FONTFAMILY]);var c=k.width+m;var i=k.height+j;if(!mxUtils.getValue(b,mxConstants.STYLE_HORIZONTAL,true)){var f=i;i=c;c=f}if(this.gridEnabled){c=this.snap(c+this.gridSize/2);i=this.snap(i+this.gridSize/2)}n=new mxRectangle(0,0,c,i)}else{var d=4*this.gridSize;n=new mxRectangle(0,0,d,d)}}}return n};mxGraph.prototype.resizeCell=function(a,c,b){return this.resizeCells([a],[c],b)[0]};mxGraph.prototype.resizeCells=function(a,c,b){b=(b!=null)?b:this.isRecursiveResize();this.model.beginUpdate();try{this.cellsResized(a,c,b);this.fireEvent(new mxEventObject(mxEvent.RESIZE_CELLS,"cells",a,"bounds",c))}finally{this.model.endUpdate()}return a};mxGraph.prototype.cellsResized=function(a,d,c){c=(c!=null)?c:false;if(a!=null&&d!=null&&a.length==d.length){this.model.beginUpdate();try{for(var b=0;b<a.length;b++){this.cellResized(a[b],d[b],false,c);if(this.isExtendParent(a[b])){this.extendParent(a[b])}this.constrainChild(a[b])}if(this.resetEdgesOnResize){this.resetEdges(a)}this.fireEvent(new mxEventObject(mxEvent.CELLS_RESIZED,"cells",a,"bounds",d))}finally{this.model.endUpdate()}}};mxGraph.prototype.cellResized=function(a,d,b,c){var e=this.model.getGeometry(a);if(e!=null&&(e.x!=d.x||e.y!=d.y||e.width!=d.width||e.height!=d.height)){e=e.clone();if(!b&&e.relative){var f=e.offset;if(f!=null){f.x+=d.x-e.x;f.y+=d.y-e.y}}else{e.x=d.x;e.y=d.y}e.width=d.width;e.height=d.height;if(!e.relative&&this.model.isVertex(a)&&!this.isAllowNegativeCoordinates()){e.x=Math.max(0,e.x);e.y=Math.max(0,e.y)}this.model.beginUpdate();try{if(c){this.resizeChildCells(a,e)}this.model.setGeometry(a,e);this.constrainChildCells(a)}finally{this.model.endUpdate()}}};mxGraph.prototype.resizeChildCells=function(a,e){var g=this.model.getGeometry(a);var d=e.width/g.width;var b=e.height/g.height;var c=this.model.getChildCount(a);for(var f=0;f<c;f++){this.scaleCell(this.model.getChildAt(a,f),d,b,true)}};mxGraph.prototype.constrainChildCells=function(a){var b=this.model.getChildCount(a);for(var c=0;c<b;c++){this.constrainChild(this.model.getChildAt(a,c))}};mxGraph.prototype.scaleCell=function(j,l,k,b){var d=this.model.getGeometry(j);if(d!=null){var a=this.view.getState(j);var c=(a!=null)?a.style:this.getCellStyle(j);d=d.clone();var g=d.x;var f=d.y;var i=d.width;var e=d.height;d.scale(l,k,c[mxConstants.STYLE_ASPECT]=="fixed");if(c[mxConstants.STYLE_RESIZE_WIDTH]=="1"){d.width=i*l}else{if(c[mxConstants.STYLE_RESIZE_WIDTH]=="0"){d.width=i}}if(c[mxConstants.STYLE_RESIZE_HEIGHT]=="1"){d.height=e*k}else{if(c[mxConstants.STYLE_RESIZE_HEIGHT]=="0"){d.height=e}}if(!this.isCellMovable(j)){d.x=g;d.y=f}if(!this.isCellResizable(j)){d.width=i;d.height=e}if(this.model.isVertex(j)){this.cellResized(j,d,true,b)}else{this.model.setGeometry(j,d)}}};mxGraph.prototype.extendParent=function(a){if(a!=null){var b=this.model.getParent(a);var d=this.getCellGeometry(b);if(b!=null&&d!=null&&!this.isCellCollapsed(b)){var c=this.getCellGeometry(a);if(c!=null&&!c.relative&&(d.width<c.x+c.width||d.height<c.y+c.height)){d=d.clone();d.width=Math.max(d.width,c.x+c.width);d.height=Math.max(d.height,c.y+c.height);this.cellsResized([b],[d],false)}}}};mxGraph.prototype.importCells=function(e,c,b,f,a,d){return this.moveCells(e,c,b,true,f,a,d)};mxGraph.prototype.moveCells=function(n,p,o,j,h,m,a){p=(p!=null)?p:0;o=(o!=null)?o:0;j=(j!=null)?j:false;if(n!=null&&(p!=0||o!=0||j||h!=null)){n=this.model.getTopmostCells(n);this.model.beginUpdate();try{var c=new mxDictionary();for(var e=0;e<n.length;e++){c.put(n[e],true)}var b=mxUtils.bind(this,function(i){while(i!=null){if(c.get(i)){return true}i=this.model.getParent(i)}return false});var l=[];for(var e=0;e<n.length;e++){var d=this.getCellGeometry(n[e]);var k=this.model.getParent(n[e]);if((d==null||!d.relative)||!this.model.isEdge(k)||(!b(this.model.getTerminal(k,true))&&!b(this.model.getTerminal(k,false)))){l.push(n[e])}}n=l;if(j){n=this.cloneCells(n,this.isCloneInvalidEdges(),a);if(h==null){h=this.getDefaultParent()}}var f=this.isAllowNegativeCoordinates();if(h!=null){this.setAllowNegativeCoordinates(true)}this.cellsMoved(n,p,o,!j&&this.isDisconnectOnMove()&&this.isAllowDanglingEdges(),h==null,this.isExtendParentsOnMove()&&h==null);this.setAllowNegativeCoordinates(f);if(h!=null){var g=this.model.getChildCount(h);this.cellsAdded(n,h,g,null,null,true)}this.fireEvent(new mxEventObject(mxEvent.MOVE_CELLS,"cells",n,"dx",p,"dy",o,"clone",j,"target",h,"event",m))}finally{this.model.endUpdate()}}return n};mxGraph.prototype.cellsMoved=function(d,c,a,b,g,f){if(d!=null&&(c!=0||a!=0)){f=(f!=null)?f:false;this.model.beginUpdate();try{if(b){this.disconnectGraph(d)}for(var e=0;e<d.length;e++){this.translateCell(d[e],c,a);if(f&&this.isExtendParent(d[e])){this.extendParent(d[e])}else{if(g){this.constrainChild(d[e])}}}if(this.resetEdgesOnMove){this.resetEdges(d)}this.fireEvent(new mxEventObject(mxEvent.CELLS_MOVED,"cells",d,"dx",c,"dy",a,"disconnect",b))}finally{this.model.endUpdate()}}};mxGraph.prototype.translateCell=function(h,l,j){var d=this.model.getGeometry(h);if(d!=null){l=parseFloat(l);j=parseFloat(j);d=d.clone();d.translate(l,j);if(!d.relative&&this.model.isVertex(h)&&!this.isAllowNegativeCoordinates()){d.x=Math.max(0,parseFloat(d.x));d.y=Math.max(0,parseFloat(d.y))}if(d.relative&&!this.model.isEdge(h)){var g=this.model.getParent(h);var c=0;if(this.model.isVertex(g)){var a=this.view.getState(g);var b=(a!=null)?a.style:this.getCellStyle(g);c=mxUtils.getValue(b,mxConstants.STYLE_ROTATION,0)}if(c!=0){var f=mxUtils.toRadians(-c);var i=Math.cos(f);var e=Math.sin(f);var k=mxUtils.getRotatedPoint(new mxPoint(l,j),i,e,new mxPoint(0,0));l=k.x;j=k.y}if(d.offset==null){d.offset=new mxPoint(l,j)}else{d.offset.x=parseFloat(d.offset.x)+l;d.offset.y=parseFloat(d.offset.y)+j}}this.model.setGeometry(h,d)}};mxGraph.prototype.getCellContainmentArea=function(o){if(o!=null&&!this.model.isEdge(o)){var m=this.model.getParent(o);if(m!=null&&m!=this.getDefaultParent()){var i=this.model.getGeometry(m);if(i!=null){var l=0;var k=0;var n=i.width;var f=i.height;if(this.isSwimlane(m)){var p=this.getStartSize(m);var c=this.view.getState(m);var b=(c!=null)?c.style:this.getCellStyle(m);var d=mxUtils.getValue(b,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST);var j=mxUtils.getValue(b,mxConstants.STYLE_FLIPH,0)==1;var a=mxUtils.getValue(b,mxConstants.STYLE_FLIPV,0)==1;if(d==mxConstants.DIRECTION_SOUTH||d==mxConstants.DIRECTION_NORTH){var e=p.width;p.width=p.height;p.height=e}if((d==mxConstants.DIRECTION_EAST&&!a)||(d==mxConstants.DIRECTION_NORTH&&!j)||(d==mxConstants.DIRECTION_WEST&&a)||(d==mxConstants.DIRECTION_SOUTH&&j)){l=p.width;k=p.height}n-=p.width;f-=p.height}return new mxRectangle(l,k,n,f)}}}return null};mxGraph.prototype.getMaximumGraphBounds=function(){return this.maximumGraphBounds};mxGraph.prototype.constrainChild=function(l,c){c=(c!=null)?c:true;if(l!=null){var e=this.getCellGeometry(l);if(e!=null&&(this.isConstrainRelativeChildren()||!e.relative)){var k=this.model.getParent(l);var b=this.getCellGeometry(k);var h=this.getMaximumGraphBounds();if(h!=null){var a=this.getBoundingBoxFromGeometry([k],false);if(a!=null){h=mxRectangle.fromRectangle(h);h.x-=a.x;h.y-=a.y}}if(this.isConstrainChild(l)){var f=this.getCellContainmentArea(l);if(f!=null){var j=this.getOverlap(l);if(j>0){f=mxRectangle.fromRectangle(f);f.x-=f.width*j;f.y-=f.height*j;f.width+=2*f.width*j;f.height+=2*f.height*j}if(h==null){h=f}else{h=mxRectangle.fromRectangle(h);h.intersect(f)}}}if(h!=null){var o=[l];if(!this.isCellCollapsed(l)){var g=this.model.getDescendants(l);for(var d=0;d<g.length;d++){if(this.isCellVisible(g[d])){o.push(g[d])}}}var m=this.getBoundingBoxFromGeometry(o,false);if(m!=null){e=e.clone();var p=0;if(e.width>h.width){p=e.width-h.width;e.width-=p}if(m.x+m.width>h.x+h.width){p-=m.x+m.width-h.x-h.width-p}var n=0;if(e.height>h.height){n=e.height-h.height;e.height-=n}if(m.y+m.height>h.y+h.height){n-=m.y+m.height-h.y-h.height-n}if(m.x<h.x){p-=m.x-h.x}if(m.y<h.y){n-=m.y-h.y}if(p!=0||n!=0){if(e.relative){if(e.offset==null){e.offset=new mxPoint()}e.offset.x+=p;e.offset.y+=n}else{e.x+=p;e.y+=n}}this.model.setGeometry(l,e)}}}}};mxGraph.prototype.resetEdges=function(c){if(c!=null){var h=new mxDictionary();for(var d=0;d<c.length;d++){h.put(c[d],true)}this.model.beginUpdate();try{for(var d=0;d<c.length;d++){var a=this.model.getEdges(c[d]);if(a!=null){for(var b=0;b<a.length;b++){var f=this.view.getState(a[b]);var e=(f!=null)?f.getVisibleTerminal(true):this.view.getVisibleTerminal(a[b],true);var g=(f!=null)?f.getVisibleTerminal(false):this.view.getVisibleTerminal(a[b],false);if(!h.get(e)||!h.get(g)){this.resetEdge(a[b])}}}this.resetEdges(this.model.getChildren(c[d]))}}finally{this.model.endUpdate()}}};mxGraph.prototype.resetEdge=function(a){var b=this.model.getGeometry(a);if(b!=null&&b.points!=null&&b.points.length>0){b=b.clone();b.points=[];this.model.setGeometry(a,b)}return a};mxGraph.prototype.getOutlineConstraint=function(n,e,r){if(e.shape!=null){var f=this.view.getPerimeterBounds(e);var q=e.style[mxConstants.STYLE_DIRECTION];if(q==mxConstants.DIRECTION_NORTH||q==mxConstants.DIRECTION_SOUTH){f.x+=f.width/2-f.height/2;f.y+=f.height/2-f.width/2;var p=f.width;f.width=f.height;f.height=p}var d=mxUtils.toRadians(e.shape.getShapeRotation());if(d!=0){var b=Math.cos(-d);var a=Math.sin(-d);var c=new mxPoint(f.getCenterX(),f.getCenterY());n=mxUtils.getRotatedPoint(n,b,a,c)}var m=1;var l=1;var k=0;var j=0;if(this.getModel().isVertex(e.cell)){var o=e.style[mxConstants.STYLE_FLIPH];var g=e.style[mxConstants.STYLE_FLIPV];if(e.shape!=null&&e.shape.stencil!=null){o=mxUtils.getValue(e.style,"stencilFlipH",0)==1||o;g=mxUtils.getValue(e.style,"stencilFlipV",0)==1||g}if(q==mxConstants.DIRECTION_NORTH||q==mxConstants.DIRECTION_SOUTH){var p=o;o=g;g=p}if(o){m=-1;k=-f.width}if(g){l=-1;j=-f.height}}n=new mxPoint((n.x-f.x)*m-k+f.x,(n.y-f.y)*l-j+f.y);var i=Math.round((n.x-f.x)*1000/f.width)/1000;var h=Math.round((n.y-f.y)*1000/f.height)/1000;return new mxConnectionConstraint(new mxPoint(i,h),false)}return null};mxGraph.prototype.getAllConnectionConstraints=function(a,b){if(a!=null&&a.shape!=null&&a.shape.stencil!=null){return a.shape.stencil.constraints}return null};mxGraph.prototype.getConnectionConstraint=function(e,d,f){var b=null;var a=e.style[(f)?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X];if(a!=null){var g=e.style[(f)?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y];if(g!=null){b=new mxPoint(parseFloat(a),parseFloat(g))}}var c=false;if(b!=null){c=mxUtils.getValue(e.style,(f)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,true)}return new mxConnectionConstraint(b,c)};mxGraph.prototype.setConnectionConstraint=function(b,a,c,d){if(d!=null){this.model.beginUpdate();try{if(d==null||d.point==null){this.setCellStyles((c)?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,null,[b]);this.setCellStyles((c)?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,null,[b]);this.setCellStyles((c)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[b])}else{if(d.point!=null){this.setCellStyles((c)?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,d.point.x,[b]);this.setCellStyles((c)?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,d.point.y,[b]);if(!d.perimeter){this.setCellStyles((c)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,"0",[b])}else{this.setCellStyles((c)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[b])}}}}finally{this.model.endUpdate()}}};mxGraph.prototype.getConnectionPoint=function(o,b){var k=null;if(o!=null&&b.point!=null){var e=this.view.getPerimeterBounds(o);var d=new mxPoint(e.getCenterX(),e.getCenterY());var q=o.style[mxConstants.STYLE_DIRECTION];var n=0;if(q!=null){if(q==mxConstants.DIRECTION_NORTH){n+=270}else{if(q==mxConstants.DIRECTION_WEST){n+=180}else{if(q==mxConstants.DIRECTION_SOUTH){n+=90}}}if(q==mxConstants.DIRECTION_NORTH||q==mxConstants.DIRECTION_SOUTH){e.rotate90()}}if(b.point!=null){var j=1;var i=1;var h=0;var g=0;if(this.getModel().isVertex(o.cell)){var l=o.style[mxConstants.STYLE_FLIPH];var f=o.style[mxConstants.STYLE_FLIPV];if(o.shape!=null&&o.shape.stencil!=null){l=mxUtils.getValue(o.style,"stencilFlipH",0)==1||l;f=mxUtils.getValue(o.style,"stencilFlipV",0)==1||f}if(q==mxConstants.DIRECTION_NORTH||q==mxConstants.DIRECTION_SOUTH){var p=l;l=f;f=p}if(l){j=-1;h=-e.width}if(f){i=-1;g=-e.height}}k=new mxPoint(e.x+b.point.x*e.width*j-h,e.y+b.point.y*e.height*i-g)}var m=o.style[mxConstants.STYLE_ROTATION]||0;if(b.perimeter){if(n!=0&&k!=null){var c=0;var a=0;if(n==90){a=1}else{if(n==180){c=-1}else{if(n==270){a=-1}}}k=mxUtils.getRotatedPoint(k,c,a,d)}if(k!=null&&b.perimeter){k=this.view.getPerimeterPoint(o,k,false)}}else{m+=n}if(m!=0&&k!=null){var r=mxUtils.toRadians(m);var c=Math.cos(r);var a=Math.sin(r);k=mxUtils.getRotatedPoint(k,c,a,d)}}if(k!=null){k.x=Math.round(k.x);k.y=Math.round(k.y)}return k};mxGraph.prototype.connectCell=function(c,a,d,e){this.model.beginUpdate();try{var b=this.model.getTerminal(c,d);this.cellConnected(c,a,d,e);this.fireEvent(new mxEventObject(mxEvent.CONNECT_CELL,"edge",c,"terminal",a,"source",d,"previous",b))}finally{this.model.endUpdate()}return c};mxGraph.prototype.cellConnected=function(d,b,e,f){if(d!=null){this.model.beginUpdate();try{var c=this.model.getTerminal(d,e);this.setConnectionConstraint(d,b,e,f);if(this.isPortsEnabled()){var g=null;if(this.isPort(b)){g=b.getId();b=this.getTerminalForPort(b,e)}var a=(e)?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT;this.setCellStyles(a,g,[d])}this.model.setTerminal(d,b,e);if(this.resetEdgesOnConnect){this.resetEdge(d)}this.fireEvent(new mxEventObject(mxEvent.CELL_CONNECTED,"edge",d,"terminal",b,"source",e,"previous",c))}finally{this.model.endUpdate()}}};mxGraph.prototype.disconnectGraph=function(m){if(m!=null){this.model.beginUpdate();try{var f=this.view.scale;var k=this.view.translate;var e=new mxDictionary();for(var j=0;j<m.length;j++){e.put(m[j],true)}for(var j=0;j<m.length;j++){if(this.model.isEdge(m[j])){var g=this.model.getGeometry(m[j]);if(g!=null){var c=this.view.getState(m[j]);var h=this.view.getState(this.model.getParent(m[j]));if(c!=null&&h!=null){g=g.clone();var p=-h.origin.x;var l=-h.origin.y;var o=c.absolutePoints;var a=this.model.getTerminal(m[j],true);if(a!=null&&this.isCellDisconnectable(m[j],a,true)){while(a!=null&&!e.get(a)){a=this.model.getParent(a)}if(a==null){g.setTerminalPoint(new mxPoint(o[0].x/f-k.x+p,o[0].y/f-k.y+l),true);this.model.setTerminal(m[j],null,true)}}var b=this.model.getTerminal(m[j],false);if(b!=null&&this.isCellDisconnectable(m[j],b,false)){while(b!=null&&!e.get(b)){b=this.model.getParent(b)}if(b==null){var d=o.length-1;g.setTerminalPoint(new mxPoint(o[d].x/f-k.x+p,o[d].y/f-k.y+l),false);this.model.setTerminal(m[j],null,false)}}this.model.setGeometry(m[j],g)}}}}}finally{this.model.endUpdate()}}};mxGraph.prototype.getCurrentRoot=function(){return this.view.currentRoot};mxGraph.prototype.getTranslateForRoot=function(a){return null};mxGraph.prototype.isPort=function(a){return false};mxGraph.prototype.getTerminalForPort=function(a,b){return this.model.getParent(a)};mxGraph.prototype.getChildOffsetForCell=function(a){return null};mxGraph.prototype.enterGroup=function(a){a=a||this.getSelectionCell();if(a!=null&&this.isValidRoot(a)){this.view.setCurrentRoot(a);this.clearSelection()}};mxGraph.prototype.exitGroup=function(){var a=this.model.getRoot();var d=this.getCurrentRoot();if(d!=null){var b=this.model.getParent(d);while(b!=a&&!this.isValidRoot(b)&&this.model.getParent(b)!=a){b=this.model.getParent(b)}if(b==a||this.model.getParent(b)==a){this.view.setCurrentRoot(null)}else{this.view.setCurrentRoot(b)}var c=this.view.getState(d);if(c!=null){this.setSelectionCell(d)}}};mxGraph.prototype.home=function(){var b=this.getCurrentRoot();if(b!=null){this.view.setCurrentRoot(null);var a=this.view.getState(b);if(a!=null){this.setSelectionCell(b)}}};mxGraph.prototype.isValidRoot=function(a){return(a!=null)};mxGraph.prototype.getGraphBounds=function(){return this.view.getGraphBounds()};mxGraph.prototype.getCellBounds=function(b,h,g){var d=[b];if(h){d=d.concat(this.model.getEdges(b))}var a=this.view.getBounds(d);if(g){var c=this.model.getChildCount(b);for(var f=0;f<c;f++){var e=this.getCellBounds(this.model.getChildAt(b,f),h,true);if(a!=null){a.add(e)}else{a=e}}}return a};mxGraph.prototype.getBoundingBoxFromGeometry=function(k,g){g=(g!=null)?g:false;var m=null;if(k!=null){for(var e=0;e<k.length;e++){if(g||this.model.isVertex(k[e])){var d=this.getCellGeometry(k[e]);if(d!=null){var h=null;if(this.model.isEdge(k[e])){var a=function(i){if(i!=null){if(c==null){c=new mxRectangle(i.x,i.y,0,0)}else{c.add(new mxRectangle(i.x,i.y,0,0))}}};if(this.model.getTerminal(k[e],true)==null){a(d.getTerminalPoint(true))}if(this.model.getTerminal(k[e],false)==null){a(d.getTerminalPoint(false))}var l=d.points;if(l!=null&&l.length>0){var c=new mxRectangle(l[0].x,l[0].y,0,0);for(var b=1;b<l.length;b++){a(l[b])}}h=c}else{var f=this.model.getParent(k[e]);if(d.relative){if(this.model.isVertex(f)&&f!=this.view.currentRoot){var c=this.getBoundingBoxFromGeometry([f],false);if(c!=null){h=new mxRectangle(d.x*c.width,d.y*c.height,d.width,d.height);if(mxUtils.indexOf(k,f)>=0){h.x+=c.x;h.y+=c.y}}}}else{h=mxRectangle.fromRectangle(d);if(this.model.isVertex(f)&&mxUtils.indexOf(k,f)>=0){var c=this.getBoundingBoxFromGeometry([f],false);if(c!=null){h.x+=c.x;h.y+=c.y}}}if(h!=null&&d.offset!=null){h.x+=d.offset.x;h.y+=d.offset.y}}if(h!=null){if(m==null){m=mxRectangle.fromRectangle(h)}else{m.add(h)}}}}}}return m};mxGraph.prototype.refresh=function(a){this.view.clear(a,a==null);this.view.validate();this.sizeDidChange();this.fireEvent(new mxEventObject(mxEvent.REFRESH))};mxGraph.prototype.snap=function(a){if(this.gridEnabled){a=Math.round(a/this.gridSize)*this.gridSize}return a};mxGraph.prototype.panGraph=function(b,a){if(this.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.container)){this.container.scrollLeft=-b;this.container.scrollTop=-a}else{var c=this.view.getCanvas();if(this.dialect==mxConstants.DIALECT_SVG){if(b==0&&a==0){if(mxClient.IS_IE){c.setAttribute("transform","translate("+b+","+a+")")}else{c.removeAttribute("transform")}if(this.shiftPreview1!=null){var f=this.shiftPreview1.firstChild;while(f!=null){var d=f.nextSibling;this.container.appendChild(f);f=d}if(this.shiftPreview1.parentNode!=null){this.shiftPreview1.parentNode.removeChild(this.shiftPreview1)}this.shiftPreview1=null;this.container.appendChild(c.parentNode);f=this.shiftPreview2.firstChild;while(f!=null){var d=f.nextSibling;this.container.appendChild(f);f=d}if(this.shiftPreview2.parentNode!=null){this.shiftPreview2.parentNode.removeChild(this.shiftPreview2)}this.shiftPreview2=null}}else{c.setAttribute("transform","translate("+b+","+a+")");if(this.shiftPreview1==null){this.shiftPreview1=document.createElement("div");this.shiftPreview1.style.position="absolute";this.shiftPreview1.style.overflow="visible";this.shiftPreview2=document.createElement("div");this.shiftPreview2.style.position="absolute";this.shiftPreview2.style.overflow="visible";var e=this.shiftPreview1;var f=this.container.firstChild;while(f!=null){var d=f.nextSibling;if(f!=c.parentNode){e.appendChild(f)}else{e=this.shiftPreview2}f=d}if(this.shiftPreview1.firstChild!=null){this.container.insertBefore(this.shiftPreview1,c.parentNode)}if(this.shiftPreview2.firstChild!=null){this.container.appendChild(this.shiftPreview2)}}this.shiftPreview1.style.left=b+"px";this.shiftPreview1.style.top=a+"px";this.shiftPreview2.style.left=b+"px";this.shiftPreview2.style.top=a+"px"}}else{c.style.left=b+"px";c.style.top=a+"px"}this.panDx=b;this.panDy=a;this.fireEvent(new mxEventObject(mxEvent.PAN))}};mxGraph.prototype.zoomIn=function(){this.zoom(this.zoomFactor)};mxGraph.prototype.zoomOut=function(){this.zoom(1/this.zoomFactor)};mxGraph.prototype.zoomActual=function(){if(this.view.scale==1){this.view.setTranslate(0,0)}else{this.view.translate.x=0;this.view.translate.y=0;this.view.setScale(1)}};mxGraph.prototype.zoomTo=function(b,a){this.zoom(b/this.view.scale,a)};mxGraph.prototype.center=function(c,f,g,e){c=(c!=null)?c:true;f=(f!=null)?f:true;g=(g!=null)?g:0.5;e=(e!=null)?e:0.5;var d=mxUtils.hasScrollbars(this.container);var h=this.container.clientWidth;var b=this.container.clientHeight;var a=this.getGraphBounds();var l=this.view.translate;var n=this.view.scale;var m=(c)?h-a.width:0;var k=(f)?b-a.height:0;if(!d){this.view.setTranslate((c)?Math.floor(l.x-a.x*n+m*g/n):l.x,(f)?Math.floor(l.y-a.y*n+k*e/n):l.y)}else{a.x-=l.x;a.y-=l.y;var j=this.container.scrollWidth;var i=this.container.scrollHeight;if(j>h){m=0}if(i>b){k=0}this.view.setTranslate(Math.floor(m/2-a.x),Math.floor(k/2-a.y));this.container.scrollLeft=(j-h)/2;this.container.scrollTop=(i-b)/2}};mxGraph.prototype.zoom=function(j,a){a=(a!=null)?a:this.centerZoom;var e=Math.round(this.view.scale*j*100)/100;var b=this.view.getState(this.getSelectionCell());j=e/this.view.scale;if(this.keepSelectionVisibleOnZoom&&b!=null){var k=new mxRectangle(b.x*j,b.y*j,b.width*j,b.height*j);this.view.scale=e;if(!this.scrollRectToVisible(k)){this.view.revalidate();this.view.setScale(e)}}else{var c=mxUtils.hasScrollbars(this.container);if(a&&!c){var n=this.container.offsetWidth;var m=this.container.offsetHeight;if(j>1){var i=(j-1)/(e*2);n*=-i;m*=-i}else{var i=(1/j-1)/(this.view.scale*2);n*=i;m*=i}this.view.scaleAndTranslate(e,this.view.translate.x+n,this.view.translate.y+m)}else{var h=this.view.translate.x;var g=this.view.translate.y;var d=this.container.scrollLeft;var l=this.container.scrollTop;this.view.setScale(e);if(c){var n=0;var m=0;if(a){n=this.container.offsetWidth*(j-1)/2;m=this.container.offsetHeight*(j-1)/2}this.container.scrollLeft=(this.view.translate.x-h)*this.view.scale+Math.round(d*j+n);this.container.scrollTop=(this.view.translate.y-g)*this.view.scale+Math.round(l*j+m)}}}};mxGraph.prototype.zoomToRect=function(j){var n=this.container.clientWidth/j.width;var m=this.container.clientHeight/j.height;var h=n/m;j.x=Math.max(0,j.x);j.y=Math.max(0,j.y);var e=Math.min(this.container.scrollWidth,j.x+j.width);var k=Math.min(this.container.scrollHeight,j.y+j.height);j.width=e-j.x;j.height=k-j.y;if(h<1){var c=j.height/h;var b=(c-j.height)/2;j.height=c;var a=Math.min(j.y,b);j.y=j.y-a;k=Math.min(this.container.scrollHeight,j.y+j.height);j.height=k-j.y}else{var g=j.width*h;var l=(g-j.width)/2;j.width=g;var d=Math.min(j.x,l);j.x=j.x-d;e=Math.min(this.container.scrollWidth,j.x+j.width);j.width=e-j.x}var f=this.container.clientWidth/j.width;var i=this.view.scale*f;if(!mxUtils.hasScrollbars(this.container)){this.view.scaleAndTranslate(i,(this.view.translate.x-j.x/this.view.scale),(this.view.translate.y-j.y/this.view.scale))}else{this.view.setScale(i);this.container.scrollLeft=Math.round(j.x*f);this.container.scrollTop=Math.round(j.y*f)}};mxGraph.prototype.scrollCellToVisible=function(k,b){var i=-this.view.translate.x;var g=-this.view.translate.y;var c=this.view.getState(k);if(c!=null){var a=new mxRectangle(i+c.x,g+c.y,c.width,c.height);if(b&&this.container!=null){var j=this.container.clientWidth;var e=this.container.clientHeight;a.x=a.getCenterX()-j/2;a.width=j;a.y=a.getCenterY()-e/2;a.height=e}var f=new mxPoint(this.view.translate.x,this.view.translate.y);if(this.scrollRectToVisible(a)){var d=new mxPoint(this.view.translate.x,this.view.translate.y);this.view.translate.x=f.x;this.view.translate.y=f.y;this.view.setTranslate(d.x,d.y)}}};mxGraph.prototype.scrollRectToVisible=function(j){var m=false;if(j!=null){var l=this.container.offsetWidth;var d=this.container.offsetHeight;var b=Math.min(l,j.width);var a=Math.min(d,j.height);if(mxUtils.hasScrollbars(this.container)){var f=this.container;j.x+=this.view.translate.x;j.y+=this.view.translate.y;var p=f.scrollLeft-j.x;var i=Math.max(p-f.scrollLeft,0);if(p>0){f.scrollLeft-=p+2}else{p=j.x+b-f.scrollLeft-f.clientWidth;if(p>0){f.scrollLeft+=p+2}}var n=f.scrollTop-j.y;var e=Math.max(0,n-f.scrollTop);if(n>0){f.scrollTop-=n+2}else{n=j.y+a-f.scrollTop-f.clientHeight;if(n>0){f.scrollTop+=n+2}}if(!this.useScrollbarsForPanning&&(i!=0||e!=0)){this.view.setTranslate(i,e)}}else{var k=-this.view.translate.x;var g=-this.view.translate.y;var o=this.view.scale;if(j.x+b>k+l){this.view.translate.x-=(j.x+b-l-k)/o;m=true}if(j.y+a>g+d){this.view.translate.y-=(j.y+a-d-g)/o;m=true}if(j.x<k){this.view.translate.x+=(k-j.x)/o;m=true}if(j.y<g){this.view.translate.y+=(g-j.y)/o;m=true}if(m){this.view.refresh();if(this.selectionCellsHandler!=null){this.selectionCellsHandler.refresh()}}}}return m};mxGraph.prototype.getCellGeometry=function(a){return this.model.getGeometry(a)};mxGraph.prototype.isCellVisible=function(a){return this.model.isVisible(a)};mxGraph.prototype.isCellCollapsed=function(a){return this.model.isCollapsed(a)};mxGraph.prototype.isCellConnectable=function(a){return this.model.isConnectable(a)};mxGraph.prototype.isOrthogonal=function(b){var c=b.style[mxConstants.STYLE_ORTHOGONAL];if(c!=null){return c}var a=this.view.getEdgeStyle(b);return a==mxEdgeStyle.SegmentConnector||a==mxEdgeStyle.ElbowConnector||a==mxEdgeStyle.SideToSide||a==mxEdgeStyle.TopToBottom||a==mxEdgeStyle.EntityRelation||a==mxEdgeStyle.OrthConnector};mxGraph.prototype.isLoop=function(b){var c=b.getVisibleTerminalState(true);var a=b.getVisibleTerminalState(false);return(c!=null&&c==a)};mxGraph.prototype.isCloneEvent=function(a){return mxEvent.isControlDown(a)};mxGraph.prototype.isToggleEvent=function(a){return(mxClient.IS_MAC)?mxEvent.isMetaDown(a):mxEvent.isControlDown(a)};mxGraph.prototype.isGridEnabledEvent=function(a){return a!=null&&!mxEvent.isAltDown(a)};mxGraph.prototype.isConstrainedEvent=function(a){return mxEvent.isShiftDown(a)};mxGraph.prototype.isIgnoreTerminalEvent=function(a){return false};mxGraph.prototype.validationAlert=function(a){mxUtils.alert(a)};mxGraph.prototype.isEdgeValid=function(a,b,c){return this.getEdgeValidationError(a,b,c)==null};mxGraph.prototype.getEdgeValidationError=function(b,a,g){if(b!=null&&!this.isAllowDanglingEdges()&&(a==null||g==null)){return""}if(b!=null&&this.model.getTerminal(b,true)==null&&this.model.getTerminal(b,false)==null){return null}if(!this.allowLoops&&a==g&&a!=null){return""}if(!this.isValidConnection(a,g)){return""}if(a!=null&&g!=null){var h="";if(!this.multigraph){var d=this.model.getEdgesBetween(a,g,true);if(d.length>1||(d.length==1&&d[0]!=b)){h+=(mxResources.get(this.alreadyConnectedResource)||this.alreadyConnectedResource)+"\n"}}var j=this.model.getDirectedEdgeCount(a,true,b);var e=this.model.getDirectedEdgeCount(g,false,b);if(this.multiplicities!=null){for(var f=0;f<this.multiplicities.length;f++){var c=this.multiplicities[f].check(this,b,a,g,j,e);if(c!=null){h+=c}}}var c=this.validateEdge(b,a,g);if(c!=null){h+=c}return(h.length>0)?h:null}return(this.allowDanglingEdges)?null:""};mxGraph.prototype.validateEdge=function(a,b,c){return null};mxGraph.prototype.validateGraph=function(h,a){h=(h!=null)?h:this.model.getRoot();a=(a!=null)?a:new Object();var j=true;var c=this.model.getChildCount(h);for(var d=0;d<c;d++){var e=this.model.getChildAt(h,d);var k=a;if(this.isValidRoot(e)){k=new Object()}var f=this.validateGraph(e,k);if(f!=null){this.setCellWarning(e,f.replace(/\n/g,"<br>"))}else{this.setCellWarning(e,null)}j=j&&f==null}var g="";if(this.isCellCollapsed(h)&&!j){g+=(mxResources.get(this.containsValidationErrorsResource)||this.containsValidationErrorsResource)+"\n"}if(this.model.isEdge(h)){g+=this.getEdgeValidationError(h,this.model.getTerminal(h,true),this.model.getTerminal(h,false))||""}else{g+=this.getCellValidationError(h)||""}var b=this.validateCell(h,a);if(b!=null){g+=b}if(this.model.getParent(h)==null){this.view.validate()}return(g.length>0||!j)?g:null};mxGraph.prototype.getCellValidationError=function(a){var b=this.model.getDirectedEdgeCount(a,true);var c=this.model.getDirectedEdgeCount(a,false);var f=this.model.getValue(a);var d="";if(this.multiplicities!=null){for(var e=0;e<this.multiplicities.length;e++){var g=this.multiplicities[e];if(g.source&&mxUtils.isNode(f,g.type,g.attr,g.value)&&(b>g.max||b<g.min)){d+=g.countError+"\n"}else{if(!g.source&&mxUtils.isNode(f,g.type,g.attr,g.value)&&(c>g.max||c<g.min)){d+=g.countError+"\n"}}}}return(d.length>0)?d:null};mxGraph.prototype.validateCell=function(a,b){return null};mxGraph.prototype.getBackgroundImage=function(){return this.backgroundImage};mxGraph.prototype.setBackgroundImage=function(a){this.backgroundImage=a};mxGraph.prototype.getFoldingImage=function(b){if(b!=null&&this.foldingEnabled&&!this.getModel().isEdge(b.cell)){var a=this.isCellCollapsed(b.cell);if(this.isCellFoldable(b.cell,!a)){return(a)?this.collapsedImage:this.expandedImage}}return null};mxGraph.prototype.convertValueToString=function(a){var b=this.model.getValue(a);if(b!=null){if(mxUtils.isNode(b)){return b.nodeName}else{if(typeof(b.toString)=="function"){return b.toString()}}}return""};mxGraph.prototype.getLabel=function(b){var a="";if(this.labelsVisible&&b!=null){var d=this.view.getState(b);var c=(d!=null)?d.style:this.getCellStyle(b);if(!mxUtils.getValue(c,mxConstants.STYLE_NOLABEL,false)){a=this.convertValueToString(b)}}return a};mxGraph.prototype.isHtmlLabel=function(a){return this.isHtmlLabels()};mxGraph.prototype.isHtmlLabels=function(){return this.htmlLabels};mxGraph.prototype.setHtmlLabels=function(a){this.htmlLabels=a};mxGraph.prototype.isWrapping=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return(b!=null)?b[mxConstants.STYLE_WHITE_SPACE]=="wrap":false};mxGraph.prototype.isLabelClipped=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return(b!=null)?b[mxConstants.STYLE_OVERFLOW]=="hidden":false};mxGraph.prototype.getTooltip=function(e,c,a,f){var d=null;if(e!=null){if(e.control!=null&&(c==e.control.node||c.parentNode==e.control.node)){d=this.collapseExpandResource;d=mxUtils.htmlEntities(mxResources.get(d)||d).replace(/\\n/g,"<br>")}if(d==null&&e.overlays!=null){e.overlays.visit(function(h,g){if(d==null&&(c==g.node||c.parentNode==g.node)){d=g.overlay.toString()}})}if(d==null){var b=this.selectionCellsHandler.getHandler(e.cell);if(b!=null&&typeof(b.getTooltipForNode)=="function"){d=b.getTooltipForNode(c)}}if(d==null){d=this.getTooltipForCell(e.cell)}}return d};mxGraph.prototype.getTooltipForCell=function(a){var b=null;if(a!=null&&a.getTooltip!=null){b=a.getTooltip()}else{b=this.convertValueToString(a)}return b};mxGraph.prototype.getCursorForMouseEvent=function(a){return this.getCursorForCell(a.getCell())};mxGraph.prototype.getCursorForCell=function(a){return null};mxGraph.prototype.getStartSize=function(e){var a=new mxRectangle();var d=this.view.getState(e);var c=(d!=null)?d.style:this.getCellStyle(e);if(c!=null){var b=parseInt(mxUtils.getValue(c,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));if(mxUtils.getValue(c,mxConstants.STYLE_HORIZONTAL,true)){a.height=b}else{a.width=b}}return a};mxGraph.prototype.getImage=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_IMAGE]:null};mxGraph.prototype.getVerticalAlign=function(a){return(a!=null&&a.style!=null)?(a.style[mxConstants.STYLE_VERTICAL_ALIGN]||mxConstants.ALIGN_MIDDLE):null};mxGraph.prototype.getIndicatorColor=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_INDICATOR_COLOR]:null};mxGraph.prototype.getIndicatorGradientColor=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_INDICATOR_GRADIENTCOLOR]:null};mxGraph.prototype.getIndicatorShape=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_INDICATOR_SHAPE]:null};mxGraph.prototype.getIndicatorImage=function(a){return(a!=null&&a.style!=null)?a.style[mxConstants.STYLE_INDICATOR_IMAGE]:null};mxGraph.prototype.getBorder=function(){return this.border};mxGraph.prototype.setBorder=function(a){this.border=a};mxGraph.prototype.isSwimlane=function(a){if(a!=null){if(this.model.getParent(a)!=this.model.getRoot()){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);if(b!=null&&!this.model.isEdge(a)){return b[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_SWIMLANE}}}return false};mxGraph.prototype.isResizeContainer=function(){return this.resizeContainer};mxGraph.prototype.setResizeContainer=function(a){this.resizeContainer=a};mxGraph.prototype.isEnabled=function(){return this.enabled};mxGraph.prototype.setEnabled=function(a){this.enabled=a};mxGraph.prototype.isEscapeEnabled=function(){return this.escapeEnabled};mxGraph.prototype.setEscapeEnabled=function(a){this.escapeEnabled=a};mxGraph.prototype.isInvokesStopCellEditing=function(){return this.invokesStopCellEditing};mxGraph.prototype.setInvokesStopCellEditing=function(a){this.invokesStopCellEditing=a};mxGraph.prototype.isEnterStopsCellEditing=function(){return this.enterStopsCellEditing};mxGraph.prototype.setEnterStopsCellEditing=function(a){this.enterStopsCellEditing=a};mxGraph.prototype.isCellLocked=function(a){var b=this.model.getGeometry(a);return this.isCellsLocked()||(b!=null&&this.model.isVertex(a)&&b.relative)};mxGraph.prototype.isCellsLocked=function(){return this.cellsLocked};mxGraph.prototype.setCellsLocked=function(a){this.cellsLocked=a};mxGraph.prototype.getCloneableCells=function(a){return this.model.filterCells(a,mxUtils.bind(this,function(b){return this.isCellCloneable(b)}))};mxGraph.prototype.isCellCloneable=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return this.isCellsCloneable()&&b[mxConstants.STYLE_CLONEABLE]!=0};mxGraph.prototype.isCellsCloneable=function(){return this.cellsCloneable};mxGraph.prototype.setCellsCloneable=function(a){this.cellsCloneable=a};mxGraph.prototype.getExportableCells=function(a){return this.model.filterCells(a,mxUtils.bind(this,function(b){return this.canExportCell(b)}))};mxGraph.prototype.canExportCell=function(a){return this.exportEnabled};mxGraph.prototype.getImportableCells=function(a){return this.model.filterCells(a,mxUtils.bind(this,function(b){return this.canImportCell(b)}))};mxGraph.prototype.canImportCell=function(a){return this.importEnabled};mxGraph.prototype.isCellSelectable=function(a){return this.isCellsSelectable()};mxGraph.prototype.isCellsSelectable=function(){return this.cellsSelectable};mxGraph.prototype.setCellsSelectable=function(a){this.cellsSelectable=a};mxGraph.prototype.getDeletableCells=function(a){return this.model.filterCells(a,mxUtils.bind(this,function(b){return this.isCellDeletable(b)}))};mxGraph.prototype.isCellDeletable=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return this.isCellsDeletable()&&b[mxConstants.STYLE_DELETABLE]!=0};mxGraph.prototype.isCellsDeletable=function(){return this.cellsDeletable};mxGraph.prototype.setCellsDeletable=function(a){this.cellsDeletable=a};mxGraph.prototype.isLabelMovable=function(a){return !this.isCellLocked(a)&&((this.model.isEdge(a)&&this.edgeLabelsMovable)||(this.model.isVertex(a)&&this.vertexLabelsMovable))};mxGraph.prototype.isCellRotatable=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return b[mxConstants.STYLE_ROTATABLE]!=0};mxGraph.prototype.getMovableCells=function(a){return this.model.filterCells(a,mxUtils.bind(this,function(b){return this.isCellMovable(b)}))};mxGraph.prototype.isCellMovable=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return this.isCellsMovable()&&!this.isCellLocked(a)&&b[mxConstants.STYLE_MOVABLE]!=0};mxGraph.prototype.isCellsMovable=function(){return this.cellsMovable};mxGraph.prototype.setCellsMovable=function(a){this.cellsMovable=a};mxGraph.prototype.isGridEnabled=function(){return this.gridEnabled};mxGraph.prototype.setGridEnabled=function(a){this.gridEnabled=a};mxGraph.prototype.isPortsEnabled=function(){return this.portsEnabled};mxGraph.prototype.setPortsEnabled=function(a){this.portsEnabled=a};mxGraph.prototype.getGridSize=function(){return this.gridSize};mxGraph.prototype.setGridSize=function(a){this.gridSize=a};mxGraph.prototype.getTolerance=function(){return this.tolerance};mxGraph.prototype.setTolerance=function(a){this.tolerance=a};mxGraph.prototype.isVertexLabelsMovable=function(){return this.vertexLabelsMovable};mxGraph.prototype.setVertexLabelsMovable=function(a){this.vertexLabelsMovable=a};mxGraph.prototype.isEdgeLabelsMovable=function(){return this.edgeLabelsMovable};mxGraph.prototype.setEdgeLabelsMovable=function(a){this.edgeLabelsMovable=a};mxGraph.prototype.isSwimlaneNesting=function(){return this.swimlaneNesting};mxGraph.prototype.setSwimlaneNesting=function(a){this.swimlaneNesting=a};mxGraph.prototype.isSwimlaneSelectionEnabled=function(){return this.swimlaneSelectionEnabled};mxGraph.prototype.setSwimlaneSelectionEnabled=function(a){this.swimlaneSelectionEnabled=a};mxGraph.prototype.isMultigraph=function(){return this.multigraph};mxGraph.prototype.setMultigraph=function(a){this.multigraph=a};mxGraph.prototype.isAllowLoops=function(){return this.allowLoops};mxGraph.prototype.setAllowDanglingEdges=function(a){this.allowDanglingEdges=a};mxGraph.prototype.isAllowDanglingEdges=function(){return this.allowDanglingEdges};mxGraph.prototype.setConnectableEdges=function(a){this.connectableEdges=a};mxGraph.prototype.isConnectableEdges=function(){return this.connectableEdges};mxGraph.prototype.setCloneInvalidEdges=function(a){this.cloneInvalidEdges=a};mxGraph.prototype.isCloneInvalidEdges=function(){return this.cloneInvalidEdges};mxGraph.prototype.setAllowLoops=function(a){this.allowLoops=a};mxGraph.prototype.isDisconnectOnMove=function(){return this.disconnectOnMove};mxGraph.prototype.setDisconnectOnMove=function(a){this.disconnectOnMove=a};mxGraph.prototype.isDropEnabled=function(){return this.dropEnabled};mxGraph.prototype.setDropEnabled=function(a){this.dropEnabled=a};mxGraph.prototype.isSplitEnabled=function(){return this.splitEnabled};mxGraph.prototype.setSplitEnabled=function(a){this.splitEnabled=a};mxGraph.prototype.isCellResizable=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return this.isCellsResizable()&&!this.isCellLocked(a)&&mxUtils.getValue(b,mxConstants.STYLE_RESIZABLE,"1")!="0"};mxGraph.prototype.isCellsResizable=function(){return this.cellsResizable};mxGraph.prototype.setCellsResizable=function(a){this.cellsResizable=a};mxGraph.prototype.isTerminalPointMovable=function(a,b){return true};mxGraph.prototype.isCellBendable=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return this.isCellsBendable()&&!this.isCellLocked(a)&&b[mxConstants.STYLE_BENDABLE]!=0};mxGraph.prototype.isCellsBendable=function(){return this.cellsBendable};mxGraph.prototype.setCellsBendable=function(a){this.cellsBendable=a};mxGraph.prototype.isCellEditable=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return this.isCellsEditable()&&!this.isCellLocked(a)&&b[mxConstants.STYLE_EDITABLE]!=0};mxGraph.prototype.isCellsEditable=function(){return this.cellsEditable};mxGraph.prototype.setCellsEditable=function(a){this.cellsEditable=a};mxGraph.prototype.isCellDisconnectable=function(a,b,c){return this.isCellsDisconnectable()&&!this.isCellLocked(a)};mxGraph.prototype.isCellsDisconnectable=function(){return this.cellsDisconnectable};mxGraph.prototype.setCellsDisconnectable=function(a){this.cellsDisconnectable=a};mxGraph.prototype.isValidSource=function(a){return(a==null&&this.allowDanglingEdges)||(a!=null&&(!this.model.isEdge(a)||this.connectableEdges)&&this.isCellConnectable(a))};mxGraph.prototype.isValidTarget=function(a){return this.isValidSource(a)};mxGraph.prototype.isValidConnection=function(a,b){return this.isValidSource(a)&&this.isValidTarget(b)};mxGraph.prototype.setConnectable=function(a){this.connectionHandler.setEnabled(a)};mxGraph.prototype.isConnectable=function(a){return this.connectionHandler.isEnabled()};mxGraph.prototype.setTooltips=function(a){this.tooltipHandler.setEnabled(a)};mxGraph.prototype.setPanning=function(a){this.panningHandler.panningEnabled=a};mxGraph.prototype.isEditing=function(a){if(this.cellEditor!=null){var b=this.cellEditor.getEditingCell();return(a==null)?b!=null:a==b}return false};mxGraph.prototype.isAutoSizeCell=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return this.isAutoSizeCells()||b[mxConstants.STYLE_AUTOSIZE]==1};mxGraph.prototype.isAutoSizeCells=function(){return this.autoSizeCells};mxGraph.prototype.setAutoSizeCells=function(a){this.autoSizeCells=a};mxGraph.prototype.isExtendParent=function(a){return !this.getModel().isEdge(a)&&this.isExtendParents()};mxGraph.prototype.isExtendParents=function(){return this.extendParents};mxGraph.prototype.setExtendParents=function(a){this.extendParents=a};mxGraph.prototype.isExtendParentsOnAdd=function(a){return this.extendParentsOnAdd};mxGraph.prototype.setExtendParentsOnAdd=function(a){this.extendParentsOnAdd=a};mxGraph.prototype.isExtendParentsOnMove=function(){return this.extendParentsOnMove};mxGraph.prototype.setExtendParentsOnMove=function(a){this.extendParentsOnMove=a};mxGraph.prototype.isRecursiveResize=function(a){return this.recursiveResize};mxGraph.prototype.setRecursiveResize=function(a){this.recursiveResize=a};mxGraph.prototype.isConstrainChild=function(a){return this.isConstrainChildren()&&!this.getModel().isEdge(this.getModel().getParent(a))};mxGraph.prototype.isConstrainChildren=function(){return this.constrainChildren};mxGraph.prototype.setConstrainChildren=function(a){this.constrainChildren=a};mxGraph.prototype.isConstrainRelativeChildren=function(){return this.constrainRelativeChildren};mxGraph.prototype.setConstrainRelativeChildren=function(a){this.constrainRelativeChildren=a};mxGraph.prototype.isAllowNegativeCoordinates=function(){return this.allowNegativeCoordinates};mxGraph.prototype.setAllowNegativeCoordinates=function(a){this.allowNegativeCoordinates=a};mxGraph.prototype.getOverlap=function(a){return(this.isAllowOverlapParent(a))?this.defaultOverlap:0};mxGraph.prototype.isAllowOverlapParent=function(a){return false};mxGraph.prototype.getFoldableCells=function(a,b){return this.model.filterCells(a,mxUtils.bind(this,function(c){return this.isCellFoldable(c,b)}))};mxGraph.prototype.isCellFoldable=function(a,d){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return this.model.getChildCount(a)>0&&b[mxConstants.STYLE_FOLDABLE]!=0};mxGraph.prototype.isValidDropTarget=function(a,c,b){return a!=null&&((this.isSplitEnabled()&&this.isSplitTarget(a,c,b))||(!this.model.isEdge(a)&&(this.isSwimlane(a)||(this.model.getChildCount(a)>0&&!this.isCellCollapsed(a)))))};mxGraph.prototype.isSplitTarget=function(d,c,b){if(this.model.isEdge(d)&&c!=null&&c.length==1&&this.isCellConnectable(c[0])&&this.getEdgeValidationError(d,this.model.getTerminal(d,true),c[0])==null){var e=this.model.getTerminal(d,true);var a=this.model.getTerminal(d,false);return(!this.model.isAncestor(c[0],e)&&!this.model.isAncestor(c[0],a))}return false};mxGraph.prototype.getDropTarget=function(h,f,g,c){if(!this.isSwimlaneNesting()){for(var a=0;a<h.length;a++){if(this.isSwimlane(h[a])){return null}}}var j=mxUtils.convertPoint(this.container,mxEvent.getClientX(f),mxEvent.getClientY(f));j.x-=this.panDx;j.y-=this.panDy;var d=this.getSwimlaneAt(j.x,j.y);if(g==null){g=d}else{if(d!=null){var b=this.model.getParent(d);while(b!=null&&this.isSwimlane(b)&&b!=g){b=this.model.getParent(b)}if(b==g){g=d}}}while(g!=null&&!this.isValidDropTarget(g,h,f)&&!this.model.isLayer(g)){g=this.model.getParent(g)}if(c==null||!c){var e=g;while(e!=null&&mxUtils.indexOf(h,e)<0){e=this.model.getParent(e)}}return(!this.model.isLayer(g)&&e==null)?g:null};mxGraph.prototype.getDefaultParent=function(){var b=this.getCurrentRoot();if(b==null){b=this.defaultParent;if(b==null){var a=this.model.getRoot();b=this.model.getChildAt(a,0)}}return b};mxGraph.prototype.setDefaultParent=function(a){this.defaultParent=a};mxGraph.prototype.getSwimlane=function(a){while(a!=null&&!this.isSwimlane(a)){a=this.model.getParent(a)}return a};mxGraph.prototype.getSwimlaneAt=function(b,h,e){e=e||this.getDefaultParent();if(e!=null){var c=this.model.getChildCount(e);for(var d=0;d<c;d++){var g=this.model.getChildAt(e,d);var a=this.getSwimlaneAt(b,h,g);if(a!=null){return a}else{if(this.isSwimlane(g)){var f=this.view.getState(g);if(this.intersects(f,b,h)){return g}}}}}return null};mxGraph.prototype.getCellAt=function(h,g,j,f,c,b){f=(f!=null)?f:true;c=(c!=null)?c:true;if(j==null){j=this.getCurrentRoot();if(j==null){j=this.getModel().getRoot()}}if(j!=null){var d=this.model.getChildCount(j);for(var e=d-1;e>=0;e--){var k=this.model.getChildAt(j,e);var l=this.getCellAt(h,g,k,f,c,b);if(l!=null){return l}else{if(this.isCellVisible(k)&&(c&&this.model.isEdge(k)||f&&this.model.isVertex(k))){var a=this.view.getState(k);if(a!=null&&(b==null||!b(a,h,g))&&this.intersects(a,h,g)){return k}}}}}return null};mxGraph.prototype.intersects=function(a,k,j){if(a!=null){var m=a.absolutePoints;if(m!=null){var e=this.tolerance*this.tolerance;var n=m[0];for(var d=1;d<m.length;d++){var f=m[d];var h=mxUtils.ptSegDistSq(n.x,n.y,f.x,f.y,k,j);if(h<=e){return true}n=f}}else{var c=mxUtils.toRadians(mxUtils.getValue(a.style,mxConstants.STYLE_ROTATION)||0);if(c!=0){var l=Math.cos(-c);var g=Math.sin(-c);var b=new mxPoint(a.getCenterX(),a.getCenterY());var n=mxUtils.getRotatedPoint(new mxPoint(k,j),l,g,b);k=n.x;j=n.y}if(mxUtils.contains(a,k,j)){return true}}}return false};mxGraph.prototype.hitsSwimlaneContent=function(d,a,f){var c=this.getView().getState(d);var b=this.getStartSize(d);if(c!=null){var e=this.getView().getScale();a-=c.x;f-=c.y;if(b.width>0&&a>0&&a>b.width*e){return true}else{if(b.height>0&&f>0&&f>b.height*e){return true}}}return false};mxGraph.prototype.getChildVertices=function(a){return this.getChildCells(a,true,false)};mxGraph.prototype.getChildEdges=function(a){return this.getChildCells(a,false,true)};mxGraph.prototype.getChildCells=function(f,d,b){f=(f!=null)?f:this.getDefaultParent();d=(d!=null)?d:false;b=(b!=null)?b:false;var c=this.model.getChildCells(f,d,b);var a=[];for(var e=0;e<c.length;e++){if(this.isCellVisible(c[e])){a.push(c[e])}}return a};mxGraph.prototype.getConnections=function(a,b){return this.getEdges(a,b,true,true,false)};mxGraph.prototype.getIncomingEdges=function(a,b){return this.getEdges(a,b,true,false,false)};mxGraph.prototype.getOutgoingEdges=function(a,b){return this.getEdges(a,b,false,true,false)};mxGraph.prototype.getEdges=function(o,n,f,k,e,c){f=(f!=null)?f:true;k=(k!=null)?k:true;e=(e!=null)?e:true;c=(c!=null)?c:false;var h=[];var l=this.isCellCollapsed(o);var g=this.model.getChildCount(o);for(var j=0;j<g;j++){var d=this.model.getChildAt(o,j);if(l||!this.isCellVisible(d)){h=h.concat(this.model.getEdges(d,f,k))}}h=h.concat(this.model.getEdges(o,f,k));var p=[];for(var j=0;j<h.length;j++){var b=this.view.getState(h[j]);var a=(b!=null)?b.getVisibleTerminal(true):this.view.getVisibleTerminal(h[j],true);var m=(b!=null)?b.getVisibleTerminal(false):this.view.getVisibleTerminal(h[j],false);if((e&&a==m)||((a!=m)&&((f&&m==o&&(n==null||this.isValidAncestor(a,n,c)))||(k&&a==o&&(n==null||this.isValidAncestor(m,n,c)))))){p.push(h[j])}}return p};mxGraph.prototype.isValidAncestor=function(a,b,c){return(c?this.model.isAncestor(b,a):this.model.getParent(a)==b)};mxGraph.prototype.getOpposites=function(e,g,b,h){b=(b!=null)?b:true;h=(h!=null)?h:true;var k=[];var d=new mxDictionary();if(e!=null){for(var f=0;f<e.length;f++){var c=this.view.getState(e[f]);var a=(c!=null)?c.getVisibleTerminal(true):this.view.getVisibleTerminal(e[f],true);var j=(c!=null)?c.getVisibleTerminal(false):this.view.getVisibleTerminal(e[f],false);if(a==g&&j!=null&&j!=g&&h){if(!d.get(j)){d.put(j,true);k.push(j)}}else{if(j==g&&a!=null&&a!=g&&b){if(!d.get(a)){d.put(a,true);k.push(a)}}}}}return k};mxGraph.prototype.getEdgesBetween=function(b,h,e){e=(e!=null)?e:false;var f=this.getEdges(b);var j=[];for(var g=0;g<f.length;g++){var d=this.view.getState(f[g]);var a=(d!=null)?d.getVisibleTerminal(true):this.view.getVisibleTerminal(f[g],true);var c=(d!=null)?d.getVisibleTerminal(false):this.view.getVisibleTerminal(f[g],false);if((a==b&&c==h)||(!e&&a==h&&c==b)){j.push(f[g])}}return j};mxGraph.prototype.getPointForEvent=function(a,f){var d=mxUtils.convertPoint(this.container,mxEvent.getClientX(a),mxEvent.getClientY(a));var b=this.view.scale;var c=this.view.translate;var e=(f!=false)?this.gridSize/2:0;d.x=this.snap(d.x/b-c.x-e);d.y=this.snap(d.y/b-c.y-e);return d};mxGraph.prototype.getCells=function(k,j,d,o,l,p){p=(p!=null)?p:[];if(d>0||o>0){var h=this.getModel();var n=k+d;var a=j+o;if(l==null){l=this.getCurrentRoot();if(l==null){l=h.getRoot()}}if(l!=null){var e=h.getChildCount(l);for(var f=0;f<e;f++){var m=h.getChildAt(l,f);var b=this.view.getState(m);if(b!=null&&this.isCellVisible(m)){var c=mxUtils.getValue(b.style,mxConstants.STYLE_ROTATION)||0;var g=b;if(c!=0){g=mxUtils.getBoundingBox(g,c)}if((h.isEdge(m)||h.isVertex(m))&&g.x>=k&&g.y+g.height<=a&&g.y>=j&&g.x+g.width<=n){p.push(m)}else{this.getCells(k,j,d,o,m,p)}}}}}return p};mxGraph.prototype.getCellsBeyond=function(c,g,h,f,j){var k=[];if(f||j){if(h==null){h=this.getDefaultParent()}if(h!=null){var d=this.model.getChildCount(h);for(var e=0;e<d;e++){var b=this.model.getChildAt(h,e);var a=this.view.getState(b);if(this.isCellVisible(b)&&a!=null){if((!f||a.x>=c)&&(!j||a.y>=g)){k.push(b)}}}}}return k};mxGraph.prototype.findTreeRoots=function(p,m,c){m=(m!=null)?m:false;c=(c!=null)?c:false;var r=[];if(p!=null){var h=this.getModel();var f=h.getChildCount(p);var d=null;var n=0;for(var g=0;g<f;g++){var q=h.getChildAt(p,g);if(this.model.isVertex(q)&&this.isCellVisible(q)){var b=this.getConnections(q,(m)?p:null);var l=0;var k=0;for(var e=0;e<b.length;e++){var a=this.view.getVisibleTerminal(b[e],true);if(a==q){l++}else{k++}}if((c&&l==0&&k>0)||(!c&&k==0&&l>0)){r.push(q)}var o=(c)?k-l:l-k;if(o>n){n=o;d=q}}}if(r.length==0&&d!=null){r.push(d)}}return r};mxGraph.prototype.traverse=function(h,c,d,b,l){if(d!=null&&h!=null){c=(c!=null)?c:true;l=l||new mxDictionary();if(!l.get(h)){l.put(h,true);var m=d(h,b);if(m==null||m){var a=this.model.getEdgeCount(h);if(a>0){for(var f=0;f<a;f++){var j=this.model.getEdgeAt(h,f);var k=this.model.getTerminal(j,true)==h;if(!c||k){var g=this.model.getTerminal(j,!k);this.traverse(g,c,d,j,l)}}}}}}};mxGraph.prototype.isCellSelected=function(a){return this.getSelectionModel().isSelected(a)};mxGraph.prototype.isSelectionEmpty=function(){return this.getSelectionModel().isEmpty()};mxGraph.prototype.clearSelection=function(){return this.getSelectionModel().clear()};mxGraph.prototype.getSelectionCount=function(){return this.getSelectionModel().cells.length};mxGraph.prototype.getSelectionCell=function(){return this.getSelectionModel().cells[0]};mxGraph.prototype.getSelectionCells=function(){return this.getSelectionModel().cells.slice()};mxGraph.prototype.setSelectionCell=function(a){this.getSelectionModel().setCell(a)};mxGraph.prototype.setSelectionCells=function(a){this.getSelectionModel().setCells(a)};mxGraph.prototype.addSelectionCell=function(a){this.getSelectionModel().addCell(a)};mxGraph.prototype.addSelectionCells=function(a){this.getSelectionModel().addCells(a)};mxGraph.prototype.removeSelectionCell=function(a){this.getSelectionModel().removeCell(a)};mxGraph.prototype.removeSelectionCells=function(a){this.getSelectionModel().removeCells(a)};mxGraph.prototype.selectRegion=function(c,a){var b=this.getCells(c.x,c.y,c.width,c.height);this.selectCellsForEvent(b,a);return b};mxGraph.prototype.selectNextCell=function(){this.selectCell(true)};mxGraph.prototype.selectPreviousCell=function(){this.selectCell()};mxGraph.prototype.selectParentCell=function(){this.selectCell(false,true)};mxGraph.prototype.selectChildCell=function(){this.selectCell(false,false,true)};mxGraph.prototype.selectCell=function(a,h,b){var d=this.selectionModel;var l=(d.cells.length>0)?d.cells[0]:null;if(d.cells.length>1){d.clear()}var k=(l!=null)?this.model.getParent(l):this.getDefaultParent();var e=this.model.getChildCount(k);if(l==null&&e>0){var c=this.model.getChildAt(k,0);this.setSelectionCell(c)}else{if((l==null||h)&&this.view.getState(k)!=null&&this.model.getGeometry(k)!=null){if(this.getCurrentRoot()!=k){this.setSelectionCell(k)}}else{if(l!=null&&b){var g=this.model.getChildCount(l);if(g>0){var c=this.model.getChildAt(l,0);this.setSelectionCell(c)}}else{if(e>0){var f=k.getIndex(l);if(a){f++;var c=this.model.getChildAt(k,f%e);this.setSelectionCell(c)}else{f--;var j=(f<0)?e-1:f;var c=this.model.getChildAt(k,j);this.setSelectionCell(c)}}}}}};mxGraph.prototype.selectAll=function(b,c){b=b||this.getDefaultParent();var a=(c)?this.model.filterDescendants(function(d){return d!=b},b):this.model.getChildren(b);if(a!=null){this.setSelectionCells(a)}};mxGraph.prototype.selectVertices=function(a){this.selectCells(true,false,a)};mxGraph.prototype.selectEdges=function(a){this.selectCells(false,true,a)};mxGraph.prototype.selectCells=function(c,a,e){e=e||this.getDefaultParent();var d=mxUtils.bind(this,function(f){return this.view.getState(f)!=null&&((this.model.getChildCount(f)==0&&this.model.isVertex(f)&&c&&!this.model.isEdge(this.model.getParent(f)))||(this.model.isEdge(f)&&a))});var b=this.model.filterDescendants(d,e);this.setSelectionCells(b)};mxGraph.prototype.selectCellForEvent=function(a,b){var c=this.isCellSelected(a);if(this.isToggleEvent(b)){if(c){this.removeSelectionCell(a)}else{this.addSelectionCell(a)}}else{if(!c||this.getSelectionCount()!=1){this.setSelectionCell(a)}}};mxGraph.prototype.selectCellsForEvent=function(b,a){if(this.isToggleEvent(a)){this.addSelectionCells(b)}else{this.setSelectionCells(b)}};mxGraph.prototype.createHandler=function(c){var a=null;if(c!=null){if(this.model.isEdge(c.cell)){var b=c.getVisibleTerminalState(true);var e=c.getVisibleTerminalState(false);var d=this.getCellGeometry(c.cell);var f=this.view.getEdgeStyle(c,(d!=null)?d.points:null,b,e);a=this.createEdgeHandler(c,f)}else{a=this.createVertexHandler(c)}}return a};mxGraph.prototype.createVertexHandler=function(a){return new mxVertexHandler(a)};mxGraph.prototype.createEdgeHandler=function(b,c){var a=null;if(c==mxEdgeStyle.Loop||c==mxEdgeStyle.ElbowConnector||c==mxEdgeStyle.SideToSide||c==mxEdgeStyle.TopToBottom){a=this.createElbowEdgeHandler(b)}else{if(c==mxEdgeStyle.SegmentConnector||c==mxEdgeStyle.OrthConnector){a=this.createEdgeSegmentHandler(b)}else{a=new mxEdgeHandler(b)}}return a};mxGraph.prototype.createEdgeSegmentHandler=function(a){return new mxEdgeSegmentHandler(a)};mxGraph.prototype.createElbowEdgeHandler=function(a){return new mxElbowEdgeHandler(a)};mxGraph.prototype.addMouseListener=function(a){if(this.mouseListeners==null){this.mouseListeners=[]}this.mouseListeners.push(a)};mxGraph.prototype.removeMouseListener=function(b){if(this.mouseListeners!=null){for(var a=0;a<this.mouseListeners.length;a++){if(this.mouseListeners[a]==b){this.mouseListeners.splice(a,1);break}}}};mxGraph.prototype.updateMouseEvent=function(a,c){if(a.graphX==null||a.graphY==null){var b=mxUtils.convertPoint(this.container,a.getX(),a.getY());a.graphX=b.x-this.panDx;a.graphY=b.y-this.panDy;if(a.getCell()==null&&this.isMouseDown&&c==mxEvent.MOUSE_MOVE){a.state=this.view.getState(this.getCellAt(b.x,b.y,null,null,null,function(d){return d.shape==null||d.shape.paintBackground!=mxRectangleShape.prototype.paintBackground||mxUtils.getValue(d.style,mxConstants.STYLE_POINTER_EVENTS,"1")=="1"||(d.shape.fill!=null&&d.shape.fill!=mxConstants.NONE)}))}}return a};mxGraph.prototype.getStateForTouchEvent=function(b){var a=mxEvent.getClientX(b);var d=mxEvent.getClientY(b);var c=mxUtils.convertPoint(this.container,a,d);return this.view.getState(this.getCellAt(c.x,c.y))};mxGraph.prototype.isEventIgnored=function(d,c,b){var e=mxEvent.isMouseEvent(c.getEvent());var a=false;if(c.getEvent()==this.lastEvent){a=true}else{this.lastEvent=c.getEvent()}if(this.eventSource!=null&&d!=mxEvent.MOUSE_MOVE){mxEvent.removeGestureListeners(this.eventSource,null,this.mouseMoveRedirect,this.mouseUpRedirect);this.mouseMoveRedirect=null;this.mouseUpRedirect=null;this.eventSource=null}else{if(this.eventSource!=null&&c.getSource()!=this.eventSource){a=true}else{if(mxClient.IS_TOUCH&&d==mxEvent.MOUSE_DOWN&&!e){this.eventSource=c.getSource();this.mouseMoveRedirect=mxUtils.bind(this,function(f){this.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(f,this.getStateForTouchEvent(f)))});this.mouseUpRedirect=mxUtils.bind(this,function(f){this.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(f,this.getStateForTouchEvent(f)))});mxEvent.addGestureListeners(this.eventSource,null,this.mouseMoveRedirect,this.mouseUpRedirect)}}}if(this.isSyntheticEventIgnored(d,c,b)){a=true}if(!mxEvent.isPopupTrigger(this.lastEvent)&&d!=mxEvent.MOUSE_MOVE&&this.lastEvent.detail==2){return true}if(d==mxEvent.MOUSE_UP&&this.isMouseDown){this.isMouseDown=false}else{if(d==mxEvent.MOUSE_DOWN&&!this.isMouseDown){this.isMouseDown=true;this.isMouseTrigger=e}else{if(!a&&(((!mxClient.IS_FF||d!=mxEvent.MOUSE_MOVE)&&this.isMouseDown&&this.isMouseTrigger!=e)||(d==mxEvent.MOUSE_DOWN&&this.isMouseDown)||(d==mxEvent.MOUSE_UP&&!this.isMouseDown))){a=true}}}if(!a&&d==mxEvent.MOUSE_DOWN){this.lastMouseX=c.getX();this.lastMouseY=c.getY()}return a};mxGraph.prototype.isSyntheticEventIgnored=function(d,c,b){var a=false;var e=mxEvent.isMouseEvent(c.getEvent());if(this.ignoreMouseEvents&&e&&d!=mxEvent.MOUSE_MOVE){this.ignoreMouseEvents=d!=mxEvent.MOUSE_UP;a=true}else{if(mxClient.IS_FF&&!e&&d==mxEvent.MOUSE_UP){this.ignoreMouseEvents=true}}return a};mxGraph.prototype.isEventSourceIgnored=function(e,c){var d=c.getSource();var a=(d.nodeName!=null)?d.nodeName.toLowerCase():"";var b=!mxEvent.isMouseEvent(c.getEvent())||mxEvent.isLeftMouseButton(c.getEvent());return e==mxEvent.MOUSE_DOWN&&b&&(a=="select"||a=="option"||(a=="input"&&d.type!="checkbox"&&d.type!="radio"&&d.type!="button"&&d.type!="submit"&&d.type!="file"))};mxGraph.prototype.getEventState=function(a){return a};mxGraph.prototype.fireMouseEvent=function(e,k,g){if(this.isEventSourceIgnored(e,k)){if(this.tooltipHandler!=null){this.tooltipHandler.hide()}return}if(g==null){g=this}k=this.updateMouseEvent(k,e);if((!this.nativeDblClickEnabled&&!mxEvent.isPopupTrigger(k.getEvent()))||(this.doubleTapEnabled&&mxClient.IS_TOUCH&&mxEvent.isTouchEvent(k.getEvent()))){var c=new Date().getTime();if((!mxClient.IS_QUIRKS&&e==mxEvent.MOUSE_DOWN)||(mxClient.IS_QUIRKS&&e==mxEvent.MOUSE_UP&&!this.fireDoubleClick)){if(this.lastTouchEvent!=null&&this.lastTouchEvent!=k.getEvent()&&c-this.lastTouchTime<this.doubleTapTimeout&&Math.abs(this.lastTouchX-k.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-k.getY())<this.doubleTapTolerance&&this.doubleClickCounter<2){this.doubleClickCounter++;var b=false;if(e==mxEvent.MOUSE_UP){if(k.getCell()==this.lastTouchCell&&this.lastTouchCell!=null){this.lastTouchTime=0;var m=this.lastTouchCell;this.lastTouchCell=null;if(mxClient.IS_QUIRKS){k.getSource().fireEvent("ondblclick")}this.dblClick(k.getEvent(),m);b=true}}else{this.fireDoubleClick=true;this.lastTouchTime=0}if(!mxClient.IS_QUIRKS||b){mxEvent.consume(k.getEvent());return}}else{if(this.lastTouchEvent==null||this.lastTouchEvent!=k.getEvent()){this.lastTouchCell=k.getCell();this.lastTouchX=k.getX();this.lastTouchY=k.getY();this.lastTouchTime=c;this.lastTouchEvent=k.getEvent();this.doubleClickCounter=0}}}else{if((this.isMouseDown||e==mxEvent.MOUSE_UP)&&this.fireDoubleClick){this.fireDoubleClick=false;var m=this.lastTouchCell;this.lastTouchCell=null;this.isMouseDown=false;var a=(m!=null)||(mxEvent.isTouchEvent(k.getEvent())&&(mxClient.IS_GC||mxClient.IS_SF));if(a&&Math.abs(this.lastTouchX-k.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-k.getY())<this.doubleTapTolerance){this.dblClick(k.getEvent(),m)}else{mxEvent.consume(k.getEvent())}return}}}if(!this.isEventIgnored(e,k,g)){k.state=this.getEventState(k.getState());this.fireEvent(new mxEventObject(mxEvent.FIRE_MOUSE_EVENT,"eventName",e,"event",k));if((mxClient.IS_OP||mxClient.IS_SF||mxClient.IS_GC||mxClient.IS_IE11||(mxClient.IS_IE&&mxClient.IS_SVG)||k.getEvent().target!=this.container)){if(e==mxEvent.MOUSE_MOVE&&this.isMouseDown&&this.autoScroll&&!mxEvent.isMultiTouchEvent(k.getEvent)){this.scrollPointToVisible(k.getGraphX(),k.getGraphY(),this.autoExtend)}else{if(e==mxEvent.MOUSE_UP&&this.ignoreScrollbars&&this.translateToScrollPosition&&(this.container.scrollLeft!=0||this.container.scrollTop!=0)){var o=this.view.scale;var j=this.view.translate;this.view.setTranslate(j.x-this.container.scrollLeft/o,j.y-this.container.scrollTop/o);this.container.scrollLeft=0;this.container.scrollTop=0}}if(this.mouseListeners!=null){var h=[g,k];if(!k.getEvent().preventDefault){k.getEvent().returnValue=true}for(var f=0;f<this.mouseListeners.length;f++){var d=this.mouseListeners[f];if(e==mxEvent.MOUSE_DOWN){d.mouseDown.apply(d,h)}else{if(e==mxEvent.MOUSE_MOVE){d.mouseMove.apply(d,h)}else{if(e==mxEvent.MOUSE_UP){d.mouseUp.apply(d,h)}}}}}if(e==mxEvent.MOUSE_UP){this.click(k)}}if(mxEvent.isTouchEvent(k.getEvent())&&e==mxEvent.MOUSE_DOWN&&this.tapAndHoldEnabled&&!this.tapAndHoldInProgress){this.tapAndHoldInProgress=true;this.initialTouchX=k.getGraphX();this.initialTouchY=k.getGraphY();var n=function(){if(this.tapAndHoldValid){this.tapAndHold(k)}this.tapAndHoldInProgress=false;this.tapAndHoldValid=false};if(this.tapAndHoldThread){window.clearTimeout(this.tapAndHoldThread)}this.tapAndHoldThread=window.setTimeout(mxUtils.bind(this,n),this.tapAndHoldDelay);this.tapAndHoldValid=true}else{if(e==mxEvent.MOUSE_UP){this.tapAndHoldInProgress=false;this.tapAndHoldValid=false}else{if(this.tapAndHoldValid){this.tapAndHoldValid=Math.abs(this.initialTouchX-k.getGraphX())<this.tolerance&&Math.abs(this.initialTouchY-k.getGraphY())<this.tolerance}}}if(e==mxEvent.MOUSE_DOWN&&this.isEditing()&&!this.cellEditor.isEventSource(k.getEvent())){this.stopEditing(!this.isInvokesStopCellEditing())}this.consumeMouseEvent(e,k,g)}};mxGraph.prototype.consumeMouseEvent=function(c,b,a){if(c==mxEvent.MOUSE_DOWN&&mxEvent.isTouchEvent(b.getEvent())){b.consume(false)}};mxGraph.prototype.fireGestureEvent=function(b,a){this.lastTouchTime=0;this.fireEvent(new mxEventObject(mxEvent.GESTURE,"event",b,"cell",a))};mxGraph.prototype.destroy=function(){if(!this.destroyed){this.destroyed=true;if(this.tooltipHandler!=null){this.tooltipHandler.destroy()}if(this.selectionCellsHandler!=null){this.selectionCellsHandler.destroy()}if(this.panningHandler!=null){this.panningHandler.destroy()}if(this.popupMenuHandler!=null){this.popupMenuHandler.destroy()}if(this.connectionHandler!=null){this.connectionHandler.destroy()}if(this.graphHandler!=null){this.graphHandler.destroy()}if(this.cellEditor!=null){this.cellEditor.destroy()}if(this.view!=null){this.view.destroy()}if(this.model!=null&&this.graphModelChangeListener!=null){this.model.removeListener(this.graphModelChangeListener);this.graphModelChangeListener=null}this.container=null}};