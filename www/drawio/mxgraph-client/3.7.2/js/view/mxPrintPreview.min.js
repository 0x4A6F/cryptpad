function mxPrintPreview(i,d,c,e,a,h,b,g,f){this.graph=i;this.scale=(d!=null)?d:1/i.pageScale;this.border=(e!=null)?e:0;this.pageFormat=mxRectangle.fromRectangle((c!=null)?c:i.pageFormat);this.title=(g!=null)?g:"Printer-friendly version";this.x0=(a!=null)?a:0;this.y0=(h!=null)?h:0;this.borderColor=b;this.pageSelector=(f!=null)?f:true}mxPrintPreview.prototype.graph=null;mxPrintPreview.prototype.pageFormat=null;mxPrintPreview.prototype.scale=null;mxPrintPreview.prototype.border=0;mxPrintPreview.prototype.marginTop=0;mxPrintPreview.prototype.marginBottom=0;mxPrintPreview.prototype.x0=0;mxPrintPreview.prototype.y0=0;mxPrintPreview.prototype.autoOrigin=true;mxPrintPreview.prototype.printOverlays=false;mxPrintPreview.prototype.printControls=false;mxPrintPreview.prototype.printBackgroundImage=false;mxPrintPreview.prototype.backgroundColor="#ffffff";mxPrintPreview.prototype.borderColor=null;mxPrintPreview.prototype.title=null;mxPrintPreview.prototype.pageSelector=null;mxPrintPreview.prototype.wnd=null;mxPrintPreview.prototype.targetWindow=null;mxPrintPreview.prototype.pageCount=0;mxPrintPreview.prototype.clipping=true;mxPrintPreview.prototype.getWindow=function(){return this.wnd};mxPrintPreview.prototype.getDoctype=function(){var a="";if(document.documentMode==5){a='<meta http-equiv="X-UA-Compatible" content="IE=5">'}else{if(document.documentMode==8){a='<meta http-equiv="X-UA-Compatible" content="IE=8">'}else{if(document.documentMode>8){a='<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->'}}}return a};mxPrintPreview.prototype.appendGraph=function(d,e,b,c,f,a){this.graph=d;this.scale=(e!=null)?e:1/d.pageScale;this.x0=b;this.y0=c;this.open(null,null,f,a)};mxPrintPreview.prototype.open=function(r,f,h,w){var t=this.graph.cellRenderer.initializeOverlay;var u=null;try{if(this.printOverlays){this.graph.cellRenderer.initializeOverlay=function(i,e){e.init(i.view.getDrawPane())}}if(this.printControls){this.graph.cellRenderer.initControl=function(e,j,i,F){j.dialect=e.view.graph.dialect;j.init(e.view.getDrawPane())}}this.wnd=(f!=null)?f:this.wnd;var o=false;if(this.wnd==null){o=true;this.wnd=window.open()}var E=this.wnd.document;if(o){var v=this.getDoctype();if(v!=null&&v.length>0){E.writeln(v)}if(mxClient.IS_VML){E.writeln('<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">')}else{if(document.compatMode==="CSS1Compat"){E.writeln("<!DOCTYPE html>")}E.writeln("<html>")}E.writeln("<head>");this.writeHead(E,r);E.writeln("</head>");E.writeln('<body class="mxPage">')}var p=this.graph.getGraphBounds().clone();var x=this.graph.getView().getScale();var b=x/this.scale;var d=this.graph.getView().getTranslate();if(!this.autoOrigin){this.x0-=d.x*this.scale;this.y0-=d.y*this.scale;p.width+=p.x;p.height+=p.y;p.x=0;p.y=0;this.border=0}var c=this.pageFormat.width-(this.border*2);var g=this.pageFormat.height-(this.border*2);this.pageFormat.height+=this.marginTop+this.marginBottom;p.width/=b;p.height/=b;var l=Math.max(1,Math.ceil((p.width+this.x0)/c));var D=Math.max(1,Math.ceil((p.height+this.y0)/g));this.pageCount=l*D;var n=mxUtils.bind(this,function(){if(this.pageSelector&&(D>1||l>1)){var e=this.createPageSelector(D,l);E.body.appendChild(e);if(mxClient.IS_IE&&E.documentMode==null||E.documentMode==5||E.documentMode==8||E.documentMode==7){e.style.position="absolute";var i=function(){e.style.top=((E.body.scrollTop||E.documentElement.scrollTop)+10)+"px"};mxEvent.addListener(this.wnd,"scroll",function(j){i()});mxEvent.addListener(this.wnd,"resize",function(j){i()})}}});var k=mxUtils.bind(this,function(i,e){if(this.borderColor!=null){i.style.borderColor=this.borderColor;i.style.borderStyle="solid";i.style.borderWidth="1px"}i.style.background=this.backgroundColor;if(h||e){i.style.pageBreakAfter="always"}if(o&&(mxClient.IS_IE||document.documentMode>=11||mxClient.IS_EDGE)){E.writeln(i.outerHTML);i.parentNode.removeChild(i)}else{i.parentNode.removeChild(i);E.body.appendChild(i)}if(h||e){this.addPageBreak(E)}});var a=this.getCoverPages(this.pageFormat.width,this.pageFormat.height);if(a!=null){for(var z=0;z<a.length;z++){k(a[z],true)}}var m=this.getAppendices(this.pageFormat.width,this.pageFormat.height);for(var z=0;z<D;z++){var q=z*g/this.scale-this.y0/this.scale+(p.y-d.y*x)/x;for(var y=0;y<l;y++){if(this.wnd==null){return null}var s=y*c/this.scale-this.x0/this.scale+(p.x-d.x*x)/x;var C=z*l+y+1;var B=new mxRectangle(s,q,c,g);u=this.renderPage(this.pageFormat.width,this.pageFormat.height,0,0,mxUtils.bind(this,function(e){this.addGraphFragment(-s,-q,this.scale,C,e,B);if(this.printBackgroundImage){this.insertBackgroundImage(e,-s,-q)}}),C);u.setAttribute("id","mxPage-"+C);k(u,m!=null||z<D-1||y<l-1)}}if(m!=null){for(var z=0;z<m.length;z++){k(m[z],z<m.length-1)}}if(o&&!w){this.closeDocument();n()}this.wnd.focus()}catch(A){if(u!=null&&u.parentNode!=null){u.parentNode.removeChild(u)}}finally{this.graph.cellRenderer.initializeOverlay=t}return this.wnd};mxPrintPreview.prototype.addPageBreak=function(b){var a=b.createElement("hr");a.className="mxPageBreak";b.body.appendChild(a)};mxPrintPreview.prototype.closeDocument=function(){if(this.wnd!=null&&this.wnd.document!=null){var a=this.wnd.document;this.writePostfix(a);a.writeln("</body>");a.writeln("</html>");a.close();mxEvent.release(a.body)}};mxPrintPreview.prototype.writeHead=function(b,a){if(this.title!=null){b.writeln("<title>"+this.title+"</title>")}if(mxClient.IS_VML){b.writeln('<style type="text/css">v\\:*{behavior:url(#default#VML)}o\\:*{behavior:url(#default#VML)}</style>')}mxClient.link("stylesheet",mxClient.basePath+"/css/common.css",b);b.writeln('<style type="text/css">');b.writeln("@media print {");b.writeln("  table.mxPageSelector { display: none; }");b.writeln("  hr.mxPageBreak { display: none; }");b.writeln("}");b.writeln("@media screen {");b.writeln("  table.mxPageSelector { position: fixed; right: 10px; top: 10px;font-family: Arial; font-size:10pt; border: solid 1px darkgray;background: white; border-collapse:collapse; }");b.writeln("  table.mxPageSelector td { border: solid 1px gray; padding:4px; }");b.writeln("  body.mxPage { background: gray; }");b.writeln("}");if(a!=null){b.writeln(a)}b.writeln("</style>")};mxPrintPreview.prototype.writePostfix=function(a){};mxPrintPreview.prototype.createPageSelector=function(d,c){var l=this.wnd.document;var n=l.createElement("table");n.className="mxPageSelector";n.setAttribute("border","0");var g=l.createElement("tbody");for(var f=0;f<d;f++){var o=l.createElement("tr");for(var e=0;e<c;e++){var h=f*c+e+1;var m=l.createElement("td");var k=l.createElement("a");k.setAttribute("href","#mxPage-"+h);if(mxClient.IS_NS&&!mxClient.IS_SF&&!mxClient.IS_GC){var b="var page = document.getElementById('mxPage-"+h+"');page.scrollIntoView(true);event.preventDefault();";k.setAttribute("onclick",b)}mxUtils.write(k,h,l);m.appendChild(k);o.appendChild(m)}g.appendChild(o)}n.appendChild(g);return n};mxPrintPreview.prototype.renderPage=function(k,c,n,m,g,i){var j=this.wnd.document;var a=document.createElement("div");var l=null;try{if(n!=0||m!=0){a.style.position="relative";a.style.width=k+"px";a.style.height=c+"px";a.style.pageBreakInside="avoid";var b=document.createElement("div");b.style.position="relative";b.style.top=this.border+"px";b.style.left=this.border+"px";b.style.width=(k-2*this.border)+"px";b.style.height=(c-2*this.border)+"px";b.style.overflow="hidden";var f=document.createElement("div");f.style.position="relative";f.style.marginLeft=n+"px";f.style.marginTop=m+"px";if(j.documentMode==8){b.style.position="absolute";f.style.position="absolute"}if(j.documentMode==10){f.style.width="100%";f.style.height="100%"}b.appendChild(f);a.appendChild(b);document.body.appendChild(a);l=f}else{a.style.width=k+"px";a.style.height=c+"px";a.style.overflow="hidden";a.style.pageBreakInside="avoid";if(j.documentMode==8){a.style.position="relative"}var b=document.createElement("div");b.style.width=(k-2*this.border)+"px";b.style.height=(c-2*this.border)+"px";b.style.overflow="hidden";if(mxClient.IS_IE&&(j.documentMode==null||j.documentMode==5||j.documentMode==8||j.documentMode==7)){b.style.marginTop=this.border+"px";b.style.marginLeft=this.border+"px"}else{b.style.top=this.border+"px";b.style.left=this.border+"px"}if(this.graph.dialect==mxConstants.DIALECT_VML){b.style.position="absolute"}a.appendChild(b);document.body.appendChild(a);l=b}}catch(d){a.parentNode.removeChild(a);a=null;throw d}g(l);return a};mxPrintPreview.prototype.getRoot=function(){var a=this.graph.view.currentRoot;if(a==null){a=this.graph.getModel().getRoot()}return a};mxPrintPreview.prototype.addGraphFragment=function(h,g,y,w,n,r){var l=this.graph.getView();var f=this.graph.container;this.graph.container=n;var b=l.getCanvas();var v=l.getBackgroundPane();var p=l.getDrawPane();var i=l.getOverlayPane();if(this.graph.dialect==mxConstants.DIALECT_SVG){l.createSvg()}else{if(this.graph.dialect==mxConstants.DIALECT_VML){l.createVml()}else{l.createHtml()}}var e=l.isEventsEnabled();l.setEventsEnabled(false);var j=this.graph.isEnabled();this.graph.setEnabled(false);var k=l.getTranslate();l.translate=new mxPoint(h,g);var q=this.graph.cellRenderer.redraw;var d=l.states;var m=l.scale;if(this.clipping){var x=new mxRectangle((r.x+k.x)*m,(r.y+k.y)*m,r.width*m/y,r.height*m/y);this.graph.cellRenderer.redraw=function(B,A,s){if(B!=null){var D=d.get(B.cell);if(D!=null){var C=l.getBoundingBox(D,false);if(C!=null&&!mxUtils.intersects(x,C)){return}}}q.apply(this,arguments)}}var t=null;try{var c=[this.getRoot()];t=new mxTemporaryCellStates(l,y,c)}finally{if(mxClient.IS_IE){l.overlayPane.innerHTML="";l.canvas.style.overflow="hidden";l.canvas.style.position="relative";l.canvas.style.top=this.marginTop+"px";l.canvas.style.width=r.width+"px";l.canvas.style.height=r.height+"px"}else{var u=n.firstChild;while(u!=null){var o=u.nextSibling;var z=u.nodeName.toLowerCase();if(z=="svg"){u.style.overflow="hidden";u.style.position="relative";u.style.top=this.marginTop+"px";u.setAttribute("width",r.width);u.setAttribute("height",r.height);u.style.width="";u.style.height=""}else{if(u.style.cursor!="default"&&z!="div"){u.parentNode.removeChild(u)}}u=o}}if(this.printBackgroundImage){var a=n.getElementsByTagName("svg");if(a.length>0){a[0].style.position="absolute"}}l.overlayPane.parentNode.removeChild(l.overlayPane);this.graph.setEnabled(j);this.graph.container=f;this.graph.cellRenderer.redraw=q;l.canvas=b;l.backgroundPane=v;l.drawPane=p;l.overlayPane=i;l.translate=k;t.destroy();l.setEventsEnabled(e)}};mxPrintPreview.prototype.insertBackgroundImage=function(e,c,a){var d=this.graph.backgroundImage;if(d!=null){var b=document.createElement("img");b.style.position="absolute";b.style.marginLeft=Math.round(c*this.scale)+"px";b.style.marginTop=Math.round(a*this.scale)+"px";b.setAttribute("width",Math.round(this.scale*d.width));b.setAttribute("height",Math.round(this.scale*d.height));b.src=d.src;e.insertBefore(b,e.firstChild)}};mxPrintPreview.prototype.getCoverPages=function(){return null};mxPrintPreview.prototype.getAppendices=function(){return null};mxPrintPreview.prototype.print=function(a){var b=this.open(a);if(b!=null){b.print()}};mxPrintPreview.prototype.close=function(){if(this.wnd!=null){this.wnd.close();this.wnd=null}};