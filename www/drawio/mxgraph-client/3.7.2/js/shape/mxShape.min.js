function mxShape(a){this.stencil=a;this.initStyles()}mxShape.prototype.dialect=null;mxShape.prototype.scale=1;mxShape.prototype.antiAlias=true;mxShape.prototype.bounds=null;mxShape.prototype.points=null;mxShape.prototype.node=null;mxShape.prototype.state=null;mxShape.prototype.style=null;mxShape.prototype.boundingBox=null;mxShape.prototype.stencil=null;mxShape.prototype.svgStrokeTolerance=8;mxShape.prototype.pointerEvents=true;mxShape.prototype.svgPointerEvents="all";mxShape.prototype.shapePointerEvents=false;mxShape.prototype.stencilPointerEvents=false;mxShape.prototype.vmlScale=1;mxShape.prototype.outline=false;mxShape.prototype.visible=true;mxShape.prototype.useSvgBoundingBox=false;mxShape.prototype.init=function(a){if(this.node==null){this.node=this.create(a);if(a!=null){a.appendChild(this.node)}}};mxShape.prototype.initStyles=function(a){this.strokewidth=1;this.rotation=0;this.opacity=100;this.fillOpacity=100;this.strokeOpacity=100;this.flipH=false;this.flipV=false};mxShape.prototype.isParseVml=function(){return true};mxShape.prototype.isHtmlAllowed=function(){return false};mxShape.prototype.getSvgScreenOffset=function(){var a=this.stencil&&this.stencil.strokewidth!="inherit"?Number(this.stencil.strokewidth):this.strokewidth;return(mxUtils.mod(Math.max(1,Math.round(a*this.scale)),2)==1)?0.5:0};mxShape.prototype.create=function(a){var b=null;if(a!=null&&a.ownerSVGElement!=null){b=this.createSvg(a)}else{if(document.documentMode==8||!mxClient.IS_VML||(this.dialect!=mxConstants.DIALECT_VML&&this.isHtmlAllowed())){b=this.createHtml(a)}else{b=this.createVml(a)}}return b};mxShape.prototype.createSvg=function(){return document.createElementNS(mxConstants.NS_SVG,"g")};mxShape.prototype.createVml=function(){var a=document.createElement(mxClient.VML_PREFIX+":group");a.style.position="absolute";return a};mxShape.prototype.createHtml=function(){var a=document.createElement("div");a.style.position="absolute";return a};mxShape.prototype.reconfigure=function(){this.redraw()};mxShape.prototype.redraw=function(){this.updateBoundsFromPoints();if(this.visible&&this.checkBounds()){this.node.style.visibility="visible";this.clear();if(this.node.nodeName=="DIV"&&(this.isHtmlAllowed()||!mxClient.IS_VML)){this.redrawHtmlShape()}else{this.redrawShape()}this.updateBoundingBox()}else{this.node.style.visibility="hidden";this.boundingBox=null}};mxShape.prototype.clear=function(){if(this.node.ownerSVGElement!=null){while(this.node.lastChild!=null){this.node.removeChild(this.node.lastChild)}}else{this.node.style.cssText="position:absolute;"+((this.cursor!=null)?("cursor:"+this.cursor+";"):"");this.node.innerHTML=""}};mxShape.prototype.updateBoundsFromPoints=function(){var b=this.points;if(b!=null&&b.length>0&&b[0]!=null){this.bounds=new mxRectangle(Number(b[0].x),Number(b[0].y),1,1);for(var a=1;a<this.points.length;a++){if(b[a]!=null){this.bounds.add(new mxRectangle(Number(b[a].x),Number(b[a].y),1,1))}}}};mxShape.prototype.getLabelBounds=function(a){return a};mxShape.prototype.checkBounds=function(){return(!isNaN(this.scale)&&isFinite(this.scale)&&this.scale>0&&this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)&&this.bounds.width>0&&this.bounds.height>0)};mxShape.prototype.createVmlGroup=function(){var a=document.createElement(mxClient.VML_PREFIX+":group");a.style.position="absolute";a.style.width=this.node.style.width;a.style.height=this.node.style.height;return a};mxShape.prototype.redrawShape=function(){var a=this.createCanvas();if(a!=null){a.pointerEvents=this.pointerEvents;this.paint(a);if(this.node!=a.root){this.node.insertAdjacentHTML("beforeend",a.root.outerHTML)}if(this.node.nodeName=="DIV"&&document.documentMode==8){this.node.style.filter="";mxUtils.addTransparentBackgroundFilter(this.node)}this.destroyCanvas(a)}};mxShape.prototype.createCanvas=function(){var a=null;if(this.node.ownerSVGElement!=null){a=this.createSvgCanvas()}else{if(mxClient.IS_VML){this.updateVmlContainer();a=this.createVmlCanvas()}}if(a!=null&&this.outline){a.setStrokeWidth(this.strokewidth);a.setStrokeColor(this.stroke);if(this.isDashed!=null){a.setDashed(this.isDashed)}a.setStrokeWidth=function(){};a.setStrokeColor=function(){};a.setFillColor=function(){};a.setGradient=function(){};a.setDashed=function(){}}return a};mxShape.prototype.createSvgCanvas=function(){var a=new mxSvgCanvas2D(this.node,false);a.strokeTolerance=(this.pointerEvents)?this.svgStrokeTolerance:0;a.pointerEventsValue=this.svgPointerEvents;a.blockImagePointerEvents=mxClient.IS_FF;var b=this.getSvgScreenOffset();if(b!=0){this.node.setAttribute("transform","translate("+b+","+b+")")}else{this.node.removeAttribute("transform")}if(!this.antiAlias){a.format=function(c){return Math.round(parseFloat(c))}}return a};mxShape.prototype.createVmlCanvas=function(){var e=(document.documentMode==8&&this.isParseVml())?this.createVmlGroup():this.node;var b=new mxVmlCanvas2D(e,false);if(e.tagUrn!=""){var a=Math.max(1,Math.round(this.bounds.width));var d=Math.max(1,Math.round(this.bounds.height));e.coordsize=(a*this.vmlScale)+","+(d*this.vmlScale);b.scale(this.vmlScale);b.vmlScale=this.vmlScale}var c=this.scale;b.translate(-Math.round(this.bounds.x/c),-Math.round(this.bounds.y/c));return b};mxShape.prototype.updateVmlContainer=function(){this.node.style.left=Math.round(this.bounds.x)+"px";this.node.style.top=Math.round(this.bounds.y)+"px";var a=Math.max(1,Math.round(this.bounds.width));var b=Math.max(1,Math.round(this.bounds.height));this.node.style.width=a+"px";this.node.style.height=b+"px";this.node.style.overflow="visible"};mxShape.prototype.redrawHtmlShape=function(){this.updateHtmlBounds(this.node);this.updateHtmlFilters(this.node);this.updateHtmlColors(this.node)};mxShape.prototype.updateHtmlFilters=function(e){var g="";if(this.opacity<100){g+="alpha(opacity="+(this.opacity)+")"}if(this.isShadow){g+="progid:DXImageTransform.Microsoft.dropShadow (OffX='"+Math.round(mxConstants.SHADOW_OFFSET_X*this.scale)+"', OffY='"+Math.round(mxConstants.SHADOW_OFFSET_Y*this.scale)+"', Color='"+mxConstants.VML_SHADOWCOLOR+"')"}if(this.fill!=null&&this.fill!=mxConstants.NONE&&this.gradient&&this.gradient!=mxConstants.NONE){var i=this.fill;var a=this.gradient;var d="0";var h={east:0,south:1,west:2,north:3};var b=(this.direction!=null)?h[this.direction]:0;if(this.gradientDirection!=null){b=mxUtils.mod(b+h[this.gradientDirection]-1,4)}if(b==1){d="1";var c=i;i=a;a=c}else{if(b==2){var c=i;i=a;a=c}else{if(b==3){d="1"}}}g+="progid:DXImageTransform.Microsoft.gradient(startColorStr='"+i+"', endColorStr='"+a+"', gradientType='"+d+"')"}e.style.filter=g};mxShape.prototype.updateHtmlColors=function(b){var a=this.stroke;if(a!=null&&a!=mxConstants.NONE){b.style.borderColor=a;if(this.isDashed){b.style.borderStyle="dashed"}else{if(this.strokewidth>0){b.style.borderStyle="solid"}}b.style.borderWidth=Math.max(1,Math.ceil(this.strokewidth*this.scale))+"px"}else{b.style.borderWidth="0px"}a=(this.outline)?null:this.fill;if(a!=null&&a!=mxConstants.NONE){b.style.backgroundColor=a;b.style.backgroundImage="none"}else{if(this.pointerEvents){b.style.backgroundColor="transparent"}else{if(document.documentMode==8){mxUtils.addTransparentBackgroundFilter(b)}else{this.setTransparentBackgroundImage(b)}}}};mxShape.prototype.updateHtmlBounds=function(b){var a=(document.documentMode>=9)?0:Math.ceil(this.strokewidth*this.scale);b.style.borderWidth=Math.max(1,a)+"px";b.style.overflow="hidden";b.style.left=Math.round(this.bounds.x-a/2)+"px";b.style.top=Math.round(this.bounds.y-a/2)+"px";if(document.compatMode=="CSS1Compat"){a=-a}b.style.width=Math.round(Math.max(0,this.bounds.width+a))+"px";b.style.height=Math.round(Math.max(0,this.bounds.height+a))+"px"};mxShape.prototype.destroyCanvas=function(a){if(a instanceof mxSvgCanvas2D){for(var b in a.gradients){var c=a.gradients[b];if(c!=null){c.mxRefCount=(c.mxRefCount||0)+1}}this.releaseSvgGradients(this.oldGradients);this.oldGradients=a.gradients}};mxShape.prototype.paint=function(g){var p=this.scale;var l=this.bounds.x/p;var k=this.bounds.y/p;var m=this.bounds.width/p;var e=this.bounds.height/p;if(this.isPaintBoundsInverted()){var n=(m-e)/2;l+=n;k-=n;var d=m;m=e;e=d}this.updateTransform(g,l,k,m,e);this.configureCanvas(g,l,k,m,e);var b=null;if((this.stencil==null&&this.points==null&&this.shapePointerEvents)||(this.stencil!=null&&this.stencilPointerEvents)){var f=this.createBoundingBox();if(this.dialect==mxConstants.DIALECT_SVG){b=this.createTransparentSvgRectangle(f.x,f.y,f.width,f.height);this.node.appendChild(b)}else{var j=g.createRect("rect",f.x/p,f.y/p,f.width/p,f.height/p);j.appendChild(g.createTransparentFill());j.stroked="false";g.root.appendChild(j)}}if(this.stencil!=null){this.stencil.drawShape(g,this,l,k,m,e)}else{g.setStrokeWidth(this.strokewidth);if(this.points!=null){var o=[];for(var a=0;a<this.points.length;a++){if(this.points[a]!=null){o.push(new mxPoint(this.points[a].x/p,this.points[a].y/p))}}this.paintEdgeShape(g,o)}else{this.paintVertexShape(g,l,k,m,e)}}if(b!=null&&g.state!=null&&g.state.transform!=null){b.setAttribute("transform",g.state.transform)}};mxShape.prototype.configureCanvas=function(j,d,i,e,f){var g=null;if(this.style!=null){g=this.style.dashPattern}j.setAlpha(this.opacity/100);j.setFillAlpha(this.fillOpacity/100);j.setStrokeAlpha(this.strokeOpacity/100);if(this.isShadow!=null){j.setShadow(this.isShadow)}if(this.isDashed!=null){j.setDashed(this.isDashed)}if(g!=null){j.setDashPattern(g)}if(this.fill!=null&&this.fill!=mxConstants.NONE&&this.gradient&&this.gradient!=mxConstants.NONE){var a=this.getGradientBounds(j,d,i,e,f);j.setGradient(this.fill,this.gradient,a.x,a.y,a.width,a.height,this.gradientDirection)}else{j.setFillColor(this.fill)}j.setStrokeColor(this.stroke)};mxShape.prototype.getGradientBounds=function(f,a,e,b,d){return new mxRectangle(a,e,b,d)};mxShape.prototype.updateTransform=function(f,a,e,b,d){f.scale(this.scale);f.rotate(this.getShapeRotation(),this.flipH,this.flipV,a+b/2,e+d/2)};mxShape.prototype.paintVertexShape=function(f,a,e,b,d){this.paintBackground(f,a,e,b,d);f.setShadow(false);this.paintForeground(f,a,e,b,d)};mxShape.prototype.paintBackground=function(f,a,e,b,d){};mxShape.prototype.paintForeground=function(f,a,e,b,d){};mxShape.prototype.paintEdgeShape=function(b,a){};mxShape.prototype.getArcSize=function(a,b){var c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;return Math.min(a*c,b*c)};mxShape.prototype.paintGlassEffect=function(j,b,i,d,g,f){var a=Math.ceil(this.strokewidth/2);var e=0.4;j.setGradient("#ffffff","#ffffff",b,i,d,g*0.6,"south",0.9,0.1);j.begin();f+=2*a;if(this.isRounded){j.moveTo(b-a+f,i-a);j.quadTo(b-a,i-a,b-a,i-a+f);j.lineTo(b-a,i+g*e);j.quadTo(b+d*0.5,i+g*0.7,b+d+a,i+g*e);j.lineTo(b+d+a,i-a+f);j.quadTo(b+d+a,i-a,b+d+a-f,i-a)}else{j.moveTo(b-a,i-a);j.lineTo(b-a,i+g*e);j.quadTo(b+d*0.5,i+g*0.7,b+d+a,i+g*e);j.lineTo(b+d+a,i-a)}j.close();j.fill()};mxShape.prototype.addPoints=function(s,x,u,n,h){var w=x[x.length-1];if(h&&u){x=x.slice();var a=x[0];var d=new mxPoint(w.x+(a.x-w.x)/2,w.y+(a.y-w.y)/2);x.splice(0,0,d)}var l=x[0];var p=1;s.moveTo(l.x,l.y);while(p<((h)?x.length:x.length-1)){var t=x[mxUtils.mod(p,x.length)];var g=l.x-t.x;var f=l.y-t.y;if(u&&(g!=0||f!=0)){var m=Math.sqrt(g*g+f*f);var o=g*Math.min(n,m/2)/m;var y=f*Math.min(n,m/2)/m;var r=t.x+o;var e=t.y+y;s.lineTo(r,e);var k=x[mxUtils.mod(p+1,x.length)];while(p<x.length-2&&Math.round(k.x-t.x)==0&&Math.round(k.y-t.y)==0){k=x[mxUtils.mod(p+2,x.length)];p++}g=k.x-t.x;f=k.y-t.y;m=Math.max(1,Math.sqrt(g*g+f*f));var j=g*Math.min(n,m/2)/m;var v=f*Math.min(n,m/2)/m;var q=t.x+j;var b=t.y+v;s.quadTo(t.x,t.y,q,b);t=new mxPoint(q,b)}else{s.lineTo(t.x,t.y)}l=t;p++}if(h){s.close()}else{s.lineTo(w.x,w.y)}};mxShape.prototype.resetStyles=function(){this.initStyles();this.spacing=0;delete this.fill;delete this.gradient;delete this.gradientDirection;delete this.stroke;delete this.startSize;delete this.endSize;delete this.startArrow;delete this.endArrow;delete this.direction;delete this.isShadow;delete this.isDashed;delete this.isRounded;delete this.glass};mxShape.prototype.apply=function(b){this.state=b;this.style=b.style;if(this.style!=null){this.fill=mxUtils.getValue(this.style,mxConstants.STYLE_FILLCOLOR,this.fill);this.gradient=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENTCOLOR,this.gradient);this.gradientDirection=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENT_DIRECTION,this.gradientDirection);this.opacity=mxUtils.getValue(this.style,mxConstants.STYLE_OPACITY,this.opacity);this.fillOpacity=mxUtils.getValue(this.style,mxConstants.STYLE_FILL_OPACITY,this.fillOpacity);this.strokeOpacity=mxUtils.getValue(this.style,mxConstants.STYLE_STROKE_OPACITY,this.strokeOpacity);this.stroke=mxUtils.getValue(this.style,mxConstants.STYLE_STROKECOLOR,this.stroke);this.strokewidth=mxUtils.getNumber(this.style,mxConstants.STYLE_STROKEWIDTH,this.strokewidth);this.spacing=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING,this.spacing);this.startSize=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,this.startSize);this.endSize=mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,this.endSize);this.startArrow=mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,this.startArrow);this.endArrow=mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,this.endArrow);this.rotation=mxUtils.getValue(this.style,mxConstants.STYLE_ROTATION,this.rotation);this.direction=mxUtils.getValue(this.style,mxConstants.STYLE_DIRECTION,this.direction);this.flipH=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPH,0)==1;this.flipV=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPV,0)==1;if(this.stencil!=null){this.flipH=mxUtils.getValue(this.style,"stencilFlipH",0)==1||this.flipH;this.flipV=mxUtils.getValue(this.style,"stencilFlipV",0)==1||this.flipV}if(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH){var a=this.flipH;this.flipH=this.flipV;this.flipV=a}this.isShadow=mxUtils.getValue(this.style,mxConstants.STYLE_SHADOW,this.isShadow)==1;this.isDashed=mxUtils.getValue(this.style,mxConstants.STYLE_DASHED,this.isDashed)==1;this.isRounded=mxUtils.getValue(this.style,mxConstants.STYLE_ROUNDED,this.isRounded)==1;this.glass=mxUtils.getValue(this.style,mxConstants.STYLE_GLASS,this.glass)==1;if(this.fill==mxConstants.NONE){this.fill=null}if(this.gradient==mxConstants.NONE){this.gradient=null}if(this.stroke==mxConstants.NONE){this.stroke=null}}};mxShape.prototype.setCursor=function(a){if(a==null){a=""}this.cursor=a;if(this.node!=null){this.node.style.cursor=a}};mxShape.prototype.getCursor=function(){return this.cursor};mxShape.prototype.updateBoundingBox=function(){if(this.useSvgBoundingBox&&this.node!=null&&this.node.ownerSVGElement!=null){try{var a=this.node.getBBox();if(a.width>0&&a.height>0){this.boundingBox=new mxRectangle(a.x,a.y,a.width,a.height);this.boundingBox.grow(this.strokewidth*this.scale/2);return}}catch(d){}}if(this.bounds!=null){var f=this.createBoundingBox();if(f!=null){this.augmentBoundingBox(f);var c=this.getShapeRotation();if(c!=0){f=mxUtils.getBoundingBox(f,c)}}this.boundingBox=f}};mxShape.prototype.createBoundingBox=function(){var a=this.bounds.clone();if((this.stencil!=null&&(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH))||this.isPaintBoundsInverted()){a.rotate90()}return a};mxShape.prototype.augmentBoundingBox=function(a){if(this.isShadow){a.width+=Math.ceil(mxConstants.SHADOW_OFFSET_X*this.scale);a.height+=Math.ceil(mxConstants.SHADOW_OFFSET_Y*this.scale)}a.grow(this.strokewidth*this.scale/2)};mxShape.prototype.isPaintBoundsInverted=function(){return this.stencil==null&&(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH)};mxShape.prototype.getRotation=function(){return(this.rotation!=null)?this.rotation:0};mxShape.prototype.getTextRotation=function(){var a=this.getRotation();if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)!=1){a+=mxText.prototype.verticalTextRotation}return a};mxShape.prototype.getShapeRotation=function(){var a=this.getRotation();if(this.direction!=null){if(this.direction==mxConstants.DIRECTION_NORTH){a+=270}else{if(this.direction==mxConstants.DIRECTION_WEST){a+=180}else{if(this.direction==mxConstants.DIRECTION_SOUTH){a+=90}}}}return a};mxShape.prototype.createTransparentSvgRectangle=function(a,e,b,c){var d=document.createElementNS(mxConstants.NS_SVG,"rect");d.setAttribute("x",a);d.setAttribute("y",e);d.setAttribute("width",b);d.setAttribute("height",c);d.setAttribute("fill","none");d.setAttribute("stroke","none");d.setAttribute("pointer-events","all");return d};mxShape.prototype.setTransparentBackgroundImage=function(a){a.style.backgroundImage="url('"+mxClient.imageBasePath+"/transparent.gif')"};mxShape.prototype.releaseSvgGradients=function(b){if(b!=null){for(var a in b){var c=b[a];if(c!=null){c.mxRefCount=(c.mxRefCount||0)-1;if(c.mxRefCount==0&&c.parentNode!=null){c.parentNode.removeChild(c)}}}}};mxShape.prototype.destroy=function(){if(this.node!=null){mxEvent.release(this.node);if(this.node.parentNode!=null){this.node.parentNode.removeChild(this.node)}this.node=null}this.releaseSvgGradients(this.oldGradients);this.oldGradients=null};