function mxEditor(a){this.actions=[];this.addActions();if(document.body!=null){this.cycleAttributeValues=[];this.popupHandler=new mxDefaultPopupMenu();this.undoManager=new mxUndoManager();this.graph=this.createGraph();this.toolbar=this.createToolbar();this.keyHandler=new mxDefaultKeyHandler(this);this.configure(a);this.graph.swimlaneIndicatorColorAttribute=this.cycleAttributeName;if(this.onInit!=null){this.onInit()}if(mxClient.IS_IE){mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}))}}}if(mxLoadResources){mxResources.add(mxClient.basePath+"/resources/editor")}mxEditor.prototype=new mxEventSource();mxEditor.prototype.constructor=mxEditor;mxEditor.prototype.askZoomResource=(mxClient.language!="none")?"askZoom":"";mxEditor.prototype.lastSavedResource=(mxClient.language!="none")?"lastSaved":"";mxEditor.prototype.currentFileResource=(mxClient.language!="none")?"currentFile":"";mxEditor.prototype.propertiesResource=(mxClient.language!="none")?"properties":"";mxEditor.prototype.tasksResource=(mxClient.language!="none")?"tasks":"";mxEditor.prototype.helpResource=(mxClient.language!="none")?"help":"";mxEditor.prototype.outlineResource=(mxClient.language!="none")?"outline":"";mxEditor.prototype.outline=null;mxEditor.prototype.graph=null;mxEditor.prototype.graphRenderHint=null;mxEditor.prototype.toolbar=null;mxEditor.prototype.status=null;mxEditor.prototype.popupHandler=null;mxEditor.prototype.undoManager=null;mxEditor.prototype.keyHandler=null;mxEditor.prototype.actions=null;mxEditor.prototype.dblClickAction="edit";mxEditor.prototype.swimlaneRequired=false;mxEditor.prototype.disableContextMenu=true;mxEditor.prototype.insertFunction=null;mxEditor.prototype.forcedInserting=false;mxEditor.prototype.templates=null;mxEditor.prototype.defaultEdge=null;mxEditor.prototype.defaultEdgeStyle=null;mxEditor.prototype.defaultGroup=null;mxEditor.prototype.groupBorderSize=null;mxEditor.prototype.filename=null;mxEditor.prototype.linefeed="&#xa;";mxEditor.prototype.postParameterName="xml";mxEditor.prototype.escapePostData=true;mxEditor.prototype.urlPost=null;mxEditor.prototype.urlImage=null;mxEditor.prototype.horizontalFlow=false;mxEditor.prototype.layoutDiagram=false;mxEditor.prototype.swimlaneSpacing=0;mxEditor.prototype.maintainSwimlanes=false;mxEditor.prototype.layoutSwimlanes=false;mxEditor.prototype.cycleAttributeValues=null;mxEditor.prototype.cycleAttributeIndex=0;mxEditor.prototype.cycleAttributeName="fillColor";mxEditor.prototype.tasks=null;mxEditor.prototype.tasksWindowImage=null;mxEditor.prototype.tasksTop=20;mxEditor.prototype.help=null;mxEditor.prototype.helpWindowImage=null;mxEditor.prototype.urlHelp=null;mxEditor.prototype.helpWidth=300;mxEditor.prototype.helpHeight=260;mxEditor.prototype.propertiesWidth=240;mxEditor.prototype.propertiesHeight=null;mxEditor.prototype.movePropertiesDialog=false;mxEditor.prototype.validating=false;mxEditor.prototype.modified=false;mxEditor.prototype.isModified=function(){return this.modified};mxEditor.prototype.setModified=function(a){this.modified=a};mxEditor.prototype.addActions=function(){this.addAction("save",function(a){a.save()});this.addAction("print",function(a){var b=new mxPrintPreview(a.graph,1);b.open()});this.addAction("show",function(a){mxUtils.show(a.graph,null,10,10)});this.addAction("exportImage",function(c){var b=c.getUrlImage();if(b==null||mxClient.IS_LOCAL){c.execute("show")}else{var d=mxUtils.getViewXml(c.graph,1);var a=mxUtils.getXml(d,"\n");mxUtils.submit(b,c.postParameterName+"="+encodeURIComponent(a),document,"_blank")}});this.addAction("refresh",function(a){a.graph.refresh()});this.addAction("cut",function(a){if(a.graph.isEnabled()){mxClipboard.cut(a.graph)}});this.addAction("copy",function(a){if(a.graph.isEnabled()){mxClipboard.copy(a.graph)}});this.addAction("paste",function(a){if(a.graph.isEnabled()){mxClipboard.paste(a.graph)}});this.addAction("delete",function(a){if(a.graph.isEnabled()){a.graph.removeCells()}});this.addAction("group",function(a){if(a.graph.isEnabled()){a.graph.setSelectionCell(a.groupCells())}});this.addAction("ungroup",function(a){if(a.graph.isEnabled()){a.graph.setSelectionCells(a.graph.ungroupCells())}});this.addAction("removeFromParent",function(a){if(a.graph.isEnabled()){a.graph.removeCellsFromParent()}});this.addAction("undo",function(a){if(a.graph.isEnabled()){a.undo()}});this.addAction("redo",function(a){if(a.graph.isEnabled()){a.redo()}});this.addAction("zoomIn",function(a){a.graph.zoomIn()});this.addAction("zoomOut",function(a){a.graph.zoomOut()});this.addAction("actualSize",function(a){a.graph.zoomActual()});this.addAction("fit",function(a){a.graph.fit()});this.addAction("showProperties",function(b,a){b.showProperties(a)});this.addAction("selectAll",function(a){if(a.graph.isEnabled()){a.graph.selectAll()}});this.addAction("selectNone",function(a){if(a.graph.isEnabled()){a.graph.clearSelection()}});this.addAction("selectVertices",function(a){if(a.graph.isEnabled()){a.graph.selectVertices()}});this.addAction("selectEdges",function(a){if(a.graph.isEnabled()){a.graph.selectEdges()}});this.addAction("edit",function(b,a){if(b.graph.isEnabled()&&b.graph.isCellEditable(a)){b.graph.startEditingAtCell(a)}});this.addAction("toBack",function(b,a){if(b.graph.isEnabled()){b.graph.orderCells(true)}});this.addAction("toFront",function(b,a){if(b.graph.isEnabled()){b.graph.orderCells(false)}});this.addAction("enterGroup",function(b,a){b.graph.enterGroup(a)});this.addAction("exitGroup",function(a){a.graph.exitGroup()});this.addAction("home",function(a){a.graph.home()});this.addAction("selectPrevious",function(a){if(a.graph.isEnabled()){a.graph.selectPreviousCell()}});this.addAction("selectNext",function(a){if(a.graph.isEnabled()){a.graph.selectNextCell()}});this.addAction("selectParent",function(a){if(a.graph.isEnabled()){a.graph.selectParentCell()}});this.addAction("selectChild",function(a){if(a.graph.isEnabled()){a.graph.selectChildCell()}});this.addAction("collapse",function(a){if(a.graph.isEnabled()){a.graph.foldCells(true)}});this.addAction("collapseAll",function(b){if(b.graph.isEnabled()){var a=b.graph.getChildVertices();b.graph.foldCells(true,false,a)}});this.addAction("expand",function(a){if(a.graph.isEnabled()){a.graph.foldCells(false)}});this.addAction("expandAll",function(b){if(b.graph.isEnabled()){var a=b.graph.getChildVertices();b.graph.foldCells(false,false,a)}});this.addAction("bold",function(a){if(a.graph.isEnabled()){a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_BOLD)}});this.addAction("italic",function(a){if(a.graph.isEnabled()){a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_ITALIC)}});this.addAction("underline",function(a){if(a.graph.isEnabled()){a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_UNDERLINE)}});this.addAction("alignCellsLeft",function(a){if(a.graph.isEnabled()){a.graph.alignCells(mxConstants.ALIGN_LEFT)}});this.addAction("alignCellsCenter",function(a){if(a.graph.isEnabled()){a.graph.alignCells(mxConstants.ALIGN_CENTER)}});this.addAction("alignCellsRight",function(a){if(a.graph.isEnabled()){a.graph.alignCells(mxConstants.ALIGN_RIGHT)}});this.addAction("alignCellsTop",function(a){if(a.graph.isEnabled()){a.graph.alignCells(mxConstants.ALIGN_TOP)}});this.addAction("alignCellsMiddle",function(a){if(a.graph.isEnabled()){a.graph.alignCells(mxConstants.ALIGN_MIDDLE)}});this.addAction("alignCellsBottom",function(a){if(a.graph.isEnabled()){a.graph.alignCells(mxConstants.ALIGN_BOTTOM)}});this.addAction("alignFontLeft",function(a){a.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT)});this.addAction("alignFontCenter",function(a){if(a.graph.isEnabled()){a.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER)}});this.addAction("alignFontRight",function(a){if(a.graph.isEnabled()){a.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_RIGHT)}});this.addAction("alignFontTop",function(a){if(a.graph.isEnabled()){a.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_TOP)}});this.addAction("alignFontMiddle",function(a){if(a.graph.isEnabled()){a.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE)}});this.addAction("alignFontBottom",function(a){if(a.graph.isEnabled()){a.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_BOTTOM)}});this.addAction("zoom",function(a){var b=a.graph.getView().scale*100;var c=parseFloat(mxUtils.prompt(mxResources.get(a.askZoomResource)||a.askZoomResource,b))/100;if(!isNaN(c)){a.graph.getView().setScale(c)}});this.addAction("toggleTasks",function(a){if(a.tasks!=null){a.tasks.setVisible(!a.tasks.isVisible())}else{a.showTasks()}});this.addAction("toggleHelp",function(a){if(a.help!=null){a.help.setVisible(!a.help.isVisible())}else{a.showHelp()}});this.addAction("toggleOutline",function(a){if(a.outline==null){a.showOutline()}else{a.outline.setVisible(!a.outline.isVisible())}});this.addAction("toggleConsole",function(a){mxLog.setVisible(!mxLog.isVisible())})};mxEditor.prototype.configure=function(a){if(a!=null){var b=new mxCodec(a.ownerDocument);b.decode(a,this);this.resetHistory()}};mxEditor.prototype.resetFirstTime=function(){document.cookie="mxgraph=seen; expires=Fri, 27 Jul 2001 02:47:11 UTC; path=/"};mxEditor.prototype.resetHistory=function(){this.lastSnapshot=new Date().getTime();this.undoManager.clear();this.ignoredChanges=0;this.setModified(false)};mxEditor.prototype.addAction=function(b,a){this.actions[b]=a};mxEditor.prototype.execute=function(d,a,b){var f=this.actions[d];if(f!=null){try{var c=arguments;c[0]=this;f.apply(this,c)}catch(g){mxUtils.error("Cannot execute "+d+": "+g.message,280,true);throw g}}else{mxUtils.error("Cannot find action "+d,280,true)}};mxEditor.prototype.addTemplate=function(a,b){this.templates[a]=b};mxEditor.prototype.getTemplate=function(a){return this.templates[a]};mxEditor.prototype.createGraph=function(){var a=new mxGraph(null,null,this.graphRenderHint);a.setTooltips(true);a.setPanning(true);this.installDblClickHandler(a);this.installUndoHandler(a);this.installDrillHandler(a);this.installChangeHandler(a);this.installInsertHandler(a);a.popupMenuHandler.factoryMethod=mxUtils.bind(this,function(d,b,c){return this.createPopupMenu(d,b,c)});a.connectionHandler.factoryMethod=mxUtils.bind(this,function(b,c){return this.createEdge(b,c)});this.createSwimlaneManager(a);this.createLayoutManager(a);return a};mxEditor.prototype.createSwimlaneManager=function(b){var a=new mxSwimlaneManager(b,false);a.isHorizontal=mxUtils.bind(this,function(){return this.horizontalFlow});a.isEnabled=mxUtils.bind(this,function(){return this.maintainSwimlanes});return a};mxEditor.prototype.createLayoutManager=function(c){var b=new mxLayoutManager(c);var a=this;b.getLayout=function(d){var f=null;var e=a.graph.getModel();if(e.getParent(d)!=null){if(a.layoutSwimlanes&&c.isSwimlane(d)){if(a.swimlaneLayout==null){a.swimlaneLayout=a.createSwimlaneLayout()}f=a.swimlaneLayout}else{if(a.layoutDiagram&&(c.isValidRoot(d)||e.getParent(e.getParent(d))==null)){if(a.diagramLayout==null){a.diagramLayout=a.createDiagramLayout()}f=a.diagramLayout}}}return f};return b};mxEditor.prototype.setGraphContainer=function(a){if(this.graph.container==null){this.graph.init(a);this.rubberband=new mxRubberband(this.graph);if(this.disableContextMenu){mxEvent.disableContextMenu(a)}if(mxClient.IS_QUIRKS){new mxDivResizer(a)}}};mxEditor.prototype.installDblClickHandler=function(a){a.addListener(mxEvent.DOUBLE_CLICK,mxUtils.bind(this,function(d,c){var b=c.getProperty("cell");if(b!=null&&a.isEnabled()&&this.dblClickAction!=null){this.execute(this.dblClickAction,b);c.consume()}}))};mxEditor.prototype.installUndoHandler=function(b){var a=mxUtils.bind(this,function(e,d){var f=d.getProperty("edit");this.undoManager.undoableEditHappened(f)});b.getModel().addListener(mxEvent.UNDO,a);b.getView().addListener(mxEvent.UNDO,a);var c=function(e,d){var f=d.getProperty("edit").changes;b.setSelectionCells(b.getSelectionCellsForChanges(f))};this.undoManager.addListener(mxEvent.UNDO,c);this.undoManager.addListener(mxEvent.REDO,c)};mxEditor.prototype.installDrillHandler=function(b){var a=mxUtils.bind(this,function(c){this.fireEvent(new mxEventObject(mxEvent.ROOT))});b.getView().addListener(mxEvent.DOWN,a);b.getView().addListener(mxEvent.UP,a)};mxEditor.prototype.installChangeHandler=function(b){var a=mxUtils.bind(this,function(e,c){this.setModified(true);if(this.validating==true){b.validateGraph()}var f=c.getProperty("edit").changes;for(var d=0;d<f.length;d++){var g=f[d];if(g instanceof mxRootChange||(g instanceof mxValueChange&&g.cell==this.graph.model.root)||(g instanceof mxCellAttributeChange&&g.cell==this.graph.model.root)){this.fireEvent(new mxEventObject(mxEvent.ROOT));break}}});b.getModel().addListener(mxEvent.CHANGE,a)};mxEditor.prototype.installInsertHandler=function(b){var a=this;var c={mouseDown:function(d,e){if(a.insertFunction!=null&&!e.isPopupTrigger()&&(a.forcedInserting||e.getState()==null)){a.graph.clearSelection();a.insertFunction(e.getEvent(),e.getCell());this.isActive=true;e.consume()}},mouseMove:function(d,e){if(this.isActive){e.consume()}},mouseUp:function(d,e){if(this.isActive){this.isActive=false;e.consume()}}};b.addMouseListener(c)};mxEditor.prototype.createDiagramLayout=function(){var a=this.graph.gridSize;var b=new mxStackLayout(this.graph,!this.horizontalFlow,this.swimlaneSpacing,2*a,2*a);b.isVertexIgnored=function(c){return !b.graph.isSwimlane(c)};return b};mxEditor.prototype.createSwimlaneLayout=function(){return new mxCompactTreeLayout(this.graph,this.horizontalFlow)};mxEditor.prototype.createToolbar=function(){return new mxDefaultToolbar(null,this)};mxEditor.prototype.setToolbarContainer=function(a){this.toolbar.init(a);if(mxClient.IS_QUIRKS){new mxDivResizer(a)}};mxEditor.prototype.setStatusContainer=function(a){if(this.status==null){this.status=a;this.addListener(mxEvent.SAVE,mxUtils.bind(this,function(){var b=new Date().toLocaleString();this.setStatus((mxResources.get(this.lastSavedResource)||this.lastSavedResource)+": "+b)}));this.addListener(mxEvent.OPEN,mxUtils.bind(this,function(){this.setStatus((mxResources.get(this.currentFileResource)||this.currentFileResource)+": "+this.filename)}));if(mxClient.IS_QUIRKS){new mxDivResizer(a)}}};mxEditor.prototype.setStatus=function(a){if(this.status!=null&&a!=null){this.status.innerHTML=a}};mxEditor.prototype.setTitleContainer=function(a){this.addListener(mxEvent.ROOT,mxUtils.bind(this,function(b){a.innerHTML=this.getTitle()}));if(mxClient.IS_QUIRKS){new mxDivResizer(a)}};mxEditor.prototype.treeLayout=function(a,b){if(a!=null){var c=new mxCompactTreeLayout(this.graph,b);c.execute(a)}};mxEditor.prototype.getTitle=function(){var d="";var c=this.graph;var a=c.getCurrentRoot();while(a!=null&&c.getModel().getParent(c.getModel().getParent(a))!=null){if(c.isValidRoot(a)){d=" > "+c.convertValueToString(a)+d}a=c.getModel().getParent(a)}var b=this.getRootTitle();return b+d};mxEditor.prototype.getRootTitle=function(){var a=this.graph.getModel().getRoot();return this.graph.convertValueToString(a)};mxEditor.prototype.undo=function(){this.undoManager.undo()};mxEditor.prototype.redo=function(){this.undoManager.redo()};mxEditor.prototype.groupCells=function(){var a=(this.groupBorderSize!=null)?this.groupBorderSize:this.graph.gridSize;return this.graph.groupCells(this.createGroup(),a)};mxEditor.prototype.createGroup=function(){var a=this.graph.getModel();return a.cloneCell(this.defaultGroup)};mxEditor.prototype.open=function(a){if(a!=null){var b=mxUtils.load(a).getXml();this.readGraphModel(b.documentElement);this.filename=a;this.fireEvent(new mxEventObject(mxEvent.OPEN,"filename",a))}};mxEditor.prototype.readGraphModel=function(a){var b=new mxCodec(a.ownerDocument);b.decode(a,this.graph.getModel());this.resetHistory()};mxEditor.prototype.save=function(b,a){b=b||this.getUrlPost();if(b!=null&&b.length>0){var c=this.writeGraphModel(a);this.postDiagram(b,c);this.setModified(false)}this.fireEvent(new mxEventObject(mxEvent.SAVE,"url",b))};mxEditor.prototype.postDiagram=function(a,b){if(this.escapePostData){b=encodeURIComponent(b)}mxUtils.post(a,this.postParameterName+"="+b,mxUtils.bind(this,function(c){this.fireEvent(new mxEventObject(mxEvent.POST,"request",c,"url",a,"data",b))}))};mxEditor.prototype.writeGraphModel=function(b){b=(b!=null)?b:this.linefeed;var a=new mxCodec();var c=a.encode(this.graph.getModel());return mxUtils.getXml(c,b)};mxEditor.prototype.getUrlPost=function(){return this.urlPost};mxEditor.prototype.getUrlImage=function(){return this.urlImage};mxEditor.prototype.swapStyles=function(c,a){var b=this.graph.getStylesheet().styles[a];this.graph.getView().getStylesheet().putCellStyle(a,this.graph.getStylesheet().styles[c]);this.graph.getStylesheet().putCellStyle(c,b);this.graph.refresh()};mxEditor.prototype.showProperties=function(b){b=b||this.graph.getSelectionCell();if(b==null){b=this.graph.getCurrentRoot();if(b==null){b=this.graph.getModel().getRoot()}}if(b!=null){this.graph.stopEditing(true);var e=mxUtils.getOffset(this.graph.container);var a=e.x+10;var f=e.y;if(this.properties!=null&&!this.movePropertiesDialog){a=this.properties.getX();f=this.properties.getY()}else{var d=this.graph.getCellBounds(b);if(d!=null){a+=d.x+Math.min(200,d.width);f+=d.y}}this.hideProperties();var c=this.createProperties(b);if(c!=null){this.properties=new mxWindow(mxResources.get(this.propertiesResource)||this.propertiesResource,c,a,f,this.propertiesWidth,this.propertiesHeight,false);this.properties.setVisible(true)}}};mxEditor.prototype.isPropertiesVisible=function(){return this.properties!=null};mxEditor.prototype.createProperties=function(b){var g=this.graph.getModel();var m=g.getValue(b);if(mxUtils.isNode(m)){var c=new mxForm("properties");var j=c.addText("ID",b.getId());j.setAttribute("readonly","true");var r=null;var h=null;var d=null;var f=null;var e=null;if(g.isVertex(b)){r=g.getGeometry(b);if(r!=null){h=c.addText("top",r.y);d=c.addText("left",r.x);f=c.addText("width",r.width);e=c.addText("height",r.height)}}var p=g.getStyle(b);var o=c.addText("Style",p||"");var k=m.attributes;var a=[];for(var n=0;n<k.length;n++){var s=k[n].value;a[n]=c.addTextarea(k[n].nodeName,s,(k[n].nodeName=="label")?4:2)}var l=mxUtils.bind(this,function(){this.hideProperties();g.beginUpdate();try{if(r!=null){r=r.clone();r.x=parseFloat(d.value);r.y=parseFloat(h.value);r.width=parseFloat(f.value);r.height=parseFloat(e.value);g.setGeometry(b,r)}if(o.value.length>0){g.setStyle(b,o.value)}else{g.setStyle(b,null)}for(var t=0;t<k.length;t++){var u=new mxCellAttributeChange(b,k[t].nodeName,a[t].value);g.execute(u)}if(this.graph.isAutoSizeCell(b)){this.graph.updateCellSize(b)}}finally{g.endUpdate()}});var q=mxUtils.bind(this,function(){this.hideProperties()});c.addButtons(l,q);return c.table}return null};mxEditor.prototype.hideProperties=function(){if(this.properties!=null){this.properties.destroy();this.properties=null}};mxEditor.prototype.showTasks=function(){if(this.tasks==null){var d=document.createElement("div");d.style.padding="4px";d.style.paddingLeft="20px";var b=document.body.clientWidth;var c=new mxWindow(mxResources.get(this.tasksResource)||this.tasksResource,d,b-220,this.tasksTop,200);c.setClosable(true);c.destroyOnClose=false;var a=mxUtils.bind(this,function(e){mxEvent.release(d);d.innerHTML="";this.createTasks(d)});this.graph.getModel().addListener(mxEvent.CHANGE,a);this.graph.getSelectionModel().addListener(mxEvent.CHANGE,a);this.graph.addListener(mxEvent.ROOT,a);if(this.tasksWindowImage!=null){c.setImage(this.tasksWindowImage)}this.tasks=c;this.createTasks(d)}this.tasks.setVisible(true)};mxEditor.prototype.refreshTasks=function(a){if(this.tasks!=null){var a=this.tasks.content;mxEvent.release(a);a.innerHTML="";this.createTasks(a)}};mxEditor.prototype.createTasks=function(a){};mxEditor.prototype.showHelp=function(f){if(this.help==null){var e=document.createElement("iframe");e.setAttribute("src",mxResources.get("urlHelp")||this.urlHelp);e.setAttribute("height","100%");e.setAttribute("width","100%");e.setAttribute("frameBorder","0");e.style.backgroundColor="white";var a=document.body.clientWidth;var c=(document.body.clientHeight||document.documentElement.clientHeight);var d=new mxWindow(mxResources.get(this.helpResource)||this.helpResource,e,(a-this.helpWidth)/2,(c-this.helpHeight)/3,this.helpWidth,this.helpHeight);d.setMaximizable(true);d.setClosable(true);d.destroyOnClose=false;d.setResizable(true);if(this.helpWindowImage!=null){d.setImage(this.helpWindowImage)}if(mxClient.IS_NS){var b=function(g){var i=d.div.offsetHeight;e.setAttribute("height",(i-26)+"px")};d.addListener(mxEvent.RESIZE_END,b);d.addListener(mxEvent.MAXIMIZE,b);d.addListener(mxEvent.NORMALIZE,b);d.addListener(mxEvent.SHOW,b)}this.help=d}this.help.setVisible(true)};mxEditor.prototype.showOutline=function(){var a=this.outline==null;if(a){var d=document.createElement("div");d.style.overflow="hidden";d.style.position="relative";d.style.width="100%";d.style.height="100%";d.style.background="white";d.style.cursor="move";if(document.documentMode==8){d.style.filter="progid:DXImageTransform.Microsoft.alpha(opacity=100)"}var c=new mxWindow(mxResources.get(this.outlineResource)||this.outlineResource,d,600,480,200,200,false);var b=new mxOutline(this.graph,d);c.setClosable(true);c.setResizable(true);c.destroyOnClose=false;c.addListener(mxEvent.RESIZE_END,function(){b.update()});this.outline=c;this.outline.outline=b}this.outline.setVisible(true);this.outline.outline.update(true)};mxEditor.prototype.setMode=function(a){if(a=="select"){this.graph.panningHandler.useLeftButtonForPanning=false;this.graph.setConnectable(false)}else{if(a=="connect"){this.graph.panningHandler.useLeftButtonForPanning=false;this.graph.setConnectable(true)}else{if(a=="pan"){this.graph.panningHandler.useLeftButtonForPanning=true;this.graph.setConnectable(false)}}}};mxEditor.prototype.createPopupMenu=function(c,a,b){this.popupHandler.createMenu(this,c,a,b)};mxEditor.prototype.createEdge=function(c,g){var f=null;if(this.defaultEdge!=null){var a=this.graph.getModel();f=a.cloneCell(this.defaultEdge)}else{f=new mxCell("");f.setEdge(true);var d=new mxGeometry();d.relative=true;f.setGeometry(d)}var b=this.getEdgeStyle();if(b!=null){f.setStyle(b)}return f};mxEditor.prototype.getEdgeStyle=function(){return this.defaultEdgeStyle};mxEditor.prototype.consumeCycleAttribute=function(a){return(this.cycleAttributeValues!=null&&this.cycleAttributeValues.length>0&&this.graph.isSwimlane(a))?this.cycleAttributeValues[this.cycleAttributeIndex++%this.cycleAttributeValues.length]:null};mxEditor.prototype.cycleAttribute=function(a){if(this.cycleAttributeName!=null){var b=this.consumeCycleAttribute(a);if(b!=null){a.setStyle(a.getStyle()+";"+this.cycleAttributeName+"="+b)}}};mxEditor.prototype.addVertex=function(k,h,j,i){var g=this.graph.getModel();while(k!=null&&!this.graph.isValidDropTarget(k)){k=g.getParent(k)}k=(k!=null)?k:this.graph.getSwimlaneAt(j,i);var d=this.graph.getView().scale;var f=g.getGeometry(h);var c=g.getGeometry(k);if(this.graph.isSwimlane(h)&&!this.graph.swimlaneNesting){k=null}else{if(k==null&&this.swimlaneRequired){return null}else{if(k!=null&&c!=null){var a=this.graph.getView().getState(k);if(a!=null){j-=a.origin.x*d;i-=a.origin.y*d;if(this.graph.isConstrainedMoving){var b=f.width;var l=f.height;var e=a.x+a.width;if(j+b>e){j-=j+b-e}e=a.y+a.height;if(i+l>e){i-=i+l-e}}}else{if(c!=null){j-=c.x*d;i-=c.y*d}}}}}f=f.clone();f.x=this.graph.snap(j/d-this.graph.getView().translate.x-this.graph.gridSize/2);f.y=this.graph.snap(i/d-this.graph.getView().translate.y-this.graph.gridSize/2);h.setGeometry(f);if(k==null){k=this.graph.getDefaultParent()}this.cycleAttribute(h);this.fireEvent(new mxEventObject(mxEvent.BEFORE_ADD_VERTEX,"vertex",h,"parent",k));g.beginUpdate();try{h=this.graph.addCell(h,k);if(h!=null){this.graph.constrainChild(h);this.fireEvent(new mxEventObject(mxEvent.ADD_VERTEX,"vertex",h))}}finally{g.endUpdate()}if(h!=null){this.graph.setSelectionCell(h);this.graph.scrollCellToVisible(h);this.fireEvent(new mxEventObject(mxEvent.AFTER_ADD_VERTEX,"vertex",h))}return h};mxEditor.prototype.destroy=function(){if(!this.destroyed){this.destroyed=true;if(this.tasks!=null){this.tasks.destroy()}if(this.outline!=null){this.outline.destroy()}if(this.properties!=null){this.properties.destroy()}if(this.keyHandler!=null){this.keyHandler.destroy()}if(this.rubberband!=null){this.rubberband.destroy()}if(this.toolbar!=null){this.toolbar.destroy()}if(this.graph!=null){this.graph.destroy()}this.status=null;this.templates=null}};