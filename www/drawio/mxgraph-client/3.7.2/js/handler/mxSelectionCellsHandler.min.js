function mxSelectionCellsHandler(a){mxEventSource.call(this);this.graph=a;this.handlers=new mxDictionary();this.graph.addMouseListener(this);this.refreshHandler=mxUtils.bind(this,function(c,b){if(this.isEnabled()){this.refresh()}});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.refreshHandler);this.graph.getModel().addListener(mxEvent.CHANGE,this.refreshHandler);this.graph.getView().addListener(mxEvent.SCALE,this.refreshHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.refreshHandler);this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.refreshHandler);this.graph.getView().addListener(mxEvent.DOWN,this.refreshHandler);this.graph.getView().addListener(mxEvent.UP,this.refreshHandler)}mxUtils.extend(mxSelectionCellsHandler,mxEventSource);mxSelectionCellsHandler.prototype.graph=null;mxSelectionCellsHandler.prototype.enabled=true;mxSelectionCellsHandler.prototype.refreshHandler=null;mxSelectionCellsHandler.prototype.maxHandlers=100;mxSelectionCellsHandler.prototype.handlers=null;mxSelectionCellsHandler.prototype.isEnabled=function(){return this.enabled};mxSelectionCellsHandler.prototype.setEnabled=function(a){this.enabled=a};mxSelectionCellsHandler.prototype.getHandler=function(a){return this.handlers.get(a)};mxSelectionCellsHandler.prototype.reset=function(){this.handlers.visit(function(a,b){b.reset.apply(b)})};mxSelectionCellsHandler.prototype.refresh=function(){var e=this.handlers;this.handlers=new mxDictionary();var b=this.graph.getSelectionCells();for(var a=0;a<b.length;a++){var d=this.graph.view.getState(b[a]);if(d!=null){var c=e.remove(b[a]);if(c!=null){if(c.state!=d){c.destroy();c=null}else{if(c.refresh!=null){c.refresh()}c.redraw()}}if(c==null){c=this.graph.createHandler(d);this.fireEvent(new mxEventObject(mxEvent.ADD,"state",d))}if(c!=null){this.handlers.put(b[a],c)}}}e.visit(mxUtils.bind(this,function(f,g){this.fireEvent(new mxEventObject(mxEvent.REMOVE,"state",g.state));g.destroy()}))};mxSelectionCellsHandler.prototype.updateHandler=function(b){var a=this.handlers.remove(b.cell);if(a!=null){a.destroy();a=this.graph.createHandler(b);if(a!=null){this.handlers.put(b.cell,a)}}};mxSelectionCellsHandler.prototype.mouseDown=function(b,c){if(this.graph.isEnabled()&&this.isEnabled()){var a=[b,c];this.handlers.visit(function(d,e){e.mouseDown.apply(e,a)})}};mxSelectionCellsHandler.prototype.mouseMove=function(b,c){if(this.graph.isEnabled()&&this.isEnabled()){var a=[b,c];this.handlers.visit(function(d,e){e.mouseMove.apply(e,a)})}};mxSelectionCellsHandler.prototype.mouseUp=function(b,c){if(this.graph.isEnabled()&&this.isEnabled()){var a=[b,c];this.handlers.visit(function(d,e){e.mouseUp.apply(e,a)})}};mxSelectionCellsHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);if(this.refreshHandler!=null){this.graph.getSelectionModel().removeListener(this.refreshHandler);this.graph.getModel().removeListener(this.refreshHandler);this.graph.getView().removeListener(this.refreshHandler);this.refreshHandler=null}};