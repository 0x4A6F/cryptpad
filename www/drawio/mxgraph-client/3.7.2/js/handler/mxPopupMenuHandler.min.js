function mxPopupMenuHandler(b,a){if(b!=null){this.graph=b;this.factoryMethod=a;this.graph.addMouseListener(this);this.gestureHandler=mxUtils.bind(this,function(d,c){this.inTolerance=false});this.graph.addListener(mxEvent.GESTURE,this.gestureHandler);this.init()}}mxPopupMenuHandler.prototype=new mxPopupMenu();mxPopupMenuHandler.prototype.constructor=mxPopupMenuHandler;mxPopupMenuHandler.prototype.graph=null;mxPopupMenuHandler.prototype.selectOnPopup=true;mxPopupMenuHandler.prototype.clearSelectionOnBackground=true;mxPopupMenuHandler.prototype.triggerX=null;mxPopupMenuHandler.prototype.triggerY=null;mxPopupMenuHandler.prototype.screenX=null;mxPopupMenuHandler.prototype.screenY=null;mxPopupMenuHandler.prototype.init=function(){mxPopupMenu.prototype.init.apply(this);mxEvent.addGestureListeners(this.div,mxUtils.bind(this,function(a){this.graph.tooltipHandler.hide()}))};mxPopupMenuHandler.prototype.isSelectOnPopup=function(a){return this.selectOnPopup};mxPopupMenuHandler.prototype.mouseDown=function(a,b){if(this.isEnabled()&&!mxEvent.isMultiTouchEvent(b.getEvent())){this.hideMenu();this.triggerX=b.getGraphX();this.triggerY=b.getGraphY();this.screenX=mxEvent.getMainEvent(b.getEvent()).screenX;this.screenY=mxEvent.getMainEvent(b.getEvent()).screenY;this.popupTrigger=this.isPopupTrigger(b);this.inTolerance=true}};mxPopupMenuHandler.prototype.mouseMove=function(a,b){if(this.inTolerance&&this.screenX!=null&&this.screenY!=null){if(Math.abs(mxEvent.getMainEvent(b.getEvent()).screenX-this.screenX)>this.graph.tolerance||Math.abs(mxEvent.getMainEvent(b.getEvent()).screenY-this.screenY)>this.graph.tolerance){this.inTolerance=false}}};mxPopupMenuHandler.prototype.mouseUp=function(c,d){if(this.popupTrigger&&this.inTolerance&&this.triggerX!=null&&this.triggerY!=null){var a=this.getCellForPopupEvent(d);if(this.graph.isEnabled()&&this.isSelectOnPopup(d)&&a!=null&&!this.graph.isCellSelected(a)){this.graph.setSelectionCell(a)}else{if(this.clearSelectionOnBackground&&a==null){this.graph.clearSelection()}}this.graph.tooltipHandler.hide();var b=mxUtils.getScrollOrigin();this.popup(d.getX()+b.x+1,d.getY()+b.y+1,a,d.getEvent());d.consume()}this.popupTrigger=false;this.inTolerance=false};mxPopupMenuHandler.prototype.getCellForPopupEvent=function(a){return a.getCell()};mxPopupMenuHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);this.graph.removeListener(this.gestureHandler);mxPopupMenu.prototype.destroy.apply(this)};