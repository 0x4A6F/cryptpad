function mxFastOrganicLayout(a){mxGraphLayout.call(this,a)}mxFastOrganicLayout.prototype=new mxGraphLayout();mxFastOrganicLayout.prototype.constructor=mxFastOrganicLayout;mxFastOrganicLayout.prototype.useInputOrigin=true;mxFastOrganicLayout.prototype.resetEdges=true;mxFastOrganicLayout.prototype.disableEdgeStyle=true;mxFastOrganicLayout.prototype.forceConstant=50;mxFastOrganicLayout.prototype.forceConstantSquared=0;mxFastOrganicLayout.prototype.minDistanceLimit=2;mxFastOrganicLayout.prototype.maxDistanceLimit=500;mxFastOrganicLayout.prototype.minDistanceLimitSquared=4;mxFastOrganicLayout.prototype.initialTemp=200;mxFastOrganicLayout.prototype.temperature=0;mxFastOrganicLayout.prototype.maxIterations=0;mxFastOrganicLayout.prototype.iteration=0;mxFastOrganicLayout.prototype.vertexArray;mxFastOrganicLayout.prototype.dispX;mxFastOrganicLayout.prototype.dispY;mxFastOrganicLayout.prototype.cellLocation;mxFastOrganicLayout.prototype.radius;mxFastOrganicLayout.prototype.radiusSquared;mxFastOrganicLayout.prototype.isMoveable;mxFastOrganicLayout.prototype.neighbours;mxFastOrganicLayout.prototype.indices;mxFastOrganicLayout.prototype.allowedToRun=true;mxFastOrganicLayout.prototype.isVertexIgnored=function(a){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||this.graph.getConnections(a).length==0};mxFastOrganicLayout.prototype.execute=function(k){var d=this.graph.getModel();this.vertexArray=[];var c=this.graph.getChildVertices(k);for(var v=0;v<c.length;v++){if(!this.isVertexIgnored(c[v])){this.vertexArray.push(c[v])}}var h=(this.useInputOrigin)?this.graph.getBoundingBoxFromGeometry(this.vertexArray):null;var s=this.vertexArray.length;this.indices=[];this.dispX=[];this.dispY=[];this.cellLocation=[];this.isMoveable=[];this.neighbours=[];this.radius=[];this.radiusSquared=[];if(this.forceConstant<0.001){this.forceConstant=0.001}this.forceConstantSquared=this.forceConstant*this.forceConstant;for(var v=0;v<this.vertexArray.length;v++){var w=this.vertexArray[v];this.cellLocation[v]=[];var r=mxObjectIdentity.get(w);this.indices[r]=v;var g=this.getVertexBounds(w);var t=g.width;var q=g.height;var m=g.x;var l=g.y;this.cellLocation[v][0]=m+t/2;this.cellLocation[v][1]=l+q/2;this.radius[v]=Math.min(t,q);this.radiusSquared[v]=this.radius[v]*this.radius[v]}d.beginUpdate();try{for(var v=0;v<s;v++){this.dispX[v]=0;this.dispY[v]=0;this.isMoveable[v]=this.isVertexMovable(this.vertexArray[v]);var a=this.graph.getConnections(this.vertexArray[v],k);var c=this.graph.getOpposites(a,this.vertexArray[v]);this.neighbours[v]=[];for(var u=0;u<c.length;u++){if(this.resetEdges){this.graph.resetEdge(a[u])}if(this.disableEdgeStyle){this.setEdgeStyleEnabled(a[u],false)}var r=mxObjectIdentity.get(c[u]);var f=this.indices[r];if(f!=null){this.neighbours[v][u]=f}else{this.neighbours[v][u]=v}}}this.temperature=this.initialTemp;if(this.maxIterations==0){this.maxIterations=20*Math.sqrt(s)}for(this.iteration=0;this.iteration<this.maxIterations;this.iteration++){if(!this.allowedToRun){return}this.calcRepulsion();this.calcAttraction();this.calcPositions();this.reduceTemperature()}var e=null;var b=null;for(var v=0;v<this.vertexArray.length;v++){var w=this.vertexArray[v];if(this.isVertexMovable(w)){var g=this.getVertexBounds(w);if(g!=null){this.cellLocation[v][0]-=g.width/2;this.cellLocation[v][1]-=g.height/2;var m=this.graph.snap(this.cellLocation[v][0]);var l=this.graph.snap(this.cellLocation[v][1]);this.setVertexLocation(w,m,l);if(e==null){e=m}else{e=Math.min(e,m)}if(b==null){b=l}else{b=Math.min(b,l)}}}}var p=-(e||0)+1;var o=-(b||0)+1;if(h!=null){p+=h.x;o+=h.y}this.graph.moveCells(this.vertexArray,p,o)}finally{d.endUpdate()}};mxFastOrganicLayout.prototype.calcPositions=function(){for(var b=0;b<this.vertexArray.length;b++){if(this.isMoveable[b]){var c=Math.sqrt(this.dispX[b]*this.dispX[b]+this.dispY[b]*this.dispY[b]);if(c<0.001){c=0.001}var d=this.dispX[b]/c*Math.min(c,this.temperature);var a=this.dispY[b]/c*Math.min(c,this.temperature);this.dispX[b]=0;this.dispY[b]=0;this.cellLocation[b][0]+=d;this.cellLocation[b][1]+=a}}};mxFastOrganicLayout.prototype.calcAttraction=function(){for(var l=0;l<this.vertexArray.length;l++){for(var f=0;f<this.neighbours[l].length;f++){var g=this.neighbours[l][f];if(l!=g&&this.isMoveable[l]&&this.isMoveable[g]){var h=this.cellLocation[l][0]-this.cellLocation[g][0];var m=this.cellLocation[l][1]-this.cellLocation[g][1];var e=h*h+m*m-this.radiusSquared[l]-this.radiusSquared[g];if(e<this.minDistanceLimitSquared){e=this.minDistanceLimitSquared}var d=Math.sqrt(e);var c=(e)/this.forceConstant;var b=(h/d)*c;var a=(m/d)*c;this.dispX[l]-=b;this.dispY[l]-=a;this.dispX[g]+=b;this.dispY[g]+=a}}}};mxFastOrganicLayout.prototype.calcRepulsion=function(){var b=this.vertexArray.length;for(var h=0;h<b;h++){for(var f=h;f<b;f++){if(!this.allowedToRun){return}if(f!=h&&this.isMoveable[h]&&this.isMoveable[f]){var g=this.cellLocation[h][0]-this.cellLocation[f][0];var k=this.cellLocation[h][1]-this.cellLocation[f][1];if(g==0){g=0.01+Math.random()}if(k==0){k=0.01+Math.random()}var e=Math.sqrt((g*g)+(k*k));var l=e-this.radius[h]-this.radius[f];if(l>this.maxDistanceLimit){continue}if(l<this.minDistanceLimit){l=this.minDistanceLimit}var d=this.forceConstantSquared/l;var c=(g/e)*d;var a=(k/e)*d;this.dispX[h]+=c;this.dispY[h]+=a;this.dispX[f]-=c;this.dispY[f]-=a}}}};mxFastOrganicLayout.prototype.reduceTemperature=function(){this.temperature=this.initialTemp*(1-this.iteration/this.maxIterations)};