function Dialog(k,c,i,e,j,l,g){var m=0;if(mxClient.IS_VML&&(document.documentMode==null||document.documentMode<8)){m=80}i+=m;e+=m;var b=Math.max(0,Math.round((document.body.scrollWidth-i)/2));var f=Math.max(0,Math.round((Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)-e-k.footerHeight)/3));if(k.dialogs.length>0){this.zIndex+=k.dialogs.length*2}var a=k.createDiv("geDialog");a.style.width=i+"px";a.style.height=e+"px";a.style.left=b+"px";a.style.top=f+"px";a.style.zIndex=this.zIndex;if(this.bg==null){this.bg=k.createDiv("background");this.bg.style.position="absolute";this.bg.style.background="white";this.bg.style.left="0px";this.bg.style.top="0px";this.bg.style.bottom="0px";this.bg.style.right="0px";this.bg.style.zIndex=this.zIndex-2;mxUtils.setOpacity(this.bg,this.bgOpacity);if(mxClient.IS_QUIRKS){new mxDivResizer(this.bg)}}if(j){document.body.appendChild(this.bg)}a.appendChild(c);document.body.appendChild(a);if(l){var d=document.createElement("img");d.setAttribute("src",Dialog.prototype.closeImage);d.setAttribute("title",mxResources.get("close"));d.className="geDialogClose";d.style.top=(f+14)+"px";d.style.left=(b+i+38-m)+"px";d.style.zIndex=this.zIndex;mxEvent.addListener(d,"click",mxUtils.bind(this,function(){k.hideDialog(true)}));document.body.appendChild(d);this.dialogImg=d;mxEvent.addListener(this.bg,"click",mxUtils.bind(this,function(){k.hideDialog(true)}))}this.onDialogClose=g;this.container=a;k.editor.fireEvent(new mxEventObject("showDialog"))}Dialog.prototype.zIndex=mxPopupMenu.prototype.zIndex-1;Dialog.prototype.noColorImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/nocolor.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkEzRDlBMUUwODYxMTExRTFCMzA4RDdDMjJBMEMxRDM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkEzRDlBMUUxODYxMTExRTFCMzA4RDdDMjJBMEMxRDM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTNEOUExREU4NjExMTFFMUIzMDhEN0MyMkEwQzFEMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTNEOUExREY4NjExMTFFMUIzMDhEN0MyMkEwQzFEMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5xh3fmAAAABlBMVEX////MzMw46qqDAAAAGElEQVR42mJggAJGKGAYIIGBth8KAAIMAEUQAIElnLuQAAAAAElFTkSuQmCC";Dialog.prototype.closeImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/close.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJAQMAAADaX5RTAAAABlBMVEV7mr3///+wksspAAAAAnRSTlP/AOW3MEoAAAAdSURBVAgdY9jXwCDDwNDRwHCwgeExmASygSL7GgB12QiqNHZZIwAAAABJRU5ErkJggg==";Dialog.prototype.clearImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/clear.gif":"data:image/gif;base64,R0lGODlhDQAKAIABAMDAwP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUIzOEM1NzI4NjEyMTFFMUEzMkNDMUE3NjZERDE2QjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUIzOEM1NzM4NjEyMTFFMUEzMkNDMUE3NjZERDE2QjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QjM4QzU3MDg2MTIxMUUxQTMyQ0MxQTc2NkREMTZCMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QjM4QzU3MTg2MTIxMUUxQTMyQ0MxQTc2NkREMTZCMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAAEALAAAAAANAAoAAAIXTGCJebD9jEOTqRlttXdrB32PJ2ncyRQAOw==";Dialog.prototype.lockedImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/locked.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzdDMDZCODExNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzdDMDZCODIxNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozN0MwNkI3RjE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozN0MwNkI4MDE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvqMCFYAAAAVUExURZmZmb+/v7KysqysrMzMzLGxsf///4g8N1cAAAAHdFJOU////////wAaSwNGAAAAPElEQVR42lTMQQ4AIQgEwUa0//9kTQirOweYOgDqAMbZUr10AGlAwx4/BJ2QJ4U0L5brYjovvpv32xZgAHZaATFtMbu4AAAAAElFTkSuQmCC";Dialog.prototype.unlockedImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/unlocked.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzdDMDZCN0QxNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzdDMDZCN0UxNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozN0MwNkI3QjE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozN0MwNkI3QzE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkKMpVwAAAAYUExURZmZmbKysr+/v6ysrOXl5czMzLGxsf///zHN5lwAAAAIdFJOU/////////8A3oO9WQAAADxJREFUeNpUzFESACAEBNBVsfe/cZJU+8Mzs8CIABCidtfGOndnYsT40HDSiCcbPdoJo10o9aI677cpwACRoAF3dFNlswAAAABJRU5ErkJggg==";Dialog.prototype.bgOpacity=80;Dialog.prototype.close=function(a){if(this.onDialogClose!=null){this.onDialogClose(a);this.onDialogClose=null}if(this.dialogImg!=null){this.dialogImg.parentNode.removeChild(this.dialogImg);this.dialogImg=null}if(this.bg!=null&&this.bg.parentNode!=null){this.bg.parentNode.removeChild(this.bg)}this.container.parentNode.removeChild(this.container)};var OpenDialog=function(){var b=document.createElement("iframe");b.style.backgroundColor="transparent";b.allowTransparency="true";b.style.borderStyle="none";b.style.borderWidth="0px";b.style.overflow="hidden";b.frameBorder="0";var a=(mxClient.IS_VML&&(document.documentMode==null||document.documentMode<8))?20:0;b.setAttribute("width",(((Editor.useLocalStorage)?640:320)+a)+"px");b.setAttribute("height",(((Editor.useLocalStorage)?480:220)+a)+"px");b.setAttribute("src",OPEN_FORM);this.container=b};var ColorDialog=function(l,d,m,k){this.editorUi=l;var i=document.createElement("input");i.style.marginBottom="10px";i.style.width="216px";if(mxClient.IS_IE){i.style.marginTop="10px";document.body.appendChild(i)}this.init=function(){if(!mxClient.IS_TOUCH){i.focus()}};var e=new jscolor.color(i);e.pickerOnfocus=false;e.showPicker();var b=document.createElement("div");jscolor.picker.box.style.position="relative";jscolor.picker.box.style.width="230px";jscolor.picker.box.style.height="100px";jscolor.picker.box.style.paddingBottom="10px";b.appendChild(jscolor.picker.box);var a=document.createElement("center");function j(){var p=c((ColorDialog.recentColors.length==0)?["FFFFFF"]:ColorDialog.recentColors,11,"FFFFFF",true);p.style.marginBottom="8px";return p}function c(u,r,p,w){r=(r!=null)?r:12;var x=document.createElement("table");x.style.borderCollapse="collapse";x.setAttribute("cellspacing","0");x.style.marginBottom="20px";x.style.cellSpacing="0px";var t=document.createElement("tbody");x.appendChild(t);var z=u.length/r;for(var y=0;y<z;y++){var v=document.createElement("tr");for(var s=0;s<r;s++){(function(A){var B=document.createElement("td");B.style.border="1px solid black";B.style.padding="0px";B.style.width="16px";B.style.height="16px";if(A==null){A=p}if(A=="none"){B.style.background="url('"+Dialog.prototype.noColorImage+"')"}else{B.style.backgroundColor="#"+A}v.appendChild(B);if(A!=null){B.style.cursor="pointer";mxEvent.addListener(B,"click",function(){if(A=="none"){e.fromString("ffffff");i.value="none"}else{e.fromString(A)}})}})(u[y*r+s])}t.appendChild(v)}if(w){var q=document.createElement("td");q.setAttribute("title",mxResources.get("reset"));q.style.border="1px solid black";q.style.padding="0px";q.style.width="16px";q.style.height="16px";q.style.backgroundImage="url('"+Dialog.prototype.closeImage+"')";q.style.backgroundPosition="center center";q.style.backgroundRepeat="no-repeat";q.style.cursor="pointer";v.appendChild(q);mxEvent.addListener(q,"click",function(){ColorDialog.resetRecentColors();x.parentNode.replaceChild(j(),x)})}a.appendChild(x);return x}b.appendChild(i);mxUtils.br(b);j();var o=c(["E6D0DE","CDA2BE","B5739D","E1D5E7","C3ABD0","A680B8","D4E1F5","A9C4EB","7EA6E0","D5E8D4","9AC7BF","67AB9F","D5E8D4","B9E0A5","97D077","FFF2CC","FFE599","FFD966","FFF4C3","FFCE9F","FFB570","F8CECC","F19C99","EA6B66"],12);o.style.marginBottom="8px";o=c(["none","FFFFFF","E6E6E6","CCCCCC","B3B3B3","999999","808080","666666","4D4D4D","333333","1A1A1A","000000","FFCCCC","FFE6CC","FFFFCC","E6FFCC","CCFFCC","CCFFE6","CCFFFF","CCE5FF","CCCCFF","E5CCFF","FFCCFF","FFCCE6","FF9999","FFCC99","FFFF99","CCFF99","99FF99","99FFCC","99FFFF","99CCFF","9999FF","CC99FF","FF99FF","FF99CC","FF6666","FFB366","FFFF66","B3FF66","66FF66","66FFB3","66FFFF","66B2FF","6666FF","B266FF","FF66FF","FF66B3","FF3333","FF9933","FFFF33","99FF33","33FF33","33FF99","33FFFF","3399FF","3333FF","9933FF","FF33FF","FF3399","FF0000","FF8000","FFFF00","80FF00","00FF00","00FF80","00FFFF","007FFF","0000FF","7F00FF","FF00FF","FF0080","CC0000","CC6600","CCCC00","66CC00","00CC00","00CC66","00CCCC","0066CC","0000CC","6600CC","CC00CC","CC0066","990000","994C00","999900","4D9900","009900","00994D","009999","004C99","000099","4C0099","990099","99004D","660000","663300","666600","336600","006600","006633","006666","003366","000066","330066","660066","660033","330000","331A00","333300","1A3300","003300","00331A","003333","001933","000033","190033","330033","33001A"]);o.style.marginBottom="16px";b.appendChild(a);var g=document.createElement("div");g.style.textAlign="right";g.style.whiteSpace="nowrap";var h=mxUtils.button(mxResources.get("cancel"),function(){l.hideDialog();if(k!=null){k()}});h.className="geBtn";if(l.editor.cancelFirst){g.appendChild(h)}var f=(m!=null)?m:this.createApplyFunction();var n=mxUtils.button(mxResources.get("apply"),function(){var p=i.value;ColorDialog.addRecentColor(p,12);if(p!="none"&&p.charAt(0)!="#"){p="#"+p}f(p);l.hideDialog()});n.className="geBtn gePrimaryBtn";g.appendChild(n);if(!l.editor.cancelFirst){g.appendChild(h)}if(d!=null){if(d=="none"){e.fromString("ffffff");i.value="none"}else{e.fromString(d)}}b.appendChild(g);this.picker=e;this.colorInput=i;mxEvent.addListener(b,"keydown",function(p){if(p.keyCode==27){l.hideDialog();if(k!=null){k()}mxEvent.consume(p)}});this.container=b};ColorDialog.prototype.createApplyFunction=function(){return mxUtils.bind(this,function(a){var b=this.editorUi.editor.graph;b.getModel().beginUpdate();try{b.setCellStyles(this.currentColorKey,a);this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",[this.currentColorKey],"values",[a],"cells",b.getSelectionCells()))}finally{b.getModel().endUpdate()}})};ColorDialog.recentColors=[];ColorDialog.addRecentColor=function(b,a){if(b!=null){mxUtils.remove(b,ColorDialog.recentColors);ColorDialog.recentColors.splice(0,0,b);if(ColorDialog.recentColors.length>a){ColorDialog.recentColors.pop()}}};ColorDialog.resetRecentColors=function(){ColorDialog.recentColors=[]};var AboutDialog=function(c){var f=document.createElement("div");f.setAttribute("align","center");var b=document.createElement("h3");mxUtils.write(b,mxResources.get("about")+" GraphEditor");f.appendChild(b);var a=document.createElement("img");a.style.border="0px";a.setAttribute("width","176");a.setAttribute("width","151");a.setAttribute("src",IMAGE_PATH+"/logo.png");f.appendChild(a);mxUtils.br(f);mxUtils.write(f,"Powered by mxGraph "+mxClient.VERSION);mxUtils.br(f);var d=document.createElement("a");d.setAttribute("href","http://www.jgraph.com/");d.setAttribute("target","_blank");mxUtils.write(d,"www.jgraph.com");f.appendChild(d);mxUtils.br(f);mxUtils.br(f);var e=mxUtils.button(mxResources.get("close"),function(){c.hideDialog()});e.className="geBtn gePrimaryBtn";f.appendChild(e);this.container=f};var PageSetupDialog=function(m){var n=m.editor.graph;var q,d;var p=document.createElement("table");p.style.width="100%";p.style.height="100%";var e=document.createElement("tbody");q=document.createElement("tr");d=document.createElement("td");d.style.verticalAlign="top";d.style.fontSize="10pt";mxUtils.write(d,mxResources.get("paperSize")+":");q.appendChild(d);d=document.createElement("td");d.style.verticalAlign="top";d.style.fontSize="10pt";var f=PageSetupDialog.addPageFormatPanel(d,"pagesetupdialog",n.pageFormat);q.appendChild(d);e.appendChild(q);q=document.createElement("tr");d=document.createElement("td");mxUtils.write(d,mxResources.get("background")+":");q.appendChild(d);d=document.createElement("td");d.style.whiteSpace="nowrap";var c=document.createElement("input");c.setAttribute("type","text");var j=document.createElement("button");j.style.width="18px";j.style.height="18px";j.style.marginRight="20px";j.style.backgroundPosition="center center";j.style.backgroundRepeat="no-repeat";var b=n.background;function h(){if(b==null||b==mxConstants.NONE){j.style.backgroundColor="";j.style.backgroundImage="url('"+Dialog.prototype.noColorImage+"')"}else{j.style.backgroundColor=b;j.style.backgroundImage=""}}h();mxEvent.addListener(j,"click",function(r){m.pickColor(b||"none",function(s){b=s;h()});mxEvent.consume(r)});d.appendChild(j);mxUtils.write(d,mxResources.get("gridSize")+":");var l=document.createElement("input");l.setAttribute("type","number");l.setAttribute("min","0");l.style.width="40px";l.style.marginLeft="6px";l.value=n.getGridSize();d.appendChild(l);mxEvent.addListener(l,"change",function(){var r=parseInt(l.value);l.value=Math.max(1,(isNaN(r))?n.getGridSize():r)});q.appendChild(d);e.appendChild(q);q=document.createElement("tr");d=document.createElement("td");mxUtils.write(d,mxResources.get("image")+":");q.appendChild(d);d=document.createElement("td");var i=document.createElement("a");i.style.textDecoration="underline";i.style.cursor="pointer";i.style.color="#a0a0a0";var a=n.backgroundImage;function g(){if(a==null){i.removeAttribute("title");i.style.fontSize="";i.innerHTML=mxResources.get("change")+"..."}else{i.setAttribute("title",a.src);i.style.fontSize="11px";i.innerHTML=a.src.substring(0,42)+"..."}}mxEvent.addListener(i,"click",function(r){m.showBackgroundImageDialog(function(s){a=s;g()});mxEvent.consume(r)});g();d.appendChild(i);q.appendChild(d);e.appendChild(q);q=document.createElement("tr");d=document.createElement("td");d.colSpan=2;d.style.paddingTop="16px";d.setAttribute("align","right");var k=mxUtils.button(mxResources.get("cancel"),function(){m.hideDialog()});k.className="geBtn";if(m.editor.cancelFirst){d.appendChild(k)}var o=mxUtils.button(mxResources.get("apply"),function(){m.hideDialog();m.setPageFormat(f.get());if(n.background!=b){m.setBackgroundColor(b)}if(n.backgroundImage!==a){m.setBackgroundImage(a)}if(n.gridSize!==l.value){n.setGridSize(parseInt(l.value))}});o.className="geBtn gePrimaryBtn";d.appendChild(o);if(!m.editor.cancelFirst){d.appendChild(k)}q.appendChild(d);e.appendChild(q);p.appendChild(e);this.container=p};PageSetupDialog.addPageFormatPanel=function(l,y,o,d){var p="format-"+y;var v=document.createElement("input");v.setAttribute("name",p);v.setAttribute("type","radio");v.setAttribute("value","portrait");var s=document.createElement("input");s.setAttribute("name",p);s.setAttribute("type","radio");s.setAttribute("value","landscape");var q=document.createElement("select");q.style.marginBottom="8px";q.style.width="202px";var j=document.createElement("div");j.style.marginLeft="4px";j.style.width="210px";j.style.height="24px";v.style.marginRight="6px";j.appendChild(v);var a=document.createElement("span");a.style.maxWidth="100px";mxUtils.write(a,mxResources.get("portrait"));j.appendChild(a);s.style.marginLeft="10px";s.style.marginRight="6px";j.appendChild(s);var u=document.createElement("span");u.style.width="100px";mxUtils.write(u,mxResources.get("landscape"));j.appendChild(u);var w=document.createElement("div");w.style.marginLeft="4px";w.style.width="210px";w.style.height="24px";var m=document.createElement("input");m.setAttribute("size","6");m.setAttribute("value",o.width);w.appendChild(m);mxUtils.write(w," x ");var k=document.createElement("input");k.setAttribute("size","6");k.setAttribute("value",o.height);w.appendChild(k);mxUtils.write(w," pt");j.style.display="none";w.style.display="none";var x=new Object();var e=PageSetupDialog.getFormats();for(var r=0;r<e.length;r++){var t=e[r];x[t.key]=t;var n=document.createElement("option");n.setAttribute("value",t.key);mxUtils.write(n,t.title);q.appendChild(n)}var h=false;function b(C,z,E){if(E||(m!=document.activeElement&&k!=document.activeElement)){var A=false;for(var B=0;B<e.length;B++){var D=e[B];if(h){if(D.key=="custom"){q.value=D.key;h=false}}else{if(D.format!=null){if(o.width==D.format.width&&o.height==D.format.height){q.value=D.key;v.setAttribute("checked","checked");v.defaultChecked=true;v.checked=true;s.removeAttribute("checked");s.defaultChecked=false;s.checked=false;A=true}else{if(o.width==D.format.height&&o.height==D.format.width){q.value=D.key;v.removeAttribute("checked");v.defaultChecked=false;v.checked=false;s.setAttribute("checked","checked");s.defaultChecked=true;s.checked=true;A=true}}}}}if(!A){m.value=o.width;k.value=o.height;n.setAttribute("selected","selected");v.setAttribute("checked","checked");v.defaultChecked=true;j.style.display="none";w.style.display=""}else{j.style.display="";w.style.display="none"}}}b();l.appendChild(q);mxUtils.br(l);l.appendChild(j);l.appendChild(w);var c=o;var g=function(){var i=x[q.value];if(i.format!=null){m.value=i.format.width;k.value=i.format.height;w.style.display="none";j.style.display=""}else{j.style.display="none";w.style.display=""}var z=new mxRectangle(0,0,parseInt(m.value),parseInt(k.value));if(q.value!="custom"&&s.checked){z=new mxRectangle(0,0,z.height,z.width)}if(z.width!=c.width||z.height!=c.height){c=z;if(d!=null){d(c)}}};mxEvent.addListener(a,"click",function(f){v.checked=true;g();mxEvent.consume(f)});mxEvent.addListener(u,"click",function(f){s.checked=true;g();mxEvent.consume(f)});mxEvent.addListener(m,"blur",g);mxEvent.addListener(m,"click",g);mxEvent.addListener(k,"blur",g);mxEvent.addListener(k,"click",g);mxEvent.addListener(s,"change",g);mxEvent.addListener(v,"change",g);mxEvent.addListener(q,"change",function(){h=q.value=="custom";g()});g();return{set:function(f){o=f;b(null,null,true)},get:function(){return c},widthInput:m,heightInput:k}};PageSetupDialog.getFormats=function(){return[{key:"letter",title:'US-Letter (8,5" x 11")',format:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT},{key:"legal",title:'US-Legal (8,5" x 14")',format:new mxRectangle(0,0,850,1400)},{key:"tabloid",title:"US-Tabloid (279 mm x 432 mm)",format:new mxRectangle(0,0,1100,1700)},{key:"a3",title:"A3 (297 mm x 420 mm)",format:new mxRectangle(0,0,1169,1652)},{key:"a4",title:"A4 (210 mm x 297 mm)",format:mxConstants.PAGE_FORMAT_A4_PORTRAIT},{key:"a5",title:"A5 (148 mm x 210 mm)",format:new mxRectangle(0,0,584,826)},{key:"custom",title:mxResources.get("custom"),format:null}]};var PrintDialog=function(a,b){this.create(a,b)};PrintDialog.prototype.create=function(k){var l=k.editor.graph;var o,a;var m=document.createElement("table");m.style.width="100%";m.style.height="100%";var c=document.createElement("tbody");o=document.createElement("tr");var d=document.createElement("input");d.setAttribute("type","checkbox");a=document.createElement("td");a.setAttribute("colspan","2");a.style.fontSize="10pt";a.appendChild(d);var j=document.createElement("span");mxUtils.write(j," "+mxResources.get("fitPage"));a.appendChild(j);mxEvent.addListener(j,"click",function(p){d.checked=!d.checked;h.checked=!d.checked;mxEvent.consume(p)});mxEvent.addListener(d,"change",function(){h.checked=!d.checked});o.appendChild(a);c.appendChild(o);o=o.cloneNode(false);var h=document.createElement("input");h.setAttribute("type","checkbox");a=document.createElement("td");a.style.fontSize="10pt";a.appendChild(h);var j=document.createElement("span");mxUtils.write(j," "+mxResources.get("posterPrint")+":");a.appendChild(j);mxEvent.addListener(j,"click",function(p){h.checked=!h.checked;d.checked=!h.checked;mxEvent.consume(p)});o.appendChild(a);var i=document.createElement("input");i.setAttribute("value","1");i.setAttribute("type","number");i.setAttribute("min","1");i.setAttribute("size","4");i.setAttribute("disabled","disabled");i.style.width="50px";a=document.createElement("td");a.style.fontSize="10pt";a.appendChild(i);mxUtils.write(a," "+mxResources.get("pages")+" (max)");o.appendChild(a);c.appendChild(o);mxEvent.addListener(h,"change",function(){if(h.checked){i.removeAttribute("disabled")}else{i.setAttribute("disabled","disabled")}d.checked=!h.checked});o=o.cloneNode(false);a=document.createElement("td");mxUtils.write(a,mxResources.get("pageScale")+":");o.appendChild(a);a=document.createElement("td");var n=document.createElement("input");n.setAttribute("value","100 %");n.setAttribute("size","5");n.style.width="50px";a.appendChild(n);o.appendChild(a);c.appendChild(o);o=document.createElement("tr");a=document.createElement("td");a.colSpan=2;a.style.paddingTop="20px";a.setAttribute("align","right");function e(p){var x=d.checked||h.checked;var A=parseInt(n.value)/100;if(isNaN(A)){A=1;n.value="100%"}A*=0.75;var w=l.pageFormat||mxConstants.PAGE_FORMAT_A4_PORTRAIT;var s=1/l.pageScale;if(x){var r=(d.checked)?1:parseInt(i.value);if(!isNaN(r)){s=mxUtils.getScaleForPageCount(r,l,w)}}var z=l.getGraphBounds();var t=0;var q=0;var y=0;w=mxRectangle.fromRectangle(w);w.width=Math.ceil(w.width*A);w.height=Math.ceil(w.height*A);s*=A;if(!x&&l.pageVisible){var u=l.getPageLayout();q-=u.x*w.width;y-=u.y*w.height}else{x=true}var v=PrintDialog.createPrintPreview(l,s,w,t,q,y,x);v.open();if(p){PrintDialog.printPreview(v)}}var g=mxUtils.button(mxResources.get("cancel"),function(){k.hideDialog()});g.className="geBtn";if(k.editor.cancelFirst){a.appendChild(g)}if(!mxClient.IS_CHROMEAPP){var f=mxUtils.button(mxResources.get("preview"),function(){k.hideDialog();e(false)});f.className="geBtn";a.appendChild(f)}var b=mxUtils.button(mxResources.get((mxClient.IS_CHROMEAPP)?"ok":"print"),function(){k.hideDialog();e(true)});b.className="geBtn gePrimaryBtn";a.appendChild(b);if(!k.editor.cancelFirst){a.appendChild(g)}o.appendChild(a);c.appendChild(o);m.appendChild(c);this.container=m};PrintDialog.printPreview=function(b){if(b.wnd!=null){var a=function(){b.wnd.focus();b.wnd.print();b.wnd.close()};if(mxClient.IS_GC){window.setTimeout(a,500)}else{a()}}};PrintDialog.createPrintPreview=function(j,b,f,c,a,h,g){var e=new mxPrintPreview(j,b,f,c,a,h);e.title=mxResources.get("preview");e.printBackgroundImage=true;e.autoOrigin=g;var d=j.background;if(d==null||d==""||d==mxConstants.NONE){d="#ffffff"}e.backgroundColor=d;var i=e.writeHead;e.writeHead=function(k){i.apply(this,arguments);k.writeln('<style type="text/css">');k.writeln("@media screen {");k.writeln("  body > div { padding:30px;box-sizing:content-box; }");k.writeln("}");k.writeln("</style>")};return e};var FilenameDialog=function(o,q,a,k,j,g,p,h,c,m){c=(c!=null)?c:true;var f,i;var r=document.createElement("table");var b=document.createElement("tbody");r.style.marginTop="8px";f=document.createElement("tr");i=document.createElement("td");i.style.whiteSpace="nowrap";i.style.fontSize="10pt";i.style.width="120px";mxUtils.write(i,(j||mxResources.get("filename"))+":");f.appendChild(i);var l=document.createElement("input");l.setAttribute("value",q||"");l.style.marginLeft="4px";l.style.width="180px";var e=mxUtils.button(a,function(){if(g==null||g(l.value)){if(c){o.hideDialog()}k(l.value)}});e.className="geBtn gePrimaryBtn";this.init=function(){if(j==null&&p!=null){return}l.focus();if(mxClient.IS_FF||document.documentMode>=5||mxClient.IS_QUIRKS){l.select()}else{document.execCommand("selectAll",false,null)}if(Graph.fileSupport){var u=r.parentNode;var t=o.editor.graph;var s=null;mxEvent.addListener(u,"dragleave",function(v){if(s!=null){s.style.backgroundColor="";s=null}v.stopPropagation();v.preventDefault()});mxEvent.addListener(u,"dragover",mxUtils.bind(this,function(v){if(s==null&&(!mxClient.IS_IE||document.documentMode>10)){s=l;s.style.backgroundColor="#ebf2f9"}v.stopPropagation();v.preventDefault()}));mxEvent.addListener(u,"drop",mxUtils.bind(this,function(v){if(s!=null){s.style.backgroundColor="";s=null}if(mxUtils.indexOf(v.dataTransfer.types,"text/uri-list")>=0){l.value=decodeURIComponent(v.dataTransfer.getData("text/uri-list"));e.click()}v.stopPropagation();v.preventDefault()}))}};i=document.createElement("td");i.appendChild(l);f.appendChild(i);if(j!=null||p==null){b.appendChild(f)}if(p!=null){f=document.createElement("tr");i=document.createElement("td");i.colSpan=2;i.appendChild(p);f.appendChild(i);b.appendChild(f)}f=document.createElement("tr");i=document.createElement("td");i.colSpan=2;i.style.paddingTop="20px";i.style.whiteSpace="nowrap";i.setAttribute("align","right");var n=mxUtils.button(mxResources.get("cancel"),function(){o.hideDialog();if(m!=null){m()}});n.className="geBtn";if(o.editor.cancelFirst){i.appendChild(n)}if(h!=null){var d=mxUtils.button(mxResources.get("help"),function(){window.open(h)});d.className="geBtn";i.appendChild(d)}mxEvent.addListener(l,"keypress",function(s){if(s.keyCode==13){e.click()}});i.appendChild(e);if(!o.editor.cancelFirst){i.appendChild(n)}f.appendChild(i);b.appendChild(f);r.appendChild(b);this.container=r};var TextareaDialog=function(q,t,e,j,m,c,l,r,b,p,o,d){l=(l!=null)?l:300;r=(r!=null)?r:120;p=(p!=null)?p:false;var g,i;var s=document.createElement("table");var a=document.createElement("tbody");g=document.createElement("tr");i=document.createElement("td");i.style.fontSize="10pt";i.style.width="100px";mxUtils.write(i,t);g.appendChild(i);a.appendChild(g);g=document.createElement("tr");i=document.createElement("td");var k=document.createElement("textarea");if(o){k.setAttribute("wrap","off")}mxUtils.write(k,e||"");k.style.resize="none";k.style.width=l+"px";k.style.height=r+"px";this.textarea=k;this.init=function(){k.focus();k.scrollTop=0};i.appendChild(k);g.appendChild(i);a.appendChild(g);g=document.createElement("tr");i=document.createElement("td");i.style.paddingTop="14px";i.style.whiteSpace="nowrap";i.setAttribute("align","right");var n=mxUtils.button(c||mxResources.get("cancel"),function(){q.hideDialog();if(m!=null){m()}});n.className="geBtn";if(q.editor.cancelFirst){i.appendChild(n)}if(b!=null){b(i)}if(j!=null){var f=mxUtils.button(d||mxResources.get("apply"),function(){if(!p){q.hideDialog()}j(k.value)});f.className="geBtn gePrimaryBtn";i.appendChild(f)}if(!q.editor.cancelFirst){i.appendChild(n)}g.appendChild(i);a.appendChild(g);s.appendChild(a);this.container=s};var EditDiagramDialog=function(k){var a=document.createElement("div");a.style.textAlign="right";var j=document.createElement("textarea");j.setAttribute("wrap","off");j.style.overflow="auto";j.style.resize="none";j.style.width="600px";j.style.height="370px";j.style.marginBottom="16px";j.value=mxUtils.getPrettyXml(k.editor.getGraphXml());a.appendChild(j);this.init=function(){j.focus()};if(Graph.fileSupport){function l(n){n.stopPropagation();n.preventDefault();if(n.dataTransfer.files.length>0){var o=n.dataTransfer.files[0];var m=new FileReader();m.onload=function(p){j.value=p.target.result};m.readAsText(o)}else{j.value=k.extractGraphModelFromEvent(n)}}function d(m){m.stopPropagation();m.preventDefault()}j.addEventListener("dragover",d,false);j.addEventListener("drop",l,false)}var h=mxUtils.button(mxResources.get("cancel"),function(){k.hideDialog()});h.className="geBtn";if(k.editor.cancelFirst){a.appendChild(h)}var i=document.createElement("select");i.style.width="180px";i.className="geBtn";if(k.editor.graph.isEnabled()){var e=document.createElement("option");e.setAttribute("value","replace");mxUtils.write(e,mxResources.get("replaceExistingDrawing"));i.appendChild(e)}var f=document.createElement("option");f.setAttribute("value","new");mxUtils.write(f,mxResources.get("openInNewWindow"));var c=window.chrome!=null&&chrome.app!=null&&chrome.app.runtime!=null;if(!c){i.appendChild(f)}if(k.editor.graph.isEnabled()){var b=document.createElement("option");b.setAttribute("value","import");mxUtils.write(b,mxResources.get("addToExistingDrawing"));i.appendChild(b)}a.appendChild(i);var g=mxUtils.button(mxResources.get("ok"),function(){var q=k.editor.graph.zapGremlins(mxUtils.trim(j.value));var n=null;if(i.value=="new"){window.openFile=new OpenFile(function(){k.hideDialog();window.openFile=null});window.openFile.setData(q,null);window.open(k.getUrl())}else{if(i.value=="replace"){k.editor.graph.model.beginUpdate();try{k.editor.setGraphXml(mxUtils.parseXml(q).documentElement);k.hideDialog()}catch(s){n=s}finally{k.editor.graph.model.endUpdate()}}else{if(i.value=="import"){k.editor.graph.model.beginUpdate();try{var r=mxUtils.parseXml(q);var m=new mxGraphModel();var p=new mxCodec(r);p.decode(r.documentElement,m);var o=m.getChildren(m.getChildAt(m.getRoot(),0));k.editor.graph.setSelectionCells(k.editor.graph.importCells(o));k.hideDialog()}catch(s){n=s}finally{k.editor.graph.model.endUpdate()}}}}if(n!=null){mxUtils.alert(n.message)}});g.className="geBtn gePrimaryBtn";a.appendChild(g);if(!k.editor.cancelFirst){a.appendChild(h)}this.container=a};var ExportDialog=function(u){var d=u.editor.graph;var i=d.getGraphBounds();var A=d.view.scale;var t=Math.ceil(i.width/A);var s=Math.ceil(i.height/A);var h,j;var y=document.createElement("table");var a=document.createElement("tbody");y.setAttribute("cellpadding",(mxClient.IS_SF)?"0":"2");h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";j.style.width="100px";mxUtils.write(j,mxResources.get("filename")+":");h.appendChild(j);var l=document.createElement("input");l.setAttribute("value",u.editor.getOrCreateFilename());l.style.width="180px";j=document.createElement("td");j.appendChild(l);h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("format")+":");h.appendChild(j);var m=document.createElement("select");m.style.width="180px";var f=document.createElement("option");f.setAttribute("value","png");mxUtils.write(f,mxResources.get("formatPng"));m.appendChild(f);var z=document.createElement("option");if(ExportDialog.showGifOption){z.setAttribute("value","gif");mxUtils.write(z,mxResources.get("formatGif"));m.appendChild(z)}var v=document.createElement("option");v.setAttribute("value","jpg");mxUtils.write(v,mxResources.get("formatJpg"));m.appendChild(v);var g=document.createElement("option");g.setAttribute("value","pdf");mxUtils.write(g,mxResources.get("formatPdf"));m.appendChild(g);var c=document.createElement("option");c.setAttribute("value","svg");mxUtils.write(c,mxResources.get("formatSvg"));m.appendChild(c);if(ExportDialog.showXmlOption){var e=document.createElement("option");e.setAttribute("value","xml");mxUtils.write(e,mxResources.get("formatXml"));m.appendChild(e)}j=document.createElement("td");j.appendChild(m);h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("zoom")+" (%):");h.appendChild(j);var b=document.createElement("input");b.setAttribute("type","number");b.setAttribute("value","100");b.style.width="180px";j=document.createElement("td");j.appendChild(b);h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("width")+":");h.appendChild(j);var r=document.createElement("input");r.setAttribute("value",t);r.style.width="180px";j=document.createElement("td");j.appendChild(r);h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("height")+":");h.appendChild(j);var p=document.createElement("input");p.setAttribute("value",s);p.style.width="180px";j=document.createElement("td");j.appendChild(p);h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("background")+":");h.appendChild(j);var k=document.createElement("input");k.setAttribute("type","checkbox");k.checked=d.background==null||d.background==mxConstants.NONE;j=document.createElement("td");j.appendChild(k);mxUtils.write(j,mxResources.get("transparent"));h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("borderWidth")+":");h.appendChild(j);var x=document.createElement("input");x.setAttribute("type","number");x.setAttribute("value",ExportDialog.lastBorderValue);x.style.width="180px";j=document.createElement("td");j.appendChild(x);h.appendChild(j);a.appendChild(h);y.appendChild(a);function o(){var C=l.value;var B=C.lastIndexOf(".");if(B>0){l.value=C.substring(0,B+1)+m.value}else{l.value=C+"."+m.value}if(m.value==="xml"){b.setAttribute("disabled","true");r.setAttribute("disabled","true");p.setAttribute("disabled","true");x.setAttribute("disabled","true")}else{b.removeAttribute("disabled");r.removeAttribute("disabled");p.removeAttribute("disabled");x.removeAttribute("disabled")}if(m.value==="png"||m.value==="svg"){k.removeAttribute("disabled")}else{k.setAttribute("disabled","disabled")}}mxEvent.addListener(m,"change",o);o();function w(){if(r.value*p.value>MAX_AREA||r.value<=0){r.style.backgroundColor="red"}else{r.style.backgroundColor=""}if(r.value*p.value>MAX_AREA||p.value<=0){p.style.backgroundColor="red"}else{p.style.backgroundColor=""}}mxEvent.addListener(b,"change",function(){var B=Math.max(0,parseFloat(b.value)||100)/100;b.value=parseFloat((B*100).toFixed(2));if(t>0){r.value=Math.floor(t*B);p.value=Math.floor(s*B)}else{b.value="100";r.value=t;p.value=s}w()});mxEvent.addListener(r,"change",function(){var B=parseInt(r.value)/t;if(B>0){b.value=parseFloat((B*100).toFixed(2));p.value=Math.floor(s*B)}else{b.value="100";r.value=t;p.value=s}w()});mxEvent.addListener(p,"change",function(){var B=parseInt(p.value)/s;if(B>0){b.value=parseFloat((B*100).toFixed(2));r.value=Math.floor(t*B)}else{b.value="100";r.value=t;p.value=s}w()});h=document.createElement("tr");j=document.createElement("td");j.setAttribute("align","right");j.style.paddingTop="22px";j.colSpan=2;var n=mxUtils.button(mxResources.get("export"),mxUtils.bind(this,function(){if(parseInt(b.value)<=0){mxUtils.alert(mxResources.get("drawingEmpty"))}else{var C=l.value;var F=m.value;var E=Math.max(0,parseFloat(b.value)||100)/100;var B=Math.max(0,parseInt(x.value));var D=d.background;if((F=="svg"||F=="png")&&k.checked){D=null}else{if(D==null||D==mxConstants.NONE){D="#ffffff"}}ExportDialog.lastBorderValue=B;ExportDialog.exportFile(u,C,F,D,E,B)}}));n.className="geBtn gePrimaryBtn";var q=mxUtils.button(mxResources.get("cancel"),function(){u.hideDialog()});q.className="geBtn";if(u.editor.cancelFirst){j.appendChild(q);j.appendChild(n)}else{j.appendChild(n);j.appendChild(q)}h.appendChild(j);a.appendChild(h);y.appendChild(a);this.container=y};ExportDialog.lastBorderValue=0;ExportDialog.showGifOption=true;ExportDialog.showXmlOption=true;ExportDialog.exportFile=function(o,c,n,f,r,l){var p=o.editor.graph;if(n=="xml"){ExportDialog.saveLocalFile(o,mxUtils.getXml(o.editor.getGraphXml()),c,n)}else{if(n=="svg"){ExportDialog.saveLocalFile(o,mxUtils.getXml(p.getSvg(f,r,l)),c,n)}else{var a=p.getGraphBounds();var q=mxUtils.createXmlDocument();var k=q.createElement("output");q.appendChild(k);var e=new mxXmlCanvas2D(k);e.translate(Math.floor((l/r-a.x)/p.view.scale),Math.floor((l/r-a.y)/p.view.scale));e.scale(r/p.view.scale);var i=new mxImageExport();i.drawState(p.getView().getState(p.model.root),e);var d="xml="+encodeURIComponent(mxUtils.getXml(k));var m=Math.ceil(a.width*r/p.view.scale+2*l);var g=Math.ceil(a.height*r/p.view.scale+2*l);if(d.length<=MAX_REQUEST_SIZE&&m*g<MAX_AREA){o.hideDialog();var j=new mxXmlRequest(EXPORT_URL,"format="+n+"&filename="+encodeURIComponent(c)+"&bg="+((f!=null)?f:"none")+"&w="+m+"&h="+g+"&"+d);j.simulate(document,"_blank")}else{mxUtils.alert(mxResources.get("drawingTooLarge"))}}}};ExportDialog.saveLocalFile=function(b,d,a,e){if(d.length<MAX_REQUEST_SIZE){b.hideDialog();var c=new mxXmlRequest(SAVE_URL,"xml="+encodeURIComponent(d)+"&filename="+encodeURIComponent(a)+"&format="+e);c.simulate(document,"_blank")}else{mxUtils.alert(mxResources.get("drawingTooLarge"));mxUtils.popup(xml)}};var EditDataDialog=function(t,d){var q=document.createElement("div");var f=t.editor.graph;q.style.height="310px";q.style.overflow="auto";var v=f.getModel().getValue(d);if(!mxUtils.isNode(v)){var B=mxUtils.createXmlDocument();var o=B.createElement("object");o.setAttribute("label",v||"");v=o}var e=new mxForm("properties");e.table.style.width="100%";e.table.style.paddingRight="20px";var u=v.attributes;var p=[];var b=[];var j=0;var g=function(F,D){F.parentNode.style.marginRight="12px";var C=document.createElement("a");var i=mxUtils.createImage(Dialog.prototype.closeImage);i.style.height="9px";i.style.fontSize="9px";i.style.marginBottom="7px";C.className="geButton";C.setAttribute("title",mxResources.get("delete"));C.style.margin="0px";C.style.width="14px";C.style.height="14px";C.style.fontSize="14px";C.style.cursor="pointer";C.style.marginLeft="6px";C.appendChild(i);var E=(function(G){return function(){var I=0;for(var H=0;H<p.length;H++){if(p[H]==G){b[H]=null;e.table.deleteRow(I);break}if(b[H]!=null){I++}}}})(D);mxEvent.addListener(C,"click",E);F.parentNode.style.whiteSpace="nowrap";F.parentNode.appendChild(C)};var a=function(C,i,D){p[C]=i;b[C]=e.addTextarea(p[j]+":",D,2);b[C].style.width="100%";g(b[C],i)};var z=[];for(var w=0;w<u.length;w++){if(u[w].nodeName!="label"&&u[w].nodeName!="placeholders"){z.push({name:u[w].nodeName,value:u[w].nodeValue})}}z.sort(function(C,i){return ~~(C.name>i.name)});for(var w=0;w<z.length;w++){a(j,z[w].name,z[w].value);j++}q.appendChild(e.table);var r=document.createElement("div");r.style.whiteSpace="nowrap";r.style.marginTop="6px";var l=document.createElement("input");l.setAttribute("placeholder",mxResources.get("enterPropertyName"));l.setAttribute("type","text");l.setAttribute("size",(mxClient.IS_QUIRKS)?"18":"22");l.style.marginLeft="2px";r.appendChild(l);q.appendChild(r);var c=mxUtils.button(mxResources.get("addProperty"),function(){var C=l.value;if(C.length>0&&C!="label"&&C!="placeholders"){try{var i=mxUtils.indexOf(p,C);if(i>=0&&b[i]!=null){b[i].focus()}else{var F=v.cloneNode(false);F.setAttribute(C,"");if(i>=0){p.splice(i,1);b.splice(i,1)}p.push(C);var E=e.addTextarea(C+":","",2);E.style.width="100%";b.push(E);g(E,C);E.focus()}l.value=""}catch(D){mxUtils.alert(D)}}else{mxUtils.alert(mxResources.get("invalidName"))}});this.init=function(){if(b.length>0){b[0].focus()}else{l.focus()}};c.setAttribute("disabled","disabled");c.style.marginLeft="10px";c.style.width="144px";r.appendChild(c);var s=mxUtils.button(mxResources.get("cancel"),function(){t.hideDialog.apply(t,arguments)});s.className="geBtn";var h=mxUtils.button(mxResources.get("apply"),function(){try{t.hideDialog.apply(t,arguments);v=v.cloneNode(true);var D=false;for(var C=0;C<p.length;C++){if(b[C]==null){v.removeAttribute(p[C])}else{v.setAttribute(p[C],b[C].value);D=D||(p[C]=="placeholder"&&v.getAttribute("placeholders")=="1")}}if(D){v.removeAttribute("label")}f.getModel().setValue(d,v)}catch(E){mxUtils.alert(E)}});h.className="geBtn gePrimaryBtn";function n(){if(l.value.length>0){c.removeAttribute("disabled")}else{c.setAttribute("disabled","disabled")}}mxEvent.addListener(l,"keyup",n);mxEvent.addListener(l,"change",n);var x=document.createElement("div");x.style.marginTop="18px";x.style.textAlign="right";if(t.editor.graph.getModel().isVertex(d)||t.editor.graph.getModel().isEdge(d)){var A=document.createElement("span");A.style.marginRight="10px";var m=document.createElement("input");m.setAttribute("type","checkbox");m.style.marginRight="6px";if(v.getAttribute("placeholders")=="1"){m.setAttribute("checked","checked");m.defaultChecked=true}mxEvent.addListener(m,"click",function(){if(v.getAttribute("placeholders")=="1"){v.removeAttribute("placeholders")}else{v.setAttribute("placeholders","1")}});A.appendChild(m);mxUtils.write(A,mxResources.get("placeholders"));if(EditDataDialog.placeholderHelpLink!=null){var k=document.createElement("a");k.setAttribute("href",EditDataDialog.placeholderHelpLink);k.setAttribute("title",mxResources.get("help"));k.setAttribute("target","_blank");k.style.marginLeft="10px";k.style.cursor="help";var y=document.createElement("img");y.setAttribute("border","0");y.setAttribute("valign","middle");y.style.marginTop="-4px";y.setAttribute("src",Editor.helpImage);k.appendChild(y);A.appendChild(k)}x.appendChild(A)}if(t.editor.cancelFirst){x.appendChild(s);x.appendChild(h)}else{x.appendChild(h);x.appendChild(s)}q.appendChild(x);this.container=q};EditDataDialog.placeholderHelpLink=null;var LinkDialog=function(h,i,d,e){var a=document.createElement("div");mxUtils.write(a,mxResources.get("editLink")+":");var j=document.createElement("div");j.className="geTitle";j.style.backgroundColor="transparent";j.style.borderColor="transparent";j.style.whiteSpace="nowrap";j.style.textOverflow="clip";j.style.cursor="default";if(!mxClient.IS_VML){j.style.paddingRight="20px"}var k=document.createElement("input");k.setAttribute("value",i);k.setAttribute("placeholder","http://www.example.com/");k.setAttribute("type","text");k.style.marginTop="6px";k.style.width="400px";k.style.backgroundImage="url('"+Dialog.prototype.clearImage+"')";k.style.backgroundRepeat="no-repeat";k.style.backgroundPosition="100% 50%";k.style.paddingRight="14px";var g=document.createElement("div");g.setAttribute("title",mxResources.get("reset"));g.style.position="relative";g.style.left="-16px";g.style.width="12px";g.style.height="14px";g.style.cursor="pointer";g.style.display=(mxClient.IS_VML)?"inline":"inline-block";g.style.top=((mxClient.IS_VML)?0:3)+"px";g.style.background="url("+IMAGE_PATH+"/transparent.gif)";mxEvent.addListener(g,"click",function(){k.value="";k.focus()});j.appendChild(k);j.appendChild(g);a.appendChild(j);this.init=function(){k.focus();if(mxClient.IS_FF||document.documentMode>=5||mxClient.IS_QUIRKS){k.select()}else{document.execCommand("selectAll",false,null)}};var c=document.createElement("div");c.style.marginTop="18px";c.style.textAlign="right";mxEvent.addListener(k,"keypress",function(l){if(l.keyCode==13){h.hideDialog();e(k.value)}});var f=mxUtils.button(mxResources.get("cancel"),function(){h.hideDialog()});f.className="geBtn";if(h.editor.cancelFirst){c.appendChild(f)}var b=mxUtils.button(d,function(){h.hideDialog();e(k.value)});b.className="geBtn gePrimaryBtn";c.appendChild(b);if(!h.editor.cancelFirst){c.appendChild(f)}a.appendChild(c);this.container=a};var OutlineWindow=function(l,i,f,k,d){var m=l.editor.graph;var b=document.createElement("div");b.style.position="absolute";b.style.width="100%";b.style.height="100%";b.style.border="1px solid whiteSmoke";b.style.overflow="hidden";this.window=new mxWindow(mxResources.get("outline"),b,i,f,k,d,true,true);this.window.destroyOnClose=false;this.window.setMaximizable(false);this.window.setResizable(true);this.window.setClosable(true);this.window.setVisible(true);this.window.setLocation=function(h,n){h=Math.max(0,h);n=Math.max(0,n);mxWindow.prototype.setLocation.apply(this,arguments)};mxEvent.addListener(window,"resize",mxUtils.bind(this,function(){var n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var h=this.window.getX();var p=this.window.getY();if(h+this.window.table.clientWidth>n){h=Math.max(0,n-this.window.table.clientWidth)}if(p+this.window.table.clientHeight>o){p=Math.max(0,o-this.window.table.clientHeight)}if(this.window.getX()!=h||this.window.getY()!=p){this.window.setLocation(h,p)}}));var a=l.createOutline(this.window);this.window.addListener(mxEvent.RESIZE,mxUtils.bind(this,function(){a.update(false);a.outline.sizeDidChange()}));this.window.addListener(mxEvent.SHOW,mxUtils.bind(this,function(){a.suspended=false;a.outline.refresh();a.update()}));this.window.addListener(mxEvent.HIDE,mxUtils.bind(this,function(){a.suspended=true}));this.window.addListener(mxEvent.NORMALIZE,mxUtils.bind(this,function(){a.suspended=false;a.update()}));this.window.addListener(mxEvent.MINIMIZE,mxUtils.bind(this,function(){a.suspended=true}));var g=a.createGraph;a.createGraph=function(h){var n=g.apply(this,arguments);n.gridEnabled=false;n.pageScale=m.pageScale;n.pageFormat=m.pageFormat;n.background=m.background;n.pageVisible=m.pageVisible;var o=mxUtils.getCurrentStyle(m.container);b.style.backgroundColor=o.backgroundColor;return n};function c(){a.outline.pageScale=m.pageScale;a.outline.pageFormat=m.pageFormat;a.outline.pageVisible=m.pageVisible;a.outline.background=m.background;var h=mxUtils.getCurrentStyle(m.container);b.style.backgroundColor=h.backgroundColor;if(m.view.backgroundPageShape!=null&&a.outline.view.backgroundPageShape!=null){a.outline.view.backgroundPageShape.fill=m.view.backgroundPageShape.fill}a.outline.refresh()}a.init(b);l.editor.addListener("resetGraphView",c);l.addListener("pageFormatChanged",c);l.addListener("backgroundColorChanged",c);l.addListener("backgroundImageChanged",c);l.addListener("pageViewChanged",function(){c();a.update(true)});if(a.outline.dialect==mxConstants.DIALECT_SVG){var j=l.actions.get("zoomIn");var e=l.actions.get("zoomOut");mxEvent.addMouseWheelListener(function(n,h){var o=false;var p=mxEvent.getSource(n);while(p!=null){if(p==a.outline.view.canvas.ownerSVGElement){o=true;break}p=p.parentNode}if(o){if(h){j.funct()}else{e.funct()}mxEvent.consume(n)}})}};var LayersWindow=function(s,k,j,m,v){var a=s.editor.graph;var n=document.createElement("div");n.style.userSelect="none";n.style.background="whiteSmoke";n.style.border="1px solid whiteSmoke";n.style.height="100%";n.style.marginBottom="10px";n.style.overflow="auto";var t=(!EditorUi.compactUi)?"30px":"26px";var l=document.createElement("div");l.style.backgroundColor="#e5e5e5";l.style.position="absolute";l.style.overflow="auto";l.style.left="0px";l.style.right="0px";l.style.top="0px";l.style.bottom=(parseInt(t)+7)+"px";n.appendChild(l);var p=null;var b=null;mxEvent.addListener(n,"dragover",function(h){h.dataTransfer.dropEffect="move";b=0;h.stopPropagation();h.preventDefault()});mxEvent.addListener(n,"drop",function(h){h.stopPropagation();h.preventDefault()});var f=null;var i=null;var r=document.createElement("div");r.className="geToolbarContainer";r.style.position="absolute";r.style.bottom="0px";r.style.left="0px";r.style.right="0px";r.style.height=t;r.style.overflow="hidden";r.style.padding=(!EditorUi.compactUi)?"1px":"4px 0px 3px 0px";r.style.backgroundColor="whiteSmoke";r.style.borderWidth="1px 0px 0px 0px";r.style.borderColor="#c3c3c3";r.style.borderStyle="solid";r.style.display="block";r.style.whiteSpace="nowrap";if(mxClient.IS_QUIRKS){r.style.filter="none"}var e=document.createElement("a");e.className="geButton";if(mxClient.IS_QUIRKS){e.style.filter="none"}var g=e.cloneNode();g.innerHTML='<div class="geSprite geSprite-delete" style="display:inline-block;"></div>';mxEvent.addListener(g,"click",function(h){if(a.isEnabled()){a.model.beginUpdate();try{var w=a.model.root.getIndex(i);a.removeCells([i],false);if(a.model.getChildCount(a.model.root)==0){a.model.add(a.model.root,new mxCell());a.setDefaultParent(null)}else{if(w>0&&w<=a.model.getChildCount(a.model.root)){a.setDefaultParent(a.model.getChildAt(a.model.root,w-1))}else{a.setDefaultParent(null)}}}finally{a.model.endUpdate()}}mxEvent.consume(h)});if(!a.isEnabled()){g.className="geButton mxDisabled"}r.appendChild(g);var z=e.cloneNode();z.innerHTML='<div class="geSprite geSprite-insert" style="display:inline-block;"></div>';mxEvent.addListener(z,"click",function(h){if(a.isEnabled()&&!a.isSelectionEmpty()){a.moveCells(a.getSelectionCells(),0,0,false,i)}});r.appendChild(z);var q=e.cloneNode();q.innerHTML='<div class="geSprite geSprite-dots" style="display:inline-block;"></div>';q.setAttribute("title",mxResources.get("rename"));function o(h){if(a.isEnabled()&&h!=null){var w=new FilenameDialog(s,h.value||mxResources.get("background"),mxResources.get("rename"),mxUtils.bind(this,function(x){if(x!=null){a.getModel().setValue(h,x)}}),mxResources.get("enterName"));s.showDialog(w.container,300,100,true,true);w.init()}}mxEvent.addListener(q,"click",function(h){if(a.isEnabled()){o(i)}mxEvent.consume(h)});if(!a.isEnabled()){q.className="geButton mxDisabled"}r.appendChild(q);var u=e.cloneNode();u.innerHTML='<div class="geSprite geSprite-duplicate" style="display:inline-block;"></div>';mxEvent.addListener(u,"click",function(h){if(a.isEnabled()){var w=null;a.model.beginUpdate();try{w=a.cloneCells([i])[0];w.value=mxResources.get("untitledLayer");w.setVisible(true);w=a.addCell(w,a.model.root);a.setDefaultParent(w)}finally{a.model.endUpdate()}if(w!=null&&!a.isCellLocked(w)){a.selectAll(w)}}});if(!a.isEnabled()){u.className="geButton mxDisabled"}r.appendChild(u);var d=e.cloneNode();d.innerHTML='<div class="geSprite geSprite-plus" style="display:inline-block;"></div>';d.setAttribute("title",mxResources.get("addLayer"));mxEvent.addListener(d,"click",function(w){if(a.isEnabled()){a.model.beginUpdate();try{var h=a.addCell(new mxCell(mxResources.get("untitledLayer")),a.model.root);a.setDefaultParent(h)}finally{a.model.endUpdate()}}mxEvent.consume(w)});if(!a.isEnabled()){d.className="geButton mxDisabled"}r.appendChild(d);n.appendChild(r);function c(){f=a.model.getChildCount(a.model.root);l.innerHTML="";function w(F,H,A,K){var J=document.createElement("div");J.className="geToolbarContainer";J.style.overflow="hidden";J.style.position="relative";J.style.padding="4px";J.style.height="22px";J.style.display="block";J.style.backgroundColor="whiteSmoke";J.style.borderWidth="0px 0px 1px 0px";J.style.borderColor="#c3c3c3";J.style.borderStyle="solid";J.style.whiteSpace="nowrap";var C=document.createElement("div");C.style.display="inline-block";C.style.width="100%";C.style.textOverflow="ellipsis";C.style.overflow="hidden";mxEvent.addListener(J,"dragover",function(L){L.dataTransfer.dropEffect="move";b=F;L.stopPropagation();L.preventDefault()});mxEvent.addListener(J,"dragstart",function(L){p=J;if(mxClient.IS_FF){L.dataTransfer.setData("Text","<layer/>")}});mxEvent.addListener(J,"dragend",function(L){if(p!=null&&b!=null){a.addCell(A,a.model.root,b)}p=null;b=null;L.stopPropagation();L.preventDefault()});var B=document.createElement("img");B.setAttribute("draggable","false");B.setAttribute("align","top");B.setAttribute("border","0");B.style.cursor="pointer";B.style.padding="4px";B.setAttribute("title",mxResources.get("lockUnlock"));var y=a.view.getState(A);var x=(y!=null)?y.style:a.getCellStyle(A);if(mxUtils.getValue(x,"locked","0")=="1"){B.setAttribute("src",Dialog.prototype.lockedImage)}else{B.setAttribute("src",Dialog.prototype.unlockedImage)}mxEvent.addListener(B,"click",function(L){if(a.isEnabled()){var M=null;a.getModel().beginUpdate();try{M=(mxUtils.getValue(x,"locked","0")=="1")?null:"1";a.setCellStyles("locked",M,[A])}finally{a.getModel().endUpdate()}if(M=="1"){a.removeSelectionCells(a.getModel().getDescendants(A))}mxEvent.consume(L)}});C.appendChild(B);var G=document.createElement("input");G.setAttribute("type","checkbox");G.setAttribute("title",mxResources.get("hideIt",[A.value||mxResources.get("background")]));G.style.marginLeft="4px";G.style.marginRight="6px";G.style.marginTop="4px";C.appendChild(G);if(!a.isEnabled()){G.setAttribute("disabled","disabled")}if(a.model.isVisible(A)){G.setAttribute("checked","checked");G.defaultChecked=true}mxEvent.addListener(G,"click",function(L){if(a.isEnabled()){a.model.setVisible(A,!a.model.isVisible(A));mxEvent.consume(L)}});mxUtils.write(C,H);J.appendChild(C);if(a.isEnabled()){if(mxClient.IS_TOUCH||mxClient.IS_POINTER||mxClient.IS_VML||(mxClient.IS_IE&&document.documentMode<10)){var I=document.createElement("div");I.style.display="block";I.style.textAlign="right";I.style.whiteSpace="nowrap";I.style.position="absolute";I.style.right="6px";I.style.top="6px";if(F>0){var D=document.createElement("a");D.setAttribute("title",mxResources.get("toBack"));D.className="geButton";D.style.cssFloat="none";D.innerHTML="&#9660;";D.style.width="14px";D.style.height="14px";D.style.fontSize="14px";D.style.margin="0px";D.style.marginTop="-1px";I.appendChild(D);mxEvent.addListener(D,"click",function(L){if(a.isEnabled()){a.addCell(A,a.model.root,F-1)}mxEvent.consume(L)})}if(F>=0&&F<f-1){var E=document.createElement("a");E.setAttribute("title",mxResources.get("toFront"));E.className="geButton";E.style.cssFloat="none";E.innerHTML="&#9650;";E.style.width="14px";E.style.height="14px";E.style.fontSize="14px";E.style.margin="0px";E.style.marginTop="-1px";I.appendChild(E);mxEvent.addListener(E,"click",function(L){if(a.isEnabled()){a.addCell(A,a.model.root,F+1)}mxEvent.consume(L)})}J.appendChild(I)}if(mxClient.IS_SVG&&(!mxClient.IS_IE||document.documentMode>=10)){J.setAttribute("draggable","true");J.style.cursor="move"}}mxEvent.addListener(J,"dblclick",function(L){var M=mxEvent.getSource(L).nodeName;if(M!="INPUT"&&M!="IMG"){o(A);mxEvent.consume(L)}});if(a.getDefaultParent()==A){J.style.background="#e6eff8";J.style.fontWeight="bold";i=A}else{mxEvent.addListener(J,"click",function(L){if(a.isEnabled()){a.setDefaultParent(K);a.view.setCurrentRoot(null);c()}})}l.appendChild(J)}for(var h=f-1;h>=0;h--){(mxUtils.bind(this,function(x){w(h,x.value||mxResources.get("background"),x,x)}))(a.model.getChildAt(a.model.root,h))}g.setAttribute("title",mxResources.get("removeIt",[i.value||mxResources.get("background")]));z.setAttribute("title",mxResources.get("moveSelectionTo",[i.value||mxResources.get("background")]));u.setAttribute("title",mxResources.get("duplicateIt",[i.value||mxResources.get("background")]));q.setAttribute("title",mxResources.get("renameIt",[i.value||mxResources.get("background")]));if(a.isSelectionEmpty()){z.className="geButton mxDisabled"}}c();a.model.addListener(mxEvent.CHANGE,function(){c()});a.selectionModel.addListener(mxEvent.CHANGE,function(){if(a.isSelectionEmpty()){z.className="geButton mxDisabled"}else{z.className="geButton"}});this.window=new mxWindow(mxResources.get("layers"),n,k,j,m,v,true,true);this.window.destroyOnClose=false;this.window.setMaximizable(false);this.window.setResizable(true);this.window.setClosable(true);this.window.setVisible(true);this.refreshLayers=c;this.window.setLocation=function(h,w){h=Math.max(0,h);w=Math.max(0,w);mxWindow.prototype.setLocation.apply(this,arguments)};mxEvent.addListener(window,"resize",mxUtils.bind(this,function(){var w=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var A=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var h=this.window.getX();var B=this.window.getY();if(h+this.window.table.clientWidth>w){h=Math.max(0,w-this.window.table.clientWidth)}if(B+this.window.table.clientHeight>A){B=Math.max(0,A-this.window.table.clientHeight)}if(this.window.getX()!=h||this.window.getY()!=B){this.window.setLocation(h,B)}}))};