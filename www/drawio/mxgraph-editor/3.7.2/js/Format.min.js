Format=function(b,a){this.editorUi=b;this.container=a};Format.prototype.labelIndex=0;Format.prototype.currentIndex=0;Format.prototype.init=function(){var c=this.editorUi;var a=c.editor;var b=a.graph;this.update=mxUtils.bind(this,function(e,d){this.clearSelectionState();this.refresh()});b.getSelectionModel().addListener(mxEvent.CHANGE,this.update);b.addListener(mxEvent.EDITING_STARTED,this.update);b.addListener(mxEvent.EDITING_STOPPED,this.update);b.getModel().addListener(mxEvent.CHANGE,this.update);b.addListener(mxEvent.ROOT,mxUtils.bind(this,function(){this.refresh()}));this.refresh()};Format.prototype.clearSelectionState=function(){this.selectionState=null};Format.prototype.getSelectionState=function(){if(this.selectionState==null){this.selectionState=this.createSelectionState()}return this.selectionState};Format.prototype.createSelectionState=function(){var b=this.editorUi.editor.graph.getSelectionCells();var a=this.initSelectionState();for(var c=0;c<b.length;c++){this.updateSelectionStateForCell(a,b[c],b)}return a};Format.prototype.initSelectionState=function(){return{vertices:[],edges:[],x:null,y:null,width:null,height:null,style:{},containsImage:false,containsLabel:false,fill:true,glass:true,rounded:true,comic:true,autoSize:false,image:true,shadow:true}};Format.prototype.updateSelectionStateForCell=function(k,h,j){var i=this.editorUi.editor.graph;if(i.getModel().isVertex(h)){k.vertices.push(h);var b=i.getCellGeometry(h);if(b!=null){if(b.width>0){if(k.width==null){k.width=b.width}else{if(k.width!=b.width){k.width=""}}}else{k.containsLabel=true}if(b.height>0){if(k.height==null){k.height=b.height}else{if(k.height!=b.height){k.height=""}}}else{k.containsLabel=true}if(!b.relative||b.offset!=null){var e=(b.relative)?b.offset.x:b.x;var d=(b.relative)?b.offset.y:b.y;if(k.x==null){k.x=e}else{if(k.x!=e){k.x=""}}if(k.y==null){k.y=d}else{if(k.y!=d){k.y=""}}}}}else{if(i.getModel().isEdge(h)){k.edges.push(h)}}var a=i.view.getState(h);if(a!=null){k.autoSize=k.autoSize||this.isAutoSizeState(a);k.glass=k.glass&&this.isGlassState(a);k.rounded=k.rounded&&this.isRoundedState(a);k.comic=k.comic&&this.isComicState(a);k.image=k.image&&this.isImageState(a);k.shadow=k.shadow&&this.isShadowState(a);k.fill=k.fill&&this.isFillState(a);var c=mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE,null);k.containsImage=k.containsImage||c=="image";for(var g in a.style){var f=a.style[g];if(f!=null){if(k.style[g]==null){k.style[g]=f}else{if(k.style[g]!=f){k.style[g]=""}}}}}};Format.prototype.isFillState=function(a){return a.view.graph.model.isVertex(a.cell)||mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE,null)=="arrow"||mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE,null)=="flexArrow"};Format.prototype.isGlassState=function(b){var a=mxUtils.getValue(b.style,mxConstants.STYLE_SHAPE,null);return(a=="label"||a=="rectangle"||a=="internalStorage"||a=="ext"||a=="umlLifeline"||a=="swimlane"||a=="process")};Format.prototype.isRoundedState=function(b){var a=mxUtils.getValue(b.style,mxConstants.STYLE_SHAPE,null);return(a=="label"||a=="rectangle"||a=="internalStorage"||a=="corner"||a=="parallelogram"||a=="swimlane"||a=="triangle"||a=="trapezoid"||a=="ext"||a=="step"||a=="tee"||a=="process"||a=="link"||a=="rhombus"||a=="offPageConnector"||a=="loopLimit"||a=="hexagon"||a=="manualInput"||a=="curlyBracket"||a=="singleArrow"||a=="doubleArrow"||a=="flexArrow"||a=="card"||a=="umlLifeline")};Format.prototype.isComicState=function(b){var a=mxUtils.getValue(b.style,mxConstants.STYLE_SHAPE,null);return mxUtils.indexOf(["label","rectangle","internalStorage","corner","parallelogram","note","collate","swimlane","triangle","trapezoid","ext","step","tee","process","link","rhombus","offPageConnector","loopLimit","hexagon","manualInput","singleArrow","doubleArrow","flexArrow","card","umlLifeline","connector","folder","component","sortShape","cross","umlFrame","cube","isoCube","isoRectangle"],a)>=0};Format.prototype.isAutoSizeState=function(a){return mxUtils.getValue(a.style,mxConstants.STYLE_AUTOSIZE,null)=="1"};Format.prototype.isImageState=function(b){var a=mxUtils.getValue(b.style,mxConstants.STYLE_SHAPE,null);return(a=="label"||a=="image")};Format.prototype.isShadowState=function(b){var a=mxUtils.getValue(b.style,mxConstants.STYLE_SHAPE,null);return(a!="image")};Format.prototype.clear=function(){this.container.innerHTML="";if(this.panels!=null){for(var a=0;a<this.panels.length;a++){this.panels[a].destroy()}}this.panels=[]};Format.prototype.refresh=function(){if(this.container.style.width=="0px"){return}this.clear();var k=this.editorUi;var o=k.editor.graph;var a=document.createElement("div");a.style.whiteSpace="nowrap";a.style.color="rgb(112, 112, 112)";a.style.textAlign="left";a.style.cursor="default";var l=document.createElement("div");l.style.border="1px solid #c0c0c0";l.style.borderWidth="0px 0px 1px 0px";l.style.textAlign="center";l.style.fontWeight="bold";l.style.overflow="hidden";l.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block";l.style.paddingTop="8px";l.style.height=(mxClient.IS_QUIRKS)?"34px":"25px";l.style.width="100%";this.container.appendChild(a);if(o.isSelectionEmpty()){mxUtils.write(l,mxResources.get("diagram"));var g=document.createElement("img");g.setAttribute("border","0");g.setAttribute("src",Dialog.prototype.closeImage);g.setAttribute("title",mxResources.get("hide"));g.style.position="absolute";g.style.display="block";g.style.right="0px";g.style.top="8px";g.style.cursor="pointer";g.style.marginTop="1px";g.style.marginRight="17px";g.style.border="1px solid transparent";g.style.padding="1px";g.style.opacity=0.5;l.appendChild(g);mxEvent.addListener(g,"click",function(){k.actions.get("formatPanel").funct()});a.appendChild(l);this.panels.push(new DiagramFormatPanel(this,k,a))}else{if(o.isEditing()){mxUtils.write(l,mxResources.get("text"));a.appendChild(l);this.panels.push(new TextFormatPanel(this,k,a))}else{var i=this.getSelectionState().containsLabel;var n=null;var b=null;var f=mxUtils.bind(this,function(r,p,q){var s=mxUtils.bind(this,function(t){if(n!=r){if(i){this.labelIndex=q}else{this.currentIndex=q}if(n!=null){n.style.backgroundColor="#d7d7d7";n.style.borderBottomWidth="1px"}n=r;n.style.backgroundColor="";n.style.borderBottomWidth="0px";if(b!=p){if(b!=null){b.style.display="none"}b=p;b.style.display=""}}});mxEvent.addListener(r,"click",s);if(q==((i)?this.labelIndex:this.currentIndex)){s()}});var m=0;l.style.backgroundColor="#d7d7d7";l.style.borderLeftWidth="1px";l.style.width=(i)?"50%":"33.3%";l.style.width=(i)?"50%":"33.3%";var e=l.cloneNode(false);var d=e.cloneNode(false);e.style.backgroundColor="#d7d7d7";d.style.backgroundColor="#d7d7d7";if(i){e.style.borderLeftWidth="0px"}else{l.style.borderLeftWidth="0px";mxUtils.write(l,mxResources.get("style"));a.appendChild(l);var c=a.cloneNode(false);c.style.display="none";this.panels.push(new StyleFormatPanel(this,k,c));this.container.appendChild(c);f(l,c,m++)}mxUtils.write(e,mxResources.get("text"));a.appendChild(e);var h=a.cloneNode(false);h.style.display="none";this.panels.push(new TextFormatPanel(this,k,h));this.container.appendChild(h);mxUtils.write(d,mxResources.get("arrange"));a.appendChild(d);var j=a.cloneNode(false);j.style.display="none";this.panels.push(new ArrangePanel(this,k,j));this.container.appendChild(j);f(e,h,m++);f(d,j,m++)}}};BaseFormatPanel=function(c,b,a){this.format=c;this.editorUi=b;this.container=a;this.listeners=[]};BaseFormatPanel.prototype.getSelectionState=function(){var f=this.editorUi.editor.graph;var b=f.getSelectionCells();var a=null;for(var d=0;d<b.length;d++){var e=f.view.getState(b[d]);if(e!=null){var c=mxUtils.getValue(e.style,mxConstants.STYLE_SHAPE,null);if(c!=null){if(a==null){a=c}else{if(a!=c){return null}}}}}return a};BaseFormatPanel.prototype.installInputHandler=function(j,l,f,e,h,k,c,b){k=(k!=null)?k:"";b=(b!=null)?b:false;var g=this.editorUi;var m=g.editor.graph;e=(e!=null)?e:1;h=(h!=null)?h:999;var a=null;var i=false;var d=mxUtils.bind(this,function(o){var s=(b)?parseFloat(j.value):parseInt(j.value);if(!isNaN(s)&&l==mxConstants.STYLE_ROTATION){s=mxUtils.mod(Math.round(s*100),36000)/100}s=Math.min(h,Math.max(e,(isNaN(s))?f:s));if(m.cellEditor.isContentEditing()&&c){if(!i){i=true;if(a!=null){m.cellEditor.restoreSelection(a);a=null}c(s);j.value=s+k;i=false}}else{if(s!=mxUtils.getValue(this.format.getSelectionState().style,l,f)){if(m.isEditing()){m.stopEditing(true)}m.getModel().beginUpdate();try{m.setCellStyles(l,s,m.getSelectionCells());if(l==mxConstants.STYLE_FONTSIZE){var q=m.getSelectionCells();for(var r=0;r<q.length;r++){var n=q[r];if(m.isHtmlLabel(n)){var u=document.createElement("div");u.innerHTML=m.convertValueToString(n);var t=u.getElementsByTagName("font");for(var p=0;p<t.length;p++){t[p].removeAttribute("size");t[p].style.fontSize=s+"px"}m.cellLabelChanged(n,u.innerHTML)}}}}finally{m.getModel().endUpdate()}g.fireEvent(new mxEventObject("styleChanged","keys",[l],"values",[s],"cells",m.getSelectionCells()))}}j.value=s+k;mxEvent.consume(o)});if(c&&m.cellEditor.isContentEditing()){mxEvent.addListener(j,"mousedown",function(){a=m.cellEditor.saveSelection()});mxEvent.addListener(j,"touchstart",function(){a=m.cellEditor.saveSelection()})}mxEvent.addListener(j,"change",d);mxEvent.addListener(j,"blur",d);return d};BaseFormatPanel.prototype.createPanel=function(){var a=document.createElement("div");a.style.padding="12px 0px 12px 18px";a.style.borderBottom="1px solid #c0c0c0";return a};BaseFormatPanel.prototype.createTitle=function(a){var b=document.createElement("div");b.style.padding="0px 0px 6px 0px";b.style.whiteSpace="nowrap";b.style.overflow="hidden";b.style.width="200px";b.style.fontWeight="bold";mxUtils.write(b,a);return b};BaseFormatPanel.prototype.createStepper=function(g,d,a,i,j,f){a=(a!=null)?a:1;i=(i!=null)?i:8;if(mxClient.IS_QUIRKS){i=i-2}else{if(mxClient.IS_MT||document.documentMode>=8){i=i+1}}var c=document.createElement("div");mxUtils.setPrefixedStyle(c.style,"borderRadius","3px");c.style.border="1px solid rgb(192, 192, 192)";c.style.position="absolute";var e=document.createElement("div");e.style.borderBottom="1px solid rgb(192, 192, 192)";e.style.position="relative";e.style.height=i+"px";e.style.width="10px";e.className="geBtnUp";c.appendChild(e);var h=e.cloneNode(false);h.style.border="none";h.style.height=i+"px";h.className="geBtnDown";c.appendChild(h);mxEvent.addListener(h,"click",function(k){if(g.value==""){g.value=f||"2"}var l=parseInt(g.value);if(!isNaN(l)){g.value=l-a;if(d!=null){d(k)}}mxEvent.consume(k)});mxEvent.addListener(e,"click",function(k){if(g.value==""){g.value=f||"0"}var l=parseInt(g.value);if(!isNaN(l)){g.value=l+a;if(d!=null){d(k)}}mxEvent.consume(k)});if(j){var b=null;mxEvent.addGestureListeners(c,function(k){if(mxClient.IS_QUIRKS||document.documentMode==8){b=document.selection.createRange()}mxEvent.consume(k)},null,function(k){if(b!=null){try{b.select()}catch(l){}b=null;mxEvent.consume(k)}})}return c};BaseFormatPanel.prototype.createOption=function(f,b,e,c){var a=document.createElement("div");a.style.padding="6px 0px 1px 0px";a.style.whiteSpace="nowrap";a.style.overflow="hidden";a.style.width="200px";a.style.height=(mxClient.IS_QUIRKS)?"27px":"18px";var d=document.createElement("input");d.setAttribute("type","checkbox");d.style.margin="0px 6px 0px 0px";a.appendChild(d);var i=document.createElement("span");mxUtils.write(i,f);a.appendChild(i);var h=false;var g=b();var j=function(k){if(!h){h=true;if(k){d.setAttribute("checked","checked");d.defaultChecked=true;d.checked=true}else{d.removeAttribute("checked");d.defaultChecked=false;d.checked=false}if(g!=k){g=k;if(b()!=g){e(g)}}h=false}};mxEvent.addListener(a,"click",function(k){var l=mxEvent.getSource(k);if(l==a||l==i){d.checked=!d.checked}j(d.checked)});j(g);if(c!=null){c.install(j);this.listeners.push(c)}return a};BaseFormatPanel.prototype.createCellOption=function(h,i,e,d,k,g,b,a){d=(d!=null)?((d=="null")?null:d):"1";k=(k!=null)?((k=="null")?null:k):"0";var f=this.editorUi;var c=f.editor;var j=c.graph;return this.createOption(h,function(){var l=j.view.getState(j.getSelectionCell());if(l!=null){return mxUtils.getValue(l.style,i,e)!=k}return null},function(l){if(a){j.stopEditing()}if(b!=null){b.funct()}else{j.getModel().beginUpdate();try{var m=(l)?d:k;j.setCellStyles(i,m,j.getSelectionCells());if(g!=null){g(j.getSelectionCells(),m)}f.fireEvent(new mxEventObject("styleChanged","keys",[i],"values",[m],"cells",j.getSelectionCells()))}finally{j.getModel().endUpdate()}}},{install:function(l){this.listener=function(){var m=j.view.getState(j.getSelectionCell());if(m!=null){l(mxUtils.getValue(m.style,i,e)!=k)}};j.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){j.getModel().removeListener(this.listener)}})};BaseFormatPanel.prototype.createColorOption=function(j,i,h,c,d,g,f){var a=document.createElement("div");a.style.padding="6px 0px 1px 0px";a.style.whiteSpace="nowrap";a.style.overflow="hidden";a.style.width="200px";a.style.height=(mxClient.IS_QUIRKS)?"27px":"18px";var e=document.createElement("input");e.setAttribute("type","checkbox");e.style.margin="0px 6px 0px 0px";if(!f){a.appendChild(e)}var m=document.createElement("span");mxUtils.write(m,j);a.appendChild(m);var l=false;var k=i();var b=null;var n=function(o,p){if(!l){l=true;b.innerHTML='<div style="width:'+((mxClient.IS_QUIRKS)?"30":"36")+"px;height:12px;margin:3px;border:1px solid black;background-color:"+((o!=null&&o!=mxConstants.NONE)?o:c)+';"></div>';if(mxClient.IS_MT||mxClient.IS_QUIRKS||document.documentMode==8){b.firstChild.style.margin="0px"}if(o!=null&&o!=mxConstants.NONE){e.setAttribute("checked","checked");e.defaultChecked=true;e.checked=true}else{e.removeAttribute("checked");e.defaultChecked=false;e.checked=false}b.style.display=(e.checked||f)?"":"none";if(g!=null){g(o)}if(!p&&(f||k!=o)){k=o;if(f||i()!=k){h(k)}}l=false}};b=mxUtils.button("",mxUtils.bind(this,function(o){this.editorUi.pickColor(k,n);mxEvent.consume(o)}));b.style.position="absolute";b.style.marginTop="-4px";b.style.right=(mxClient.IS_QUIRKS)?"0px":"20px";b.style.height="22px";b.className="geColorBtn";b.style.display=(e.checked||f)?"":"none";a.appendChild(b);mxEvent.addListener(a,"click",function(o){var p=mxEvent.getSource(o);if(p==e||p.nodeName!="INPUT"){if(p!=e){e.checked=!e.checked}if(!e.checked&&k!=null&&k!=mxConstants.NONE&&c!=mxConstants.NONE){c=k}n((e.checked)?c:mxConstants.NONE)}});n(k,true);if(d!=null){d.install(n);this.listeners.push(d)}return a};BaseFormatPanel.prototype.createCellColorOption=function(b,h,f,a,g){var e=this.editorUi;var c=e.editor;var d=c.graph;return this.createColorOption(b,function(){var i=d.view.getState(d.getSelectionCell());if(i!=null){return mxUtils.getValue(i.style,h,null)}return null},function(i){d.getModel().beginUpdate();try{if(g!=null){g(i)}d.setCellStyles(h,i,d.getSelectionCells());e.fireEvent(new mxEventObject("styleChanged","keys",[h],"values",[i],"cells",d.getSelectionCells()))}finally{d.getModel().endUpdate()}},f||mxConstants.NONE,{install:function(i){this.listener=function(){var j=d.view.getState(d.getSelectionCell());if(j!=null){i(mxUtils.getValue(j.style,h,null))}};d.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){d.getModel().removeListener(this.listener)}},a)};BaseFormatPanel.prototype.addArrow=function(c,b){b=(b!=null)?b:10;var e=document.createElement("div");e.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block";e.style.padding="6px";e.style.paddingRight="4px";var a=(10-b);if(a==2){e.style.paddingTop=6+"px"}else{if(a>0){e.style.paddingTop=(6-a)+"px"}else{e.style.marginTop="-2px"}}e.style.height=b+"px";e.style.borderLeft="1px solid #a0a0a0";e.innerHTML='<img border="0" src="'+((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHBJREFUeNpidHB2ZyAGsACxDRBPIKCuA6TwCBB/h2rABu4A8SYmKCcXiP/iUFgAxL9gCi8A8SwsirZCMQMTkmANEH9E4v+CmsaArvAdyNFI/FlQ92EoBIE+qCRIUz168DBgsU4OqhinQpgHMABAgAEALY4XLIsJ20oAAAAASUVORK5CYII=":IMAGE_PATH+"/dropdown.png")+'" style="margin-bottom:4px;">';mxUtils.setOpacity(e,70);var d=c.getElementsByTagName("div")[0];if(d!=null){d.style.paddingRight="6px";d.style.marginLeft="4px";d.style.marginTop="-1px";d.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block";mxUtils.setOpacity(d,60)}mxUtils.setOpacity(c,100);c.style.border="1px solid #a0a0a0";c.style.backgroundColor="white";c.style.backgroundImage="none";c.style.width="auto";c.className+=" geColorBtn";mxUtils.setPrefixedStyle(c.style,"borderRadius","3px");c.appendChild(e);return d};BaseFormatPanel.prototype.addUnitInput=function(a,h,i,c,f,d,b,j){b=(b!=null)?b:0;var g=document.createElement("input");g.style.position="absolute";g.style.textAlign="right";g.style.marginTop="-2px";g.style.right=(i+12)+"px";g.style.width=c+"px";a.appendChild(g);var e=this.createStepper(g,f,d,null,j);e.style.marginTop=(b-2)+"px";e.style.right=i+"px";a.appendChild(e);return g};BaseFormatPanel.prototype.createRelativeOption=function(f,g,b,j,i){b=(b!=null)?b:44;var h=this.editorUi.editor.graph;var a=this.createPanel();a.style.paddingTop="10px";a.style.paddingBottom="10px";mxUtils.write(a,f);a.style.fontWeight="bold";function d(k){if(j!=null){j(e)}else{var m=parseInt(e.value);m=Math.min(100,Math.max(0,(isNaN(m))?100:m));var l=h.view.getState(h.getSelectionCell());if(l!=null&&m!=mxUtils.getValue(l.style,g,100)){if(m==100){m=null}h.setCellStyles(g,m,h.getSelectionCells())}e.value=((m!=null)?m:"100")+" %"}mxEvent.consume(k)}var e=this.addUnitInput(a,"%",20,b,d,10,-15,j!=null);if(g!=null){var c=mxUtils.bind(this,function(n,k,o){if(o||e!=document.activeElement){var m=this.format.getSelectionState();var l=parseInt(mxUtils.getValue(m.style,g,100));e.value=(isNaN(l))?"":l+" %"}});mxEvent.addListener(e,"keydown",function(k){if(k.keyCode==13){h.container.focus();mxEvent.consume(k)}else{if(k.keyCode==27){c(null,null,true);h.container.focus();mxEvent.consume(k)}}});h.getModel().addListener(mxEvent.CHANGE,c);this.listeners.push({destroy:function(){h.getModel().removeListener(c)}});c()}mxEvent.addListener(e,"blur",d);mxEvent.addListener(e,"change",d);if(i!=null){i(e)}return a};BaseFormatPanel.prototype.addLabel=function(e,d,b,c){c=(c!=null)?c:61;var a=document.createElement("div");mxUtils.write(a,d);a.style.position="absolute";a.style.right=b+"px";a.style.width=c+"px";a.style.marginTop="6px";a.style.textAlign="center";e.appendChild(a)};BaseFormatPanel.prototype.addKeyHandler=function(a,b){mxEvent.addListener(a,"keydown",mxUtils.bind(this,function(c){if(c.keyCode==13){this.editorUi.editor.graph.container.focus();mxEvent.consume(c)}else{if(c.keyCode==27){if(b!=null){b(null,null,true)}this.editorUi.editor.graph.container.focus();mxEvent.consume(c)}}}))};BaseFormatPanel.prototype.styleButtons=function(b){for(var a=0;a<b.length;a++){mxUtils.setPrefixedStyle(b[a].style,"borderRadius","3px");mxUtils.setOpacity(b[a],100);b[a].style.border="1px solid #a0a0a0";b[a].style.padding="4px";b[a].style.paddingTop="3px";b[a].style.paddingRight="1px";b[a].style.margin="1px";b[a].style.width="24px";b[a].style.height="20px";b[a].className+=" geColorBtn"}};BaseFormatPanel.prototype.destroy=function(){if(this.listeners!=null){for(var a=0;a<this.listeners.length;a++){this.listeners[a].destroy()}this.listeners=null}};ArrangePanel=function(c,b,a){BaseFormatPanel.call(this,c,b,a);this.init()};mxUtils.extend(ArrangePanel,BaseFormatPanel);ArrangePanel.prototype.init=function(){var b=this.editorUi.editor.graph;var a=this.format.getSelectionState();this.container.appendChild(this.addLayerOps(this.createPanel()));this.addGeometry(this.container);this.addEdgeGeometry(this.container);if(!a.containsLabel||a.edges.length==0){this.container.appendChild(this.addAngle(this.createPanel()))}if(!a.containsLabel&&a.edges.length==0){this.container.appendChild(this.addFlip(this.createPanel()))}if(a.vertices.length>1){this.container.appendChild(this.addAlign(this.createPanel()));this.container.appendChild(this.addDistribute(this.createPanel()))}this.container.appendChild(this.addGroupOps(this.createPanel()))};ArrangePanel.prototype.addLayerOps=function(c){var b=this.editorUi;var a=mxUtils.button(mxResources.get("toFront"),function(d){b.actions.get("toFront").funct()});a.setAttribute("title",mxResources.get("toFront")+" ("+this.editorUi.actions.get("toFront").shortcut+")");a.style.width="100px";a.style.marginRight="2px";c.appendChild(a);var a=mxUtils.button(mxResources.get("toBack"),function(d){b.actions.get("toBack").funct()});a.setAttribute("title",mxResources.get("toBack")+" ("+this.editorUi.actions.get("toBack").shortcut+")");a.style.width="100px";c.appendChild(a);return c};ArrangePanel.prototype.addGroupOps=function(f){var e=this.editorUi;var d=e.editor.graph;var a=d.getSelectionCell();var b=this.format.getSelectionState();var c=0;f.style.paddingTop="8px";f.style.paddingBottom="6px";if(d.getSelectionCount()>1){btn=mxUtils.button(mxResources.get("group"),function(g){e.actions.get("group").funct()});btn.setAttribute("title",mxResources.get("group")+" ("+this.editorUi.actions.get("group").shortcut+")");btn.style.width="202px";btn.style.marginBottom="2px";f.appendChild(btn);c++}else{if(d.getSelectionCount()==1&&!d.getModel().isEdge(a)&&!d.isSwimlane(a)&&d.getModel().getChildCount(a)>0){btn=mxUtils.button(mxResources.get("ungroup"),function(g){e.actions.get("ungroup").funct()});btn.setAttribute("title",mxResources.get("ungroup")+" ("+this.editorUi.actions.get("ungroup").shortcut+")");btn.style.width="202px";btn.style.marginBottom="2px";f.appendChild(btn);c++}}if(d.getSelectionCount()==1&&d.getModel().isVertex(a)&&d.getModel().isVertex(d.getModel().getParent(a))){if(c>0){mxUtils.br(f)}btn=mxUtils.button(mxResources.get("removeFromGroup"),function(g){e.actions.get("removeFromGroup").funct()});btn.setAttribute("title",mxResources.get("removeFromGroup"));btn.style.width="202px";btn.style.marginBottom="2px";f.appendChild(btn);c++}else{if(d.getSelectionCount()>0){if(c>0){mxUtils.br(f)}btn=mxUtils.button(mxResources.get("clearWaypoints"),mxUtils.bind(this,function(g){this.editorUi.actions.get("clearWaypoints").funct()}));btn.setAttribute("title",mxResources.get("clearWaypoints")+" ("+this.editorUi.actions.get("clearWaypoints").shortcut+")");btn.style.width="202px";btn.style.marginBottom="2px";f.appendChild(btn);c++}}if(d.getSelectionCount()==1){if(c>0){mxUtils.br(f)}btn=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(g){this.editorUi.actions.get("editData").funct()}));btn.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")");btn.style.width="100px";btn.style.marginBottom="2px";f.appendChild(btn);c++;btn=mxUtils.button(mxResources.get("editLink"),mxUtils.bind(this,function(g){this.editorUi.actions.get("editLink").funct()}));btn.setAttribute("title",mxResources.get("editLink"));btn.style.width="100px";btn.style.marginLeft="2px";btn.style.marginBottom="2px";f.appendChild(btn);c++}if(c==0){f.style.display="none"}return f};ArrangePanel.prototype.addAlign=function(c){var h=this.editorUi.editor.graph;c.style.paddingTop="6px";c.style.paddingBottom="12px";c.appendChild(this.createTitle(mxResources.get("align")));var d=document.createElement("div");d.style.position="relative";d.style.paddingLeft="0px";d.style.borderWidth="0px";d.className="geToolbarContainer";if(mxClient.IS_QUIRKS){c.style.height="60px"}var e=this.editorUi.toolbar.addButton("geSprite-alignleft",mxResources.get("left"),function(){h.alignCells(mxConstants.ALIGN_LEFT)},d);var b=this.editorUi.toolbar.addButton("geSprite-aligncenter",mxResources.get("center"),function(){h.alignCells(mxConstants.ALIGN_CENTER)},d);var g=this.editorUi.toolbar.addButton("geSprite-alignright",mxResources.get("right"),function(){h.alignCells(mxConstants.ALIGN_RIGHT)},d);var f=this.editorUi.toolbar.addButton("geSprite-aligntop",mxResources.get("top"),function(){h.alignCells(mxConstants.ALIGN_TOP)},d);var i=this.editorUi.toolbar.addButton("geSprite-alignmiddle",mxResources.get("middle"),function(){h.alignCells(mxConstants.ALIGN_MIDDLE)},d);var a=this.editorUi.toolbar.addButton("geSprite-alignbottom",mxResources.get("bottom"),function(){h.alignCells(mxConstants.ALIGN_BOTTOM)},d);this.styleButtons([e,b,g,f,i,a]);g.style.marginRight="6px";c.appendChild(d);return c};ArrangePanel.prototype.addFlip=function(f){var e=this.editorUi;var c=e.editor;var d=c.graph;f.style.paddingTop="6px";f.style.paddingBottom="10px";var b=document.createElement("div");b.style.marginTop="2px";b.style.marginBottom="8px";b.style.fontWeight="bold";mxUtils.write(b,mxResources.get("flip"));f.appendChild(b);var a=mxUtils.button(mxResources.get("horizontal"),function(g){d.toggleCellStyles(mxConstants.STYLE_FLIPH,false)});a.setAttribute("title",mxResources.get("horizontal"));a.style.width="100px";a.style.marginRight="2px";f.appendChild(a);var a=mxUtils.button(mxResources.get("vertical"),function(g){d.toggleCellStyles(mxConstants.STYLE_FLIPV,false)});a.setAttribute("title",mxResources.get("vertical"));a.style.width="100px";f.appendChild(a);return f};ArrangePanel.prototype.addDistribute=function(e){var d=this.editorUi;var b=d.editor;var c=b.graph;e.style.paddingTop="6px";e.style.paddingBottom="12px";e.appendChild(this.createTitle(mxResources.get("distribute")));var a=mxUtils.button(mxResources.get("horizontal"),function(f){c.distributeCells(true)});a.setAttribute("title",mxResources.get("horizontal"));a.style.width="100px";a.style.marginRight="2px";e.appendChild(a);var a=mxUtils.button(mxResources.get("vertical"),function(f){c.distributeCells(false)});a.setAttribute("title",mxResources.get("vertical"));a.style.width="100px";e.appendChild(a);return e};ArrangePanel.prototype.addAngle=function(a){var f=this.editorUi;var e=f.editor;var j=e.graph;var k=this.format.getSelectionState();a.style.paddingBottom="8px";var i=document.createElement("div");i.style.position="absolute";i.style.width="70px";i.style.marginTop="0px";i.style.fontWeight="bold";var h=null;var d=null;var b=null;if(k.edges.length==0){mxUtils.write(i,mxResources.get("angle"));a.appendChild(i);h=this.addUnitInput(a,"°",20,44,function(){d.apply(this,arguments)});mxUtils.br(a);a.style.paddingTop="10px"}else{a.style.paddingTop="8px"}if(!k.containsLabel){var g=mxResources.get("reverse");if(k.vertices.length>0&&k.edges.length>0){g=mxResources.get("turn")+" / "+g}else{if(k.vertices.length>0){g=mxResources.get("turn")}}b=mxUtils.button(g,function(l){f.actions.get("turn").funct()});b.setAttribute("title",g+" ("+this.editorUi.actions.get("turn").shortcut+")");b.style.width="202px";a.appendChild(b);if(h!=null){b.style.marginTop="8px"}}if(h!=null){var c=mxUtils.bind(this,function(n,l,o){if(o||document.activeElement!=h){k=this.format.getSelectionState();var m=parseFloat(mxUtils.getValue(k.style,mxConstants.STYLE_ROTATION,0));h.value=(isNaN(m))?"":m+"°"}});d=this.installInputHandler(h,mxConstants.STYLE_ROTATION,0,0,360,"°",null,true);this.addKeyHandler(h,c);j.getModel().addListener(mxEvent.CHANGE,c);this.listeners.push({destroy:function(){j.getModel().removeListener(c)}});c()}return a};ArrangePanel.prototype.addGeometry=function(j){var n=this.editorUi;var d=n.editor.graph;var b=this.format.getSelectionState();var k=this.createPanel();k.style.paddingBottom="8px";var q=document.createElement("div");q.style.position="absolute";q.style.width="50px";q.style.marginTop="0px";q.style.fontWeight="bold";mxUtils.write(q,mxResources.get("size"));k.appendChild(q);var i,o,s,r;var p=this.addUnitInput(k,"pt",84,44,function(){i.apply(this,arguments)});var m=this.addUnitInput(k,"pt",20,44,function(){o.apply(this,arguments)});var g=document.createElement("div");g.className="geSprite geSprite-fit";g.setAttribute("title",mxResources.get("autosize")+" ("+this.editorUi.actions.get("autosize").shortcut+")");g.style.position="relative";g.style.cursor="pointer";g.style.marginTop="-3px";g.style.border="0px";g.style.left="52px";mxUtils.setOpacity(g,50);mxEvent.addListener(g,"mouseenter",function(){mxUtils.setOpacity(g,100)});mxEvent.addListener(g,"mouseleave",function(){mxUtils.setOpacity(g,50)});mxEvent.addListener(g,"click",function(){n.actions.get("autosize").funct()});k.appendChild(g);this.addLabel(k,mxResources.get("width"),84);this.addLabel(k,mxResources.get("height"),20);mxUtils.br(k);var h=document.createElement("div");h.style.paddingTop="8px";h.style.paddingRight="20px";h.style.whiteSpace="nowrap";h.style.textAlign="right";var a=this.createCellOption(mxResources.get("constrainProportions"),mxConstants.STYLE_ASPECT,null,"fixed","null");a.style.width="100%";h.appendChild(a);k.appendChild(h);this.addKeyHandler(p,e);this.addKeyHandler(m,e);i=this.addGeometryHandler(p,function(u,t){if(u.width>0){u.width=Math.max(1,t)}});o=this.addGeometryHandler(m,function(u,t){if(u.height>0){u.height=Math.max(1,t)}});j.appendChild(k);var c=this.createPanel();c.style.paddingBottom="30px";var q=document.createElement("div");q.style.position="absolute";q.style.width="70px";q.style.marginTop="0px";q.style.fontWeight="bold";mxUtils.write(q,mxResources.get("position"));c.appendChild(q);var f=this.addUnitInput(c,"pt",84,44,function(){s.apply(this,arguments)});var l=this.addUnitInput(c,"pt",20,44,function(){r.apply(this,arguments)});mxUtils.br(c);this.addLabel(c,mxResources.get("left"),84);this.addLabel(c,mxResources.get("top"),20);var e=mxUtils.bind(this,function(u,t,v){b=this.format.getSelectionState();if(!b.containsLabel&&b.vertices.length==d.getSelectionCount()&&b.width!=null&&b.height!=null){k.style.display="";if(v||document.activeElement!=p){p.value=b.width+((b.width=="")?"":" pt")}if(v||document.activeElement!=m){m.value=b.height+((b.height=="")?"":" pt")}}else{k.style.display="none"}if(b.vertices.length==d.getSelectionCount()&&b.x!=null&&b.y!=null){c.style.display="";if(v||document.activeElement!=f){f.value=b.x+((b.x=="")?"":" pt")}if(v||document.activeElement!=l){l.value=b.y+((b.y=="")?"":" pt")}}else{c.style.display="none"}});this.addKeyHandler(f,e);this.addKeyHandler(l,e);d.getModel().addListener(mxEvent.CHANGE,e);this.listeners.push({destroy:function(){d.getModel().removeListener(e)}});e();s=this.addGeometryHandler(f,function(u,t){if(u.relative){u.offset.x=t}else{u.x=t}});r=this.addGeometryHandler(l,function(u,t){if(u.relative){u.offset.y=t}else{u.y=t}});j.appendChild(c)};ArrangePanel.prototype.addGeometryHandler=function(b,c){var e=this.editorUi;var d=e.editor.graph;var a=null;function f(g){if(b.value!=""){var k=parseFloat(b.value);if(k!=a){d.getModel().beginUpdate();try{var h=d.getSelectionCells();for(var j=0;j<h.length;j++){if(d.getModel().isVertex(h[j])){var l=d.getCellGeometry(h[j]);if(l!=null){l=l.clone();c(l,k);d.getModel().setGeometry(h[j],l)}}}}finally{d.getModel().endUpdate()}a=k;b.value=k+" pt"}else{if(isNaN(k)){b.value=a+" pt"}}}mxEvent.consume(g)}mxEvent.addListener(b,"blur",f);mxEvent.addListener(b,"change",f);mxEvent.addListener(b,"focus",function(){a=b.value});return f};ArrangePanel.prototype.addEdgeGeometry=function(b){var h=this.editorUi;var k=h.editor.graph;var i=this.format.getSelectionState();var a=this.createPanel();var j=document.createElement("div");j.style.position="absolute";j.style.width="70px";j.style.marginTop="0px";j.style.fontWeight="bold";mxUtils.write(j,mxResources.get("width"));a.appendChild(j);var e,f,g;var c=this.addUnitInput(a,"pt",20,44,function(){e.apply(this,arguments)});mxUtils.br(a);this.addKeyHandler(c,d);function e(l){var m=parseInt(c.value);m=Math.min(999,Math.max(1,(isNaN(m))?1:m));if(m!=mxUtils.getValue(i.style,"width",mxCellRenderer.prototype.defaultShapes.flexArrow.prototype.defaultWidth)){k.setCellStyles("width",m,k.getSelectionCells());h.fireEvent(new mxEventObject("styleChanged","keys",["width"],"values",[m],"cells",k.getSelectionCells()))}c.value=m+" pt";mxEvent.consume(l)}mxEvent.addListener(c,"blur",e);mxEvent.addListener(c,"change",e);b.appendChild(a);var d=mxUtils.bind(this,function(m,l,o){i=this.format.getSelectionState();if(i.style.shape=="link"||i.style.shape=="flexArrow"){a.style.display="";if(o||document.activeElement!=c){var n=mxUtils.getValue(i.style,"width",mxCellRenderer.prototype.defaultShapes.flexArrow.prototype.defaultWidth);c.value=n+" pt"}}else{a.style.display="none"}});k.getModel().addListener(mxEvent.CHANGE,d);this.listeners.push({destroy:function(){k.getModel().removeListener(d)}});d()};TextFormatPanel=function(c,b,a){BaseFormatPanel.call(this,c,b,a);this.init()};mxUtils.extend(TextFormatPanel,BaseFormatPanel);TextFormatPanel.prototype.init=function(){this.container.style.borderBottom="none";this.addFont(this.container)};TextFormatPanel.prototype.addFont=function(af){var J=this.editorUi;var B=J.editor;var al=B.graph;var ag=this.format.getSelectionState();var o=this.createTitle(mxResources.get("font"));o.style.paddingLeft="18px";o.style.paddingTop="10px";o.style.paddingBottom="6px";af.appendChild(o);var h=this.createPanel();h.style.paddingTop="2px";h.style.paddingBottom="2px";h.style.position="relative";h.style.marginLeft="-2px";h.style.borderWidth="0px";h.className="geToolbarContainer";if(mxClient.IS_QUIRKS){h.style.display="block"}if(al.cellEditor.isContentEditing()){var ac=h.cloneNode();var az=this.editorUi.toolbar.addMenu(mxResources.get("style"),mxResources.get("style"),true,"formatBlock",ac);az.style.color="rgb(112, 112, 112)";az.style.whiteSpace="nowrap";az.style.overflow="hidden";az.style.margin="0px";this.addArrow(az);az.style.width="192px";az.style.height="15px";var L=az.getElementsByTagName("div")[0];L.style.cssFloat="right";af.appendChild(ac)}af.appendChild(h);var an=this.createPanel();an.style.marginTop="8px";an.style.borderTop="1px solid #c0c0c0";an.style.paddingTop="6px";an.style.paddingBottom="6px";var G=this.editorUi.toolbar.addMenu("Helvetica",mxResources.get("fontFamily"),true,"fontFamily",h);G.style.color="rgb(112, 112, 112)";G.style.whiteSpace="nowrap";G.style.overflow="hidden";G.style.margin="0px";this.addArrow(G);G.style.width="192px";G.style.height="15px";if(mxClient.IS_FF){G.getElementsByTagName("div")[0].style.marginTop="-18px"}var a=h.cloneNode(false);a.style.marginLeft="-3px";var aA=this.editorUi.toolbar.addItems(["bold","italic","underline"],a,true);aA[0].setAttribute("title",mxResources.get("bold")+" ("+this.editorUi.actions.get("bold").shortcut+")");aA[1].setAttribute("title",mxResources.get("italic")+" ("+this.editorUi.actions.get("italic").shortcut+")");aA[2].setAttribute("title",mxResources.get("underline")+" ("+this.editorUi.actions.get("underline").shortcut+")");var t=this.editorUi.toolbar.addItems(["vertical"],a,true)[0];if(mxClient.IS_QUIRKS){mxUtils.br(af)}af.appendChild(a);this.styleButtons(aA);this.styleButtons([t]);var aE=h.cloneNode(false);aE.style.marginLeft="-3px";aE.style.paddingBottom="0px";var O=this.editorUi.toolbar.addButton("geSprite-left",mxResources.get("left"),(al.cellEditor.isContentEditing())?function(){document.execCommand("justifyleft",false,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT]),aE);var Z=this.editorUi.toolbar.addButton("geSprite-center",mxResources.get("center"),(al.cellEditor.isContentEditing())?function(){document.execCommand("justifycenter",false,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER]),aE);var Q=this.editorUi.toolbar.addButton("geSprite-right",mxResources.get("right"),(al.cellEditor.isContentEditing())?function(){document.execCommand("justifyright",false,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT]),aE);this.styleButtons([O,Z,Q]);if(al.cellEditor.isContentEditing()){var ab=this.editorUi.toolbar.addButton("geSprite-removeformat",mxResources.get("removeFormat"),function(){document.execCommand("removeformat",false,null)},a);this.styleButtons([ab])}var ai=this.editorUi.toolbar.addButton("geSprite-top",mxResources.get("top"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP]),aE);var X=this.editorUi.toolbar.addButton("geSprite-middle",mxResources.get("middle"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE]),aE);var l=this.editorUi.toolbar.addButton("geSprite-bottom",mxResources.get("bottom"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM]),aE);this.styleButtons([ai,X,l]);if(mxClient.IS_QUIRKS){mxUtils.br(af)}af.appendChild(aE);var at,am,au,b,ak,C,p;if(al.cellEditor.isContentEditing()){ai.style.display="none";X.style.display="none";l.style.display="none";t.style.display="none";au=this.editorUi.toolbar.addButton("geSprite-justifyfull",null,function(){document.execCommand("justifyfull",false,null)},aE);this.styleButtons([au,at=this.editorUi.toolbar.addButton("geSprite-subscript",mxResources.get("subscript")+" (Ctrl+,)",function(){document.execCommand("subscript",false,null)},aE),am=this.editorUi.toolbar.addButton("geSprite-superscript",mxResources.get("superscript")+" (Ctrl+.)",function(){document.execCommand("superscript",false,null)},aE)]);au.style.marginRight="9px";var f=aE.cloneNode(false);f.style.paddingTop="4px";var K=[this.editorUi.toolbar.addButton("geSprite-orderedlist",mxResources.get("numberedList"),function(){document.execCommand("insertorderedlist",false,null)},f),this.editorUi.toolbar.addButton("geSprite-unorderedlist",mxResources.get("bulletedList"),function(){document.execCommand("insertunorderedlist",false,null)},f),this.editorUi.toolbar.addButton("geSprite-outdent",mxResources.get("decreaseIndent"),function(){document.execCommand("outdent",false,null)},f),this.editorUi.toolbar.addButton("geSprite-indent",mxResources.get("increaseIndent"),function(){document.execCommand("indent",false,null)},f),this.editorUi.toolbar.addButton("geSprite-code",mxResources.get("html"),function(){al.cellEditor.toggleViewMode()},f)];this.styleButtons(K);K[K.length-1].style.marginLeft="9px";if(mxClient.IS_QUIRKS){mxUtils.br(af);f.style.height="40"}af.appendChild(f)}else{aA[2].style.marginRight="9px";Q.style.marginRight="9px"}var aD=h.cloneNode(false);aD.style.marginLeft="0px";aD.style.paddingTop="8px";aD.style.paddingBottom="4px";aD.style.fontWeight="normal";mxUtils.write(aD,mxResources.get("position"));var Y=document.createElement("select");Y.style.position="absolute";Y.style.right="20px";Y.style.width="97px";Y.style.marginTop="-2px";var V=["topLeft","top","topRight","left","center","right","bottomLeft","bottom","bottomRight"];var q={topLeft:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_TOP,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_BOTTOM],top:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_TOP,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_BOTTOM],topRight:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_TOP,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_BOTTOM],left:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_MIDDLE],center:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE],right:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_MIDDLE],bottomLeft:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_TOP],bottom:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_TOP],bottomRight:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_TOP]};for(var I=0;I<V.length;I++){var g=document.createElement("option");g.setAttribute("value",V[I]);mxUtils.write(g,mxResources.get(V[I]));Y.appendChild(g)}aD.appendChild(Y);var aC=h.cloneNode(false);aC.style.marginLeft="0px";aC.style.paddingTop="4px";aC.style.paddingBottom="4px";aC.style.fontWeight="normal";mxUtils.write(aC,mxResources.get("writingDirection"));var E=document.createElement("select");E.style.position="absolute";E.style.right="20px";E.style.width="97px";E.style.marginTop="-2px";var r=["automatic","leftToRight","rightToLeft"];var n={automatic:null,leftToRight:mxConstants.TEXT_DIRECTION_LTR,rightToLeft:mxConstants.TEXT_DIRECTION_RTL};for(var I=0;I<r.length;I++){var aq=document.createElement("option");aq.setAttribute("value",r[I]);mxUtils.write(aq,mxResources.get(r[I]));E.appendChild(aq)}aC.appendChild(E);if(!al.isEditing()){af.appendChild(aD);mxEvent.addListener(Y,"change",function(i){al.getModel().beginUpdate();try{var aF=q[Y.value];if(aF!=null){al.setCellStyles(mxConstants.STYLE_LABEL_POSITION,aF[0],al.getSelectionCells());al.setCellStyles(mxConstants.STYLE_VERTICAL_LABEL_POSITION,aF[1],al.getSelectionCells());al.setCellStyles(mxConstants.STYLE_ALIGN,aF[2],al.getSelectionCells());al.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,aF[3],al.getSelectionCells())}}finally{al.getModel().endUpdate()}mxEvent.consume(i)});af.appendChild(aC);mxEvent.addListener(E,"change",function(i){al.setCellStyles(mxConstants.STYLE_TEXT_DIRECTION,n[E.value],al.getSelectionCells());mxEvent.consume(i)})}var aB=document.createElement("input");aB.style.textAlign="right";aB.style.marginTop="4px";if(!mxClient.IS_QUIRKS){aB.style.position="absolute";aB.style.right="32px"}aB.style.width="46px";aB.style.height=(mxClient.IS_QUIRKS)?"21px":"17px";a.appendChild(aB);var A=null;var H=this.installInputHandler(aB,mxConstants.STYLE_FONTSIZE,Menus.prototype.defaultFontSize,1,999," pt",function(aH){A=aH;document.execCommand("fontSize",false,"4");var aG=al.cellEditor.textarea.getElementsByTagName("font");for(var aF=0;aF<aG.length;aF++){if(aG[aF].getAttribute("size")=="4"){aG[aF].removeAttribute("size");aG[aF].style.fontSize=A+"px";window.setTimeout(function(){aB.value=A+" pt";A=null},0);break}}},true);var aw=this.createStepper(aB,H,1,10,true,Menus.prototype.defaultFontSize);aw.style.display=aB.style.display;aw.style.marginTop="4px";if(!mxClient.IS_QUIRKS){aw.style.right="20px"}a.appendChild(aw);var L=G.getElementsByTagName("div")[0];L.style.cssFloat="right";var av=null;var aj="#ffffff";var ao=null;var S="#000000";var ae=(al.cellEditor.isContentEditing())?this.createColorOption(mxResources.get("backgroundColor"),function(){return aj},function(i){document.execCommand("backcolor",false,(i!=mxConstants.NONE)?i:"transparent")},"#ffffff",{install:function(i){av=i},destroy:function(){av=null}},null,true):this.createCellColorOption(mxResources.get("backgroundColor"),mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"#ffffff");ae.style.fontWeight="bold";var w=this.createCellColorOption(mxResources.get("borderColor"),mxConstants.STYLE_LABEL_BORDERCOLOR,"#000000");w.style.fontWeight="bold";var c=(al.cellEditor.isContentEditing())?this.createColorOption(mxResources.get("fontColor"),function(){return S},function(i){document.execCommand("forecolor",false,(i!=mxConstants.NONE)?i:"transparent")},"#000000",{install:function(i){ao=i},destroy:function(){ao=null}},null,true):this.createCellColorOption(mxResources.get("fontColor"),mxConstants.STYLE_FONTCOLOR,"#000000",function(i){if(i==null||i==mxConstants.NONE){ae.style.display="none"}else{ae.style.display=""}w.style.display=ae.style.display},function(i){if(i==null||i==mxConstants.NONE){al.setCellStyles(mxConstants.STYLE_NOLABEL,"1",al.getSelectionCells())}else{al.setCellStyles(mxConstants.STYLE_NOLABEL,null,al.getSelectionCells())}});c.style.fontWeight="bold";an.appendChild(c);an.appendChild(ae);if(!al.cellEditor.isContentEditing()){an.appendChild(w)}af.appendChild(an);var U=this.createPanel();U.style.paddingTop="2px";U.style.paddingBottom="4px";var F=this.createCellOption(mxResources.get("wordWrap"),mxConstants.STYLE_WHITE_SPACE,null,"wrap","null",null,null,true);F.style.fontWeight="bold";if(!ag.containsLabel&&!ag.autoSize&&ag.edges.length==0){U.appendChild(F)}var R=this.createCellOption(mxResources.get("formattedText"),"html","0",null,null,null,J.actions.get("formattedText"));R.style.fontWeight="bold";U.appendChild(R);var ap=this.createPanel();ap.style.paddingTop="10px";ap.style.paddingBottom="28px";ap.style.fontWeight="normal";var m=document.createElement("div");m.style.position="absolute";m.style.width="70px";m.style.marginTop="0px";m.style.fontWeight="bold";mxUtils.write(m,mxResources.get("spacing"));ap.appendChild(m);var T,z,ad,aa,e;var ax=this.addUnitInput(ap,"pt",91,44,function(){T.apply(this,arguments)});var s=this.addUnitInput(ap,"pt",20,44,function(){z.apply(this,arguments)});mxUtils.br(ap);this.addLabel(ap,mxResources.get("top"),91);this.addLabel(ap,mxResources.get("global"),20);mxUtils.br(ap);mxUtils.br(ap);var v=this.addUnitInput(ap,"pt",162,44,function(){ad.apply(this,arguments)});var D=this.addUnitInput(ap,"pt",91,44,function(){aa.apply(this,arguments)});var x=this.addUnitInput(ap,"pt",20,44,function(){e.apply(this,arguments)});mxUtils.br(ap);this.addLabel(ap,mxResources.get("left"),162);this.addLabel(ap,mxResources.get("bottom"),91);this.addLabel(ap,mxResources.get("right"),20);if(!al.cellEditor.isContentEditing()){af.appendChild(U);af.appendChild(this.createRelativeOption(mxResources.get("opacity"),mxConstants.STYLE_TEXT_OPACITY));af.appendChild(ap)}else{var N=null;var ar=null;af.appendChild(this.createRelativeOption(mxResources.get("lineheight"),null,null,function(i){var aG=(i.value=="")?120:parseInt(i.value);aG=Math.max(120,(isNaN(aG))?120:aG);if(N!=null){al.cellEditor.restoreSelection(N);N=null}var aH=al.getSelectedElement();var aF=aH;while(aF!=null&&aF.nodeType!=mxConstants.NODETYPE_ELEMENT){aF=aF.parentNode}if(aF!=null&&aF==al.cellEditor.textarea&&al.cellEditor.textarea.firstChild!=null){if(al.cellEditor.textarea.firstChild.nodeName!="FONT"){al.cellEditor.textarea.innerHTML="<font>"+al.cellEditor.textarea.innerHTML+"</font>"}aF=al.cellEditor.textarea.firstChild}if(aF!=null&&aF!=al.cellEditor.textarea){aF.style.lineHeight=aG+"%"}i.value=aG+" %"},function(i){ar=i;mxEvent.addListener(i,"mousedown",function(){N=al.cellEditor.saveSelection()});mxEvent.addListener(i,"touchstart",function(){N=al.cellEditor.saveSelection()});i.value="120 %"}));var P=h.cloneNode(false);P.style.paddingLeft="0px";var u=this.editorUi.toolbar.addItems(["link","image"],P,true);var K=[this.editorUi.toolbar.addButton("geSprite-horizontalrule",mxResources.get("insertHorizontalRule"),function(){document.execCommand("inserthorizontalrule",false,null)},P),this.editorUi.toolbar.addMenuFunctionInContainer(P,"geSprite-table",mxResources.get("table"),false,mxUtils.bind(this,function(i){this.editorUi.menus.addInsertTableItem(i)}))];this.styleButtons(u);this.styleButtons(K);var k=this.createPanel();k.style.paddingTop="10px";k.style.paddingBottom="10px";k.appendChild(this.createTitle(mxResources.get("insert")));k.appendChild(P);af.appendChild(k);if(mxClient.IS_QUIRKS){k.style.height="70"}var d=h.cloneNode(false);d.style.paddingLeft="0px";var K=[this.editorUi.toolbar.addButton("geSprite-insertcolumnbefore",mxResources.get("insertColumnBefore"),function(){try{if(ak!=null){al.selectNode(al.insertColumn(ak,(C!=null)?C.cellIndex:0))}}catch(i){alert(i)}},d),this.editorUi.toolbar.addButton("geSprite-insertcolumnafter",mxResources.get("insertColumnAfter"),function(){try{if(ak!=null){al.selectNode(al.insertColumn(ak,(C!=null)?C.cellIndex+1:-1))}}catch(i){alert(i)}},d),this.editorUi.toolbar.addButton("geSprite-deletecolumn",mxResources.get("deleteColumn"),function(){try{if(ak!=null&&C!=null){al.deleteColumn(ak,C.cellIndex)}}catch(i){alert(i)}},d),this.editorUi.toolbar.addButton("geSprite-insertrowbefore",mxResources.get("insertRowBefore"),function(){try{if(ak!=null&&p!=null){al.selectNode(al.insertRow(ak,p.sectionRowIndex))}}catch(i){alert(i)}},d),this.editorUi.toolbar.addButton("geSprite-insertrowafter",mxResources.get("insertRowAfter"),function(){try{if(ak!=null&&p!=null){al.selectNode(al.insertRow(ak,p.sectionRowIndex+1))}}catch(i){alert(i)}},d),this.editorUi.toolbar.addButton("geSprite-deleterow",mxResources.get("deleteRow"),function(){try{if(ak!=null&&p!=null){al.deleteRow(ak,p.sectionRowIndex)}}catch(i){alert(i)}},d)];this.styleButtons(K);K[2].style.marginRight="9px";var j=this.createPanel();j.style.paddingTop="10px";j.style.paddingBottom="10px";j.appendChild(this.createTitle(mxResources.get("table")));j.appendChild(d);if(mxClient.IS_QUIRKS){mxUtils.br(af);j.style.height="70"}var M=h.cloneNode(false);M.style.paddingLeft="0px";var K=[this.editorUi.toolbar.addButton("geSprite-strokecolor",mxResources.get("borderColor"),mxUtils.bind(this,function(){if(ak!=null){var i=ak.style.borderColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(aG,aF,aI,aH){return"#"+("0"+Number(aF).toString(16)).substr(-2)+("0"+Number(aI).toString(16)).substr(-2)+("0"+Number(aH).toString(16)).substr(-2)});this.editorUi.pickColor(i,function(aF){if(aF==null||aF==mxConstants.NONE){ak.removeAttribute("border");ak.style.border="";ak.style.borderCollapse=""}else{ak.setAttribute("border","1");ak.style.border="1px solid "+aF;ak.style.borderCollapse="collapse"}})}}),M),this.editorUi.toolbar.addButton("geSprite-fillcolor",mxResources.get("backgroundColor"),mxUtils.bind(this,function(){if(ak!=null){var i=ak.style.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(aG,aF,aI,aH){return"#"+("0"+Number(aF).toString(16)).substr(-2)+("0"+Number(aI).toString(16)).substr(-2)+("0"+Number(aH).toString(16)).substr(-2)});this.editorUi.pickColor(i,function(aF){if(aF==null||aF==mxConstants.NONE){ak.style.backgroundColor=""}else{ak.style.backgroundColor=aF}})}}),M),this.editorUi.toolbar.addButton("geSprite-fit",mxResources.get("spacing"),function(){if(ak!=null){var i=ak.getAttribute("cellPadding")||0;var aF=new FilenameDialog(J,i,mxResources.get("apply"),mxUtils.bind(this,function(aG){if(aG!=null&&aG.length>0){ak.setAttribute("cellPadding",aG)}else{ak.removeAttribute("cellPadding")}}),mxResources.get("spacing"));J.showDialog(aF.container,300,80,true,true);aF.init()}},M),this.editorUi.toolbar.addButton("geSprite-left",mxResources.get("left"),function(){if(ak!=null){ak.setAttribute("align","left")}},M),this.editorUi.toolbar.addButton("geSprite-center",mxResources.get("center"),function(){if(ak!=null){ak.setAttribute("align","center")}},M),this.editorUi.toolbar.addButton("geSprite-right",mxResources.get("right"),function(){if(ak!=null){ak.setAttribute("align","right")}},M)];this.styleButtons(K);K[2].style.marginRight="9px";if(mxClient.IS_QUIRKS){mxUtils.br(j);mxUtils.br(j)}j.appendChild(M);af.appendChild(j);b=j}function ah(i,aF){if(mxClient.IS_IE&&(mxClient.IS_QUIRKS||document.documentMode<10)){i.style.filter=(aF)?"progid:DXImageTransform.Microsoft.Gradient(StartColorStr='#c5ecff', EndColorStr='#87d4fb', GradientType=0)":""}else{i.style.backgroundImage=(aF)?"linear-gradient(#c5ecff 0px,#87d4fb 100%)":""}}var ay=mxUtils.bind(this,function(aH,aM,i){ag=this.format.getSelectionState();var aG=mxUtils.getValue(ag.style,mxConstants.STYLE_FONTSTYLE,0);ah(aA[0],(aG&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD);ah(aA[1],(aG&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC);ah(aA[2],(aG&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE);G.firstChild.nodeValue=mxUtils.htmlEntities(mxUtils.getValue(ag.style,mxConstants.STYLE_FONTFAMILY,Menus.prototype.defaultFont));ah(t,mxUtils.getValue(ag.style,mxConstants.STYLE_HORIZONTAL,"1")=="0");if(i||document.activeElement!=aB){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_FONTSIZE,Menus.prototype.defaultFontSize));aB.value=(isNaN(aI))?"":aI+" pt"}var aJ=mxUtils.getValue(ag.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER);ah(O,aJ==mxConstants.ALIGN_LEFT);ah(Z,aJ==mxConstants.ALIGN_CENTER);ah(Q,aJ==mxConstants.ALIGN_RIGHT);var aL=mxUtils.getValue(ag.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE);ah(ai,aL==mxConstants.ALIGN_TOP);ah(X,aL==mxConstants.ALIGN_MIDDLE);ah(l,aL==mxConstants.ALIGN_BOTTOM);var aK=mxUtils.getValue(ag.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);var aN=mxUtils.getValue(ag.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(aK==mxConstants.ALIGN_LEFT&&aN==mxConstants.ALIGN_TOP){Y.value="topLeft"}else{if(aK==mxConstants.ALIGN_CENTER&&aN==mxConstants.ALIGN_TOP){Y.value="top"}else{if(aK==mxConstants.ALIGN_RIGHT&&aN==mxConstants.ALIGN_TOP){Y.value="topRight"}else{if(aK==mxConstants.ALIGN_LEFT&&aN==mxConstants.ALIGN_BOTTOM){Y.value="bottomLeft"}else{if(aK==mxConstants.ALIGN_CENTER&&aN==mxConstants.ALIGN_BOTTOM){Y.value="bottom"}else{if(aK==mxConstants.ALIGN_RIGHT&&aN==mxConstants.ALIGN_BOTTOM){Y.value="bottomRight"}else{if(aK==mxConstants.ALIGN_LEFT){Y.value="left"}else{if(aK==mxConstants.ALIGN_RIGHT){Y.value="right"}else{Y.value="center"}}}}}}}}var aF=mxUtils.getValue(ag.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION);if(aF==mxConstants.TEXT_DIRECTION_RTL){E.value="rightToLeft"}else{if(aF==mxConstants.TEXT_DIRECTION_LTR){E.value="leftToRight"}else{if(aF==mxConstants.TEXT_DIRECTION_AUTO){E.value="automatic"}}}if(i||document.activeElement!=s){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_SPACING,2));s.value=(isNaN(aI))?"":aI+" pt"}if(i||document.activeElement!=ax){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_SPACING_TOP,0));ax.value=(isNaN(aI))?"":aI+" pt"}if(i||document.activeElement!=x){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_SPACING_RIGHT,0));x.value=(isNaN(aI))?"":aI+" pt"}if(i||document.activeElement!=D){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_SPACING_BOTTOM,0));D.value=(isNaN(aI))?"":aI+" pt"}if(i||document.activeElement!=v){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_SPACING_LEFT,0));v.value=(isNaN(aI))?"":aI+" pt"}});z=this.installInputHandler(s,mxConstants.STYLE_SPACING,2,-999,999," pt");T=this.installInputHandler(ax,mxConstants.STYLE_SPACING_TOP,0,-999,999," pt");e=this.installInputHandler(x,mxConstants.STYLE_SPACING_RIGHT,0,-999,999," pt");aa=this.installInputHandler(D,mxConstants.STYLE_SPACING_BOTTOM,0,-999,999," pt");ad=this.installInputHandler(v,mxConstants.STYLE_SPACING_LEFT,0,-999,999," pt");this.addKeyHandler(aB,ay);this.addKeyHandler(s,ay);this.addKeyHandler(ax,ay);this.addKeyHandler(x,ay);this.addKeyHandler(D,ay);this.addKeyHandler(v,ay);al.getModel().addListener(mxEvent.CHANGE,ay);this.listeners.push({destroy:function(){al.getModel().removeListener(ay)}});ay();if(al.cellEditor.isContentEditing()){var y=false;var W=function(){if(!y){y=true;window.setTimeout(function(){var aL=al.getSelectedElement();var aK=aL;while(aK!=null&&aK.nodeType!=mxConstants.NODETYPE_ELEMENT){aK=aK.parentNode}if(aK!=null){var aJ=mxUtils.getCurrentStyle(aK);if(aJ!=null){ah(aA[0],aJ.fontWeight=="bold"||al.getParentByName(aK,"B",al.cellEditor.textarea)!=null);ah(aA[1],aJ.fontStyle=="italic"||al.getParentByName(aK,"I",al.cellEditor.textarea)!=null);ah(aA[2],al.getParentByName(aK,"U",al.cellEditor.textarea)!=null);ah(O,aJ.textAlign=="left");ah(Z,aJ.textAlign=="center");ah(Q,aJ.textAlign=="right");ah(au,aJ.textAlign=="justify");ah(am,al.getParentByName(aK,"SUP",al.cellEditor.textarea)!=null);ah(at,al.getParentByName(aK,"SUB",al.cellEditor.textarea)!=null);ak=al.getParentByName(aK,"TABLE",al.cellEditor.textarea);p=(ak==null)?null:al.getParentByName(aK,"TR",ak);C=(ak==null)?null:al.getParentByName(aK,"TD",ak);b.style.display=(ak!=null)?"":"none";if(document.activeElement!=aB){if(aK.nodeName=="FONT"&&aK.getAttribute("size")=="4"&&A!=null){aK.removeAttribute("size");aK.style.fontSize=A+"px";A=null}else{aB.value=parseFloat(aJ.fontSize)+" pt"}var aI=aK.style.lineHeight||aJ.lineHeight;var aF=parseFloat(aI);if(aI.substring(aI.length-2)=="px"){aF=aF/parseFloat(aJ.fontSize)}if(aI.substring(aI.length-1)!="%"){aF*=100}ar.value=aF+" %"}var aH=aJ.color.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(aN,aM,aP,aO){return"#"+("0"+Number(aM).toString(16)).substr(-2)+("0"+Number(aP).toString(16)).substr(-2)+("0"+Number(aO).toString(16)).substr(-2)});var i=aJ.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(aN,aM,aP,aO){return"#"+("0"+Number(aM).toString(16)).substr(-2)+("0"+Number(aP).toString(16)).substr(-2)+("0"+Number(aO).toString(16)).substr(-2)});if(ao!=null){if(aH.charAt(0)=="#"){S=aH}else{S="#000000"}ao(S,true)}if(av!=null){if(i.charAt(0)=="#"){aj=i}else{aj=null}av(aj,true)}if(G.firstChild!=null){var aG=aJ.fontFamily;if(aG.charAt(0)=="'"){aG=aG.substring(1)}if(aG.charAt(aG.length-1)=="'"){aG=aG.substring(0,aG.length-1)}G.firstChild.nodeValue=aG}}}y=false},0)}};mxEvent.addListener(al.cellEditor.textarea,"input",W);mxEvent.addListener(al.cellEditor.textarea,"touchend",W);mxEvent.addListener(al.cellEditor.textarea,"mouseup",W);mxEvent.addListener(al.cellEditor.textarea,"keyup",W);this.listeners.push({destroy:function(){}});W()}return af};StyleFormatPanel=function(c,b,a){BaseFormatPanel.call(this,c,b,a);this.init()};mxUtils.extend(StyleFormatPanel,BaseFormatPanel);StyleFormatPanel.prototype.init=function(){var f=this.editorUi;var c=f.editor;var e=c.graph;var b=this.format.getSelectionState();if(!b.containsImage||b.style.shape=="image"){this.container.appendChild(this.addFill(this.createPanel()))}this.container.appendChild(this.addStroke(this.createPanel()));var d=this.createRelativeOption(mxResources.get("opacity"),mxConstants.STYLE_OPACITY,41);d.style.paddingTop="8px";d.style.paddingBottom="8px";this.container.appendChild(d);this.container.appendChild(this.addEffects(this.createPanel()));var a=this.addEditOps(this.createPanel());if(a.firstChild!=null){mxUtils.br(a)}this.container.appendChild(this.addStyleOps(a))};StyleFormatPanel.prototype.addEditOps=function(d){var b=this.format.getSelectionState();var a=null;if(this.editorUi.editor.graph.getSelectionCount()==1){a=mxUtils.button(mxResources.get("editStyle"),mxUtils.bind(this,function(e){this.editorUi.actions.get("editStyle").funct()}));a.setAttribute("title",mxResources.get("editStyle")+" ("+this.editorUi.actions.get("editStyle").shortcut+")");a.style.width="202px";a.style.marginBottom="2px";d.appendChild(a)}if(b.image){var c=mxUtils.button(mxResources.get("editImage"),mxUtils.bind(this,function(e){this.editorUi.actions.get("image").funct()}));c.setAttribute("title",mxResources.get("editImage"));c.style.marginBottom="2px";if(a==null){c.style.width="202px"}else{a.style.width="100px";c.style.width="100px";c.style.marginLeft="2px"}d.appendChild(c)}return d};StyleFormatPanel.prototype.addFill=function(a){var j=this.editorUi;var m=j.editor.graph;var n=this.format.getSelectionState();a.style.paddingTop="6px";a.style.paddingBottom="6px";var e=document.createElement("select");e.style.position="absolute";e.style.marginTop="-2px";e.style.right=(mxClient.IS_QUIRKS)?"52px":"72px";e.style.width="70px";mxEvent.addListener(e,"click",function(i){mxEvent.consume(i)});var g=this.createCellColorOption(mxResources.get("gradient"),mxConstants.STYLE_GRADIENTCOLOR,"#ffffff",function(i){if(i==null||i==mxConstants.NONE){e.style.display="none"}else{e.style.display=""}});var l=(n.style.shape=="image")?mxConstants.STYLE_IMAGE_BACKGROUND:mxConstants.STYLE_FILLCOLOR;var k=this.createCellColorOption(mxResources.get("fill"),l,"#ffffff");k.style.fontWeight="bold";var h=mxUtils.getValue(n.style,l,null);g.style.display=(h!=null&&h!=mxConstants.NONE&&n.fill&&n.style.shape!="image")?"":"none";var f=[mxConstants.DIRECTION_NORTH,mxConstants.DIRECTION_EAST,mxConstants.DIRECTION_SOUTH,mxConstants.DIRECTION_WEST];for(var d=0;d<f.length;d++){var c=document.createElement("option");c.setAttribute("value",f[d]);mxUtils.write(c,mxResources.get(f[d]));e.appendChild(c)}g.appendChild(e);var b=mxUtils.bind(this,function(){n=this.format.getSelectionState();var i=mxUtils.getValue(n.style,mxConstants.STYLE_GRADIENT_DIRECTION,mxConstants.DIRECTION_SOUTH);if(i==""){i=mxConstants.DIRECTION_SOUTH}e.value=i;a.style.display=(n.fill)?"":"none";var o=mxUtils.getValue(n.style,mxConstants.STYLE_FILLCOLOR,null);if(!n.fill||n.containsImage||o==null||o==mxConstants.NONE){g.style.display="none"}else{g.style.display=""}});m.getModel().addListener(mxEvent.CHANGE,b);this.listeners.push({destroy:function(){m.getModel().removeListener(b)}});b();mxEvent.addListener(e,"change",function(i){m.setCellStyles(mxConstants.STYLE_GRADIENT_DIRECTION,e.value,m.getSelectionCells());mxEvent.consume(i)});a.appendChild(k);a.appendChild(g);if(n.style.shape=="swimlane"){a.appendChild(this.createCellColorOption(mxResources.get("laneColor"),"swimlaneFillColor","#ffffff"))}return a};StyleFormatPanel.prototype.addStroke=function(z){var C=this.editorUi;var D=C.editor.graph;var d=this.format.getSelectionState();z.style.paddingTop="4px";z.style.paddingBottom="4px";z.style.whiteSpace="normal";var r=document.createElement("div");r.style.fontWeight="bold";var I=document.createElement("select");I.style.position="absolute";I.style.marginTop="-2px";I.style.right="72px";I.style.width="80px";var v=["sharp","rounded","curved"];for(var M=0;M<v.length;M++){var F=document.createElement("option");F.setAttribute("value",v[M]);mxUtils.write(F,mxResources.get(v[M]));I.appendChild(F)}mxEvent.addListener(I,"change",function(V){D.getModel().beginUpdate();try{var Y=[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED];var W=["0",null];if(I.value=="rounded"){W=["1",null]}else{if(I.value=="curved"){W=[null,"1"]}}for(var X=0;X<Y.length;X++){D.setCellStyles(Y[X],W[X],D.getSelectionCells())}C.fireEvent(new mxEventObject("styleChanged","keys",Y,"values",W,"cells",D.getSelectionCells()))}finally{D.getModel().endUpdate()}mxEvent.consume(V)});mxEvent.addListener(I,"click",function(i){mxEvent.consume(i)});var P=(d.style.shape=="image")?mxConstants.STYLE_IMAGE_BORDER:mxConstants.STYLE_STROKECOLOR;var S=this.createCellColorOption(mxResources.get("line"),P,"#000000");S.appendChild(I);r.appendChild(S);var g=r.cloneNode(false);g.style.fontWeight="normal";g.style.whiteSpace="nowrap";g.style.position="relative";g.style.paddingLeft="16px";g.style.marginBottom="2px";g.style.marginTop="2px";g.className="geToolbarContainer";var Q=mxUtils.bind(this,function(Z,W,aa,Y,i){var X=this.editorUi.menus.styleChange(Z,"",Y,i,"geIcon",null);var V=document.createElement("div");V.style.width=W+"px";V.style.height="1px";V.style.borderBottom="1px "+aa+" black";V.style.paddingTop="6px";X.firstChild.firstChild.style.padding="0px 4px 0px 4px";X.firstChild.firstChild.style.width=W+"px";X.firstChild.firstChild.appendChild(V);return X});var b=this.editorUi.toolbar.addMenuFunctionInContainer(g,"geSprite-orthogonal",mxResources.get("pattern"),false,mxUtils.bind(this,function(i){Q(i,75,"solid",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],[null,null]).setAttribute("title",mxResources.get("solid"));Q(i,75,"dashed",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1",null]).setAttribute("title",mxResources.get("dashed"));Q(i,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 1"]).setAttribute("title",mxResources.get("dotted")+" (1)");Q(i,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 2"]).setAttribute("title",mxResources.get("dotted")+" (2)");Q(i,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 4"]).setAttribute("title",mxResources.get("dotted")+" (3)")}));var q=g.cloneNode(false);var l=this.editorUi.toolbar.addMenuFunctionInContainer(q,"geSprite-connection",mxResources.get("connection"),false,mxUtils.bind(this,function(i){this.editorUi.menus.styleChange(i,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],[null,null,null,null],"geIcon geSprite geSprite-connection",null,true).setAttribute("title",mxResources.get("line"));this.editorUi.menus.styleChange(i,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["link",null,null,null],"geIcon geSprite geSprite-linkedge",null,true).setAttribute("title",mxResources.get("link"));this.editorUi.menus.styleChange(i,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["flexArrow",null,null,null],"geIcon geSprite geSprite-arrow",null,true).setAttribute("title",mxResources.get("arrow"));this.editorUi.menus.styleChange(i,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["arrow",null,null,null],"geIcon geSprite geSprite-simplearrow",null,true).setAttribute("title",mxResources.get("simpleArrow"))}));var h=this.editorUi.toolbar.addMenuFunctionInContainer(q,"geSprite-orthogonal",mxResources.get("pattern"),false,mxUtils.bind(this,function(i){Q(i,33,"solid",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],[null,null]).setAttribute("title",mxResources.get("solid"));Q(i,33,"dashed",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1",null]).setAttribute("title",mxResources.get("dashed"));Q(i,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 1"]).setAttribute("title",mxResources.get("dotted")+" (1)");Q(i,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 2"]).setAttribute("title",mxResources.get("dotted")+" (2)");Q(i,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 4"]).setAttribute("title",mxResources.get("dotted")+" (3)")}));var U=g.cloneNode(false);var a=document.createElement("input");a.style.textAlign="right";a.style.marginTop="2px";a.style.width="41px";a.setAttribute("title",mxResources.get("linewidth"));g.appendChild(a);var u=a.cloneNode(true);q.appendChild(u);function w(i){var V=parseInt(a.value);V=Math.min(999,Math.max(1,(isNaN(V))?1:V));if(V!=mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1)){D.setCellStyles(mxConstants.STYLE_STROKEWIDTH,V,D.getSelectionCells());C.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_STROKEWIDTH],"values",[V],"cells",D.getSelectionCells()))}a.value=V+" pt";mxEvent.consume(i)}function c(i){var V=parseInt(u.value);V=Math.min(999,Math.max(1,(isNaN(V))?1:V));if(V!=mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1)){D.setCellStyles(mxConstants.STYLE_STROKEWIDTH,V,D.getSelectionCells());C.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_STROKEWIDTH],"values",[V],"cells",D.getSelectionCells()))}u.value=V+" pt";mxEvent.consume(i)}var j=this.createStepper(a,w,1,9);j.style.display=a.style.display;j.style.marginTop="2px";g.appendChild(j);var t=this.createStepper(u,c,1,9);t.style.display=u.style.display;t.style.marginTop="2px";q.appendChild(t);if(!mxClient.IS_QUIRKS){a.style.position="absolute";a.style.right="32px";a.style.height="15px";j.style.right="20px";u.style.position="absolute";u.style.right="32px";u.style.height="15px";t.style.right="20px"}else{a.style.height="17px";u.style.height="17px"}mxEvent.addListener(a,"blur",w);mxEvent.addListener(a,"change",w);mxEvent.addListener(u,"blur",c);mxEvent.addListener(u,"change",c);if(mxClient.IS_QUIRKS){mxUtils.br(U);mxUtils.br(U)}var G=this.editorUi.toolbar.addMenuFunctionInContainer(U,"geSprite-orthogonal",mxResources.get("waypoints"),false,mxUtils.bind(this,function(i){if(d.style.shape!="arrow"){this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",null,true).setAttribute("title",mxResources.get("straight"));this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",null,true).setAttribute("title",mxResources.get("orthogonal"));this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",null,true).setAttribute("title",mxResources.get("simple"));this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",null,true).setAttribute("title",mxResources.get("simple"));this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",null,true).setAttribute("title",mxResources.get("isometric"));this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",null,true).setAttribute("title",mxResources.get("isometric"));if(d.style.shape=="connector"){this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",null,true).setAttribute("title",mxResources.get("curved"))}this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",null,true).setAttribute("title",mxResources.get("entityRelation"))}}));var O=this.editorUi.toolbar.addMenuFunctionInContainer(U,"geSprite-startclassic",mxResources.get("linestart"),false,mxUtils.bind(this,function(V){if(d.style.shape=="connector"||d.style.shape=="flexArrow"){var i=this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.NONE,0],"geIcon",null,false);i.setAttribute("title",mxResources.get("none"));i.firstChild.firstChild.innerHTML='<font style="font-size:10px;">'+mxUtils.htmlEntities(mxResources.get("none"))+"</font>";if(d.style.shape=="connector"){this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-startclassic",null,false).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC_THIN,1],"geIcon geSprite geSprite-startclassicthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN,0],"geIcon geSprite geSprite-startopen",null,false).setAttribute("title",mxResources.get("openArrow"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN_THIN,0],"geIcon geSprite geSprite-startopenthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["openAsync",0],"geIcon geSprite geSprite-startopenasync",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-startblock",null,false).setAttribute("title",mxResources.get("block"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK_THIN,1],"geIcon geSprite geSprite-startblockthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["async",1],"geIcon geSprite geSprite-startasync",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-startoval",null,false).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-startdiamond",null,false).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-startthindiamond",null,false).setAttribute("title",mxResources.get("diamondThin"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-startclassictrans",null,false).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC_THIN,0],"geIcon geSprite geSprite-startclassicthintrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-startblocktrans",null,false).setAttribute("title",mxResources.get("block"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK_THIN,0],"geIcon geSprite geSprite-startblockthintrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["async",0],"geIcon geSprite geSprite-startasynctrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-startovaltrans",null,false).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-startdiamondtrans",null,false).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-startthindiamondtrans",null,false).setAttribute("title",mxResources.get("diamondThin"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["dash",0],"geIcon geSprite geSprite-startdash",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["cross",0],"geIcon geSprite geSprite-startcross",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["circlePlus",0],"geIcon geSprite geSprite-startcircleplus",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["circle",1],"geIcon geSprite geSprite-startcircle",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERone",0],"geIcon geSprite geSprite-starterone",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERmandOne",0],"geIcon geSprite geSprite-starteronetoone",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERmany",0],"geIcon geSprite geSprite-startermany",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERoneToMany",0],"geIcon geSprite geSprite-starteronetomany",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERzeroToOne",1],"geIcon geSprite geSprite-starteroneopt",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERzeroToMany",1],"geIcon geSprite geSprite-startermanyopt",null,false)}else{this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_BLOCK],"geIcon geSprite geSprite-startblocktrans",null,false).setAttribute("title",mxResources.get("block"))}}}));var N=this.editorUi.toolbar.addMenuFunctionInContainer(U,"geSprite-endclassic",mxResources.get("lineend"),false,mxUtils.bind(this,function(V){if(d.style.shape=="connector"||d.style.shape=="flexArrow"){var i=this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.NONE,0],"geIcon",null,false);i.setAttribute("title",mxResources.get("none"));i.firstChild.firstChild.innerHTML='<font style="font-size:10px;">'+mxUtils.htmlEntities(mxResources.get("none"))+"</font>";if(d.style.shape=="connector"){this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-endclassic",null,false).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC_THIN,1],"geIcon geSprite geSprite-endclassicthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN,0],"geIcon geSprite geSprite-endopen",null,false).setAttribute("title",mxResources.get("openArrow"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN_THIN,0],"geIcon geSprite geSprite-endopenthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["openAsync",0],"geIcon geSprite geSprite-endopenasync",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-endblock",null,false).setAttribute("title",mxResources.get("block"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK_THIN,1],"geIcon geSprite geSprite-endblockthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["async",1],"geIcon geSprite geSprite-endasync",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-endoval",null,false).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-enddiamond",null,false).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-endthindiamond",null,false).setAttribute("title",mxResources.get("diamondThin"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-endclassictrans",null,false).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC_THIN,0],"geIcon geSprite geSprite-endclassicthintrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-endblocktrans",null,false).setAttribute("title",mxResources.get("block"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK_THIN,0],"geIcon geSprite geSprite-endblockthintrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["async",0],"geIcon geSprite geSprite-endasynctrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-endovaltrans",null,false).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-enddiamondtrans",null,false).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-endthindiamondtrans",null,false).setAttribute("title",mxResources.get("diamondThin"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["dash",0],"geIcon geSprite geSprite-enddash",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["cross",0],"geIcon geSprite geSprite-endcross",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["circlePlus",0],"geIcon geSprite geSprite-endcircleplus",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["circle",1],"geIcon geSprite geSprite-endcircle",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERone",0],"geIcon geSprite geSprite-enderone",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERmandOne",0],"geIcon geSprite geSprite-enderonetoone",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERmany",0],"geIcon geSprite geSprite-endermany",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERoneToMany",0],"geIcon geSprite geSprite-enderonetomany",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERzeroToOne",1],"geIcon geSprite geSprite-enderoneopt",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERzeroToMany",1],"geIcon geSprite geSprite-endermanyopt",null,false)}else{this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_BLOCK],"geIcon geSprite geSprite-endblocktrans",null,false).setAttribute("title",mxResources.get("block"))}}}));this.addArrow(l,8);this.addArrow(G);this.addArrow(O);this.addArrow(N);var f=this.addArrow(b,9);f.className="geIcon";f.style.width="84px";var H=this.addArrow(h,9);H.className="geIcon";H.style.width="22px";var e=document.createElement("div");e.style.width="85px";e.style.height="1px";e.style.borderBottom="1px solid black";e.style.marginBottom="9px";f.appendChild(e);var E=document.createElement("div");E.style.width="23px";E.style.height="1px";E.style.borderBottom="1px solid black";E.style.marginBottom="9px";H.appendChild(E);b.style.height="15px";h.style.height="15px";l.style.height="15px";G.style.height="17px";O.style.marginLeft="3px";O.style.height="17px";N.style.marginLeft="3px";N.style.height="17px";z.appendChild(r);z.appendChild(q);z.appendChild(g);var o=g.cloneNode(false);o.style.paddingBottom="6px";o.style.paddingTop="4px";o.style.fontWeight="normal";var m=document.createElement("div");m.style.position="absolute";m.style.marginLeft="3px";m.style.marginBottom="12px";m.style.marginTop="2px";m.style.fontWeight="normal";m.style.width="76px";mxUtils.write(m,mxResources.get("lineend"));o.appendChild(m);var n,x;var y=this.addUnitInput(o,"pt",74,33,function(){n.apply(this,arguments)});var B=this.addUnitInput(o,"pt",20,33,function(){x.apply(this,arguments)});mxUtils.br(o);var L=document.createElement("div");L.style.height="8px";o.appendChild(L);m=m.cloneNode(false);mxUtils.write(m,mxResources.get("linestart"));o.appendChild(m);var s,K;var k=this.addUnitInput(o,"pt",74,33,function(){s.apply(this,arguments)});var p=this.addUnitInput(o,"pt",20,33,function(){K.apply(this,arguments)});mxUtils.br(o);this.addLabel(o,mxResources.get("spacing"),74,50);this.addLabel(o,mxResources.get("size"),20,50);mxUtils.br(o);var A=r.cloneNode(false);A.style.fontWeight="normal";A.style.position="relative";A.style.paddingLeft="16px";A.style.marginBottom="2px";A.style.marginTop="6px";A.style.borderWidth="0px";A.style.paddingBottom="18px";var m=document.createElement("div");m.style.position="absolute";m.style.marginLeft="3px";m.style.marginBottom="12px";m.style.marginTop="1px";m.style.fontWeight="normal";m.style.width="120px";mxUtils.write(m,mxResources.get("perimeter"));A.appendChild(m);var R;var T=this.addUnitInput(A,"pt",20,41,function(){R.apply(this,arguments)});if(d.edges.length==D.getSelectionCount()){z.appendChild(U);if(mxClient.IS_QUIRKS){mxUtils.br(z);mxUtils.br(z)}z.appendChild(o)}else{if(d.vertices.length==D.getSelectionCount()){if(mxClient.IS_QUIRKS){mxUtils.br(z)}z.appendChild(A)}}var J=mxUtils.bind(this,function(X,ae,i){d=this.format.getSelectionState();var W=mxUtils.getValue(d.style,P,null);if(i||document.activeElement!=a){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1));a.value=(isNaN(Y))?"":Y+" pt"}if(i||document.activeElement!=u){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1));u.value=(isNaN(Y))?"":Y+" pt"}I.style.visibility=(d.style.shape=="connector")?"":"hidden";if(mxUtils.getValue(d.style,mxConstants.STYLE_CURVED,null)=="1"){I.value="curved"}else{if(mxUtils.getValue(d.style,mxConstants.STYLE_ROUNDED,null)=="1"){I.value="rounded"}}if(mxUtils.getValue(d.style,mxConstants.STYLE_DASHED,null)=="1"){if(mxUtils.getValue(d.style,mxConstants.STYLE_DASH_PATTERN,null)==null){e.style.borderBottom="1px dashed black"}else{e.style.borderBottom="1px dotted black"}}else{e.style.borderBottom="1px solid black"}E.style.borderBottom=e.style.borderBottom;var ac=G.getElementsByTagName("div")[0];var ad=mxUtils.getValue(d.style,mxConstants.STYLE_EDGE,null);if(mxUtils.getValue(d.style,mxConstants.STYLE_NOEDGESTYLE,null)=="1"){ad=null}if(ad=="orthogonalEdgeStyle"&&mxUtils.getValue(d.style,mxConstants.STYLE_CURVED,null)=="1"){ac.className="geSprite geSprite-curved"}else{if(ad=="straight"||ad=="none"||ad==null){ac.className="geSprite geSprite-straight"}else{if(ad=="entityRelationEdgeStyle"){ac.className="geSprite geSprite-entity"}else{if(ad=="elbowEdgeStyle"){ac.className="geSprite "+((mxUtils.getValue(d.style,mxConstants.STYLE_ELBOW,null)=="vertical")?"geSprite-verticalelbow":"geSprite-horizontalelbow")}else{if(ad=="isometricEdgeStyle"){ac.className="geSprite "+((mxUtils.getValue(d.style,mxConstants.STYLE_ELBOW,null)=="vertical")?"geSprite-verticalisometric":"geSprite-horizontalisometric")}else{ac.className="geSprite geSprite-orthogonal"}}}}}var aa=l.getElementsByTagName("div")[0];if(d.style.shape=="link"){aa.className="geSprite geSprite-linkedge"}else{if(d.style.shape=="flexArrow"){aa.className="geSprite geSprite-arrow"}else{if(d.style.shape=="arrow"){aa.className="geSprite geSprite-simplearrow"}else{aa.className="geSprite geSprite-connection"}}}if(d.edges.length==D.getSelectionCount()){q.style.display="";g.style.display="none"}else{q.style.display="none";g.style.display=""}function ab(af,aj,ah,ai){var ag=ah.getElementsByTagName("div")[0];ag.className=C.getCssClassForMarker(ai,d.style.shape,af,aj);if(ag.className=="geSprite geSprite-noarrow"){ag.innerHTML=mxUtils.htmlEntities(mxResources.get("none"));ag.style.backgroundImage="none";ag.style.verticalAlign="top";ag.style.marginTop="5px";ag.style.fontSize="10px";ag.nextSibling.style.marginTop="0px"}return ag}var Z=ab(mxUtils.getValue(d.style,mxConstants.STYLE_STARTARROW,null),mxUtils.getValue(d.style,"startFill","1"),O,"start");var V=ab(mxUtils.getValue(d.style,mxConstants.STYLE_ENDARROW,null),mxUtils.getValue(d.style,"endFill","1"),N,"end");if(d.style.shape=="arrow"){Z.className="geSprite geSprite-noarrow";V.className="geSprite geSprite-endblocktrans"}else{if(d.style.shape=="link"){Z.className="geSprite geSprite-noarrow";V.className="geSprite geSprite-noarrow"}}mxUtils.setOpacity(G,(d.style.shape=="arrow")?30:100);if(d.style.shape!="connector"&&d.style.shape!="flexArrow"){mxUtils.setOpacity(O,30);mxUtils.setOpacity(N,30)}else{mxUtils.setOpacity(O,100);mxUtils.setOpacity(N,100)}if(i||document.activeElement!=p){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE));p.value=(isNaN(Y))?"":Y+" pt"}if(i||document.activeElement!=k){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_SOURCE_PERIMETER_SPACING,0));k.value=(isNaN(Y))?"":Y+" pt"}if(i||document.activeElement!=B){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE));B.value=(isNaN(Y))?"":Y+" pt"}if(i||document.activeElement!=k){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_TARGET_PERIMETER_SPACING,0));y.value=(isNaN(Y))?"":Y+" pt"}if(i||document.activeElement!=T){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_PERIMETER_SPACING,0));T.value=(isNaN(Y))?"":Y+" pt"}});K=this.installInputHandler(p,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE,0,999," pt");s=this.installInputHandler(k,mxConstants.STYLE_SOURCE_PERIMETER_SPACING,0,-999,999," pt");x=this.installInputHandler(B,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE,0,999," pt");n=this.installInputHandler(y,mxConstants.STYLE_TARGET_PERIMETER_SPACING,0,-999,999," pt");R=this.installInputHandler(T,mxConstants.STYLE_PERIMETER_SPACING,0,0,999," pt");this.addKeyHandler(a,J);this.addKeyHandler(p,J);this.addKeyHandler(k,J);this.addKeyHandler(B,J);this.addKeyHandler(y,J);this.addKeyHandler(T,J);D.getModel().addListener(mxEvent.CHANGE,J);this.listeners.push({destroy:function(){D.getModel().removeListener(J)}});J();return z};StyleFormatPanel.prototype.addEffects=function(a){var h=this.editorUi;var f=h.editor;var k=f.graph;var n=this.format.getSelectionState();a.style.paddingTop="0px";a.style.paddingBottom="2px";var l=document.createElement("table");if(mxClient.IS_QUIRKS){l.style.fontSize="1em"}l.style.width="100%";l.style.fontWeight="bold";l.style.paddingRight="20px";var d=document.createElement("tbody");var m=document.createElement("tr");m.style.padding="0px";var c=document.createElement("td");c.style.padding="0px";c.style.width="50%";c.setAttribute("valign","top");var j=c.cloneNode(true);j.style.paddingLeft="8px";m.appendChild(c);m.appendChild(j);d.appendChild(m);l.appendChild(d);a.appendChild(l);var g=c;var e=0;var i=mxUtils.bind(this,function(p,r,o){var q=this.createCellOption(p,r,o);q.style.width="100%";g.appendChild(q);g=(g==c)?j:c;e++});var b=mxUtils.bind(this,function(p,o,q){n=this.format.getSelectionState();c.innerHTML="";j.innerHTML="";g=c;if(n.rounded){i(mxResources.get("rounded"),mxConstants.STYLE_ROUNDED,0)}if(n.style.shape=="swimlane"){i(mxResources.get("divider"),"swimlaneLine",1)}if(!n.containsImage){i(mxResources.get("shadow"),mxConstants.STYLE_SHADOW,0)}if(n.glass){i(mxResources.get("glass"),mxConstants.STYLE_GLASS,0)}if(n.comic){i(mxResources.get("comic"),"comic",0)}if(e==0){a.style.display="none"}});k.getModel().addListener(mxEvent.CHANGE,b);this.listeners.push({destroy:function(){k.getModel().removeListener(b)}});b();return a};StyleFormatPanel.prototype.addStyleOps=function(b){b.style.paddingTop="10px";b.style.paddingBottom="10px";var a=mxUtils.button(mxResources.get("setAsDefaultStyle"),mxUtils.bind(this,function(c){this.editorUi.actions.get("setAsDefaultStyle").funct()}));a.setAttribute("title",mxResources.get("setAsDefaultStyle")+" ("+this.editorUi.actions.get("setAsDefaultStyle").shortcut+")");a.style.width="202px";b.appendChild(a);return b};DiagramFormatPanel=function(c,b,a){BaseFormatPanel.call(this,c,b,a);this.init()};mxUtils.extend(DiagramFormatPanel,BaseFormatPanel);DiagramFormatPanel.prototype.showBackgroundImageOption=true;DiagramFormatPanel.prototype.init=function(){var c=this.editorUi;var a=c.editor;var b=a.graph;this.container.appendChild(this.addView(this.createPanel()));if(b.isEnabled()){this.container.appendChild(this.addOptions(this.createPanel()));this.container.appendChild(this.addPaperSize(this.createPanel()));this.container.appendChild(this.addStyleOps(this.createPanel()))}};DiagramFormatPanel.prototype.addView=function(f){var e=this.editorUi;var c=e.editor;var d=c.graph;f.appendChild(this.createTitle(mxResources.get("view")));this.addGridOption(f);if(d.isEnabled()){f.appendChild(this.createOption(mxResources.get("guides"),function(){return d.graphHandler.guidesEnabled},function(g){e.actions.get("guides").funct()},{install:function(g){this.listener=function(){g(d.graphHandler.guidesEnabled)};e.addListener("guidesEnabledChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}}));f.appendChild(this.createOption(mxResources.get("pageView"),function(){return d.pageVisible},function(g){e.actions.get("pageView").funct()},{install:function(g){this.listener=function(){g(d.pageVisible)};e.addListener("pageViewChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}}));var b=this.createColorOption(mxResources.get("background"),function(){return d.background},function(g){e.setBackgroundColor(g)},"#ffffff",{install:function(g){this.listener=function(){g(d.background)};e.addListener("backgroundColorChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}});if(this.showBackgroundImageOption){var a=mxUtils.button(mxResources.get("image"),function(g){e.showBackgroundImageDialog();mxEvent.consume(g)});a.style.position="absolute";a.className="geColorBtn";a.style.marginTop="-4px";a.style.paddingBottom=(document.documentMode==11||mxClient.IS_MT)?"0px":"2px";a.style.height="22px";a.style.right=(mxClient.IS_QUIRKS)?"52px":"72px";a.style.width="56px";b.appendChild(a)}f.appendChild(b)}return f};DiagramFormatPanel.prototype.addOptions=function(d){var c=this.editorUi;var a=c.editor;var b=a.graph;d.appendChild(this.createTitle(mxResources.get("options")));if(b.isEnabled()){d.appendChild(this.createOption(mxResources.get("connectionArrows"),function(){return b.connectionArrowsEnabled},function(e){c.actions.get("connectionArrows").funct()},{install:function(e){this.listener=function(){e(b.connectionArrowsEnabled)};c.addListener("connectionArrowsChanged",this.listener)},destroy:function(){c.removeListener(this.listener)}}));d.appendChild(this.createOption(mxResources.get("connectionPoints"),function(){return b.connectionHandler.isEnabled()},function(e){c.actions.get("connectionPoints").funct()},{install:function(e){this.listener=function(){e(b.connectionHandler.isEnabled())};c.addListener("connectionPointsChanged",this.listener)},destroy:function(){c.removeListener(this.listener)}}))}return d};DiagramFormatPanel.prototype.addGridOption=function(c){var f=this.editorUi;var e=f.editor.graph;var d=document.createElement("input");d.style.position="absolute";d.style.textAlign="right";d.style.width="38px";d.value=e.getGridSize()+" pt";var a=this.createStepper(d,g);d.style.display=(e.isGridEnabled())?"":"none";a.style.display=d.style.display;mxEvent.addListener(d,"keydown",function(h){if(h.keyCode==13){e.container.focus();mxEvent.consume(h)}else{if(h.keyCode==27){d.value=e.getGridSize();e.container.focus();mxEvent.consume(h)}}});function g(h){var i=parseInt(d.value);i=Math.max(1,(isNaN(i))?10:i);if(i!=e.getGridSize()){e.setGridSize(i)}d.value=i+" pt";mxEvent.consume(h)}mxEvent.addListener(d,"blur",g);mxEvent.addListener(d,"change",g);if(mxClient.IS_SVG){d.style.marginTop="-2px";d.style.right="84px";a.style.marginTop="-16px";a.style.right="72px";var b=this.createColorOption(mxResources.get("grid"),function(){var h=e.view.gridColor;return(e.isGridEnabled())?h:null},function(h){if(h==mxConstants.NONE){e.setGridEnabled(false);f.fireEvent(new mxEventObject("gridEnabledChanged"))}else{e.setGridEnabled(true);f.setGridColor(h)}d.style.display=(e.isGridEnabled())?"":"none";a.style.display=d.style.display},"#e0e0e0",{install:function(h){this.listener=function(){h((e.isGridEnabled())?e.view.gridColor:null)};f.addListener("gridColorChanged",this.listener);f.addListener("gridEnabledChanged",this.listener)},destroy:function(){f.removeListener(this.listener)}});b.appendChild(d);b.appendChild(a);c.appendChild(b)}else{d.style.marginTop="2px";d.style.right="32px";a.style.marginTop="2px";a.style.right="20px";c.appendChild(d);c.appendChild(a);c.appendChild(this.createOption(mxResources.get("grid"),function(){return e.isGridEnabled()},function(h){e.setGridEnabled(h);if(e.isGridEnabled()){e.view.gridColor="#e0e0e0"}f.fireEvent(new mxEventObject("gridEnabledChanged"))},{install:function(h){this.listener=function(){d.style.display=(e.isGridEnabled())?"":"none";a.style.display=d.style.display;h(e.isGridEnabled())};f.addListener("gridEnabledChanged",this.listener)},destroy:function(){f.removeListener(this.listener)}}))}};DiagramFormatPanel.prototype.addDocumentProperties=function(d){var c=this.editorUi;var a=c.editor;var b=a.graph;d.appendChild(this.createTitle(mxResources.get("options")));return d};DiagramFormatPanel.prototype.addPaperSize=function(f){var e=this.editorUi;var b=e.editor;var d=b.graph;f.appendChild(this.createTitle(mxResources.get("paperSize")));var a=PageSetupDialog.addPageFormatPanel(f,"formatpanel",d.pageFormat,function(g){if(d.pageFormat==null||d.pageFormat.width!=g.width||d.pageFormat.height!=g.height){e.setPageFormat(g)}});this.addKeyHandler(a.widthInput,function(){console.log("here",d.pageFormat);a.set(d.pageFormat)});-this.addKeyHandler(a.heightInput,function(){a.set(d.pageFormat)});var c=function(){a.set(d.pageFormat)};e.addListener("pageFormatChanged",c);this.listeners.push({destroy:function(){e.removeListener(c)}});d.getModel().addListener(mxEvent.CHANGE,c);this.listeners.push({destroy:function(){d.getModel().removeListener(c)}});return f};DiagramFormatPanel.prototype.addStyleOps=function(b){var a=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(c){this.editorUi.actions.get("editData").funct()}));a.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")");a.style.width="202px";a.style.marginBottom="2px";b.appendChild(a);mxUtils.br(b);a=mxUtils.button(mxResources.get("clearDefaultStyle"),mxUtils.bind(this,function(c){this.editorUi.actions.get("clearDefaultStyle").funct()}));a.setAttribute("title",mxResources.get("clearDefaultStyle")+" ("+this.editorUi.actions.get("clearDefaultStyle").shortcut+")");a.style.width="202px";b.appendChild(a);return b};DiagramFormatPanel.prototype.destroy=function(){BaseFormatPanel.prototype.destroy.apply(this,arguments);if(this.gridEnabledListener){this.editorUi.removeListener(this.gridEnabledListener);this.gridEnabledListener=null}};