Editor=function(b,a,c,d){mxEventSource.call(this);this.chromeless=(b!=null)?b:this.chromeless;this.initStencilRegistry();this.graph=d||this.createGraph(a,c);this.undoManager=this.createUndoManager();this.status="";this.getOrCreateFilename=function(){return this.filename||mxResources.get("drawing",[Editor.pageCounter])+".xml"};this.getFilename=function(){return this.filename};this.setStatus=function(e){this.status=e;this.fireEvent(new mxEventObject("statusChanged"))};this.getStatus=function(){return this.status};this.graphChangeListener=function(f,e){var g=(e!=null)?e.getProperty("edit"):null;if(g==null||!g.ignoreEdit){this.setModified(true)}};this.graph.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.graphChangeListener.apply(this,arguments)}));this.graph.resetViewOnRootChange=false;this.init()};Editor.pageCounter=0;(function(){try{var b=window;while(b.opener!=null&&typeof b.opener.Editor!=="undefined"&&!isNaN(b.opener.Editor.pageCounter)&&b.opener!=b){b=b.opener}if(b!=null){b.Editor.pageCounter++;Editor.pageCounter=b.Editor.pageCounter}}catch(a){}})();Editor.useLocalStorage=typeof(Storage)!="undefined"&&mxClient.IS_IOS;Editor.helpImage=(mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAXVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC5BxTwAAAAH3RSTlMAlUF8boNQIE0LBgOgkGlHNSwqFIx/dGVUOjApmV9ezNACSAAAAIVJREFUGNNtjNsOgzAMQ5NeoVcKDAZs+//PXLKI8YKlWvaRU7jXuFpb9qsbdK05XILUiE8JHQox1Pv3OgFUzf1AGqWqUg+QBwLF0YAeegBlCNgRWOpB5vUfTCmeoHQ/wNdy0jLH/cM+b+wLTw4n/7ACEmHVVy8h6qy8V7MNcGowWpsNbvUFcGUEdSi1s/oAAAAASUVORK5CYII=":IMAGE_PATH+"/help.png";Editor.checkmarkImage=(mxClient.IS_SVG)?"data:image/gif;base64,R0lGODlhFQAVAMQfAGxsbHx8fIqKioaGhvb29nJycvr6+sDAwJqamltbW5OTk+np6YGBgeTk5Ly8vJiYmP39/fLy8qWlpa6ursjIyOLi4vj4+N/f3+3t7fT09LCwsHZ2dubm5r6+vmZmZv///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEY4NTZERTQ5QUFBMTFFMUE5MTVDOTM5MUZGMTE3M0QiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEY4NTZERTU5QUFBMTFFMUE5MTVDOTM5MUZGMTE3M0QiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Rjg1NkRFMjlBQUExMUUxQTkxNUM5MzkxRkYxMTczRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Rjg1NkRFMzlBQUExMUUxQTkxNUM5MzkxRkYxMTczRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAB8ALAAAAAAVABUAAAVI4CeOZGmeaKqubKtylktSgCOLRyLd3+QJEJnh4VHcMoOfYQXQLBcBD4PA6ngGlIInEHEhPOANRkaIFhq8SuHCE1Hb8Lh8LgsBADs=":IMAGE_PATH+"/checkmark.gif";Editor.maximizeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAElBMVEUAAAAAAAAAAAAAAAAAAAAAAADgKxmiAAAABXRSTlMA758vX1Pw3BoAAABJSURBVAjXY8AJQkODGBhUQ0MhbAUGBiYY24CBgRnGFmZgMISwgwwDGRhEhVVBbAVmEQYGRwMmBjIAQi/CTIRd6G5AuA3dzYQBAHj0EFdHkvV4AAAAAElFTkSuQmCC";Editor.zoomOutImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAElBMVEUAAAAAAAAsLCxxcXEhISFgYGChjTUxAAAAAXRSTlMAQObYZgAAAEdJREFUCNdjIAMwCQrB2YKCggJQJqMwA7MglK1owMBgqABVApITgLJZXFxgbIQ4Qj3CHIT5ggoIe5kgNkM1KSDYKBKqxPkDAPo5BAZBE54hAAAAAElFTkSuQmCC";Editor.zoomInImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAElBMVEUAAAAAAAAsLCwhISFxcXFgYGBavKaoAAAAAXRSTlMAQObYZgAAAElJREFUCNdjIAMwCQrB2YKCggJQJqMIA4sglK3owMzgqABVwsDMwCgAZTMbG8PYCHGEeoQ5CPMFFRD2MkFshmpSQLBRJFSJ8wcAEqcEM2uhl2MAAAAASUVORK5CYII=";Editor.zoomFitImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAD1BMVEUAAAAAAAAwMDBwcHBgYGC1xl09AAAAAXRSTlMAQObYZgAAAEFJREFUCNdjIAMwCQrB2YKCggJQJqMwA7MglK1owMBgqABVApITwMdGqEeYgzBfUAFhLxPEZqgmBQQbRUKFOH8AAK5OA3lA+FFOAAAAAElFTkSuQmCC";Editor.layersImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAMAAACeyVWkAAAAaVBMVEUAAAAgICAICAgdHR0PDw8WFhYICAgLCwsXFxcvLy8ODg4uLi4iIiIqKiokJCQYGBgKCgonJycFBQUCAgIqKiocHBwcHBwODg4eHh4cHBwnJycJCQkUFBQqKiojIyMuLi4ZGRkgICAEBATOWYXAAAAAGnRSTlMAD7+fnz8/H7/ff18/77+vr5+fn39/b28fH2xSoKsAAACQSURBVBjTrYxJEsMgDARZZMAY73sgCcn/HxnhKtnk7j6oRq0psfuoyndZ/SuODkHPLzfVT6KeyPePnJ7KrnkRjWMXTn4SMnN8mXe2SSM3ts8L/ZUxxrbAULSYJJULE0Iw9pjpenoICcgcX61mGgTgtCv9Be99pzCoDhNQWQnchD1mup5++CYGcoQexajZbfwAj/0MD8ZOaUgAAAAASUVORK5CYII=";Editor.previousImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAAh0lEQVQ4je3UsQnCUBCA4U8hpa1NsoEjpHQJS0dxADdwEMuMIJkgA1hYChbGQgMi+JC8q4L/AB/vDu7x74cWWEZhJU44RmA1zujR5GIbXF9YNrjD/Q0bDRY4fEBZ4P4LlgTnCbAf84pUM8/9hY08tMUtEoQ1LpEgrNBFglChFXR6Q6GfwwR6AGKJMF74Vtt3AAAAAElFTkSuQmCC";Editor.nextImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAAi0lEQVQ4jeXUIQ7CUAwA0MeGxWI2yylwnALJUdBcgYvM7QYLmjOQIAkIPmJZghiIvypoUtX0tfnJL38X5ZfaEgUeUcManFBHgS0SLlhHggk3bCPBhCf2keCQR8wjwYTDp6YiZxJmOU1jGw7vGALescuBxsArNlOwd/CM1VSM/ut1qCIw+uOwiMJ+OF4CQzBCXm3hyAAAAABJRU5ErkJggg==";Editor.zoomOutLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAilBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2N2iNAAAALXRSTlMA+vTcKMM96GRBHwXxi0YaX1HLrKWhiHpWEOnOr52Vb2xKSDcT19PKv5l/Ngdk8+viAAABJklEQVQ4y4WT2XaDMAxEvWD2nSSUNEnTJN3r//+9Sj7ILAY6L0ijC4ONYVZRpo6cByrz2YKSUGorGTpz71lPVHvT+avoB5wIkU/mxk8veceSuNoLg44IzziXjvpih72wKQnm8yc2UoiP/LAd8jQfe2Xf4Pq+2EyYIvv9wbzHHCgwxDdlBtWZOdqDfTCVgqpygQpsZaojVAVc9UjQxnAJDIBhiQv84tq3gMQCAVTxVoSibXJf8tMuc7e1TB/DCmejBNg/w1Y3c+AM5vv4w7xM59/oXamrHaLVqPQ+OTCnmMZxgz0SdL5zji0/ld6j88qGa5KIiBB6WeJGKfUKwSMKLuXgvl1TW0tm5R9UQL/efSDYsnzxD8CinhBsTTdugJatKpJwf8v+ADb8QmvW7AeAAAAAAElFTkSuQmCC";Editor.zoomInLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAilBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2N2iNAAAALXRSTlMA+vTcKMM96GRBHwXxi0YaX1HLrKWhiHpWEOnOr52Vb2xKSDcT19PKv5l/Ngdk8+viAAABKElEQVQ4y4WT6WKCMBCENwkBwn2oFKvWqr3L+79es4EkQIDOH2d3Pxk2ABiJlB8JCXjqw4LikHVGLHTm3nM3UeVN5690GBBN0GwyV/3kkrUQR+WeKnREeKpzaXWd77CmJiXGfPIEI4V4yQ9TIW/ntlcMBe731Vts9w5TWG8F5j3mQI4hvrKpdGeYA7CX9qAcl650gVJartxRuhyHVghF8idQAIbFLvCLu28BsQEC6aKtCK6Pyb3JT7PmbmtNH8Ny56CotD/2qOs5cJbuffxgXmCib+xddVU5RNOhkvvkhTlFehzVWCOh3++MYElOhfdovaImnRYVmqDdsuhNp1QrBBE6uGC2+3ZNjGdg5B94oD+9uyVgWT79BwAxEBTWdOu3bWBVgsn/N/AHUD9IC01Oe40AAAAASUVORK5CYII=";Editor.actualSizeLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAilBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2N2iNAAAALXRSTlMA+vTcKMM96GRBHwXxi0YaX1HLrKWhiHpWEOnOr52Vb2xKSDcT19PKv5l/Ngdk8+viAAABIUlEQVQ4y4WT2XqDIBCFBxDc9yTWNEnTJN3r+79eGT4BEbXnaubMr8dBBaM450dCQp4LWFAascGIRd48eB4cNYE7f6XjgGiCFs5c+dml6CFN6j1V6IQIlHPpdV/usKcmJcV88gQTRXjLD9Mhb+fWq8YG9/uCmTCFjeeDeY85UGKIUGUuqzN42kv7oCouq9oHamlzVR1lVfpAIu1QVRiW+sAv7r4FpAYIZZVsRXB9TP5Dfpo1d1trCgzz1iiptH/sUbdz4CzN9+mLeXHn3+hdddd4RDegsrvzwZwSs2GLPRJidAqCLTlVwaMPqpYMWjTWBB2WRW86pVkhSKyDK2bdt2tmagZG4sBD/evdLQHLEvQfAOKRoLCmG1FAB6uKmby+gz+REDn7O5+EwQAAAABJRU5ErkJggg==";Editor.layersLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAmVBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+/v7///+bnZkkAAAAMnRSTlMABPr8ByiD88KsTi/rvJb272mjeUA1CuPe1M/KjVxYHxMP6KZ0S9nYzGRGGRaznpGIbzaGUf0AAAHESURBVDjLbZLZYoIwEEVDgLCjbKIgAlqXqt3m/z+uNwu1rcyDhjl3ktnYL7OY254C0VX3yWFZfzDrOClbbgKxi0YDHjwl4jbnRkXxJS/C1YP3DbBhD1n7Ex4uaAqdVDb3yJ/4J/3nJD2to/ngQz/DfUvzMp4JJ5sSCaF5oXmemgQDfDxzbi+Kq4sU+vNcuAmx94JtyOP2DD4Epz2asWSCz4Z/4fECxyNj9zC9xNLHcdPEO+awDKeSaUu0W4twZQiO2hYVisTR3RCtK/c1X6t4xMEpiGqXqVntEBLolkZZsKY4QtwH6jzq67dEHlJysB1aNOD3XT7n1UkasQN59L4yC2RELMDSeCRtz3yV22Ub3ozIUTknYx8JWqDdQxbUes98cR2kZtUSveF/bAhcedwEWmlxIkpZUy4XOCb6VBjjxHvbwo/1lBAHHi2JCr0NI570QhyHq/DhJoE2lLgyA4RVe6KmZ47O/3b86MCP0HWa73A8/C3SUc5Qc1ajt6fgpXJ+RGpMvDSchepZDOOQRcZVIKcK90x2D7etqtI+56+u6n3sPriO6nfphitR4+O2m3EbM7lh3me1FM1o+LMI887rN+s3/wZdTFlpNVJiOAAAAABJRU5ErkJggg==";Editor.closeLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAUVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////8IN+deAAAAGnRSTlMAuvAIg/dDM/QlOeuFhj0S5s4vKgzjxJRQNiLSey0AAADNSURBVDjLfZLbEoMgDEQjRRRs1XqX///QNmOHJSnjPkHOGR7IEmeoGtJZstnwjqbRfIsmgEdtPCqe9Ynz7ZSc07rE2QiSc+qv8TvjRXA2PDUm3dpe82iJhOEUfxJJo3aCv+jKmRmH4lcCjCjeh9GWOdL/GZZkXH3PYYDrHBnfc4D/RVZf5sjoC1was+Y6HQxwaUxFvq/a0Pv343VCTxfBSRiB+ab3M3eiQZXmMNBJ3Y8pGRZtYQ7DgHMXJEdPLTaN/qBjzJOBc3nmNcbsA16bMR0oLqf+AAAAAElFTkSuQmCC";Editor.editLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAgMAAAAOFJJnAAAACVBMVEUAAAD///////9zeKVjAAAAAnRSTlMAgJsrThgAAABcSURBVBjThc6xDcAgDATAd8MQTEPW8TRUmYCGnzLRYyOlIV+dZFtvkICTFGqiJEzAG0/Uje9oL+e5Vu4F5yUYJxxqGKhQZ0eBvmgwYQLQaARKD1hbiPyDR0QOeAC31EyNe5X/kAAAAABJRU5ErkJggg==";Editor.previousLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAPFBMVEUAAAD////////////////////////////////////////////////////////////////////////////YSWgTAAAAE3RSTlMA7fci493c0MW8uJ6CZks4MxQHEZL6ewAAAFZJREFUOMvdkskRgDAMA4lDwg2B7b9XOlge/KKvdsa25KFb5XlRvxXC/DNBEv8IFNjBgGdDgXtFgTyhwDXiQAUHCvwa4Uv6mR6UR+1led2mVonvl+tML45qCQNQLIx7AAAAAElFTkSuQmCC";Editor.nextLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAPFBMVEUAAAD////////////////////////////////////////////////////////////////////////////YSWgTAAAAE3RSTlMA7fci493c0MW8uJ6CZks4MxQHEZL6ewAAAFRJREFUOMvd0skRgCAQBVEFwQ0V7fxzNQP6wI05v6pZ/kyj1b7FNgik2gQzzLcAwiUAigHOTwDHK4A1CmB5BJANJG1hQ9qafYcqFlZP3IFc9eVGrR+iIgkDQRUXIAAAAABJRU5ErkJggg==";mxUtils.extend(Editor,mxEventSource);Editor.prototype.originalNoForeignObject=mxClient.NO_FO;Editor.prototype.transparentImage=(mxClient.IS_SVG)?"data:image/gif;base64,R0lGODlhMAAwAIAAAP///wAAACH5BAEAAAAALAAAAAAwADAAAAIxhI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jef6zvf+DwwKh8Si8egpAAA7":IMAGE_PATH+"/transparent.gif";Editor.prototype.extendCanvas=true;Editor.prototype.chromeless=false;Editor.prototype.cancelFirst=true;Editor.prototype.enabled=true;Editor.prototype.filename=null;Editor.prototype.modified=false;Editor.prototype.autosave=true;Editor.prototype.initialTopSpacing=0;Editor.prototype.appName=document.title;Editor.prototype.editBlankUrl=window.location.protocol+"//"+window.location.host+"/?client=1";Editor.prototype.editBlankFallbackUrl=window.location.protocol+"//"+window.location.host+"/?create=drawdata&splash=0";Editor.prototype.init=function(){};Editor.prototype.setAutosave=function(a){this.autosave=a;this.fireEvent(new mxEventObject("autosaveChanged"))};Editor.prototype.getEditBlankUrl=function(a,b){return((b)?this.editBlankFallbackUrl:this.editBlankUrl)+a};Editor.prototype.editAsNew=function(a,e){var d=(e!=null)?"&title="+encodeURIComponent(e):"";if(typeof window.postMessage!=="undefined"&&(document.documentMode==null||document.documentMode>=10)){var b=null;var c=mxUtils.bind(this,function(f){if(f.data=="ready"&&f.source==b){b.postMessage(a,"*");mxEvent.removeListener(window,"message",c)}});mxEvent.addListener(window,"message",c);b=window.open(this.getEditBlankUrl(d,false))}else{window.drawdata=a;window.open(this.getEditBlankUrl(d,true))}};Editor.prototype.createGraph=function(a,b){var c=new Graph(null,b,null,null,a);c.transparentBackground=false;if(!this.chromeless){c.isBlankLink=function(d){return !this.isExternalProtocol(d)}}return c};Editor.prototype.resetGraph=function(){this.graph.gridEnabled=!this.chromeless||urlParams.grid=="1";this.graph.graphHandler.guidesEnabled=true;this.graph.setTooltips(true);this.graph.setConnectable(true);this.graph.foldingEnabled=true;this.graph.scrollbars=this.graph.defaultScrollbars;this.graph.pageVisible=this.graph.defaultPageVisible;this.graph.pageBreaksVisible=this.graph.pageVisible;this.graph.preferPageSize=this.graph.pageBreaksVisible;this.graph.background=this.graph.defaultGraphBackground;this.graph.pageScale=mxGraph.prototype.pageScale;this.graph.pageFormat=mxGraph.prototype.pageFormat;this.updateGraphComponents();this.graph.view.setScale(1)};Editor.prototype.readGraphState=function(d){this.graph.gridEnabled=d.getAttribute("grid")!="0"&&(!this.chromeless||urlParams.grid=="1");this.graph.gridSize=parseFloat(d.getAttribute("gridSize"))||mxGraph.prototype.gridSize;this.graph.graphHandler.guidesEnabled=d.getAttribute("guides")!="0";this.graph.setTooltips(d.getAttribute("tooltips")!="0");this.graph.setConnectable(d.getAttribute("connect")!="0");this.graph.connectionArrowsEnabled=d.getAttribute("arrows")!="0";this.graph.foldingEnabled=d.getAttribute("fold")!="0";if(this.chromeless&&this.graph.foldingEnabled){this.graph.foldingEnabled=urlParams.nav=="1";this.graph.cellRenderer.forceControlClickHandler=this.graph.foldingEnabled}var f=d.getAttribute("pageScale");if(f!=null){this.graph.pageScale=f}else{this.graph.pageScale=mxGraph.prototype.pageScale}if(!this.graph.lightbox){var c=d.getAttribute("page");if(c!=null){this.graph.pageVisible=(c!="0")}else{this.graph.pageVisible=this.graph.defaultPageVisible}}else{this.graph.pageVisible=false}this.graph.pageBreaksVisible=this.graph.pageVisible;this.graph.preferPageSize=this.graph.pageBreaksVisible;var b=d.getAttribute("pageWidth");var e=d.getAttribute("pageHeight");if(b!=null&&e!=null){this.graph.pageFormat=new mxRectangle(0,0,parseFloat(b),parseFloat(e))}var a=d.getAttribute("background");if(a!=null&&a.length>0){this.graph.background=a}else{this.graph.background=this.graph.defaultGraphBackground}};Editor.prototype.setGraphXml=function(a){if(a!=null){var c=new mxCodec(a.ownerDocument);if(a.nodeName=="mxGraphModel"){this.graph.model.beginUpdate();try{this.graph.model.clear();this.graph.view.scale=1;this.readGraphState(a);this.updateGraphComponents();c.decode(a,this.graph.getModel())}finally{this.graph.model.endUpdate()}this.fireEvent(new mxEventObject("resetGraphView"))}else{if(a.nodeName=="root"){this.resetGraph();var b=c.document.createElement("mxGraphModel");b.appendChild(a);c.decode(b,this.graph.getModel());this.updateGraphComponents();this.fireEvent(new mxEventObject("resetGraphView"))}else{throw {message:mxResources.get("cannotOpenFile"),node:a,toString:function(){return this.message}}}}}else{this.resetGraph();this.graph.model.clear();this.fireEvent(new mxEventObject("resetGraphView"))}};Editor.prototype.getGraphXml=function(b){b=(b!=null)?b:true;var c=null;if(b){var a=new mxCodec(mxUtils.createXmlDocument());c=a.encode(this.graph.getModel())}else{c=this.graph.encodeCells(mxUtils.sortCells(this.graph.model.getTopmostCells(this.graph.getSelectionCells())))}if(this.graph.view.translate.x!=0||this.graph.view.translate.y!=0){c.setAttribute("dx",Math.round(this.graph.view.translate.x*100)/100);c.setAttribute("dy",Math.round(this.graph.view.translate.y*100)/100)}c.setAttribute("grid",(this.graph.isGridEnabled())?"1":"0");c.setAttribute("gridSize",this.graph.gridSize);c.setAttribute("guides",(this.graph.graphHandler.guidesEnabled)?"1":"0");c.setAttribute("tooltips",(this.graph.tooltipHandler.isEnabled())?"1":"0");c.setAttribute("connect",(this.graph.connectionHandler.isEnabled())?"1":"0");c.setAttribute("arrows",(this.graph.connectionArrowsEnabled)?"1":"0");c.setAttribute("fold",(this.graph.foldingEnabled)?"1":"0");c.setAttribute("page",(this.graph.pageVisible)?"1":"0");c.setAttribute("pageScale",this.graph.pageScale);c.setAttribute("pageWidth",this.graph.pageFormat.width);c.setAttribute("pageHeight",this.graph.pageFormat.height);if(this.graph.background!=null){c.setAttribute("background",this.graph.background)}return c};Editor.prototype.updateGraphComponents=function(){var a=this.graph;if(a.container!=null){a.view.validateBackground();a.container.style.overflow=(a.scrollbars)?"auto":"hidden";this.fireEvent(new mxEventObject("updateGraphComponents"))}};Editor.prototype.setModified=function(a){this.modified=a};Editor.prototype.setFilename=function(a){this.filename=a};Editor.prototype.createUndoManager=function(){var b=this.graph;var c=new mxUndoManager();this.undoListener=function(f,e){c.undoableEditHappened(e.getProperty("edit"))};var a=mxUtils.bind(this,function(f,e){this.undoListener.apply(this,arguments)});b.getModel().addListener(mxEvent.UNDO,a);b.getView().addListener(mxEvent.UNDO,a);var d=function(j,e){var k=b.getSelectionCellsForChanges(e.getProperty("edit").changes);var g=b.getModel();var f=[];for(var h=0;h<k.length;h++){if((g.isVertex(k[h])||g.isEdge(k[h]))&&b.view.getState(k[h])!=null){f.push(k[h])}}b.setSelectionCells(f)};c.addListener(mxEvent.UNDO,d);c.addListener(mxEvent.REDO,d);return c};Editor.prototype.initStencilRegistry=function(){};Editor.prototype.destroy=function(){if(this.graph!=null){this.graph.destroy();this.graph=null}};OpenFile=function(a){this.producer=null;this.consumer=null;this.done=a;this.args=null};OpenFile.prototype.setConsumer=function(a){this.consumer=a;this.execute()};OpenFile.prototype.setData=function(){this.args=arguments;this.execute()};OpenFile.prototype.error=function(a){this.cancel(true);mxUtils.alert(a)};OpenFile.prototype.execute=function(){if(this.consumer!=null&&this.args!=null){this.cancel(false);this.consumer.apply(this,this.args)}};OpenFile.prototype.cancel=function(a){if(this.done!=null){this.done((a!=null)?a:true)}};(function(){mxGraphView.prototype.validateBackgroundPage=function(){var i=this.graph;if(i.container!=null&&!i.transparentBackground){if(i.pageVisible){var h=this.getBackgroundPageBounds();if(this.backgroundPageShape==null){var j=i.container.firstChild;while(j!=null&&j.nodeType!=mxConstants.NODETYPE_ELEMENT){j=j.nextSibling}if(j!=null){this.backgroundPageShape=this.createBackgroundPageShape(h);this.backgroundPageShape.scale=1;this.backgroundPageShape.isShadow=!mxClient.IS_QUIRKS;this.backgroundPageShape.dialect=mxConstants.DIALECT_STRICTHTML;this.backgroundPageShape.init(i.container);j.style.position="absolute";i.container.insertBefore(this.backgroundPageShape.node,j);this.backgroundPageShape.redraw();this.backgroundPageShape.node.className="geBackgroundPage";mxEvent.addListener(this.backgroundPageShape.node,"dblclick",mxUtils.bind(this,function(k){i.dblClick(k)}));mxEvent.addGestureListeners(this.backgroundPageShape.node,mxUtils.bind(this,function(k){i.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(k))}),mxUtils.bind(this,function(k){if(i.tooltipHandler!=null&&i.tooltipHandler.isHideOnHover()){i.tooltipHandler.hide()}if(i.isMouseDown&&!mxEvent.isConsumed(k)){i.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(k))}}),mxUtils.bind(this,function(k){i.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(k))}))}}else{this.backgroundPageShape.scale=1;this.backgroundPageShape.bounds=h;this.backgroundPageShape.redraw()}}else{if(this.backgroundPageShape!=null){this.backgroundPageShape.destroy();this.backgroundPageShape=null}}this.validateBackgroundStyles()}};mxGraphView.prototype.validateBackgroundStyles=function(){var q=this.graph;var k=(q.background==null||q.background==mxConstants.NONE)?"#ffffff":q.background;var o=(this.gridColor!=k.toLowerCase())?this.gridColor:"#ffffff";var j="none";var l="";if(q.isGridEnabled()){var p=10;if(mxClient.IS_SVG){j=unescape(encodeURIComponent(this.createSvgGrid(o)));j=(window.btoa)?btoa(j):Base64.encode(j,true);j="url(data:image/svg+xml;base64,"+j+")";p=q.gridSize*this.scale*this.gridSteps}else{j="url("+this.gridImage+")"}var i=0;var n=0;if(q.view.backgroundPageShape!=null){var m=this.getBackgroundPageBounds();i=1+m.x;n=1+m.y}l=-Math.round(p-mxUtils.mod(this.translate.x*this.scale-i,p))+"px "+-Math.round(p-mxUtils.mod(this.translate.y*this.scale-n,p))+"px"}var h=q.view.canvas;if(h.ownerSVGElement!=null){h=h.ownerSVGElement}if(q.view.backgroundPageShape!=null){q.view.backgroundPageShape.node.style.backgroundPosition=l;q.view.backgroundPageShape.node.style.backgroundImage=j;q.view.backgroundPageShape.node.style.backgroundColor=k;q.container.className="geDiagramContainer geDiagramBackdrop";h.style.backgroundImage="none";h.style.backgroundColor=""}else{q.container.className="geDiagramContainer";h.style.backgroundPosition=l;h.style.backgroundColor=k;h.style.backgroundImage=j}};mxGraphView.prototype.createSvgGrid=function(j){var n=this.graph.gridSize*this.scale;while(n<this.minGridSize){n*=2}var o=this.gridSteps*n;var p=[];for(var m=1;m<this.gridSteps;m++){var l=m*n;p.push("M 0 "+l+" L "+o+" "+l+" M "+l+" 0 L "+l+" "+o)}var k=o;var h='<svg width="'+k+'" height="'+k+'" xmlns="'+mxConstants.NS_SVG+'"><defs><pattern id="grid" width="'+o+'" height="'+o+'" patternUnits="userSpaceOnUse"><path d="'+p.join(" ")+'" fill="none" stroke="'+j+'" opacity="0.2" stroke-width="1"/><path d="M '+o+" 0 L 0 0 0 "+o+'" fill="none" stroke="'+j+'" stroke-width="1"/></pattern></defs><rect width="100%" height="100%" fill="url(#grid)"/></svg>';return h};var c=mxGraph.prototype.panGraph;mxGraph.prototype.panGraph=function(k,j){c.apply(this,arguments);if(this.shiftPreview1!=null){var l=this.view.canvas;if(l.ownerSVGElement!=null){l=l.ownerSVGElement}var i=this.gridSize*this.view.scale*this.view.gridSteps;var h=-Math.round(i-mxUtils.mod(this.view.translate.x*this.view.scale+k,i))+"px "+-Math.round(i-mxUtils.mod(this.view.translate.y*this.view.scale+j,i))+"px";l.style.backgroundPosition=h}};mxGraph.prototype.updatePageBreaks=function(q,m,u){var r=this.view.scale;var s=this.view.translate;var o=this.pageFormat;var j=r*this.pageScale;var k=this.view.getBackgroundPageBounds();m=k.width;u=k.height;var i=new mxRectangle(r*s.x,r*s.y,o.width*j,o.height*j);q=q&&Math.min(i.width,i.height)>this.minPageBreakDist;var l=(q)?Math.ceil(u/i.height)-1:0;var n=(q)?Math.ceil(m/i.width)-1:0;var t=k.x+m;var h=k.y+u;if(this.horizontalPageBreaks==null&&l>0){this.horizontalPageBreaks=[]}if(this.verticalPageBreaks==null&&n>0){this.verticalPageBreaks=[]}var p=mxUtils.bind(this,function(y){if(y!=null){var x=(y==this.horizontalPageBreaks)?l:n;for(var w=0;w<=x;w++){var z=(y==this.horizontalPageBreaks)?[new mxPoint(Math.round(k.x),Math.round(k.y+(w+1)*i.height)),new mxPoint(Math.round(t),Math.round(k.y+(w+1)*i.height))]:[new mxPoint(Math.round(k.x+(w+1)*i.width),Math.round(k.y)),new mxPoint(Math.round(k.x+(w+1)*i.width),Math.round(h))];if(y[w]!=null){y[w].points=z;y[w].redraw()}else{var v=new mxPolyline(z,this.pageBreakColor);v.dialect=this.dialect;v.isDashed=this.pageBreakDashed;v.pointerEvents=false;v.init(this.view.backgroundPane);v.redraw();y[w]=v}}for(var w=x;w<y.length;w++){y[w].destroy()}y.splice(x,y.length-x)}});p(this.horizontalPageBreaks);p(this.verticalPageBreaks)};var b=mxGraphHandler.prototype.shouldRemoveCellsFromParent;mxGraphHandler.prototype.shouldRemoveCellsFromParent=function(l,j,h){for(var k=0;k<j.length;k++){if(this.graph.getModel().isVertex(j[k])){var m=this.graph.getCellGeometry(j[k]);if(m!=null&&m.relative){return false}}}return b.apply(this,arguments)};var a=mxConnectionHandler.prototype.createMarker;mxConnectionHandler.prototype.createMarker=function(){var h=a.apply(this,arguments);h.intersects=mxUtils.bind(this,function(j,i){if(this.isConnecting()){return true}return mxCellMarker.prototype.intersects.apply(h,arguments)});return h};mxGraphView.prototype.createBackgroundPageShape=function(h){return new mxRectangleShape(h,"#ffffff","#cacaca")};mxGraphView.prototype.getBackgroundPageBounds=function(){var z=this.getGraphBounds();var r=(z.width>0)?z.x/this.scale-this.translate.x:0;var q=(z.height>0)?z.y/this.scale-this.translate.y:0;var t=z.width/this.scale;var m=z.height/this.scale;var l=this.graph.pageFormat;var j=this.graph.pageScale;var v=l.width*j;var o=l.height*j;var k=Math.floor(Math.min(0,r)/v);var s=Math.floor(Math.min(0,q)/o);var u=Math.ceil(Math.max(1,r+t)/v);var n=Math.ceil(Math.max(1,q+m)/o);var A=u-k;var p=n-s;var i=new mxRectangle(this.scale*(this.translate.x+k*v),this.scale*(this.translate.y+s*o),this.scale*A*v,this.scale*p*o);return i};var d=mxGraph.prototype.panGraph;mxGraph.prototype.panGraph=function(i,h){d.apply(this,arguments);if((this.dialect!=mxConstants.DIALECT_SVG&&this.view.backgroundPageShape!=null)&&(!this.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.container))){this.view.backgroundPageShape.node.style.marginLeft=i+"px";this.view.backgroundPageShape.node.style.marginTop=h+"px"}};var g=mxPopupMenu.prototype.addItem;mxPopupMenu.prototype.addItem=function(n,m,i,l,k,j){var h=g.apply(this,arguments);if(j!=null&&!j){mxEvent.addListener(h,"mousedown",function(o){mxEvent.consume(o)})}return h};var f=mxGraphHandler.prototype.getInitialCellForEvent;mxGraphHandler.prototype.getInitialCellForEvent=function(l){var j=this.graph.getModel();var i=j.getParent(this.graph.getSelectionCell());var h=f.apply(this,arguments);var k=j.getParent(h);if(i==null||(i!=h&&i!=k)){while(!this.graph.isCellSelected(h)&&!this.graph.isCellSelected(k)&&j.isVertex(k)&&!this.graph.isContainer(k)){h=k;k=this.graph.getModel().getParent(h)}}return h};var e=mxGraphHandler.prototype.isDelayedSelection;mxGraphHandler.prototype.isDelayedSelection=function(i,l){var h=e.apply(this,arguments);if(!h){var j=this.graph.getModel();var k=j.getParent(i);while(k!=null){if(this.graph.isCellSelected(k)&&j.isVertex(k)){h=true;break}k=j.getParent(k)}}return h};mxGraphHandler.prototype.selectDelayed=function(k){if(!this.graph.popupMenuHandler.isPopupTrigger(k)){var h=k.getCell();if(h==null){h=this.cell}var l=this.graph.view.getState(h);if(l!=null&&k.isSource(l.control)){this.graph.selectCellForEvent(h,k.getEvent())}else{var i=this.graph.getModel();var j=i.getParent(h);while(!this.graph.isCellSelected(j)&&i.isVertex(j)){h=j;j=i.getParent(h)}this.graph.selectCellForEvent(h,k.getEvent())}}};mxPopupMenuHandler.prototype.getCellForPopupEvent=function(k){var h=k.getCell();var i=this.graph.getModel();var j=i.getParent(h);while(i.isVertex(j)&&!this.graph.isContainer(j)){if(this.graph.isCellSelected(j)){h=j}j=i.getParent(j)}return h}})();