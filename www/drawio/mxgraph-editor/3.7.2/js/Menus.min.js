Menus=function(a){this.editorUi=a;this.menus=new Object();this.init();if(!mxClient.IS_SVG){new Image().src=this.checkmarkImage}};Menus.prototype.defaultFont="Helvetica";Menus.prototype.defaultFontSize="12";Menus.prototype.defaultMenuItems=["file","edit","view","arrange","extras","help"];Menus.prototype.defaultFonts=["Helvetica","Verdana","Times New Roman","Garamond","Comic Sans MS","Courier New","Georgia","Lucida Console","Tahoma"];Menus.prototype.init=function(){var b=this.editorUi.editor.graph;var a=mxUtils.bind(b,b.isEnabled);this.customFonts=[];this.customFontSizes=[];this.put("fontFamily",new Menu(mxUtils.bind(this,function(f,d){var e=mxUtils.bind(this,function(h){var g=this.styleChange(f,h,[mxConstants.STYLE_FONTFAMILY],[h],null,d,function(){document.execCommand("fontname",false,h)});g.firstChild.nextSibling.style.fontFamily=h});for(var c=0;c<this.defaultFonts.length;c++){e(this.defaultFonts[c])}f.addSeparator(d);if(this.customFonts.length>0){for(var c=0;c<this.customFonts.length;c++){e(this.customFonts[c])}f.addSeparator(d);f.addItem(mxResources.get("reset"),null,mxUtils.bind(this,function(){this.customFonts=[]}),d);f.addSeparator(d)}this.promptChange(f,mxResources.get("custom")+"...","",mxConstants.DEFAULT_FONTFAMILY,mxConstants.STYLE_FONTFAMILY,d,true,mxUtils.bind(this,function(g){this.customFonts.push(g)}))})));this.put("formatBlock",new Menu(mxUtils.bind(this,function(e,c){function d(g,f){return e.addItem(g,null,mxUtils.bind(this,function(){b.cellEditor.textarea.focus();document.execCommand("formatBlock",false,"<"+f+">")}),c)}d(mxResources.get("normal"),"p");d("","h1").firstChild.nextSibling.innerHTML='<h1 style="margin:0px;">'+mxResources.get("heading")+" 1</h1>";d("","h2").firstChild.nextSibling.innerHTML='<h2 style="margin:0px;">'+mxResources.get("heading")+" 2</h2>";d("","h3").firstChild.nextSibling.innerHTML='<h3 style="margin:0px;">'+mxResources.get("heading")+" 3</h3>";d("","h4").firstChild.nextSibling.innerHTML='<h4 style="margin:0px;">'+mxResources.get("heading")+" 4</h4>";d("","h5").firstChild.nextSibling.innerHTML='<h5 style="margin:0px;">'+mxResources.get("heading")+" 5</h5>";d("","h6").firstChild.nextSibling.innerHTML='<h6 style="margin:0px;">'+mxResources.get("heading")+" 6</h6>";d("","pre").firstChild.nextSibling.innerHTML='<pre style="margin:0px;">'+mxResources.get("formatted")+"</pre>";d("","blockquote").firstChild.nextSibling.innerHTML='<blockquote style="margin-top:0px;margin-bottom:0px;">'+mxResources.get("blockquote")+"</blockquote>"})));this.put("fontSize",new Menu(mxUtils.bind(this,function(g,d){var e=[6,8,9,10,11,12,14,18,24,36,48,72];var f=mxUtils.bind(this,function(h){this.styleChange(g,h,[mxConstants.STYLE_FONTSIZE],[h],null,d,function(){document.execCommand("fontSize",false,"3");var k=b.cellEditor.textarea.getElementsByTagName("font");for(var j=0;j<k.length;j++){if(k[j].getAttribute("size")=="3"){k[j].removeAttribute("size");k[j].style.fontSize=h+"px";break}}})});for(var c=0;c<e.length;c++){f(e[c])}g.addSeparator(d);if(this.customFontSizes.length>0){for(var c=0;c<this.customFontSizes.length;c++){f(this.customFontSizes[c])}g.addSeparator(d);g.addItem(mxResources.get("reset"),null,mxUtils.bind(this,function(){this.customFontSizes=[]}),d);g.addSeparator(d)}this.promptChange(g,mxResources.get("custom")+"...","(pt)","12",mxConstants.STYLE_FONTSIZE,d,true,mxUtils.bind(this,function(h){this.customFontSizes.push(h)}))})));this.put("direction",new Menu(mxUtils.bind(this,function(d,c){d.addItem(mxResources.get("flipH"),null,function(){b.toggleCellStyles(mxConstants.STYLE_FLIPH,false)},c);d.addItem(mxResources.get("flipV"),null,function(){b.toggleCellStyles(mxConstants.STYLE_FLIPV,false)},c);this.addMenuItems(d,["-","rotation"],c)})));this.put("align",new Menu(mxUtils.bind(this,function(d,c){d.addItem(mxResources.get("leftAlign"),null,function(){b.alignCells(mxConstants.ALIGN_LEFT)},c);d.addItem(mxResources.get("center"),null,function(){b.alignCells(mxConstants.ALIGN_CENTER)},c);d.addItem(mxResources.get("rightAlign"),null,function(){b.alignCells(mxConstants.ALIGN_RIGHT)},c);d.addSeparator(c);d.addItem(mxResources.get("topAlign"),null,function(){b.alignCells(mxConstants.ALIGN_TOP)},c);d.addItem(mxResources.get("middle"),null,function(){b.alignCells(mxConstants.ALIGN_MIDDLE)},c);d.addItem(mxResources.get("bottomAlign"),null,function(){b.alignCells(mxConstants.ALIGN_BOTTOM)},c)})));this.put("distribute",new Menu(mxUtils.bind(this,function(d,c){d.addItem(mxResources.get("horizontal"),null,function(){b.distributeCells(true)},c);d.addItem(mxResources.get("vertical"),null,function(){b.distributeCells(false)},c)})));this.put("layout",new Menu(mxUtils.bind(this,function(e,c){var d=mxUtils.bind(this,function(f,g){var h=new FilenameDialog(this.editorUi,f,mxResources.get("apply"),function(i){g(parseFloat(i))},mxResources.get("spacing"));this.editorUi.showDialog(h.container,300,80,true,true);h.init()});e.addItem(mxResources.get("horizontalFlow"),null,mxUtils.bind(this,function(){var f=new mxHierarchicalLayout(b,mxConstants.DIRECTION_WEST);this.editorUi.executeLayout(function(){var g=b.getSelectionCells();f.execute(b.getDefaultParent(),g.length==0?null:g)},true)}),c);e.addItem(mxResources.get("verticalFlow"),null,mxUtils.bind(this,function(){var f=new mxHierarchicalLayout(b,mxConstants.DIRECTION_NORTH);this.editorUi.executeLayout(function(){var g=b.getSelectionCells();f.execute(b.getDefaultParent(),g.length==0?null:g)},true)}),c);e.addSeparator(c);e.addItem(mxResources.get("horizontalTree"),null,mxUtils.bind(this,function(){var g=b.getSelectionCell();var f=null;if(g==null||b.getModel().getChildCount(g)==0){if(b.getModel().getEdgeCount(g)==0){f=b.findTreeRoots(b.getDefaultParent())}}else{f=b.findTreeRoots(g)}if(f!=null&&f.length>0){g=f[0]}if(g!=null){var h=new mxCompactTreeLayout(b,true);h.edgeRouting=false;h.levelDistance=30;d(h.levelDistance,mxUtils.bind(this,function(i){h.levelDistance=i;this.editorUi.executeLayout(function(){h.execute(b.getDefaultParent(),g)},true)}))}}),c);e.addItem(mxResources.get("verticalTree"),null,mxUtils.bind(this,function(){var g=b.getSelectionCell();var f=null;if(g==null||b.getModel().getChildCount(g)==0){if(b.getModel().getEdgeCount(g)==0){f=b.findTreeRoots(b.getDefaultParent())}}else{f=b.findTreeRoots(g)}if(f!=null&&f.length>0){g=f[0]}if(g!=null){var h=new mxCompactTreeLayout(b,false);h.edgeRouting=false;h.levelDistance=30;d(h.levelDistance,mxUtils.bind(this,function(i){h.levelDistance=i;this.editorUi.executeLayout(function(){h.execute(b.getDefaultParent(),g)},true)}))}}),c);e.addItem(mxResources.get("radialTree"),null,mxUtils.bind(this,function(){var g=b.getSelectionCell();var f=null;if(g==null||b.getModel().getChildCount(g)==0){if(b.getModel().getEdgeCount(g)==0){f=b.findTreeRoots(b.getDefaultParent())}}else{f=b.findTreeRoots(g)}if(f!=null&&f.length>0){g=f[0]}if(g!=null){var h=new mxRadialTreeLayout(b,false);h.levelDistance=80;h.autoRadius=true;d(h.levelDistance,mxUtils.bind(this,function(i){h.levelDistance=i;this.editorUi.executeLayout(function(){h.execute(b.getDefaultParent(),g);if(!b.isSelectionEmpty()){g=b.getModel().getParent(g);if(b.getModel().isVertex(g)){b.updateGroupBounds([g],b.gridSize*2,true)}}},true)}))}}),c);e.addSeparator(c);e.addItem(mxResources.get("organic"),null,mxUtils.bind(this,function(){var f=new mxFastOrganicLayout(b);d(f.forceConstant,mxUtils.bind(this,function(g){f.forceConstant=g;this.editorUi.executeLayout(function(){var h=b.getSelectionCell();if(h==null||b.getModel().getChildCount(h)==0){h=b.getDefaultParent()}f.execute(h);if(b.getModel().isVertex(h)){b.updateGroupBounds([h],b.gridSize*2,true)}},true)}))}),c);e.addItem(mxResources.get("circle"),null,mxUtils.bind(this,function(){var f=new mxCircleLayout(b);this.editorUi.executeLayout(function(){var g=b.getSelectionCell();if(g==null||b.getModel().getChildCount(g)==0){g=b.getDefaultParent()}f.execute(g);if(b.getModel().isVertex(g)){b.updateGroupBounds([g],b.gridSize*2,true)}},true)}),c)})));this.put("navigation",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["home","-","exitGroup","enterGroup","-","expand","collapse","-","collapsible"],c)})));this.put("arrange",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["toFront","toBack","-"],c);this.addSubmenu("direction",d,c);this.addMenuItems(d,["turn","-"],c);this.addSubmenu("align",d,c);this.addSubmenu("distribute",d,c);d.addSeparator(c);this.addSubmenu("navigation",d,c);this.addSubmenu("insert",d,c);this.addSubmenu("layout",d,c);this.addMenuItems(d,["-","group","ungroup","removeFromGroup","-","clearWaypoints","autosize"],c)}))).isEnabled=a;this.put("insert",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["insertLink","insertImage"],c)})));this.put("view",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,((this.editorUi.format!=null)?["formatPanel"]:[]).concat(["outline","layers","-","pageView","pageScale","-","scrollbars","tooltips","-","grid","guides","-","connectionArrows","connectionPoints","-","resetView","zoomIn","zoomOut"],c))})));this.put("viewPanels",new Menu(mxUtils.bind(this,function(d,c){if(this.editorUi.format!=null){this.addMenuItems(d,["formatPanel"],c)}this.addMenuItems(d,["outline","layers"],c)})));this.put("viewZoom",new Menu(mxUtils.bind(this,function(f,d){this.addMenuItems(f,["resetView","-"],d);var e=[0.25,0.5,0.75,1,1.25,1.5,2,3,4];for(var c=0;c<e.length;c++){(function(g){f.addItem((g*100)+"%",null,function(){b.zoomTo(g)},d)})(e[c])}this.addMenuItems(f,["-","fitWindow","fitPageWidth","fitPage","fitTwoPages","-","customZoom"],d)})));this.put("file",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["new","open","-","save","saveAs","-","import","export","-","pageSetup","print"],c)})));this.put("edit",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["undo","redo","-","cut","copy","paste","delete","-","duplicate","-","editData","editTooltip","editStyle","-","edit","-","editLink","openLink","-","selectVertices","selectEdges","selectAll","selectNone","-","lockUnlock"])})));this.put("extras",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["copyConnect","collapseExpand","-","editDiagram"])})));this.put("help",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["help","-","about"])})))};Menus.prototype.put=function(a,b){this.menus[a]=b;return b};Menus.prototype.get=function(a){return this.menus[a]};Menus.prototype.addSubmenu=function(b,e,d){var a=this.get(b).isEnabled();if(e.showDisabled||a){var c=e.addItem(mxResources.get(b),null,null,d,null,a);this.addMenu(b,e,c)}};Menus.prototype.addMenu=function(b,a,c){var d=this.get(b);if(d!=null&&(a.showDisabled||d.isEnabled())){this.get(b).execute(a,c)}};Menus.prototype.addInsertTableItem=function(a){var h=this.editorUi.editor.graph;function g(n,o){var m=["<table>"];for(var l=0;l<n;l++){m.push("<tr>");for(var k=0;k<o;k++){m.push("<td><br></td>")}m.push("</tr>")}m.push("</table>");return m.join("")}var e=a.addItem("",null,mxUtils.bind(this,function(j){var p=h.getParentByName(mxEvent.getSource(j),"TD");if(p!=null){var o=h.getParentByName(p,"TR");var m=h.cellEditor.textarea.getElementsByTagName("table");var k=[];for(var l=0;l<m.length;l++){k.push(m[l])}h.container.focus();h.pasteHtmlAtCaret(g(o.sectionRowIndex+1,p.cellIndex+1));var n=h.cellEditor.textarea.getElementsByTagName("table");if(n.length==k.length+1){for(var l=n.length-1;l>=0;l--){if(l==0||n[l]!=k[l-1]){h.selectNode(n[l].rows[0].cells[0]);break}}}}}));var b='<img src="'+mxClient.imageBasePath+'/transparent.gif" width="16" height="16"/>';function i(o,p){var m=document.createElement("table");m.setAttribute("border","1");m.style.borderCollapse="collapse";if(!mxClient.IS_QUIRKS){m.setAttribute("cellPadding","8")}for(var n=0;n<o;n++){var q=m.insertRow(n);for(var l=0;l<p;l++){var k=q.insertCell(-1);if(mxClient.IS_QUIRKS){k.innerHTML=b}}}return m}function c(m,o,p){for(var n=m.rows.length;n<o;n++){var q=m.insertRow(n);for(var l=0;l<m.rows[0].cells.length;l++){var k=q.insertCell(-1);if(mxClient.IS_QUIRKS){k.innerHTML=b}}}for(var n=0;n<m.rows.length;n++){var q=m.rows[n];for(var l=q.cells.length;l<p;l++){var k=q.insertCell(-1);if(mxClient.IS_QUIRKS){k.innerHTML=b}}}}e.firstChild.innerHTML="";var d=i(5,5);e.firstChild.appendChild(d);var f=document.createElement("div");f.style.padding="4px";f.style.fontSize=Menus.prototype.defaultFontSize+"px";f.innerHTML="1x1";e.firstChild.appendChild(f);mxEvent.addListener(d,"mouseover",function(p){var q=h.getParentByName(mxEvent.getSource(p),"TD");if(q!=null){var o=h.getParentByName(q,"TR");c(d,Math.min(20,o.sectionRowIndex+2),Math.min(20,q.cellIndex+2));f.innerHTML=(q.cellIndex+1)+"x"+(o.sectionRowIndex+1);for(var m=0;m<d.rows.length;m++){var n=d.rows[m];for(var l=0;l<n.cells.length;l++){var k=n.cells[l];if(m<=o.sectionRowIndex&&l<=q.cellIndex){k.style.backgroundColor="blue"}else{k.style.backgroundColor="white"}}}mxEvent.consume(p)}})};Menus.prototype.edgeStyleChange=function(g,b,f,a,c,d,e){return g.addItem(b,null,mxUtils.bind(this,function(){var o=this.editorUi.editor.graph;o.stopEditing(false);o.getModel().beginUpdate();try{var m=o.getSelectionCells();var k=[];for(var n=0;n<m.length;n++){var h=m[n];if(o.getModel().isEdge(h)){if(e){var p=o.getCellGeometry(h);if(p!=null){p=p.clone();p.points=null;o.getModel().setGeometry(h,p)}}for(var l=0;l<f.length;l++){o.setCellStyles(f[l],a[l],[h])}k.push(h)}}this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",f,"values",a,"cells",k))}finally{o.getModel().endUpdate()}}),d,c)};Menus.prototype.styleChange=function(h,c,g,b,d,f,e){var a=this.createStyleChangeFunction(g,b);return h.addItem(c,null,mxUtils.bind(this,function(){var i=this.editorUi.editor.graph;if(e!=null&&i.cellEditor.isContentEditing()){e()}else{a()}}),f,d)};Menus.prototype.createStyleChangeFunction=function(b,a){return mxUtils.bind(this,function(){var d=this.editorUi.editor.graph;d.stopEditing(false);d.getModel().beginUpdate();try{for(var c=0;c<b.length;c++){d.setCellStyles(b[c],a[c])}this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",b,"values",a,"cells",d.getSelectionCells()))}finally{d.getModel().endUpdate()}})};Menus.prototype.promptChange=function(a,f,b,d,i,g,c,e,h){return a.addItem(f,null,mxUtils.bind(this,function(){var l=this.editorUi.editor.graph;var k=d;var j=l.getView().getState(l.getSelectionCell());if(j!=null){k=j.style[i]||k}var m=new FilenameDialog(this.editorUi,k,mxResources.get("apply"),mxUtils.bind(this,function(n){if(n!=null&&n.length>0){l.getModel().beginUpdate();try{l.stopEditing(false);l.setCellStyles(i,n)}finally{l.getModel().endUpdate()}if(e!=null){e(n)}}}),mxResources.get("enterValue")+((b.length>0)?(" "+b):""));this.editorUi.showDialog(m.container,300,80,true,true);m.init()}),g,h,c)};Menus.prototype.pickColor=function(c,g,a){var f=this.editorUi.editor.graph;if(g!=null&&f.cellEditor.isContentEditing()){var d=f.cellEditor.saveSelection();var h=new ColorDialog(this.editorUi,a||"000000",mxUtils.bind(this,function(i){f.cellEditor.restoreSelection(d);document.execCommand(g,false,(i!=mxConstants.NONE)?i:"transparent")}),function(){f.cellEditor.restoreSelection(d)});this.editorUi.showDialog(h.container,220,430,true,true);h.init()}else{if(this.colorDialog==null){this.colorDialog=new ColorDialog(this.editorUi)}this.colorDialog.currentColorKey=c;var e=f.getView().getState(f.getSelectionCell());var b="none";if(e!=null){b=e.style[c]||b}if(b=="none"){b="ffffff";this.colorDialog.picker.fromString("ffffff");this.colorDialog.colorInput.value="none"}else{this.colorDialog.picker.fromString(b)}this.editorUi.showDialog(this.colorDialog.container,220,430,true,true);this.colorDialog.init()}};Menus.prototype.toggleStyle=function(b,a){var d=this.editorUi.editor.graph;var c=d.toggleCellStyles(b,a);this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",[b],"values",[c],"cells",d.getSelectionCells()))};Menus.prototype.addMenuItem=function(g,c,d,a,b){var f=this.editorUi.actions.get(c);if(f!=null&&(g.showDisabled||f.isEnabled())&&f.visible){var e=g.addItem(f.label,null,function(){f.funct(a)},d,b,f.isEnabled());if(f.toggleAction&&f.isSelected()){g.addCheckmark(e,Editor.checkmarkImage)}this.addShortcut(e,f);return e}return null};Menus.prototype.addShortcut=function(b,c){if(c.shortcut!=null){var d=b.firstChild.nextSibling.nextSibling;var a=document.createElement("span");a.style.color="gray";mxUtils.write(a,c.shortcut);d.appendChild(a)}};Menus.prototype.addMenuItems=function(f,d,c,a,e){for(var b=0;b<d.length;b++){if(d[b]=="-"){f.addSeparator(c)}else{this.addMenuItem(f,d[b],c,a,(e!=null)?e[b]:null)}}};Menus.prototype.createPopupMenu=function(b,i,h){var j=this.editorUi.editor.graph;b.smartSeparators=true;if(j.isSelectionEmpty()){this.addMenuItems(b,["undo","redo","-","pasteHere"],null,h)}else{this.addMenuItems(b,["delete","-","cut","copy","-","duplicate"],null,h)}if(!j.isSelectionEmpty()){if(j.getSelectionCount()==1){this.addMenuItems(b,["setAsDefaultStyle"],null,h)}b.addSeparator();i=j.getSelectionCell();var a=j.view.getState(i);if(a!=null){var e=false;this.addMenuItems(b,["toFront","toBack","-"],null,h);if(j.getModel().isEdge(i)&&mxUtils.getValue(a.style,mxConstants.STYLE_EDGE,null)!="entityRelationEdgeStyle"&&mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE,null)!="arrow"){var k=j.selectionCellsHandler.getHandler(i);var f=false;if(k instanceof mxEdgeHandler&&k.bends!=null&&k.bends.length>2){var d=k.getHandleForEvent(j.updateMouseEvent(new mxMouseEvent(h)));var g=this.editorUi.actions.get("removeWaypoint");g.handler=k;g.index=d;f=d>0&&d<k.bends.length-1}this.addMenuItems(b,["-",(f)?"removeWaypoint":"addWaypoint"],null,h);var c=j.getModel().getGeometry(i);e=c!=null&&c.points!=null&&c.points.length>0}if(j.getSelectionCount()==1&&(e||(j.getModel().isVertex(i)&&j.getModel().getEdgeCount(i)>0))){this.addMenuItems(b,["clearWaypoints"],null,h)}if(j.getSelectionCount()>1){b.addSeparator();this.addMenuItems(b,["group"],null,h)}else{if(j.getSelectionCount()==1&&!j.getModel().isEdge(i)&&!j.isSwimlane(i)&&j.getModel().getChildCount(i)>0){b.addSeparator();this.addMenuItems(b,["ungroup"],null,h)}}if(j.getSelectionCount()==1){b.addSeparator();this.addMenuItems(b,["edit","-","editData","editLink"],null,h);if(j.getModel().isVertex(i)&&mxUtils.getValue(a.style,mxConstants.STYLE_IMAGE,null)!=null){b.addSeparator();this.addMenuItem(b,"image",null,h).firstChild.nextSibling.innerHTML=mxResources.get("editImage")+"..."}}}}else{this.addMenuItems(b,["-","selectVertices","selectEdges","-","selectAll"],null,h)}};Menus.prototype.createMenubar=function(a){var d=new Menubar(this.editorUi,a);var c=this.defaultMenuItems;for(var b=0;b<c.length;b++){(mxUtils.bind(this,function(f){var e=d.addMenu(mxResources.get(c[b]),mxUtils.bind(this,function(){f.funct.apply(this,arguments)}));if(e!=null){f.addListener("stateChanged",function(){e.enabled=f.enabled;if(!f.enabled){e.className="geItem mxDisabled";if(document.documentMode==8){e.style.color="#c3c3c3"}}else{e.className="geItem";if(document.documentMode==8){e.style.color=""}}})}}))(this.get(c[b]))}return d};function Menubar(b,a){this.editorUi=b;this.container=a}Menubar.prototype.hideMenu=function(){this.editorUi.hideCurrentMenu()};Menubar.prototype.addMenu=function(c,a){var b=document.createElement("a");b.setAttribute("href","javascript:void(0);");b.className="geItem";mxUtils.write(b,c);this.addMenuHandler(b,a);this.container.appendChild(b);return b};Menubar.prototype.addMenuHandler=function(c,b){if(b!=null){var a=true;var d=mxUtils.bind(this,function(e){if(a&&c.enabled==null||c.enabled){this.editorUi.editor.graph.popupMenuHandler.hideMenu();var g=new mxPopupMenu(b);g.div.className+=" geMenubarMenu";g.smartSeparators=true;g.showDisabled=true;g.autoExpand=true;g.hideMenu=mxUtils.bind(this,function(){mxPopupMenu.prototype.hideMenu.apply(g,arguments);this.editorUi.resetCurrentMenu();g.destroy()});var f=mxUtils.getOffset(c);g.popup(f.x,f.y+c.offsetHeight,null,e);this.editorUi.setCurrentMenu(g,c)}mxEvent.consume(e)});mxEvent.addListener(c,"mousemove",mxUtils.bind(this,function(e){if(this.editorUi.currentMenu!=null&&this.editorUi.currentMenuElt!=c){this.editorUi.hideCurrentMenu();d(e)}}));mxEvent.addListener(c,"mousedown",mxUtils.bind(this,function(){a=this.currentElt!=c}));mxEvent.addListener(c,"click",mxUtils.bind(this,function(e){d(e);a=true}))}};Menubar.prototype.destroy=function(){};function Menu(a,b){mxEventSource.call(this);this.funct=a;this.enabled=(b!=null)?b:true}mxUtils.extend(Menu,mxEventSource);Menu.prototype.isEnabled=function(){return this.enabled};Menu.prototype.setEnabled=function(a){if(this.enabled!=a){this.enabled=a;this.fireEvent(new mxEventObject("stateChanged"))}};Menu.prototype.execute=function(b,a){this.funct(b,a)};EditorUi.prototype.createMenus=function(){return new Menus(this)};