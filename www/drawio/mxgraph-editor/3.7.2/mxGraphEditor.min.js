function Actions(a){this.editorUi=a;this.actions=new Object();this.init()}Actions.prototype.init=function(){var f=this.editorUi;var b=f.editor;var e=b.graph;var c=function(){return Action.prototype.isEnabled.apply(this,arguments)&&e.isEnabled()};this.addAction("new...",function(){window.open(f.getUrl())});this.addAction("open...",function(){window.openNew=true;window.openKey="open";f.openFile()});this.addAction("import...",function(){window.openNew=false;window.openKey="import";window.openFile=new OpenFile(mxUtils.bind(this,function(){f.hideDialog()}));window.openFile.setConsumer(mxUtils.bind(this,function(j,h){try{var n=mxUtils.parseXml(j);var i=new mxGraphModel();var l=new mxCodec(n);l.decode(n.documentElement,i);var k=i.getChildren(i.getChildAt(i.getRoot(),0));b.graph.setSelectionCells(b.graph.importCells(k))}catch(m){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+m.message)}}));f.showDialog(new OpenDialog(this).container,320,220,true,true,function(){window.openFile=null})}).isEnabled=c;this.addAction("save",function(){f.saveFile(false)},null,null,"Ctrl+S").isEnabled=c;this.addAction("saveAs...",function(){f.saveFile(true)},null,null,"Ctrl+Shift+S").isEnabled=c;this.addAction("export...",function(){f.showDialog(new ExportDialog(f).container,300,230,true,true)});this.addAction("editDiagram...",function(){var h=new EditDiagramDialog(f);f.showDialog(h.container,620,420,true,true);h.init()});this.addAction("pageSetup...",function(){f.showDialog(new PageSetupDialog(f).container,320,220,true,true)}).isEnabled=c;this.addAction("print...",function(){f.showDialog(new PrintDialog(f).container,300,180,true,true)},null,"sprite-print","Ctrl+P");this.addAction("preview",function(){mxUtils.show(e,null,10,10)});this.addAction("undo",function(){f.undo()},null,"sprite-undo","Ctrl+Z");this.addAction("redo",function(){f.redo()},null,"sprite-redo",(!mxClient.IS_WIN)?"Ctrl+Shift+Z":"Ctrl+Y");this.addAction("cut",function(){mxClipboard.cut(e)},null,"sprite-cut","Ctrl+X");this.addAction("copy",function(){mxClipboard.copy(e)},null,"sprite-copy","Ctrl+C");this.addAction("paste",function(){if(e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())){mxClipboard.paste(e)}},false,"sprite-paste","Ctrl+V");this.addAction("pasteHere",function(k){if(e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())){e.getModel().beginUpdate();try{var m=mxClipboard.paste(e);if(m!=null){var h=e.getBoundingBoxFromGeometry(m);if(h!=null){var l=e.view.translate;var o=e.view.scale;var p=l.x;var n=l.y;var j=Math.round(e.snap(e.popupMenuHandler.triggerX/o-p));var i=Math.round(e.snap(e.popupMenuHandler.triggerY/o-n));e.cellsMoved(m,j-h.x,i-h.y)}}}finally{e.getModel().endUpdate()}}});function a(m){e.escape();var k=e.getDeletableCells(e.getSelectionCells());if(k!=null&&k.length>0){var j=e.model.getParents(k);e.removeCells(k,m);if(j!=null){var h=[];for(var l=0;l<j.length;l++){if(e.model.contains(j[l])&&(e.model.isVertex(j[l])||e.model.isEdge(j[l]))){h.push(j[l])}}e.setSelectionCells(h)}}}this.addAction("delete",function(h){a(h!=null&&mxEvent.isShiftDown(h))},null,null,"Delete");this.addAction("deleteAll",function(){a(true)},null,null,"Ctrl+Delete");this.addAction("duplicate",function(){e.setSelectionCells(e.duplicateCells())},null,null,"Ctrl+D");this.put("turn",new Action(mxResources.get("turn")+" / "+mxResources.get("reverse"),function(){e.turnShapes(e.getSelectionCells())},null,null,"Ctrl+R"));this.addAction("selectVertices",function(){e.selectVertices()},null,null,"Ctrl+Shift+I");this.addAction("selectEdges",function(){e.selectEdges()},null,null,"Ctrl+Shift+E");this.addAction("selectAll",function(){e.selectAll(null,true)},null,null,"Ctrl+A");this.addAction("selectNone",function(){e.clearSelection()},null,null,"Ctrl+Shift+A");this.addAction("lockUnlock",function(){if(!e.isSelectionEmpty()){e.getModel().beginUpdate();try{var h=e.isCellMovable(e.getSelectionCell())?1:0;e.toggleCellStyles(mxConstants.STYLE_MOVABLE,h);e.toggleCellStyles(mxConstants.STYLE_RESIZABLE,h);e.toggleCellStyles(mxConstants.STYLE_ROTATABLE,h);e.toggleCellStyles(mxConstants.STYLE_DELETABLE,h);e.toggleCellStyles(mxConstants.STYLE_EDITABLE,h);e.toggleCellStyles("connectable",h)}finally{e.getModel().endUpdate()}}},null,null,"Ctrl+L");this.addAction("home",function(){e.home()},null,null,"Home");this.addAction("exitGroup",function(){e.exitGroup()},null,null,"Ctrl+Shift+Page Up");this.addAction("enterGroup",function(){e.enterGroup()},null,null,"Ctrl+Shift+Page Down");this.addAction("expand",function(){e.foldCells(false)},null,null,"Ctrl+Page Down");this.addAction("collapse",function(){e.foldCells(true)},null,null,"Ctrl+Page Up");this.addAction("toFront",function(){e.orderCells(false)},null,null,"Ctrl+Shift+F");this.addAction("toBack",function(){e.orderCells(true)},null,null,"Ctrl+Shift+B");this.addAction("group",function(){if(e.getSelectionCount()==1){e.setCellStyles("container","1")}else{e.setSelectionCell(e.groupCells(null,0))}},null,null,"Ctrl+G");this.addAction("ungroup",function(){if(e.getSelectionCount()==1&&e.getModel().getChildCount(e.getSelectionCell())==0){e.setCellStyles("container","0")}else{e.setSelectionCells(e.ungroupCells())}},null,null,"Ctrl+Shift+U");this.addAction("removeFromGroup",function(){e.removeCellsFromParent()});this.addAction("edit",function(){if(e.isEnabled()){e.startEditingAtCell()}},null,null,"F2/Enter");this.addAction("editData...",function(){var h=e.getSelectionCell()||e.getModel().getRoot();if(h!=null){var i=new EditDataDialog(f,h);f.showDialog(i.container,320,320,true,false);i.init()}},null,null,"Ctrl+M");this.addAction("editTooltip...",function(){var k=f.editor.graph;if(k.isEnabled()&&!k.isSelectionEmpty()){var h=k.getSelectionCell();var j="";if(mxUtils.isNode(h.value)){var i=h.value.getAttribute("tooltip");if(i!=null){j=i}}var l=new TextareaDialog(f,mxResources.get("editTooltip")+":",j,function(m){k.setTooltipForCell(h,m)});f.showDialog(l.container,320,200,true,true);l.init()}});this.addAction("openLink",function(){var h=e.getLinkForCell(e.getSelectionCell());if(h!=null){window.open(h)}});this.addAction("editLink...",function(){var j=f.editor.graph;if(j.isEnabled()&&!j.isSelectionEmpty()){var h=j.getSelectionCell();var i=j.getLinkForCell(h)||"";f.showLinkDialog(i,mxResources.get("apply"),function(k){k=mxUtils.trim(k);j.setLinkForCell(h,(k.length>0)?k:null)})}});this.addAction("insertLink...",function(){if(e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())){var h=new LinkDialog(f,"",mxResources.get("insert"),function(k,n){k=mxUtils.trim(k);if(k.length>0){var m=k.substring(k.lastIndexOf("/")+1);var i=null;if(n!=null&&n.length>0){i=n[0].iconUrl;m=n[0].name||n[0].type;m=m.charAt(0).toUpperCase()+m.substring(1);if(m.length>30){m=m.substring(0,30)+"..."}}var l=e.getFreeInsertPoint();var j=new mxCell(m,new mxGeometry(l.x,l.y,100,40),"fontColor=#0000EE;fontStyle=4;rounded=1;overflow=hidden;"+((i!=null)?"shape=label;imageWidth=16;imageHeight=16;spacingLeft=26;align=left;image="+i:"spacing=10;"));j.vertex=true;e.setLinkForCell(j,k);e.cellSizeUpdated(j,true);e.setSelectionCell(e.addCell(j));e.scrollCellToVisible(e.getSelectionCell())}});f.showDialog(h.container,420,90,true,true);h.init()}}).isEnabled=c;this.addAction("link...",mxUtils.bind(this,function(){var k=f.editor.graph;if(k.isEnabled()){if(k.cellEditor.isContentEditing()){var j=k.getParentByName(k.getSelectedElement(),"A",k.cellEditor.textarea);var h="";if(j!=null){h=j.getAttribute("href")||""}var i=k.cellEditor.saveSelection();f.showLinkDialog(h,mxResources.get("apply"),mxUtils.bind(this,function(l){k.cellEditor.restoreSelection(i);if(l!=null){k.insertLink(l)}}))}else{if(k.isSelectionEmpty()){this.get("insertLink").funct()}else{this.get("editLink").funct()}}}})).isEnabled=c;this.addAction("autosize",function(){var j=e.getSelectionCells();if(j!=null){e.getModel().beginUpdate();try{for(var k=0;k<j.length;k++){var h=j[k];if(e.getModel().getChildCount(h)){e.updateGroupBounds([h],20)}else{var l=e.view.getState(h);var m=e.getCellGeometry(h);if(e.getModel().isVertex(h)&&l!=null&&l.text!=null&&m!=null&&e.isWrapping(h)){m=m.clone();m.height=l.text.boundingBox.height/e.view.scale;e.getModel().setGeometry(h,m)}else{e.updateCellSize(h)}}}}finally{e.getModel().endUpdate()}}},null,null,"Ctrl+Shift+Y");this.addAction("formattedText",function(){var k=e.getView().getState(e.getSelectionCell());if(k!=null){var j="1";e.stopEditing();e.getModel().beginUpdate();try{if(k.style.html=="1"){j=null;var i=e.convertValueToString(k.cell);if(mxUtils.getValue(k.style,"nl2Br","1")!="0"){i=i.replace(/\n/g,"").replace(/<br\s*.?>/g,"\n")}var h=document.createElement("div");h.innerHTML=i;i=mxUtils.extractTextWithWhitespace(h.childNodes);e.cellLabelChanged(k.cell,i)}else{var i=mxUtils.htmlEntities(e.convertValueToString(k.cell),false);if(mxUtils.getValue(k.style,"nl2Br","1")!="0"){i=i.replace(/\n/g,"<br/>")}e.cellLabelChanged(k.cell,e.sanitizeHtml(i))}e.setCellStyles("html",j);f.fireEvent(new mxEventObject("styleChanged","keys",["html"],"values",[(j!=null)?j:"0"],"cells",e.getSelectionCells()))}finally{e.getModel().endUpdate()}}});this.addAction("wordWrap",function(){var i=e.getView().getState(e.getSelectionCell());var h="wrap";e.stopEditing();if(i!=null&&i.style[mxConstants.STYLE_WHITE_SPACE]=="wrap"){h=null}e.setCellStyles(mxConstants.STYLE_WHITE_SPACE,h)});this.addAction("rotation",function(){var i="0";var h=e.getView().getState(e.getSelectionCell());if(h!=null){i=h.style[mxConstants.STYLE_ROTATION]||i}var j=new FilenameDialog(f,i,mxResources.get("apply"),function(k){if(k!=null&&k.length>0){e.setCellStyles(mxConstants.STYLE_ROTATION,k)}},mxResources.get("enterValue")+" ("+mxResources.get("rotation")+" 0-360)");f.showDialog(j.container,300,80,true,true);j.init()});this.addAction("resetView",function(){e.zoomTo(1);f.resetScrollbars()},null,null,"Ctrl+H");this.addAction("zoomIn",function(h){e.zoomIn()},null,null,"Ctrl + / Alt+Mousewheel");this.addAction("zoomOut",function(h){e.zoomOut()},null,null,"Ctrl - / Alt+Mousewheel");this.addAction("fitWindow",function(){e.fit()},null,null,"Ctrl+Shift+H");this.addAction("fitPage",mxUtils.bind(this,function(){if(!e.pageVisible){this.get("pageView").funct()}var i=e.pageFormat;var m=e.pageScale;var h=e.container.clientWidth-10;var j=e.container.clientHeight-10;var l=Math.floor(20*Math.min(h/i.width/m,j/i.height/m))/20;e.zoomTo(l);if(mxUtils.hasScrollbars(e.container)){var k=e.getPagePadding();e.container.scrollTop=k.y*e.view.scale;e.container.scrollLeft=Math.min(k.x*e.view.scale,(e.container.scrollWidth-e.container.clientWidth)/2)}}),null,null,"Ctrl+J");this.addAction("fitTwoPages",mxUtils.bind(this,function(){if(!e.pageVisible){this.get("pageView").funct()}var i=e.pageFormat;var m=e.pageScale;var h=e.container.clientWidth-10;var j=e.container.clientHeight-10;var l=Math.floor(20*Math.min(h/(2*i.width)/m,j/i.height/m))/20;e.zoomTo(l);if(mxUtils.hasScrollbars(e.container)){var k=e.getPagePadding();e.container.scrollTop=Math.min(k.y,(e.container.scrollHeight-e.container.clientHeight)/2);e.container.scrollLeft=Math.min(k.x,(e.container.scrollWidth-e.container.clientWidth)/2)}}),null,null,"Ctrl+Shift+J");this.addAction("fitPageWidth",mxUtils.bind(this,function(){if(!e.pageVisible){this.get("pageView").funct()}var i=e.pageFormat;var l=e.pageScale;var h=e.container.clientWidth-10;var k=Math.floor(20*h/i.width/l)/20;e.zoomTo(k);if(mxUtils.hasScrollbars(e.container)){var j=e.getPagePadding();e.container.scrollLeft=Math.min(j.x*e.view.scale,(e.container.scrollWidth-e.container.clientWidth)/2)}}));this.put("customZoom",new Action(mxResources.get("custom")+"...",mxUtils.bind(this,function(){var h=new FilenameDialog(this.editorUi,parseInt(e.getView().getScale()*100),mxResources.get("apply"),mxUtils.bind(this,function(i){var j=parseInt(i);if(!isNaN(j)&&j>0){e.zoomTo(j/100)}}),mxResources.get("zoom")+" (%)");this.editorUi.showDialog(h.container,300,80,true,true);h.init()}),null,null,"Ctrl+0"));this.addAction("pageScale...",mxUtils.bind(this,function(){var h=new FilenameDialog(this.editorUi,parseInt(e.pageScale*100),mxResources.get("apply"),mxUtils.bind(this,function(i){var j=parseInt(i);if(!isNaN(j)&&j>0){f.setPageScale(j/100)}}),mxResources.get("pageScale")+" (%)");this.editorUi.showDialog(h.container,300,80,true,true);h.init()}));var d=null;d=this.addAction("grid",function(){e.setGridEnabled(!e.isGridEnabled());f.fireEvent(new mxEventObject("gridEnabledChanged"))},null,null,"Ctrl+Shift+G");d.setToggleAction(true);d.setSelectedCallback(function(){return e.isGridEnabled()});d.setEnabled(false);d=this.addAction("guides",function(){e.graphHandler.guidesEnabled=!e.graphHandler.guidesEnabled;f.fireEvent(new mxEventObject("guidesEnabledChanged"))});d.setToggleAction(true);d.setSelectedCallback(function(){return e.graphHandler.guidesEnabled});d.setEnabled(false);d=this.addAction("tooltips",function(){e.tooltipHandler.setEnabled(!e.tooltipHandler.isEnabled())});d.setToggleAction(true);d.setSelectedCallback(function(){return e.tooltipHandler.isEnabled()});d=this.addAction("collapseExpand",function(){f.setFoldingEnabled(!e.foldingEnabled)});d.setToggleAction(true);d.setSelectedCallback(function(){return e.foldingEnabled});d.isEnabled=c;d=this.addAction("scrollbars",function(){f.setScrollbars(!f.hasScrollbars())});d.setToggleAction(true);d.setSelectedCallback(function(){return e.scrollbars});d=this.addAction("pageView",mxUtils.bind(this,function(){f.setPageVisible(!e.pageVisible)}));d.setToggleAction(true);d.setSelectedCallback(function(){return e.pageVisible});this.put("pageBackgroundColor",new Action(mxResources.get("backgroundColor")+"...",function(){f.pickColor(e.background||"none",function(h){f.setBackgroundColor(h)})}));d=this.addAction("connectionArrows",function(){e.connectionArrowsEnabled=!e.connectionArrowsEnabled;f.fireEvent(new mxEventObject("connectionArrowsChanged"))},null,null,"Ctrl+Q");d.setToggleAction(true);d.setSelectedCallback(function(){return e.connectionArrowsEnabled});d=this.addAction("connectionPoints",function(){e.setConnectable(!e.connectionHandler.isEnabled());f.fireEvent(new mxEventObject("connectionPointsChanged"))},null,null,"Ctrl+Shift+Q");d.setToggleAction(true);d.setSelectedCallback(function(){return e.connectionHandler.isEnabled()});d=this.addAction("copyConnect",function(){e.connectionHandler.setCreateTarget(!e.connectionHandler.isCreateTarget());f.fireEvent(new mxEventObject("copyConnectChanged"))});d.setToggleAction(true);d.setSelectedCallback(function(){return e.connectionHandler.isCreateTarget()});d.isEnabled=c;d=this.addAction("autosave",function(){f.editor.setAutosave(!f.editor.autosave)});d.setToggleAction(true);d.setSelectedCallback(function(){return f.editor.autosave});d.isEnabled=c;d.visible=false;this.addAction("help",function(){var h="";if(mxResources.isLanguageSupported(mxClient.language)){h="_"+mxClient.language}window.open(RESOURCES_PATH+"/help"+h+".html")});this.put("about",new Action(mxResources.get("about")+" Graph Editor...",function(){f.showDialog(new AboutDialog(f).container,320,280,true,true)},null,null,"F1"));var g=mxUtils.bind(this,function(i,k,j,h){return this.addAction(i,function(){if(j!=null&&e.cellEditor.isContentEditing()){j()}else{e.stopEditing(false);e.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,k)}},null,null,h)});g("bold",mxConstants.FONT_BOLD,function(){document.execCommand("bold",false,null)},"Ctrl+B");g("italic",mxConstants.FONT_ITALIC,function(){document.execCommand("italic",false,null)},"Ctrl+I");g("underline",mxConstants.FONT_UNDERLINE,function(){document.execCommand("underline",false,null)},"Ctrl+U");this.addAction("fontColor...",function(){f.menus.pickColor(mxConstants.STYLE_FONTCOLOR,"forecolor","000000")});this.addAction("strokeColor...",function(){f.menus.pickColor(mxConstants.STYLE_STROKECOLOR)});this.addAction("fillColor...",function(){f.menus.pickColor(mxConstants.STYLE_FILLCOLOR)});this.addAction("gradientColor...",function(){f.menus.pickColor(mxConstants.STYLE_GRADIENTCOLOR)});this.addAction("backgroundColor...",function(){f.menus.pickColor(mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"backcolor")});this.addAction("borderColor...",function(){f.menus.pickColor(mxConstants.STYLE_LABEL_BORDERCOLOR)});this.addAction("vertical",function(){f.menus.toggleStyle(mxConstants.STYLE_HORIZONTAL,true)});this.addAction("shadow",function(){f.menus.toggleStyle(mxConstants.STYLE_SHADOW)});this.addAction("solid",function(){e.getModel().beginUpdate();try{e.setCellStyles(mxConstants.STYLE_DASHED,null);e.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null);f.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",[null,null],"cells",e.getSelectionCells()))}finally{e.getModel().endUpdate()}});this.addAction("dashed",function(){e.getModel().beginUpdate();try{e.setCellStyles(mxConstants.STYLE_DASHED,"1");e.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null);f.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1",null],"cells",e.getSelectionCells()))}finally{e.getModel().endUpdate()}});this.addAction("dotted",function(){e.getModel().beginUpdate();try{e.setCellStyles(mxConstants.STYLE_DASHED,"1");e.setCellStyles(mxConstants.STYLE_DASH_PATTERN,"1 4");f.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1","1 4"],"cells",e.getSelectionCells()))}finally{e.getModel().endUpdate()}});this.addAction("sharp",function(){e.getModel().beginUpdate();try{e.setCellStyles(mxConstants.STYLE_ROUNDED,"0");e.setCellStyles(mxConstants.STYLE_CURVED,"0");f.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","0"],"cells",e.getSelectionCells()))}finally{e.getModel().endUpdate()}});this.addAction("rounded",function(){e.getModel().beginUpdate();try{e.setCellStyles(mxConstants.STYLE_ROUNDED,"1");e.setCellStyles(mxConstants.STYLE_CURVED,"0");f.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["1","0"],"cells",e.getSelectionCells()))}finally{e.getModel().endUpdate()}});this.addAction("toggleRounded",function(){if(!e.isSelectionEmpty()&&e.isEnabled()){e.getModel().beginUpdate();try{var h=e.getSelectionCells();var k=e.view.getState(h[0]);var i=(k!=null)?k.style:e.getCellStyle(h[0]);var j=(mxUtils.getValue(i,mxConstants.STYLE_ROUNDED,"0")=="1")?"0":"1";e.setCellStyles(mxConstants.STYLE_ROUNDED,j);e.setCellStyles(mxConstants.STYLE_CURVED,null);f.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",[j,"0"],"cells",e.getSelectionCells()))}finally{e.getModel().endUpdate()}}});this.addAction("curved",function(){e.getModel().beginUpdate();try{e.setCellStyles(mxConstants.STYLE_ROUNDED,"0");e.setCellStyles(mxConstants.STYLE_CURVED,"1");f.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","1"],"cells",e.getSelectionCells()))}finally{e.getModel().endUpdate()}});this.addAction("collapsible",function(){var i=e.view.getState(e.getSelectionCell());var h="1";if(i!=null&&e.getFoldingImage(i)!=null){h="0"}e.setCellStyles("collapsible",h);f.fireEvent(new mxEventObject("styleChanged","keys",["collapsible"],"values",[h],"cells",e.getSelectionCells()))});this.addAction("editStyle...",mxUtils.bind(this,function(){var i=e.getSelectionCells();if(i!=null&&i.length>0){var h=e.getModel();var j=new TextareaDialog(this.editorUi,mxResources.get("editStyle")+":",h.getStyle(i[0])||"",function(k){if(k!=null){e.setCellStyle(mxUtils.trim(k),i)}},null,null,400,220);this.editorUi.showDialog(j.container,420,300,true,true);j.init()}}),null,null,"Ctrl+E");this.addAction("setAsDefaultStyle",function(){if(e.isEnabled()&&!e.isSelectionEmpty()){f.setDefaultStyle(e.getSelectionCell())}},null,null,"Ctrl+Shift+D");this.addAction("clearDefaultStyle",function(){if(e.isEnabled()){f.clearDefaultStyle()}},null,null,"Ctrl+Shift+R");this.addAction("addWaypoint",function(){var l=e.getSelectionCell();if(l!=null&&e.getModel().isEdge(l)){var m=b.graph.selectionCellsHandler.getHandler(l);if(m instanceof mxEdgeHandler){var n=e.view.translate;var p=e.view.scale;var q=n.x;var o=n.y;var k=e.getModel().getParent(l);var h=e.getCellGeometry(k);while(e.getModel().isVertex(k)&&h!=null){q+=h.x;o+=h.y;k=e.getModel().getParent(k);h=e.getCellGeometry(k)}var j=Math.round(e.snap(e.popupMenuHandler.triggerX/p-q));var i=Math.round(e.snap(e.popupMenuHandler.triggerY/p-o));m.addPointAt(m.state,j,i)}}});this.addAction("removeWaypoint",function(){var h=f.actions.get("removeWaypoint");if(h.handler!=null){h.handler.removePoint(h.handler.state,h.index)}});this.addAction("clearWaypoints",function(){var j=e.getSelectionCells();if(j!=null){j=e.addAllEdges(j);e.getModel().beginUpdate();try{for(var k=0;k<j.length;k++){var h=j[k];if(e.getModel().isEdge(h)){var l=e.getCellGeometry(h);if(l!=null){l=l.clone();l.points=null;e.getModel().setGeometry(h,l)}}}}finally{e.getModel().endUpdate()}}},null,null,"Alt+Shift+C");d=this.addAction("subscript",mxUtils.bind(this,function(){if(e.cellEditor.isContentEditing()){document.execCommand("subscript",false,null)}}),null,null,"Ctrl+,");d=this.addAction("superscript",mxUtils.bind(this,function(){if(e.cellEditor.isContentEditing()){document.execCommand("superscript",false,null)}}),null,null,"Ctrl+.");this.addAction("image...",function(){if(e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())){var k=mxResources.get("image")+" ("+mxResources.get("url")+"):";var j=e.getView().getState(e.getSelectionCell());var i="";if(j!=null){i=j.style[mxConstants.STYLE_IMAGE]||i}var h=e.cellEditor.saveSelection();f.showImageDialog(k,i,function(n,r,p){if(e.cellEditor.isContentEditing()){e.cellEditor.restoreSelection(h);e.insertImage(n,r,p)}else{var t=e.getSelectionCells();if(n!=null){var q=null;e.getModel().beginUpdate();try{if(t.length==0){var u=e.getFreeInsertPoint();t=[e.insertVertex(e.getDefaultParent(),null,"",u.x,u.y,r,p,"shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;")];q=t}e.setCellStyles(mxConstants.STYLE_IMAGE,n,t);var l=e.view.getState(t[0]);var m=(l!=null)?l.style:e.getCellStyle(t[0]);if(m[mxConstants.STYLE_SHAPE]!="image"&&m[mxConstants.STYLE_SHAPE]!="label"){e.setCellStyles(mxConstants.STYLE_SHAPE,"image",t)}if(e.getSelectionCount()==1){if(r!=null&&p!=null){var s=t[0];var o=e.getModel().getGeometry(s);if(o!=null){o=o.clone();o.width=r;o.height=p;e.getModel().setGeometry(s,o)}}}}finally{e.getModel().endUpdate()}if(q!=null){e.setSelectionCells(q);e.scrollCellToVisible(q[0])}}}},e.cellEditor.isContentEditing(),!e.cellEditor.isContentEditing())}}).isEnabled=c;this.addAction("insertImage...",function(){if(e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())){e.clearSelection();f.actions.get("image").funct()}}).isEnabled=c;d=this.addAction("layers",mxUtils.bind(this,function(){if(this.layersWindow==null){this.layersWindow=new LayersWindow(f,document.body.offsetWidth-280,120,220,180);this.layersWindow.window.addListener("show",function(){f.fireEvent(new mxEventObject("layers"))});this.layersWindow.window.addListener("hide",function(){f.fireEvent(new mxEventObject("layers"))});this.layersWindow.window.setVisible(true);f.fireEvent(new mxEventObject("layers"))}else{this.layersWindow.window.setVisible(!this.layersWindow.window.isVisible())}}),null,null,"Ctrl+Shift+L");d.setToggleAction(true);d.setSelectedCallback(mxUtils.bind(this,function(){return this.layersWindow!=null&&this.layersWindow.window.isVisible()}));d=this.addAction("formatPanel",mxUtils.bind(this,function(){f.toggleFormatPanel()}),null,null,"Ctrl+Shift+P");d.setToggleAction(true);d.setSelectedCallback(mxUtils.bind(this,function(){return f.formatWidth>0}));d=this.addAction("outline",mxUtils.bind(this,function(){if(this.outlineWindow==null){this.outlineWindow=new OutlineWindow(f,document.body.offsetWidth-260,100,180,180);this.outlineWindow.window.addListener("show",function(){f.fireEvent(new mxEventObject("outline"))});this.outlineWindow.window.addListener("hide",function(){f.fireEvent(new mxEventObject("outline"))});this.outlineWindow.window.setVisible(true);f.fireEvent(new mxEventObject("outline"))}else{this.outlineWindow.window.setVisible(!this.outlineWindow.window.isVisible())}f.fireEvent(new mxEventObject("outline"))}),null,null,"Ctrl+Shift+O");d.setToggleAction(true);d.setSelectedCallback(mxUtils.bind(this,function(){return this.outlineWindow!=null&&this.outlineWindow.window.isVisible()}))};Actions.prototype.addAction=function(e,b,c,d,a){var f;if(e.substring(e.length-3)=="..."){e=e.substring(0,e.length-3);f=mxResources.get(e)+"..."}else{f=mxResources.get(e)}return this.put(e,new Action(f,b,c,d,a))};Actions.prototype.put=function(a,b){this.actions[a]=b;return b};Actions.prototype.get=function(a){return this.actions[a]};function Action(d,b,c,e,a){mxEventSource.call(this);this.label=d;this.funct=b;this.enabled=(c!=null)?c:true;this.iconCls=e;this.shortcut=a;this.visible=true}mxUtils.extend(Action,mxEventSource);Action.prototype.setEnabled=function(a){if(this.enabled!=a){this.enabled=a;this.fireEvent(new mxEventObject("stateChanged"))}};Action.prototype.isEnabled=function(){return this.enabled};Action.prototype.setToggleAction=function(a){this.toggleAction=a};Action.prototype.setSelectedCallback=function(a){this.selectedCallback=a};Action.prototype.isSelected=function(){return this.selectedCallback()};function Dialog(k,c,i,e,j,l,g){var m=0;if(mxClient.IS_VML&&(document.documentMode==null||document.documentMode<8)){m=80}i+=m;e+=m;var b=Math.max(0,Math.round((document.body.scrollWidth-i)/2));var f=Math.max(0,Math.round((Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)-e-k.footerHeight)/3));if(k.dialogs.length>0){this.zIndex+=k.dialogs.length*2}var a=k.createDiv("geDialog");a.style.width=i+"px";a.style.height=e+"px";a.style.left=b+"px";a.style.top=f+"px";a.style.zIndex=this.zIndex;if(this.bg==null){this.bg=k.createDiv("background");this.bg.style.position="absolute";this.bg.style.background="white";this.bg.style.left="0px";this.bg.style.top="0px";this.bg.style.bottom="0px";this.bg.style.right="0px";this.bg.style.zIndex=this.zIndex-2;mxUtils.setOpacity(this.bg,this.bgOpacity);if(mxClient.IS_QUIRKS){new mxDivResizer(this.bg)}}if(j){document.body.appendChild(this.bg)}a.appendChild(c);document.body.appendChild(a);if(l){var d=document.createElement("img");d.setAttribute("src",Dialog.prototype.closeImage);d.setAttribute("title",mxResources.get("close"));d.className="geDialogClose";d.style.top=(f+14)+"px";d.style.left=(b+i+38-m)+"px";d.style.zIndex=this.zIndex;mxEvent.addListener(d,"click",mxUtils.bind(this,function(){k.hideDialog(true)}));document.body.appendChild(d);this.dialogImg=d;mxEvent.addListener(this.bg,"click",mxUtils.bind(this,function(){k.hideDialog(true)}))}this.onDialogClose=g;this.container=a;k.editor.fireEvent(new mxEventObject("showDialog"))}Dialog.prototype.zIndex=mxPopupMenu.prototype.zIndex-1;Dialog.prototype.noColorImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/nocolor.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkEzRDlBMUUwODYxMTExRTFCMzA4RDdDMjJBMEMxRDM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkEzRDlBMUUxODYxMTExRTFCMzA4RDdDMjJBMEMxRDM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTNEOUExREU4NjExMTFFMUIzMDhEN0MyMkEwQzFEMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTNEOUExREY4NjExMTFFMUIzMDhEN0MyMkEwQzFEMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5xh3fmAAAABlBMVEX////MzMw46qqDAAAAGElEQVR42mJggAJGKGAYIIGBth8KAAIMAEUQAIElnLuQAAAAAElFTkSuQmCC";Dialog.prototype.closeImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/close.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJAQMAAADaX5RTAAAABlBMVEV7mr3///+wksspAAAAAnRSTlP/AOW3MEoAAAAdSURBVAgdY9jXwCDDwNDRwHCwgeExmASygSL7GgB12QiqNHZZIwAAAABJRU5ErkJggg==";Dialog.prototype.clearImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/clear.gif":"data:image/gif;base64,R0lGODlhDQAKAIABAMDAwP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUIzOEM1NzI4NjEyMTFFMUEzMkNDMUE3NjZERDE2QjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUIzOEM1NzM4NjEyMTFFMUEzMkNDMUE3NjZERDE2QjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QjM4QzU3MDg2MTIxMUUxQTMyQ0MxQTc2NkREMTZCMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QjM4QzU3MTg2MTIxMUUxQTMyQ0MxQTc2NkREMTZCMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAAEALAAAAAANAAoAAAIXTGCJebD9jEOTqRlttXdrB32PJ2ncyRQAOw==";Dialog.prototype.lockedImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/locked.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzdDMDZCODExNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzdDMDZCODIxNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozN0MwNkI3RjE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozN0MwNkI4MDE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvqMCFYAAAAVUExURZmZmb+/v7KysqysrMzMzLGxsf///4g8N1cAAAAHdFJOU////////wAaSwNGAAAAPElEQVR42lTMQQ4AIQgEwUa0//9kTQirOweYOgDqAMbZUr10AGlAwx4/BJ2QJ4U0L5brYjovvpv32xZgAHZaATFtMbu4AAAAAElFTkSuQmCC";Dialog.prototype.unlockedImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/unlocked.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzdDMDZCN0QxNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzdDMDZCN0UxNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozN0MwNkI3QjE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozN0MwNkI3QzE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkKMpVwAAAAYUExURZmZmbKysr+/v6ysrOXl5czMzLGxsf///zHN5lwAAAAIdFJOU/////////8A3oO9WQAAADxJREFUeNpUzFESACAEBNBVsfe/cZJU+8Mzs8CIABCidtfGOndnYsT40HDSiCcbPdoJo10o9aI677cpwACRoAF3dFNlswAAAABJRU5ErkJggg==";Dialog.prototype.bgOpacity=80;Dialog.prototype.close=function(a){if(this.onDialogClose!=null){this.onDialogClose(a);this.onDialogClose=null}if(this.dialogImg!=null){this.dialogImg.parentNode.removeChild(this.dialogImg);this.dialogImg=null}if(this.bg!=null&&this.bg.parentNode!=null){this.bg.parentNode.removeChild(this.bg)}this.container.parentNode.removeChild(this.container)};var OpenDialog=function(){var b=document.createElement("iframe");b.style.backgroundColor="transparent";b.allowTransparency="true";b.style.borderStyle="none";b.style.borderWidth="0px";b.style.overflow="hidden";b.frameBorder="0";var a=(mxClient.IS_VML&&(document.documentMode==null||document.documentMode<8))?20:0;b.setAttribute("width",(((Editor.useLocalStorage)?640:320)+a)+"px");b.setAttribute("height",(((Editor.useLocalStorage)?480:220)+a)+"px");b.setAttribute("src",OPEN_FORM);this.container=b};var ColorDialog=function(l,d,m,k){this.editorUi=l;var i=document.createElement("input");i.style.marginBottom="10px";i.style.width="216px";if(mxClient.IS_IE){i.style.marginTop="10px";document.body.appendChild(i)}this.init=function(){if(!mxClient.IS_TOUCH){i.focus()}};var e=new jscolor.color(i);e.pickerOnfocus=false;e.showPicker();var b=document.createElement("div");jscolor.picker.box.style.position="relative";jscolor.picker.box.style.width="230px";jscolor.picker.box.style.height="100px";jscolor.picker.box.style.paddingBottom="10px";b.appendChild(jscolor.picker.box);var a=document.createElement("center");function j(){var p=c((ColorDialog.recentColors.length==0)?["FFFFFF"]:ColorDialog.recentColors,11,"FFFFFF",true);p.style.marginBottom="8px";return p}function c(u,r,p,w){r=(r!=null)?r:12;var x=document.createElement("table");x.style.borderCollapse="collapse";x.setAttribute("cellspacing","0");x.style.marginBottom="20px";x.style.cellSpacing="0px";var t=document.createElement("tbody");x.appendChild(t);var z=u.length/r;for(var y=0;y<z;y++){var v=document.createElement("tr");for(var s=0;s<r;s++){(function(A){var B=document.createElement("td");B.style.border="1px solid black";B.style.padding="0px";B.style.width="16px";B.style.height="16px";if(A==null){A=p}if(A=="none"){B.style.background="url('"+Dialog.prototype.noColorImage+"')"}else{B.style.backgroundColor="#"+A}v.appendChild(B);if(A!=null){B.style.cursor="pointer";mxEvent.addListener(B,"click",function(){if(A=="none"){e.fromString("ffffff");i.value="none"}else{e.fromString(A)}})}})(u[y*r+s])}t.appendChild(v)}if(w){var q=document.createElement("td");q.setAttribute("title",mxResources.get("reset"));q.style.border="1px solid black";q.style.padding="0px";q.style.width="16px";q.style.height="16px";q.style.backgroundImage="url('"+Dialog.prototype.closeImage+"')";q.style.backgroundPosition="center center";q.style.backgroundRepeat="no-repeat";q.style.cursor="pointer";v.appendChild(q);mxEvent.addListener(q,"click",function(){ColorDialog.resetRecentColors();x.parentNode.replaceChild(j(),x)})}a.appendChild(x);return x}b.appendChild(i);mxUtils.br(b);j();var o=c(["E6D0DE","CDA2BE","B5739D","E1D5E7","C3ABD0","A680B8","D4E1F5","A9C4EB","7EA6E0","D5E8D4","9AC7BF","67AB9F","D5E8D4","B9E0A5","97D077","FFF2CC","FFE599","FFD966","FFF4C3","FFCE9F","FFB570","F8CECC","F19C99","EA6B66"],12);o.style.marginBottom="8px";o=c(["none","FFFFFF","E6E6E6","CCCCCC","B3B3B3","999999","808080","666666","4D4D4D","333333","1A1A1A","000000","FFCCCC","FFE6CC","FFFFCC","E6FFCC","CCFFCC","CCFFE6","CCFFFF","CCE5FF","CCCCFF","E5CCFF","FFCCFF","FFCCE6","FF9999","FFCC99","FFFF99","CCFF99","99FF99","99FFCC","99FFFF","99CCFF","9999FF","CC99FF","FF99FF","FF99CC","FF6666","FFB366","FFFF66","B3FF66","66FF66","66FFB3","66FFFF","66B2FF","6666FF","B266FF","FF66FF","FF66B3","FF3333","FF9933","FFFF33","99FF33","33FF33","33FF99","33FFFF","3399FF","3333FF","9933FF","FF33FF","FF3399","FF0000","FF8000","FFFF00","80FF00","00FF00","00FF80","00FFFF","007FFF","0000FF","7F00FF","FF00FF","FF0080","CC0000","CC6600","CCCC00","66CC00","00CC00","00CC66","00CCCC","0066CC","0000CC","6600CC","CC00CC","CC0066","990000","994C00","999900","4D9900","009900","00994D","009999","004C99","000099","4C0099","990099","99004D","660000","663300","666600","336600","006600","006633","006666","003366","000066","330066","660066","660033","330000","331A00","333300","1A3300","003300","00331A","003333","001933","000033","190033","330033","33001A"]);o.style.marginBottom="16px";b.appendChild(a);var g=document.createElement("div");g.style.textAlign="right";g.style.whiteSpace="nowrap";var h=mxUtils.button(mxResources.get("cancel"),function(){l.hideDialog();if(k!=null){k()}});h.className="geBtn";if(l.editor.cancelFirst){g.appendChild(h)}var f=(m!=null)?m:this.createApplyFunction();var n=mxUtils.button(mxResources.get("apply"),function(){var p=i.value;ColorDialog.addRecentColor(p,12);if(p!="none"&&p.charAt(0)!="#"){p="#"+p}f(p);l.hideDialog()});n.className="geBtn gePrimaryBtn";g.appendChild(n);if(!l.editor.cancelFirst){g.appendChild(h)}if(d!=null){if(d=="none"){e.fromString("ffffff");i.value="none"}else{e.fromString(d)}}b.appendChild(g);this.picker=e;this.colorInput=i;mxEvent.addListener(b,"keydown",function(p){if(p.keyCode==27){l.hideDialog();if(k!=null){k()}mxEvent.consume(p)}});this.container=b};ColorDialog.prototype.createApplyFunction=function(){return mxUtils.bind(this,function(a){var b=this.editorUi.editor.graph;b.getModel().beginUpdate();try{b.setCellStyles(this.currentColorKey,a);this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",[this.currentColorKey],"values",[a],"cells",b.getSelectionCells()))}finally{b.getModel().endUpdate()}})};ColorDialog.recentColors=[];ColorDialog.addRecentColor=function(b,a){if(b!=null){mxUtils.remove(b,ColorDialog.recentColors);ColorDialog.recentColors.splice(0,0,b);if(ColorDialog.recentColors.length>a){ColorDialog.recentColors.pop()}}};ColorDialog.resetRecentColors=function(){ColorDialog.recentColors=[]};var AboutDialog=function(c){var f=document.createElement("div");f.setAttribute("align","center");var b=document.createElement("h3");mxUtils.write(b,mxResources.get("about")+" GraphEditor");f.appendChild(b);var a=document.createElement("img");a.style.border="0px";a.setAttribute("width","176");a.setAttribute("width","151");a.setAttribute("src",IMAGE_PATH+"/logo.png");f.appendChild(a);mxUtils.br(f);mxUtils.write(f,"Powered by mxGraph "+mxClient.VERSION);mxUtils.br(f);var d=document.createElement("a");d.setAttribute("href","http://www.jgraph.com/");d.setAttribute("target","_blank");mxUtils.write(d,"www.jgraph.com");f.appendChild(d);mxUtils.br(f);mxUtils.br(f);var e=mxUtils.button(mxResources.get("close"),function(){c.hideDialog()});e.className="geBtn gePrimaryBtn";f.appendChild(e);this.container=f};var PageSetupDialog=function(m){var n=m.editor.graph;var q,d;var p=document.createElement("table");p.style.width="100%";p.style.height="100%";var e=document.createElement("tbody");q=document.createElement("tr");d=document.createElement("td");d.style.verticalAlign="top";d.style.fontSize="10pt";mxUtils.write(d,mxResources.get("paperSize")+":");q.appendChild(d);d=document.createElement("td");d.style.verticalAlign="top";d.style.fontSize="10pt";var f=PageSetupDialog.addPageFormatPanel(d,"pagesetupdialog",n.pageFormat);q.appendChild(d);e.appendChild(q);q=document.createElement("tr");d=document.createElement("td");mxUtils.write(d,mxResources.get("background")+":");q.appendChild(d);d=document.createElement("td");d.style.whiteSpace="nowrap";var c=document.createElement("input");c.setAttribute("type","text");var j=document.createElement("button");j.style.width="18px";j.style.height="18px";j.style.marginRight="20px";j.style.backgroundPosition="center center";j.style.backgroundRepeat="no-repeat";var b=n.background;function h(){if(b==null||b==mxConstants.NONE){j.style.backgroundColor="";j.style.backgroundImage="url('"+Dialog.prototype.noColorImage+"')"}else{j.style.backgroundColor=b;j.style.backgroundImage=""}}h();mxEvent.addListener(j,"click",function(r){m.pickColor(b||"none",function(s){b=s;h()});mxEvent.consume(r)});d.appendChild(j);mxUtils.write(d,mxResources.get("gridSize")+":");var l=document.createElement("input");l.setAttribute("type","number");l.setAttribute("min","0");l.style.width="40px";l.style.marginLeft="6px";l.value=n.getGridSize();d.appendChild(l);mxEvent.addListener(l,"change",function(){var r=parseInt(l.value);l.value=Math.max(1,(isNaN(r))?n.getGridSize():r)});q.appendChild(d);e.appendChild(q);q=document.createElement("tr");d=document.createElement("td");mxUtils.write(d,mxResources.get("image")+":");q.appendChild(d);d=document.createElement("td");var i=document.createElement("a");i.style.textDecoration="underline";i.style.cursor="pointer";i.style.color="#a0a0a0";var a=n.backgroundImage;function g(){if(a==null){i.removeAttribute("title");i.style.fontSize="";i.innerHTML=mxResources.get("change")+"..."}else{i.setAttribute("title",a.src);i.style.fontSize="11px";i.innerHTML=a.src.substring(0,42)+"..."}}mxEvent.addListener(i,"click",function(r){m.showBackgroundImageDialog(function(s){a=s;g()});mxEvent.consume(r)});g();d.appendChild(i);q.appendChild(d);e.appendChild(q);q=document.createElement("tr");d=document.createElement("td");d.colSpan=2;d.style.paddingTop="16px";d.setAttribute("align","right");var k=mxUtils.button(mxResources.get("cancel"),function(){m.hideDialog()});k.className="geBtn";if(m.editor.cancelFirst){d.appendChild(k)}var o=mxUtils.button(mxResources.get("apply"),function(){m.hideDialog();m.setPageFormat(f.get());if(n.background!=b){m.setBackgroundColor(b)}if(n.backgroundImage!==a){m.setBackgroundImage(a)}if(n.gridSize!==l.value){n.setGridSize(parseInt(l.value))}});o.className="geBtn gePrimaryBtn";d.appendChild(o);if(!m.editor.cancelFirst){d.appendChild(k)}q.appendChild(d);e.appendChild(q);p.appendChild(e);this.container=p};PageSetupDialog.addPageFormatPanel=function(l,y,o,d){var p="format-"+y;var v=document.createElement("input");v.setAttribute("name",p);v.setAttribute("type","radio");v.setAttribute("value","portrait");var s=document.createElement("input");s.setAttribute("name",p);s.setAttribute("type","radio");s.setAttribute("value","landscape");var q=document.createElement("select");q.style.marginBottom="8px";q.style.width="202px";var j=document.createElement("div");j.style.marginLeft="4px";j.style.width="210px";j.style.height="24px";v.style.marginRight="6px";j.appendChild(v);var a=document.createElement("span");a.style.maxWidth="100px";mxUtils.write(a,mxResources.get("portrait"));j.appendChild(a);s.style.marginLeft="10px";s.style.marginRight="6px";j.appendChild(s);var u=document.createElement("span");u.style.width="100px";mxUtils.write(u,mxResources.get("landscape"));j.appendChild(u);var w=document.createElement("div");w.style.marginLeft="4px";w.style.width="210px";w.style.height="24px";var m=document.createElement("input");m.setAttribute("size","6");m.setAttribute("value",o.width);w.appendChild(m);mxUtils.write(w," x ");var k=document.createElement("input");k.setAttribute("size","6");k.setAttribute("value",o.height);w.appendChild(k);mxUtils.write(w," pt");j.style.display="none";w.style.display="none";var x=new Object();var e=PageSetupDialog.getFormats();for(var r=0;r<e.length;r++){var t=e[r];x[t.key]=t;var n=document.createElement("option");n.setAttribute("value",t.key);mxUtils.write(n,t.title);q.appendChild(n)}var h=false;function b(C,z,E){if(E||(m!=document.activeElement&&k!=document.activeElement)){var A=false;for(var B=0;B<e.length;B++){var D=e[B];if(h){if(D.key=="custom"){q.value=D.key;h=false}}else{if(D.format!=null){if(o.width==D.format.width&&o.height==D.format.height){q.value=D.key;v.setAttribute("checked","checked");v.defaultChecked=true;v.checked=true;s.removeAttribute("checked");s.defaultChecked=false;s.checked=false;A=true}else{if(o.width==D.format.height&&o.height==D.format.width){q.value=D.key;v.removeAttribute("checked");v.defaultChecked=false;v.checked=false;s.setAttribute("checked","checked");s.defaultChecked=true;s.checked=true;A=true}}}}}if(!A){m.value=o.width;k.value=o.height;n.setAttribute("selected","selected");v.setAttribute("checked","checked");v.defaultChecked=true;j.style.display="none";w.style.display=""}else{j.style.display="";w.style.display="none"}}}b();l.appendChild(q);mxUtils.br(l);l.appendChild(j);l.appendChild(w);var c=o;var g=function(){var i=x[q.value];if(i.format!=null){m.value=i.format.width;k.value=i.format.height;w.style.display="none";j.style.display=""}else{j.style.display="none";w.style.display=""}var z=new mxRectangle(0,0,parseInt(m.value),parseInt(k.value));if(q.value!="custom"&&s.checked){z=new mxRectangle(0,0,z.height,z.width)}if(z.width!=c.width||z.height!=c.height){c=z;if(d!=null){d(c)}}};mxEvent.addListener(a,"click",function(f){v.checked=true;g();mxEvent.consume(f)});mxEvent.addListener(u,"click",function(f){s.checked=true;g();mxEvent.consume(f)});mxEvent.addListener(m,"blur",g);mxEvent.addListener(m,"click",g);mxEvent.addListener(k,"blur",g);mxEvent.addListener(k,"click",g);mxEvent.addListener(s,"change",g);mxEvent.addListener(v,"change",g);mxEvent.addListener(q,"change",function(){h=q.value=="custom";g()});g();return{set:function(f){o=f;b(null,null,true)},get:function(){return c},widthInput:m,heightInput:k}};PageSetupDialog.getFormats=function(){return[{key:"letter",title:'US-Letter (8,5" x 11")',format:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT},{key:"legal",title:'US-Legal (8,5" x 14")',format:new mxRectangle(0,0,850,1400)},{key:"tabloid",title:"US-Tabloid (279 mm x 432 mm)",format:new mxRectangle(0,0,1100,1700)},{key:"a3",title:"A3 (297 mm x 420 mm)",format:new mxRectangle(0,0,1169,1652)},{key:"a4",title:"A4 (210 mm x 297 mm)",format:mxConstants.PAGE_FORMAT_A4_PORTRAIT},{key:"a5",title:"A5 (148 mm x 210 mm)",format:new mxRectangle(0,0,584,826)},{key:"custom",title:mxResources.get("custom"),format:null}]};var PrintDialog=function(a,b){this.create(a,b)};PrintDialog.prototype.create=function(k){var l=k.editor.graph;var o,a;var m=document.createElement("table");m.style.width="100%";m.style.height="100%";var c=document.createElement("tbody");o=document.createElement("tr");var d=document.createElement("input");d.setAttribute("type","checkbox");a=document.createElement("td");a.setAttribute("colspan","2");a.style.fontSize="10pt";a.appendChild(d);var j=document.createElement("span");mxUtils.write(j," "+mxResources.get("fitPage"));a.appendChild(j);mxEvent.addListener(j,"click",function(p){d.checked=!d.checked;h.checked=!d.checked;mxEvent.consume(p)});mxEvent.addListener(d,"change",function(){h.checked=!d.checked});o.appendChild(a);c.appendChild(o);o=o.cloneNode(false);var h=document.createElement("input");h.setAttribute("type","checkbox");a=document.createElement("td");a.style.fontSize="10pt";a.appendChild(h);var j=document.createElement("span");mxUtils.write(j," "+mxResources.get("posterPrint")+":");a.appendChild(j);mxEvent.addListener(j,"click",function(p){h.checked=!h.checked;d.checked=!h.checked;mxEvent.consume(p)});o.appendChild(a);var i=document.createElement("input");i.setAttribute("value","1");i.setAttribute("type","number");i.setAttribute("min","1");i.setAttribute("size","4");i.setAttribute("disabled","disabled");i.style.width="50px";a=document.createElement("td");a.style.fontSize="10pt";a.appendChild(i);mxUtils.write(a," "+mxResources.get("pages")+" (max)");o.appendChild(a);c.appendChild(o);mxEvent.addListener(h,"change",function(){if(h.checked){i.removeAttribute("disabled")}else{i.setAttribute("disabled","disabled")}d.checked=!h.checked});o=o.cloneNode(false);a=document.createElement("td");mxUtils.write(a,mxResources.get("pageScale")+":");o.appendChild(a);a=document.createElement("td");var n=document.createElement("input");n.setAttribute("value","100 %");n.setAttribute("size","5");n.style.width="50px";a.appendChild(n);o.appendChild(a);c.appendChild(o);o=document.createElement("tr");a=document.createElement("td");a.colSpan=2;a.style.paddingTop="20px";a.setAttribute("align","right");function e(p){var x=d.checked||h.checked;var A=parseInt(n.value)/100;if(isNaN(A)){A=1;n.value="100%"}A*=0.75;var w=l.pageFormat||mxConstants.PAGE_FORMAT_A4_PORTRAIT;var s=1/l.pageScale;if(x){var r=(d.checked)?1:parseInt(i.value);if(!isNaN(r)){s=mxUtils.getScaleForPageCount(r,l,w)}}var z=l.getGraphBounds();var t=0;var q=0;var y=0;w=mxRectangle.fromRectangle(w);w.width=Math.ceil(w.width*A);w.height=Math.ceil(w.height*A);s*=A;if(!x&&l.pageVisible){var u=l.getPageLayout();q-=u.x*w.width;y-=u.y*w.height}else{x=true}var v=PrintDialog.createPrintPreview(l,s,w,t,q,y,x);v.open();if(p){PrintDialog.printPreview(v)}}var g=mxUtils.button(mxResources.get("cancel"),function(){k.hideDialog()});g.className="geBtn";if(k.editor.cancelFirst){a.appendChild(g)}if(!mxClient.IS_CHROMEAPP){var f=mxUtils.button(mxResources.get("preview"),function(){k.hideDialog();e(false)});f.className="geBtn";a.appendChild(f)}var b=mxUtils.button(mxResources.get((mxClient.IS_CHROMEAPP)?"ok":"print"),function(){k.hideDialog();e(true)});b.className="geBtn gePrimaryBtn";a.appendChild(b);if(!k.editor.cancelFirst){a.appendChild(g)}o.appendChild(a);c.appendChild(o);m.appendChild(c);this.container=m};PrintDialog.printPreview=function(b){if(b.wnd!=null){var a=function(){b.wnd.focus();b.wnd.print();b.wnd.close()};if(mxClient.IS_GC){window.setTimeout(a,500)}else{a()}}};PrintDialog.createPrintPreview=function(j,b,f,c,a,h,g){var e=new mxPrintPreview(j,b,f,c,a,h);e.title=mxResources.get("preview");e.printBackgroundImage=true;e.autoOrigin=g;var d=j.background;if(d==null||d==""||d==mxConstants.NONE){d="#ffffff"}e.backgroundColor=d;var i=e.writeHead;e.writeHead=function(k){i.apply(this,arguments);k.writeln('<style type="text/css">');k.writeln("@media screen {");k.writeln("  body > div { padding:30px;box-sizing:content-box; }");k.writeln("}");k.writeln("</style>")};return e};var FilenameDialog=function(o,q,a,k,j,g,p,h,c,m){c=(c!=null)?c:true;var f,i;var r=document.createElement("table");var b=document.createElement("tbody");r.style.marginTop="8px";f=document.createElement("tr");i=document.createElement("td");i.style.whiteSpace="nowrap";i.style.fontSize="10pt";i.style.width="120px";mxUtils.write(i,(j||mxResources.get("filename"))+":");f.appendChild(i);var l=document.createElement("input");l.setAttribute("value",q||"");l.style.marginLeft="4px";l.style.width="180px";var e=mxUtils.button(a,function(){if(g==null||g(l.value)){if(c){o.hideDialog()}k(l.value)}});e.className="geBtn gePrimaryBtn";this.init=function(){if(j==null&&p!=null){return}l.focus();if(mxClient.IS_FF||document.documentMode>=5||mxClient.IS_QUIRKS){l.select()}else{document.execCommand("selectAll",false,null)}if(Graph.fileSupport){var u=r.parentNode;var t=o.editor.graph;var s=null;mxEvent.addListener(u,"dragleave",function(v){if(s!=null){s.style.backgroundColor="";s=null}v.stopPropagation();v.preventDefault()});mxEvent.addListener(u,"dragover",mxUtils.bind(this,function(v){if(s==null&&(!mxClient.IS_IE||document.documentMode>10)){s=l;s.style.backgroundColor="#ebf2f9"}v.stopPropagation();v.preventDefault()}));mxEvent.addListener(u,"drop",mxUtils.bind(this,function(v){if(s!=null){s.style.backgroundColor="";s=null}if(mxUtils.indexOf(v.dataTransfer.types,"text/uri-list")>=0){l.value=decodeURIComponent(v.dataTransfer.getData("text/uri-list"));e.click()}v.stopPropagation();v.preventDefault()}))}};i=document.createElement("td");i.appendChild(l);f.appendChild(i);if(j!=null||p==null){b.appendChild(f)}if(p!=null){f=document.createElement("tr");i=document.createElement("td");i.colSpan=2;i.appendChild(p);f.appendChild(i);b.appendChild(f)}f=document.createElement("tr");i=document.createElement("td");i.colSpan=2;i.style.paddingTop="20px";i.style.whiteSpace="nowrap";i.setAttribute("align","right");var n=mxUtils.button(mxResources.get("cancel"),function(){o.hideDialog();if(m!=null){m()}});n.className="geBtn";if(o.editor.cancelFirst){i.appendChild(n)}if(h!=null){var d=mxUtils.button(mxResources.get("help"),function(){window.open(h)});d.className="geBtn";i.appendChild(d)}mxEvent.addListener(l,"keypress",function(s){if(s.keyCode==13){e.click()}});i.appendChild(e);if(!o.editor.cancelFirst){i.appendChild(n)}f.appendChild(i);b.appendChild(f);r.appendChild(b);this.container=r};var TextareaDialog=function(q,t,e,j,m,c,l,r,b,p,o,d){l=(l!=null)?l:300;r=(r!=null)?r:120;p=(p!=null)?p:false;var g,i;var s=document.createElement("table");var a=document.createElement("tbody");g=document.createElement("tr");i=document.createElement("td");i.style.fontSize="10pt";i.style.width="100px";mxUtils.write(i,t);g.appendChild(i);a.appendChild(g);g=document.createElement("tr");i=document.createElement("td");var k=document.createElement("textarea");if(o){k.setAttribute("wrap","off")}mxUtils.write(k,e||"");k.style.resize="none";k.style.width=l+"px";k.style.height=r+"px";this.textarea=k;this.init=function(){k.focus();k.scrollTop=0};i.appendChild(k);g.appendChild(i);a.appendChild(g);g=document.createElement("tr");i=document.createElement("td");i.style.paddingTop="14px";i.style.whiteSpace="nowrap";i.setAttribute("align","right");var n=mxUtils.button(c||mxResources.get("cancel"),function(){q.hideDialog();if(m!=null){m()}});n.className="geBtn";if(q.editor.cancelFirst){i.appendChild(n)}if(b!=null){b(i)}if(j!=null){var f=mxUtils.button(d||mxResources.get("apply"),function(){if(!p){q.hideDialog()}j(k.value)});f.className="geBtn gePrimaryBtn";i.appendChild(f)}if(!q.editor.cancelFirst){i.appendChild(n)}g.appendChild(i);a.appendChild(g);s.appendChild(a);this.container=s};var EditDiagramDialog=function(k){var a=document.createElement("div");a.style.textAlign="right";var j=document.createElement("textarea");j.setAttribute("wrap","off");j.style.overflow="auto";j.style.resize="none";j.style.width="600px";j.style.height="370px";j.style.marginBottom="16px";j.value=mxUtils.getPrettyXml(k.editor.getGraphXml());a.appendChild(j);this.init=function(){j.focus()};if(Graph.fileSupport){function l(n){n.stopPropagation();n.preventDefault();if(n.dataTransfer.files.length>0){var o=n.dataTransfer.files[0];var m=new FileReader();m.onload=function(p){j.value=p.target.result};m.readAsText(o)}else{j.value=k.extractGraphModelFromEvent(n)}}function d(m){m.stopPropagation();m.preventDefault()}j.addEventListener("dragover",d,false);j.addEventListener("drop",l,false)}var h=mxUtils.button(mxResources.get("cancel"),function(){k.hideDialog()});h.className="geBtn";if(k.editor.cancelFirst){a.appendChild(h)}var i=document.createElement("select");i.style.width="180px";i.className="geBtn";if(k.editor.graph.isEnabled()){var e=document.createElement("option");e.setAttribute("value","replace");mxUtils.write(e,mxResources.get("replaceExistingDrawing"));i.appendChild(e)}var f=document.createElement("option");f.setAttribute("value","new");mxUtils.write(f,mxResources.get("openInNewWindow"));var c=window.chrome!=null&&chrome.app!=null&&chrome.app.runtime!=null;if(!c){i.appendChild(f)}if(k.editor.graph.isEnabled()){var b=document.createElement("option");b.setAttribute("value","import");mxUtils.write(b,mxResources.get("addToExistingDrawing"));i.appendChild(b)}a.appendChild(i);var g=mxUtils.button(mxResources.get("ok"),function(){var q=k.editor.graph.zapGremlins(mxUtils.trim(j.value));var n=null;if(i.value=="new"){window.openFile=new OpenFile(function(){k.hideDialog();window.openFile=null});window.openFile.setData(q,null);window.open(k.getUrl())}else{if(i.value=="replace"){k.editor.graph.model.beginUpdate();try{k.editor.setGraphXml(mxUtils.parseXml(q).documentElement);k.hideDialog()}catch(s){n=s}finally{k.editor.graph.model.endUpdate()}}else{if(i.value=="import"){k.editor.graph.model.beginUpdate();try{var r=mxUtils.parseXml(q);var m=new mxGraphModel();var p=new mxCodec(r);p.decode(r.documentElement,m);var o=m.getChildren(m.getChildAt(m.getRoot(),0));k.editor.graph.setSelectionCells(k.editor.graph.importCells(o));k.hideDialog()}catch(s){n=s}finally{k.editor.graph.model.endUpdate()}}}}if(n!=null){mxUtils.alert(n.message)}});g.className="geBtn gePrimaryBtn";a.appendChild(g);if(!k.editor.cancelFirst){a.appendChild(h)}this.container=a};var ExportDialog=function(u){var d=u.editor.graph;var i=d.getGraphBounds();var A=d.view.scale;var t=Math.ceil(i.width/A);var s=Math.ceil(i.height/A);var h,j;var y=document.createElement("table");var a=document.createElement("tbody");y.setAttribute("cellpadding",(mxClient.IS_SF)?"0":"2");h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";j.style.width="100px";mxUtils.write(j,mxResources.get("filename")+":");h.appendChild(j);var l=document.createElement("input");l.setAttribute("value",u.editor.getOrCreateFilename());l.style.width="180px";j=document.createElement("td");j.appendChild(l);h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("format")+":");h.appendChild(j);var m=document.createElement("select");m.style.width="180px";var f=document.createElement("option");f.setAttribute("value","png");mxUtils.write(f,mxResources.get("formatPng"));m.appendChild(f);var z=document.createElement("option");if(ExportDialog.showGifOption){z.setAttribute("value","gif");mxUtils.write(z,mxResources.get("formatGif"));m.appendChild(z)}var v=document.createElement("option");v.setAttribute("value","jpg");mxUtils.write(v,mxResources.get("formatJpg"));m.appendChild(v);var g=document.createElement("option");g.setAttribute("value","pdf");mxUtils.write(g,mxResources.get("formatPdf"));m.appendChild(g);var c=document.createElement("option");c.setAttribute("value","svg");mxUtils.write(c,mxResources.get("formatSvg"));m.appendChild(c);if(ExportDialog.showXmlOption){var e=document.createElement("option");e.setAttribute("value","xml");mxUtils.write(e,mxResources.get("formatXml"));m.appendChild(e)}j=document.createElement("td");j.appendChild(m);h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("zoom")+" (%):");h.appendChild(j);var b=document.createElement("input");b.setAttribute("type","number");b.setAttribute("value","100");b.style.width="180px";j=document.createElement("td");j.appendChild(b);h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("width")+":");h.appendChild(j);var r=document.createElement("input");r.setAttribute("value",t);r.style.width="180px";j=document.createElement("td");j.appendChild(r);h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("height")+":");h.appendChild(j);var p=document.createElement("input");p.setAttribute("value",s);p.style.width="180px";j=document.createElement("td");j.appendChild(p);h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("background")+":");h.appendChild(j);var k=document.createElement("input");k.setAttribute("type","checkbox");k.checked=d.background==null||d.background==mxConstants.NONE;j=document.createElement("td");j.appendChild(k);mxUtils.write(j,mxResources.get("transparent"));h.appendChild(j);a.appendChild(h);h=document.createElement("tr");j=document.createElement("td");j.style.fontSize="10pt";mxUtils.write(j,mxResources.get("borderWidth")+":");h.appendChild(j);var x=document.createElement("input");x.setAttribute("type","number");x.setAttribute("value",ExportDialog.lastBorderValue);x.style.width="180px";j=document.createElement("td");j.appendChild(x);h.appendChild(j);a.appendChild(h);y.appendChild(a);function o(){var C=l.value;var B=C.lastIndexOf(".");if(B>0){l.value=C.substring(0,B+1)+m.value}else{l.value=C+"."+m.value}if(m.value==="xml"){b.setAttribute("disabled","true");r.setAttribute("disabled","true");p.setAttribute("disabled","true");x.setAttribute("disabled","true")}else{b.removeAttribute("disabled");r.removeAttribute("disabled");p.removeAttribute("disabled");x.removeAttribute("disabled")}if(m.value==="png"||m.value==="svg"){k.removeAttribute("disabled")}else{k.setAttribute("disabled","disabled")}}mxEvent.addListener(m,"change",o);o();function w(){if(r.value*p.value>MAX_AREA||r.value<=0){r.style.backgroundColor="red"}else{r.style.backgroundColor=""}if(r.value*p.value>MAX_AREA||p.value<=0){p.style.backgroundColor="red"}else{p.style.backgroundColor=""}}mxEvent.addListener(b,"change",function(){var B=Math.max(0,parseFloat(b.value)||100)/100;b.value=parseFloat((B*100).toFixed(2));if(t>0){r.value=Math.floor(t*B);p.value=Math.floor(s*B)}else{b.value="100";r.value=t;p.value=s}w()});mxEvent.addListener(r,"change",function(){var B=parseInt(r.value)/t;if(B>0){b.value=parseFloat((B*100).toFixed(2));p.value=Math.floor(s*B)}else{b.value="100";r.value=t;p.value=s}w()});mxEvent.addListener(p,"change",function(){var B=parseInt(p.value)/s;if(B>0){b.value=parseFloat((B*100).toFixed(2));r.value=Math.floor(t*B)}else{b.value="100";r.value=t;p.value=s}w()});h=document.createElement("tr");j=document.createElement("td");j.setAttribute("align","right");j.style.paddingTop="22px";j.colSpan=2;var n=mxUtils.button(mxResources.get("export"),mxUtils.bind(this,function(){if(parseInt(b.value)<=0){mxUtils.alert(mxResources.get("drawingEmpty"))}else{var C=l.value;var F=m.value;var E=Math.max(0,parseFloat(b.value)||100)/100;var B=Math.max(0,parseInt(x.value));var D=d.background;if((F=="svg"||F=="png")&&k.checked){D=null}else{if(D==null||D==mxConstants.NONE){D="#ffffff"}}ExportDialog.lastBorderValue=B;ExportDialog.exportFile(u,C,F,D,E,B)}}));n.className="geBtn gePrimaryBtn";var q=mxUtils.button(mxResources.get("cancel"),function(){u.hideDialog()});q.className="geBtn";if(u.editor.cancelFirst){j.appendChild(q);j.appendChild(n)}else{j.appendChild(n);j.appendChild(q)}h.appendChild(j);a.appendChild(h);y.appendChild(a);this.container=y};ExportDialog.lastBorderValue=0;ExportDialog.showGifOption=true;ExportDialog.showXmlOption=true;ExportDialog.exportFile=function(o,c,n,f,r,l){var p=o.editor.graph;if(n=="xml"){ExportDialog.saveLocalFile(o,mxUtils.getXml(o.editor.getGraphXml()),c,n)}else{if(n=="svg"){ExportDialog.saveLocalFile(o,mxUtils.getXml(p.getSvg(f,r,l)),c,n)}else{var a=p.getGraphBounds();var q=mxUtils.createXmlDocument();var k=q.createElement("output");q.appendChild(k);var e=new mxXmlCanvas2D(k);e.translate(Math.floor((l/r-a.x)/p.view.scale),Math.floor((l/r-a.y)/p.view.scale));e.scale(r/p.view.scale);var i=new mxImageExport();i.drawState(p.getView().getState(p.model.root),e);var d="xml="+encodeURIComponent(mxUtils.getXml(k));var m=Math.ceil(a.width*r/p.view.scale+2*l);var g=Math.ceil(a.height*r/p.view.scale+2*l);if(d.length<=MAX_REQUEST_SIZE&&m*g<MAX_AREA){o.hideDialog();var j=new mxXmlRequest(EXPORT_URL,"format="+n+"&filename="+encodeURIComponent(c)+"&bg="+((f!=null)?f:"none")+"&w="+m+"&h="+g+"&"+d);j.simulate(document,"_blank")}else{mxUtils.alert(mxResources.get("drawingTooLarge"))}}}};ExportDialog.saveLocalFile=function(b,d,a,e){if(d.length<MAX_REQUEST_SIZE){b.hideDialog();var c=new mxXmlRequest(SAVE_URL,"xml="+encodeURIComponent(d)+"&filename="+encodeURIComponent(a)+"&format="+e);c.simulate(document,"_blank")}else{mxUtils.alert(mxResources.get("drawingTooLarge"));mxUtils.popup(xml)}};var EditDataDialog=function(t,d){var q=document.createElement("div");var f=t.editor.graph;q.style.height="310px";q.style.overflow="auto";var v=f.getModel().getValue(d);if(!mxUtils.isNode(v)){var B=mxUtils.createXmlDocument();var o=B.createElement("object");o.setAttribute("label",v||"");v=o}var e=new mxForm("properties");e.table.style.width="100%";e.table.style.paddingRight="20px";var u=v.attributes;var p=[];var b=[];var j=0;var g=function(F,D){F.parentNode.style.marginRight="12px";var C=document.createElement("a");var i=mxUtils.createImage(Dialog.prototype.closeImage);i.style.height="9px";i.style.fontSize="9px";i.style.marginBottom="7px";C.className="geButton";C.setAttribute("title",mxResources.get("delete"));C.style.margin="0px";C.style.width="14px";C.style.height="14px";C.style.fontSize="14px";C.style.cursor="pointer";C.style.marginLeft="6px";C.appendChild(i);var E=(function(G){return function(){var I=0;for(var H=0;H<p.length;H++){if(p[H]==G){b[H]=null;e.table.deleteRow(I);break}if(b[H]!=null){I++}}}})(D);mxEvent.addListener(C,"click",E);F.parentNode.style.whiteSpace="nowrap";F.parentNode.appendChild(C)};var a=function(C,i,D){p[C]=i;b[C]=e.addTextarea(p[j]+":",D,2);b[C].style.width="100%";g(b[C],i)};var z=[];for(var w=0;w<u.length;w++){if(u[w].nodeName!="label"&&u[w].nodeName!="placeholders"){z.push({name:u[w].nodeName,value:u[w].nodeValue})}}z.sort(function(C,i){return ~~(C.name>i.name)});for(var w=0;w<z.length;w++){a(j,z[w].name,z[w].value);j++}q.appendChild(e.table);var r=document.createElement("div");r.style.whiteSpace="nowrap";r.style.marginTop="6px";var l=document.createElement("input");l.setAttribute("placeholder",mxResources.get("enterPropertyName"));l.setAttribute("type","text");l.setAttribute("size",(mxClient.IS_QUIRKS)?"18":"22");l.style.marginLeft="2px";r.appendChild(l);q.appendChild(r);var c=mxUtils.button(mxResources.get("addProperty"),function(){var C=l.value;if(C.length>0&&C!="label"&&C!="placeholders"){try{var i=mxUtils.indexOf(p,C);if(i>=0&&b[i]!=null){b[i].focus()}else{var F=v.cloneNode(false);F.setAttribute(C,"");if(i>=0){p.splice(i,1);b.splice(i,1)}p.push(C);var E=e.addTextarea(C+":","",2);E.style.width="100%";b.push(E);g(E,C);E.focus()}l.value=""}catch(D){mxUtils.alert(D)}}else{mxUtils.alert(mxResources.get("invalidName"))}});this.init=function(){if(b.length>0){b[0].focus()}else{l.focus()}};c.setAttribute("disabled","disabled");c.style.marginLeft="10px";c.style.width="144px";r.appendChild(c);var s=mxUtils.button(mxResources.get("cancel"),function(){t.hideDialog.apply(t,arguments)});s.className="geBtn";var h=mxUtils.button(mxResources.get("apply"),function(){try{t.hideDialog.apply(t,arguments);v=v.cloneNode(true);var D=false;for(var C=0;C<p.length;C++){if(b[C]==null){v.removeAttribute(p[C])}else{v.setAttribute(p[C],b[C].value);D=D||(p[C]=="placeholder"&&v.getAttribute("placeholders")=="1")}}if(D){v.removeAttribute("label")}f.getModel().setValue(d,v)}catch(E){mxUtils.alert(E)}});h.className="geBtn gePrimaryBtn";function n(){if(l.value.length>0){c.removeAttribute("disabled")}else{c.setAttribute("disabled","disabled")}}mxEvent.addListener(l,"keyup",n);mxEvent.addListener(l,"change",n);var x=document.createElement("div");x.style.marginTop="18px";x.style.textAlign="right";if(t.editor.graph.getModel().isVertex(d)||t.editor.graph.getModel().isEdge(d)){var A=document.createElement("span");A.style.marginRight="10px";var m=document.createElement("input");m.setAttribute("type","checkbox");m.style.marginRight="6px";if(v.getAttribute("placeholders")=="1"){m.setAttribute("checked","checked");m.defaultChecked=true}mxEvent.addListener(m,"click",function(){if(v.getAttribute("placeholders")=="1"){v.removeAttribute("placeholders")}else{v.setAttribute("placeholders","1")}});A.appendChild(m);mxUtils.write(A,mxResources.get("placeholders"));if(EditDataDialog.placeholderHelpLink!=null){var k=document.createElement("a");k.setAttribute("href",EditDataDialog.placeholderHelpLink);k.setAttribute("title",mxResources.get("help"));k.setAttribute("target","_blank");k.style.marginLeft="10px";k.style.cursor="help";var y=document.createElement("img");y.setAttribute("border","0");y.setAttribute("valign","middle");y.style.marginTop="-4px";y.setAttribute("src",Editor.helpImage);k.appendChild(y);A.appendChild(k)}x.appendChild(A)}if(t.editor.cancelFirst){x.appendChild(s);x.appendChild(h)}else{x.appendChild(h);x.appendChild(s)}q.appendChild(x);this.container=q};EditDataDialog.placeholderHelpLink=null;var LinkDialog=function(h,i,d,e){var a=document.createElement("div");mxUtils.write(a,mxResources.get("editLink")+":");var j=document.createElement("div");j.className="geTitle";j.style.backgroundColor="transparent";j.style.borderColor="transparent";j.style.whiteSpace="nowrap";j.style.textOverflow="clip";j.style.cursor="default";if(!mxClient.IS_VML){j.style.paddingRight="20px"}var k=document.createElement("input");k.setAttribute("value",i);k.setAttribute("placeholder","http://www.example.com/");k.setAttribute("type","text");k.style.marginTop="6px";k.style.width="400px";k.style.backgroundImage="url('"+Dialog.prototype.clearImage+"')";k.style.backgroundRepeat="no-repeat";k.style.backgroundPosition="100% 50%";k.style.paddingRight="14px";var g=document.createElement("div");g.setAttribute("title",mxResources.get("reset"));g.style.position="relative";g.style.left="-16px";g.style.width="12px";g.style.height="14px";g.style.cursor="pointer";g.style.display=(mxClient.IS_VML)?"inline":"inline-block";g.style.top=((mxClient.IS_VML)?0:3)+"px";g.style.background="url("+IMAGE_PATH+"/transparent.gif)";mxEvent.addListener(g,"click",function(){k.value="";k.focus()});j.appendChild(k);j.appendChild(g);a.appendChild(j);this.init=function(){k.focus();if(mxClient.IS_FF||document.documentMode>=5||mxClient.IS_QUIRKS){k.select()}else{document.execCommand("selectAll",false,null)}};var c=document.createElement("div");c.style.marginTop="18px";c.style.textAlign="right";mxEvent.addListener(k,"keypress",function(l){if(l.keyCode==13){h.hideDialog();e(k.value)}});var f=mxUtils.button(mxResources.get("cancel"),function(){h.hideDialog()});f.className="geBtn";if(h.editor.cancelFirst){c.appendChild(f)}var b=mxUtils.button(d,function(){h.hideDialog();e(k.value)});b.className="geBtn gePrimaryBtn";c.appendChild(b);if(!h.editor.cancelFirst){c.appendChild(f)}a.appendChild(c);this.container=a};var OutlineWindow=function(l,i,f,k,d){var m=l.editor.graph;var b=document.createElement("div");b.style.position="absolute";b.style.width="100%";b.style.height="100%";b.style.border="1px solid whiteSmoke";b.style.overflow="hidden";this.window=new mxWindow(mxResources.get("outline"),b,i,f,k,d,true,true);this.window.destroyOnClose=false;this.window.setMaximizable(false);this.window.setResizable(true);this.window.setClosable(true);this.window.setVisible(true);this.window.setLocation=function(h,n){h=Math.max(0,h);n=Math.max(0,n);mxWindow.prototype.setLocation.apply(this,arguments)};mxEvent.addListener(window,"resize",mxUtils.bind(this,function(){var n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var h=this.window.getX();var p=this.window.getY();if(h+this.window.table.clientWidth>n){h=Math.max(0,n-this.window.table.clientWidth)}if(p+this.window.table.clientHeight>o){p=Math.max(0,o-this.window.table.clientHeight)}if(this.window.getX()!=h||this.window.getY()!=p){this.window.setLocation(h,p)}}));var a=l.createOutline(this.window);this.window.addListener(mxEvent.RESIZE,mxUtils.bind(this,function(){a.update(false);a.outline.sizeDidChange()}));this.window.addListener(mxEvent.SHOW,mxUtils.bind(this,function(){a.suspended=false;a.outline.refresh();a.update()}));this.window.addListener(mxEvent.HIDE,mxUtils.bind(this,function(){a.suspended=true}));this.window.addListener(mxEvent.NORMALIZE,mxUtils.bind(this,function(){a.suspended=false;a.update()}));this.window.addListener(mxEvent.MINIMIZE,mxUtils.bind(this,function(){a.suspended=true}));var g=a.createGraph;a.createGraph=function(h){var n=g.apply(this,arguments);n.gridEnabled=false;n.pageScale=m.pageScale;n.pageFormat=m.pageFormat;n.background=m.background;n.pageVisible=m.pageVisible;var o=mxUtils.getCurrentStyle(m.container);b.style.backgroundColor=o.backgroundColor;return n};function c(){a.outline.pageScale=m.pageScale;a.outline.pageFormat=m.pageFormat;a.outline.pageVisible=m.pageVisible;a.outline.background=m.background;var h=mxUtils.getCurrentStyle(m.container);b.style.backgroundColor=h.backgroundColor;if(m.view.backgroundPageShape!=null&&a.outline.view.backgroundPageShape!=null){a.outline.view.backgroundPageShape.fill=m.view.backgroundPageShape.fill}a.outline.refresh()}a.init(b);l.editor.addListener("resetGraphView",c);l.addListener("pageFormatChanged",c);l.addListener("backgroundColorChanged",c);l.addListener("backgroundImageChanged",c);l.addListener("pageViewChanged",function(){c();a.update(true)});if(a.outline.dialect==mxConstants.DIALECT_SVG){var j=l.actions.get("zoomIn");var e=l.actions.get("zoomOut");mxEvent.addMouseWheelListener(function(n,h){var o=false;var p=mxEvent.getSource(n);while(p!=null){if(p==a.outline.view.canvas.ownerSVGElement){o=true;break}p=p.parentNode}if(o){if(h){j.funct()}else{e.funct()}mxEvent.consume(n)}})}};var LayersWindow=function(s,k,j,m,v){var a=s.editor.graph;var n=document.createElement("div");n.style.userSelect="none";n.style.background="whiteSmoke";n.style.border="1px solid whiteSmoke";n.style.height="100%";n.style.marginBottom="10px";n.style.overflow="auto";var t=(!EditorUi.compactUi)?"30px":"26px";var l=document.createElement("div");l.style.backgroundColor="#e5e5e5";l.style.position="absolute";l.style.overflow="auto";l.style.left="0px";l.style.right="0px";l.style.top="0px";l.style.bottom=(parseInt(t)+7)+"px";n.appendChild(l);var p=null;var b=null;mxEvent.addListener(n,"dragover",function(h){h.dataTransfer.dropEffect="move";b=0;h.stopPropagation();h.preventDefault()});mxEvent.addListener(n,"drop",function(h){h.stopPropagation();h.preventDefault()});var f=null;var i=null;var r=document.createElement("div");r.className="geToolbarContainer";r.style.position="absolute";r.style.bottom="0px";r.style.left="0px";r.style.right="0px";r.style.height=t;r.style.overflow="hidden";r.style.padding=(!EditorUi.compactUi)?"1px":"4px 0px 3px 0px";r.style.backgroundColor="whiteSmoke";r.style.borderWidth="1px 0px 0px 0px";r.style.borderColor="#c3c3c3";r.style.borderStyle="solid";r.style.display="block";r.style.whiteSpace="nowrap";if(mxClient.IS_QUIRKS){r.style.filter="none"}var e=document.createElement("a");e.className="geButton";if(mxClient.IS_QUIRKS){e.style.filter="none"}var g=e.cloneNode();g.innerHTML='<div class="geSprite geSprite-delete" style="display:inline-block;"></div>';mxEvent.addListener(g,"click",function(h){if(a.isEnabled()){a.model.beginUpdate();try{var w=a.model.root.getIndex(i);a.removeCells([i],false);if(a.model.getChildCount(a.model.root)==0){a.model.add(a.model.root,new mxCell());a.setDefaultParent(null)}else{if(w>0&&w<=a.model.getChildCount(a.model.root)){a.setDefaultParent(a.model.getChildAt(a.model.root,w-1))}else{a.setDefaultParent(null)}}}finally{a.model.endUpdate()}}mxEvent.consume(h)});if(!a.isEnabled()){g.className="geButton mxDisabled"}r.appendChild(g);var z=e.cloneNode();z.innerHTML='<div class="geSprite geSprite-insert" style="display:inline-block;"></div>';mxEvent.addListener(z,"click",function(h){if(a.isEnabled()&&!a.isSelectionEmpty()){a.moveCells(a.getSelectionCells(),0,0,false,i)}});r.appendChild(z);var q=e.cloneNode();q.innerHTML='<div class="geSprite geSprite-dots" style="display:inline-block;"></div>';q.setAttribute("title",mxResources.get("rename"));function o(h){if(a.isEnabled()&&h!=null){var w=new FilenameDialog(s,h.value||mxResources.get("background"),mxResources.get("rename"),mxUtils.bind(this,function(x){if(x!=null){a.getModel().setValue(h,x)}}),mxResources.get("enterName"));s.showDialog(w.container,300,100,true,true);w.init()}}mxEvent.addListener(q,"click",function(h){if(a.isEnabled()){o(i)}mxEvent.consume(h)});if(!a.isEnabled()){q.className="geButton mxDisabled"}r.appendChild(q);var u=e.cloneNode();u.innerHTML='<div class="geSprite geSprite-duplicate" style="display:inline-block;"></div>';mxEvent.addListener(u,"click",function(h){if(a.isEnabled()){var w=null;a.model.beginUpdate();try{w=a.cloneCells([i])[0];w.value=mxResources.get("untitledLayer");w.setVisible(true);w=a.addCell(w,a.model.root);a.setDefaultParent(w)}finally{a.model.endUpdate()}if(w!=null&&!a.isCellLocked(w)){a.selectAll(w)}}});if(!a.isEnabled()){u.className="geButton mxDisabled"}r.appendChild(u);var d=e.cloneNode();d.innerHTML='<div class="geSprite geSprite-plus" style="display:inline-block;"></div>';d.setAttribute("title",mxResources.get("addLayer"));mxEvent.addListener(d,"click",function(w){if(a.isEnabled()){a.model.beginUpdate();try{var h=a.addCell(new mxCell(mxResources.get("untitledLayer")),a.model.root);a.setDefaultParent(h)}finally{a.model.endUpdate()}}mxEvent.consume(w)});if(!a.isEnabled()){d.className="geButton mxDisabled"}r.appendChild(d);n.appendChild(r);function c(){f=a.model.getChildCount(a.model.root);l.innerHTML="";function w(F,H,A,K){var J=document.createElement("div");J.className="geToolbarContainer";J.style.overflow="hidden";J.style.position="relative";J.style.padding="4px";J.style.height="22px";J.style.display="block";J.style.backgroundColor="whiteSmoke";J.style.borderWidth="0px 0px 1px 0px";J.style.borderColor="#c3c3c3";J.style.borderStyle="solid";J.style.whiteSpace="nowrap";var C=document.createElement("div");C.style.display="inline-block";C.style.width="100%";C.style.textOverflow="ellipsis";C.style.overflow="hidden";mxEvent.addListener(J,"dragover",function(L){L.dataTransfer.dropEffect="move";b=F;L.stopPropagation();L.preventDefault()});mxEvent.addListener(J,"dragstart",function(L){p=J;if(mxClient.IS_FF){L.dataTransfer.setData("Text","<layer/>")}});mxEvent.addListener(J,"dragend",function(L){if(p!=null&&b!=null){a.addCell(A,a.model.root,b)}p=null;b=null;L.stopPropagation();L.preventDefault()});var B=document.createElement("img");B.setAttribute("draggable","false");B.setAttribute("align","top");B.setAttribute("border","0");B.style.cursor="pointer";B.style.padding="4px";B.setAttribute("title",mxResources.get("lockUnlock"));var y=a.view.getState(A);var x=(y!=null)?y.style:a.getCellStyle(A);if(mxUtils.getValue(x,"locked","0")=="1"){B.setAttribute("src",Dialog.prototype.lockedImage)}else{B.setAttribute("src",Dialog.prototype.unlockedImage)}mxEvent.addListener(B,"click",function(L){if(a.isEnabled()){var M=null;a.getModel().beginUpdate();try{M=(mxUtils.getValue(x,"locked","0")=="1")?null:"1";a.setCellStyles("locked",M,[A])}finally{a.getModel().endUpdate()}if(M=="1"){a.removeSelectionCells(a.getModel().getDescendants(A))}mxEvent.consume(L)}});C.appendChild(B);var G=document.createElement("input");G.setAttribute("type","checkbox");G.setAttribute("title",mxResources.get("hideIt",[A.value||mxResources.get("background")]));G.style.marginLeft="4px";G.style.marginRight="6px";G.style.marginTop="4px";C.appendChild(G);if(!a.isEnabled()){G.setAttribute("disabled","disabled")}if(a.model.isVisible(A)){G.setAttribute("checked","checked");G.defaultChecked=true}mxEvent.addListener(G,"click",function(L){if(a.isEnabled()){a.model.setVisible(A,!a.model.isVisible(A));mxEvent.consume(L)}});mxUtils.write(C,H);J.appendChild(C);if(a.isEnabled()){if(mxClient.IS_TOUCH||mxClient.IS_POINTER||mxClient.IS_VML||(mxClient.IS_IE&&document.documentMode<10)){var I=document.createElement("div");I.style.display="block";I.style.textAlign="right";I.style.whiteSpace="nowrap";I.style.position="absolute";I.style.right="6px";I.style.top="6px";if(F>0){var D=document.createElement("a");D.setAttribute("title",mxResources.get("toBack"));D.className="geButton";D.style.cssFloat="none";D.innerHTML="&#9660;";D.style.width="14px";D.style.height="14px";D.style.fontSize="14px";D.style.margin="0px";D.style.marginTop="-1px";I.appendChild(D);mxEvent.addListener(D,"click",function(L){if(a.isEnabled()){a.addCell(A,a.model.root,F-1)}mxEvent.consume(L)})}if(F>=0&&F<f-1){var E=document.createElement("a");E.setAttribute("title",mxResources.get("toFront"));E.className="geButton";E.style.cssFloat="none";E.innerHTML="&#9650;";E.style.width="14px";E.style.height="14px";E.style.fontSize="14px";E.style.margin="0px";E.style.marginTop="-1px";I.appendChild(E);mxEvent.addListener(E,"click",function(L){if(a.isEnabled()){a.addCell(A,a.model.root,F+1)}mxEvent.consume(L)})}J.appendChild(I)}if(mxClient.IS_SVG&&(!mxClient.IS_IE||document.documentMode>=10)){J.setAttribute("draggable","true");J.style.cursor="move"}}mxEvent.addListener(J,"dblclick",function(L){var M=mxEvent.getSource(L).nodeName;if(M!="INPUT"&&M!="IMG"){o(A);mxEvent.consume(L)}});if(a.getDefaultParent()==A){J.style.background="#e6eff8";J.style.fontWeight="bold";i=A}else{mxEvent.addListener(J,"click",function(L){if(a.isEnabled()){a.setDefaultParent(K);a.view.setCurrentRoot(null);c()}})}l.appendChild(J)}for(var h=f-1;h>=0;h--){(mxUtils.bind(this,function(x){w(h,x.value||mxResources.get("background"),x,x)}))(a.model.getChildAt(a.model.root,h))}g.setAttribute("title",mxResources.get("removeIt",[i.value||mxResources.get("background")]));z.setAttribute("title",mxResources.get("moveSelectionTo",[i.value||mxResources.get("background")]));u.setAttribute("title",mxResources.get("duplicateIt",[i.value||mxResources.get("background")]));q.setAttribute("title",mxResources.get("renameIt",[i.value||mxResources.get("background")]));if(a.isSelectionEmpty()){z.className="geButton mxDisabled"}}c();a.model.addListener(mxEvent.CHANGE,function(){c()});a.selectionModel.addListener(mxEvent.CHANGE,function(){if(a.isSelectionEmpty()){z.className="geButton mxDisabled"}else{z.className="geButton"}});this.window=new mxWindow(mxResources.get("layers"),n,k,j,m,v,true,true);this.window.destroyOnClose=false;this.window.setMaximizable(false);this.window.setResizable(true);this.window.setClosable(true);this.window.setVisible(true);this.refreshLayers=c;this.window.setLocation=function(h,w){h=Math.max(0,h);w=Math.max(0,w);mxWindow.prototype.setLocation.apply(this,arguments)};mxEvent.addListener(window,"resize",mxUtils.bind(this,function(){var w=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var A=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var h=this.window.getX();var B=this.window.getY();if(h+this.window.table.clientWidth>w){h=Math.max(0,w-this.window.table.clientWidth)}if(B+this.window.table.clientHeight>A){B=Math.max(0,A-this.window.table.clientHeight)}if(this.window.getX()!=h||this.window.getY()!=B){this.window.setLocation(h,B)}}))};Editor=function(b,a,c,d){mxEventSource.call(this);this.chromeless=(b!=null)?b:this.chromeless;this.initStencilRegistry();this.graph=d||this.createGraph(a,c);this.undoManager=this.createUndoManager();this.status="";this.getOrCreateFilename=function(){return this.filename||mxResources.get("drawing",[Editor.pageCounter])+".xml"};this.getFilename=function(){return this.filename};this.setStatus=function(e){this.status=e;this.fireEvent(new mxEventObject("statusChanged"))};this.getStatus=function(){return this.status};this.graphChangeListener=function(f,e){var g=(e!=null)?e.getProperty("edit"):null;if(g==null||!g.ignoreEdit){this.setModified(true)}};this.graph.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.graphChangeListener.apply(this,arguments)}));this.graph.resetViewOnRootChange=false;this.init()};Editor.pageCounter=0;(function(){try{var b=window;while(b.opener!=null&&typeof b.opener.Editor!=="undefined"&&!isNaN(b.opener.Editor.pageCounter)&&b.opener!=b){b=b.opener}if(b!=null){b.Editor.pageCounter++;Editor.pageCounter=b.Editor.pageCounter}}catch(a){}})();Editor.useLocalStorage=typeof(Storage)!="undefined"&&mxClient.IS_IOS;Editor.helpImage=(mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAXVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC5BxTwAAAAH3RSTlMAlUF8boNQIE0LBgOgkGlHNSwqFIx/dGVUOjApmV9ezNACSAAAAIVJREFUGNNtjNsOgzAMQ5NeoVcKDAZs+//PXLKI8YKlWvaRU7jXuFpb9qsbdK05XILUiE8JHQox1Pv3OgFUzf1AGqWqUg+QBwLF0YAeegBlCNgRWOpB5vUfTCmeoHQ/wNdy0jLH/cM+b+wLTw4n/7ACEmHVVy8h6qy8V7MNcGowWpsNbvUFcGUEdSi1s/oAAAAASUVORK5CYII=":IMAGE_PATH+"/help.png";Editor.checkmarkImage=(mxClient.IS_SVG)?"data:image/gif;base64,R0lGODlhFQAVAMQfAGxsbHx8fIqKioaGhvb29nJycvr6+sDAwJqamltbW5OTk+np6YGBgeTk5Ly8vJiYmP39/fLy8qWlpa6ursjIyOLi4vj4+N/f3+3t7fT09LCwsHZ2dubm5r6+vmZmZv///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEY4NTZERTQ5QUFBMTFFMUE5MTVDOTM5MUZGMTE3M0QiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEY4NTZERTU5QUFBMTFFMUE5MTVDOTM5MUZGMTE3M0QiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Rjg1NkRFMjlBQUExMUUxQTkxNUM5MzkxRkYxMTczRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Rjg1NkRFMzlBQUExMUUxQTkxNUM5MzkxRkYxMTczRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAB8ALAAAAAAVABUAAAVI4CeOZGmeaKqubKtylktSgCOLRyLd3+QJEJnh4VHcMoOfYQXQLBcBD4PA6ngGlIInEHEhPOANRkaIFhq8SuHCE1Hb8Lh8LgsBADs=":IMAGE_PATH+"/checkmark.gif";Editor.maximizeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAElBMVEUAAAAAAAAAAAAAAAAAAAAAAADgKxmiAAAABXRSTlMA758vX1Pw3BoAAABJSURBVAjXY8AJQkODGBhUQ0MhbAUGBiYY24CBgRnGFmZgMISwgwwDGRhEhVVBbAVmEQYGRwMmBjIAQi/CTIRd6G5AuA3dzYQBAHj0EFdHkvV4AAAAAElFTkSuQmCC";Editor.zoomOutImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAElBMVEUAAAAAAAAsLCxxcXEhISFgYGChjTUxAAAAAXRSTlMAQObYZgAAAEdJREFUCNdjIAMwCQrB2YKCggJQJqMwA7MglK1owMBgqABVApITgLJZXFxgbIQ4Qj3CHIT5ggoIe5kgNkM1KSDYKBKqxPkDAPo5BAZBE54hAAAAAElFTkSuQmCC";Editor.zoomInImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAElBMVEUAAAAAAAAsLCwhISFxcXFgYGBavKaoAAAAAXRSTlMAQObYZgAAAElJREFUCNdjIAMwCQrB2YKCggJQJqMIA4sglK3owMzgqABVwsDMwCgAZTMbG8PYCHGEeoQ5CPMFFRD2MkFshmpSQLBRJFSJ8wcAEqcEM2uhl2MAAAAASUVORK5CYII=";Editor.zoomFitImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAD1BMVEUAAAAAAAAwMDBwcHBgYGC1xl09AAAAAXRSTlMAQObYZgAAAEFJREFUCNdjIAMwCQrB2YKCggJQJqMwA7MglK1owMBgqABVApITwMdGqEeYgzBfUAFhLxPEZqgmBQQbRUKFOH8AAK5OA3lA+FFOAAAAAElFTkSuQmCC";Editor.layersImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAMAAACeyVWkAAAAaVBMVEUAAAAgICAICAgdHR0PDw8WFhYICAgLCwsXFxcvLy8ODg4uLi4iIiIqKiokJCQYGBgKCgonJycFBQUCAgIqKiocHBwcHBwODg4eHh4cHBwnJycJCQkUFBQqKiojIyMuLi4ZGRkgICAEBATOWYXAAAAAGnRSTlMAD7+fnz8/H7/ff18/77+vr5+fn39/b28fH2xSoKsAAACQSURBVBjTrYxJEsMgDARZZMAY73sgCcn/HxnhKtnk7j6oRq0psfuoyndZ/SuODkHPLzfVT6KeyPePnJ7KrnkRjWMXTn4SMnN8mXe2SSM3ts8L/ZUxxrbAULSYJJULE0Iw9pjpenoICcgcX61mGgTgtCv9Be99pzCoDhNQWQnchD1mup5++CYGcoQexajZbfwAj/0MD8ZOaUgAAAAASUVORK5CYII=";Editor.previousImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAAh0lEQVQ4je3UsQnCUBCA4U8hpa1NsoEjpHQJS0dxADdwEMuMIJkgA1hYChbGQgMi+JC8q4L/AB/vDu7x74cWWEZhJU44RmA1zujR5GIbXF9YNrjD/Q0bDRY4fEBZ4P4LlgTnCbAf84pUM8/9hY08tMUtEoQ1LpEgrNBFglChFXR6Q6GfwwR6AGKJMF74Vtt3AAAAAElFTkSuQmCC";Editor.nextImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAAi0lEQVQ4jeXUIQ7CUAwA0MeGxWI2yylwnALJUdBcgYvM7QYLmjOQIAkIPmJZghiIvypoUtX0tfnJL38X5ZfaEgUeUcManFBHgS0SLlhHggk3bCPBhCf2keCQR8wjwYTDp6YiZxJmOU1jGw7vGALescuBxsArNlOwd/CM1VSM/ut1qCIw+uOwiMJ+OF4CQzBCXm3hyAAAAABJRU5ErkJggg==";Editor.zoomOutLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAilBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2N2iNAAAALXRSTlMA+vTcKMM96GRBHwXxi0YaX1HLrKWhiHpWEOnOr52Vb2xKSDcT19PKv5l/Ngdk8+viAAABJklEQVQ4y4WT2XaDMAxEvWD2nSSUNEnTJN3r//+9Sj7ILAY6L0ijC4ONYVZRpo6cByrz2YKSUGorGTpz71lPVHvT+avoB5wIkU/mxk8veceSuNoLg44IzziXjvpih72wKQnm8yc2UoiP/LAd8jQfe2Xf4Pq+2EyYIvv9wbzHHCgwxDdlBtWZOdqDfTCVgqpygQpsZaojVAVc9UjQxnAJDIBhiQv84tq3gMQCAVTxVoSibXJf8tMuc7e1TB/DCmejBNg/w1Y3c+AM5vv4w7xM59/oXamrHaLVqPQ+OTCnmMZxgz0SdL5zji0/ld6j88qGa5KIiBB6WeJGKfUKwSMKLuXgvl1TW0tm5R9UQL/efSDYsnzxD8CinhBsTTdugJatKpJwf8v+ADb8QmvW7AeAAAAAAElFTkSuQmCC";Editor.zoomInLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAilBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2N2iNAAAALXRSTlMA+vTcKMM96GRBHwXxi0YaX1HLrKWhiHpWEOnOr52Vb2xKSDcT19PKv5l/Ngdk8+viAAABKElEQVQ4y4WT6WKCMBCENwkBwn2oFKvWqr3L+79es4EkQIDOH2d3Pxk2ABiJlB8JCXjqw4LikHVGLHTm3nM3UeVN5690GBBN0GwyV/3kkrUQR+WeKnREeKpzaXWd77CmJiXGfPIEI4V4yQ9TIW/ntlcMBe731Vts9w5TWG8F5j3mQI4hvrKpdGeYA7CX9qAcl650gVJartxRuhyHVghF8idQAIbFLvCLu28BsQEC6aKtCK6Pyb3JT7PmbmtNH8Ny56CotD/2qOs5cJbuffxgXmCib+xddVU5RNOhkvvkhTlFehzVWCOh3++MYElOhfdovaImnRYVmqDdsuhNp1QrBBE6uGC2+3ZNjGdg5B94oD+9uyVgWT79BwAxEBTWdOu3bWBVgsn/N/AHUD9IC01Oe40AAAAASUVORK5CYII=";Editor.actualSizeLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAilBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2N2iNAAAALXRSTlMA+vTcKMM96GRBHwXxi0YaX1HLrKWhiHpWEOnOr52Vb2xKSDcT19PKv5l/Ngdk8+viAAABIUlEQVQ4y4WT2XqDIBCFBxDc9yTWNEnTJN3r+79eGT4BEbXnaubMr8dBBaM450dCQp4LWFAascGIRd48eB4cNYE7f6XjgGiCFs5c+dml6CFN6j1V6IQIlHPpdV/usKcmJcV88gQTRXjLD9Mhb+fWq8YG9/uCmTCFjeeDeY85UGKIUGUuqzN42kv7oCouq9oHamlzVR1lVfpAIu1QVRiW+sAv7r4FpAYIZZVsRXB9TP5Dfpo1d1trCgzz1iiptH/sUbdz4CzN9+mLeXHn3+hdddd4RDegsrvzwZwSs2GLPRJidAqCLTlVwaMPqpYMWjTWBB2WRW86pVkhSKyDK2bdt2tmagZG4sBD/evdLQHLEvQfAOKRoLCmG1FAB6uKmby+gz+REDn7O5+EwQAAAABJRU5ErkJggg==";Editor.layersLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAmVBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+/v7///+bnZkkAAAAMnRSTlMABPr8ByiD88KsTi/rvJb272mjeUA1CuPe1M/KjVxYHxMP6KZ0S9nYzGRGGRaznpGIbzaGUf0AAAHESURBVDjLbZLZYoIwEEVDgLCjbKIgAlqXqt3m/z+uNwu1rcyDhjl3ktnYL7OY254C0VX3yWFZfzDrOClbbgKxi0YDHjwl4jbnRkXxJS/C1YP3DbBhD1n7Ex4uaAqdVDb3yJ/4J/3nJD2to/ngQz/DfUvzMp4JJ5sSCaF5oXmemgQDfDxzbi+Kq4sU+vNcuAmx94JtyOP2DD4Epz2asWSCz4Z/4fECxyNj9zC9xNLHcdPEO+awDKeSaUu0W4twZQiO2hYVisTR3RCtK/c1X6t4xMEpiGqXqVntEBLolkZZsKY4QtwH6jzq67dEHlJysB1aNOD3XT7n1UkasQN59L4yC2RELMDSeCRtz3yV22Ub3ozIUTknYx8JWqDdQxbUes98cR2kZtUSveF/bAhcedwEWmlxIkpZUy4XOCb6VBjjxHvbwo/1lBAHHi2JCr0NI570QhyHq/DhJoE2lLgyA4RVe6KmZ47O/3b86MCP0HWa73A8/C3SUc5Qc1ajt6fgpXJ+RGpMvDSchepZDOOQRcZVIKcK90x2D7etqtI+56+u6n3sPriO6nfphitR4+O2m3EbM7lh3me1FM1o+LMI887rN+s3/wZdTFlpNVJiOAAAAABJRU5ErkJggg==";Editor.closeLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAUVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////8IN+deAAAAGnRSTlMAuvAIg/dDM/QlOeuFhj0S5s4vKgzjxJRQNiLSey0AAADNSURBVDjLfZLbEoMgDEQjRRRs1XqX///QNmOHJSnjPkHOGR7IEmeoGtJZstnwjqbRfIsmgEdtPCqe9Ynz7ZSc07rE2QiSc+qv8TvjRXA2PDUm3dpe82iJhOEUfxJJo3aCv+jKmRmH4lcCjCjeh9GWOdL/GZZkXH3PYYDrHBnfc4D/RVZf5sjoC1was+Y6HQxwaUxFvq/a0Pv343VCTxfBSRiB+ab3M3eiQZXmMNBJ3Y8pGRZtYQ7DgHMXJEdPLTaN/qBjzJOBc3nmNcbsA16bMR0oLqf+AAAAAElFTkSuQmCC";Editor.editLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAgMAAAAOFJJnAAAACVBMVEUAAAD///////9zeKVjAAAAAnRSTlMAgJsrThgAAABcSURBVBjThc6xDcAgDATAd8MQTEPW8TRUmYCGnzLRYyOlIV+dZFtvkICTFGqiJEzAG0/Uje9oL+e5Vu4F5yUYJxxqGKhQZ0eBvmgwYQLQaARKD1hbiPyDR0QOeAC31EyNe5X/kAAAAABJRU5ErkJggg==";Editor.previousLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAPFBMVEUAAAD////////////////////////////////////////////////////////////////////////////YSWgTAAAAE3RSTlMA7fci493c0MW8uJ6CZks4MxQHEZL6ewAAAFZJREFUOMvdkskRgDAMA4lDwg2B7b9XOlge/KKvdsa25KFb5XlRvxXC/DNBEv8IFNjBgGdDgXtFgTyhwDXiQAUHCvwa4Uv6mR6UR+1led2mVonvl+tML45qCQNQLIx7AAAAAElFTkSuQmCC";Editor.nextLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAPFBMVEUAAAD////////////////////////////////////////////////////////////////////////////YSWgTAAAAE3RSTlMA7fci493c0MW8uJ6CZks4MxQHEZL6ewAAAFRJREFUOMvd0skRgCAQBVEFwQ0V7fxzNQP6wI05v6pZ/kyj1b7FNgik2gQzzLcAwiUAigHOTwDHK4A1CmB5BJANJG1hQ9qafYcqFlZP3IFc9eVGrR+iIgkDQRUXIAAAAABJRU5ErkJggg==";mxUtils.extend(Editor,mxEventSource);Editor.prototype.originalNoForeignObject=mxClient.NO_FO;Editor.prototype.transparentImage=(mxClient.IS_SVG)?"data:image/gif;base64,R0lGODlhMAAwAIAAAP///wAAACH5BAEAAAAALAAAAAAwADAAAAIxhI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jef6zvf+DwwKh8Si8egpAAA7":IMAGE_PATH+"/transparent.gif";Editor.prototype.extendCanvas=true;Editor.prototype.chromeless=false;Editor.prototype.cancelFirst=true;Editor.prototype.enabled=true;Editor.prototype.filename=null;Editor.prototype.modified=false;Editor.prototype.autosave=true;Editor.prototype.initialTopSpacing=0;Editor.prototype.appName=document.title;Editor.prototype.editBlankUrl=window.location.protocol+"//"+window.location.host+"/?client=1";Editor.prototype.editBlankFallbackUrl=window.location.protocol+"//"+window.location.host+"/?create=drawdata&splash=0";Editor.prototype.init=function(){};Editor.prototype.setAutosave=function(a){this.autosave=a;this.fireEvent(new mxEventObject("autosaveChanged"))};Editor.prototype.getEditBlankUrl=function(a,b){return((b)?this.editBlankFallbackUrl:this.editBlankUrl)+a};Editor.prototype.editAsNew=function(a,e){var d=(e!=null)?"&title="+encodeURIComponent(e):"";if(typeof window.postMessage!=="undefined"&&(document.documentMode==null||document.documentMode>=10)){var b=null;var c=mxUtils.bind(this,function(f){if(f.data=="ready"&&f.source==b){b.postMessage(a,"*");mxEvent.removeListener(window,"message",c)}});mxEvent.addListener(window,"message",c);b=window.open(this.getEditBlankUrl(d,false))}else{window.drawdata=a;window.open(this.getEditBlankUrl(d,true))}};Editor.prototype.createGraph=function(a,b){var c=new Graph(null,b,null,null,a);c.transparentBackground=false;if(!this.chromeless){c.isBlankLink=function(d){return !this.isExternalProtocol(d)}}return c};Editor.prototype.resetGraph=function(){this.graph.gridEnabled=!this.chromeless||urlParams.grid=="1";this.graph.graphHandler.guidesEnabled=true;this.graph.setTooltips(true);this.graph.setConnectable(true);this.graph.foldingEnabled=true;this.graph.scrollbars=this.graph.defaultScrollbars;this.graph.pageVisible=this.graph.defaultPageVisible;this.graph.pageBreaksVisible=this.graph.pageVisible;this.graph.preferPageSize=this.graph.pageBreaksVisible;this.graph.background=this.graph.defaultGraphBackground;this.graph.pageScale=mxGraph.prototype.pageScale;this.graph.pageFormat=mxGraph.prototype.pageFormat;this.updateGraphComponents();this.graph.view.setScale(1)};Editor.prototype.readGraphState=function(d){this.graph.gridEnabled=d.getAttribute("grid")!="0"&&(!this.chromeless||urlParams.grid=="1");this.graph.gridSize=parseFloat(d.getAttribute("gridSize"))||mxGraph.prototype.gridSize;this.graph.graphHandler.guidesEnabled=d.getAttribute("guides")!="0";this.graph.setTooltips(d.getAttribute("tooltips")!="0");this.graph.setConnectable(d.getAttribute("connect")!="0");this.graph.connectionArrowsEnabled=d.getAttribute("arrows")!="0";this.graph.foldingEnabled=d.getAttribute("fold")!="0";if(this.chromeless&&this.graph.foldingEnabled){this.graph.foldingEnabled=urlParams.nav=="1";this.graph.cellRenderer.forceControlClickHandler=this.graph.foldingEnabled}var f=d.getAttribute("pageScale");if(f!=null){this.graph.pageScale=f}else{this.graph.pageScale=mxGraph.prototype.pageScale}if(!this.graph.lightbox){var c=d.getAttribute("page");if(c!=null){this.graph.pageVisible=(c!="0")}else{this.graph.pageVisible=this.graph.defaultPageVisible}}else{this.graph.pageVisible=false}this.graph.pageBreaksVisible=this.graph.pageVisible;this.graph.preferPageSize=this.graph.pageBreaksVisible;var b=d.getAttribute("pageWidth");var e=d.getAttribute("pageHeight");if(b!=null&&e!=null){this.graph.pageFormat=new mxRectangle(0,0,parseFloat(b),parseFloat(e))}var a=d.getAttribute("background");if(a!=null&&a.length>0){this.graph.background=a}else{this.graph.background=this.graph.defaultGraphBackground}};Editor.prototype.setGraphXml=function(a){if(a!=null){var c=new mxCodec(a.ownerDocument);if(a.nodeName=="mxGraphModel"){this.graph.model.beginUpdate();try{this.graph.model.clear();this.graph.view.scale=1;this.readGraphState(a);this.updateGraphComponents();c.decode(a,this.graph.getModel())}finally{this.graph.model.endUpdate()}this.fireEvent(new mxEventObject("resetGraphView"))}else{if(a.nodeName=="root"){this.resetGraph();var b=c.document.createElement("mxGraphModel");b.appendChild(a);c.decode(b,this.graph.getModel());this.updateGraphComponents();this.fireEvent(new mxEventObject("resetGraphView"))}else{throw {message:mxResources.get("cannotOpenFile"),node:a,toString:function(){return this.message}}}}}else{this.resetGraph();this.graph.model.clear();this.fireEvent(new mxEventObject("resetGraphView"))}};Editor.prototype.getGraphXml=function(b){b=(b!=null)?b:true;var c=null;if(b){var a=new mxCodec(mxUtils.createXmlDocument());c=a.encode(this.graph.getModel())}else{c=this.graph.encodeCells(mxUtils.sortCells(this.graph.model.getTopmostCells(this.graph.getSelectionCells())))}if(this.graph.view.translate.x!=0||this.graph.view.translate.y!=0){c.setAttribute("dx",Math.round(this.graph.view.translate.x*100)/100);c.setAttribute("dy",Math.round(this.graph.view.translate.y*100)/100)}c.setAttribute("grid",(this.graph.isGridEnabled())?"1":"0");c.setAttribute("gridSize",this.graph.gridSize);c.setAttribute("guides",(this.graph.graphHandler.guidesEnabled)?"1":"0");c.setAttribute("tooltips",(this.graph.tooltipHandler.isEnabled())?"1":"0");c.setAttribute("connect",(this.graph.connectionHandler.isEnabled())?"1":"0");c.setAttribute("arrows",(this.graph.connectionArrowsEnabled)?"1":"0");c.setAttribute("fold",(this.graph.foldingEnabled)?"1":"0");c.setAttribute("page",(this.graph.pageVisible)?"1":"0");c.setAttribute("pageScale",this.graph.pageScale);c.setAttribute("pageWidth",this.graph.pageFormat.width);c.setAttribute("pageHeight",this.graph.pageFormat.height);if(this.graph.background!=null){c.setAttribute("background",this.graph.background)}return c};Editor.prototype.updateGraphComponents=function(){var a=this.graph;if(a.container!=null){a.view.validateBackground();a.container.style.overflow=(a.scrollbars)?"auto":"hidden";this.fireEvent(new mxEventObject("updateGraphComponents"))}};Editor.prototype.setModified=function(a){this.modified=a};Editor.prototype.setFilename=function(a){this.filename=a};Editor.prototype.createUndoManager=function(){var b=this.graph;var c=new mxUndoManager();this.undoListener=function(f,e){c.undoableEditHappened(e.getProperty("edit"))};var a=mxUtils.bind(this,function(f,e){this.undoListener.apply(this,arguments)});b.getModel().addListener(mxEvent.UNDO,a);b.getView().addListener(mxEvent.UNDO,a);var d=function(j,e){var k=b.getSelectionCellsForChanges(e.getProperty("edit").changes);var g=b.getModel();var f=[];for(var h=0;h<k.length;h++){if((g.isVertex(k[h])||g.isEdge(k[h]))&&b.view.getState(k[h])!=null){f.push(k[h])}}b.setSelectionCells(f)};c.addListener(mxEvent.UNDO,d);c.addListener(mxEvent.REDO,d);return c};Editor.prototype.initStencilRegistry=function(){};Editor.prototype.destroy=function(){if(this.graph!=null){this.graph.destroy();this.graph=null}};OpenFile=function(a){this.producer=null;this.consumer=null;this.done=a;this.args=null};OpenFile.prototype.setConsumer=function(a){this.consumer=a;this.execute()};OpenFile.prototype.setData=function(){this.args=arguments;this.execute()};OpenFile.prototype.error=function(a){this.cancel(true);mxUtils.alert(a)};OpenFile.prototype.execute=function(){if(this.consumer!=null&&this.args!=null){this.cancel(false);this.consumer.apply(this,this.args)}};OpenFile.prototype.cancel=function(a){if(this.done!=null){this.done((a!=null)?a:true)}};(function(){mxGraphView.prototype.validateBackgroundPage=function(){var i=this.graph;if(i.container!=null&&!i.transparentBackground){if(i.pageVisible){var h=this.getBackgroundPageBounds();if(this.backgroundPageShape==null){var j=i.container.firstChild;while(j!=null&&j.nodeType!=mxConstants.NODETYPE_ELEMENT){j=j.nextSibling}if(j!=null){this.backgroundPageShape=this.createBackgroundPageShape(h);this.backgroundPageShape.scale=1;this.backgroundPageShape.isShadow=!mxClient.IS_QUIRKS;this.backgroundPageShape.dialect=mxConstants.DIALECT_STRICTHTML;this.backgroundPageShape.init(i.container);j.style.position="absolute";i.container.insertBefore(this.backgroundPageShape.node,j);this.backgroundPageShape.redraw();this.backgroundPageShape.node.className="geBackgroundPage";mxEvent.addListener(this.backgroundPageShape.node,"dblclick",mxUtils.bind(this,function(k){i.dblClick(k)}));mxEvent.addGestureListeners(this.backgroundPageShape.node,mxUtils.bind(this,function(k){i.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(k))}),mxUtils.bind(this,function(k){if(i.tooltipHandler!=null&&i.tooltipHandler.isHideOnHover()){i.tooltipHandler.hide()}if(i.isMouseDown&&!mxEvent.isConsumed(k)){i.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(k))}}),mxUtils.bind(this,function(k){i.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(k))}))}}else{this.backgroundPageShape.scale=1;this.backgroundPageShape.bounds=h;this.backgroundPageShape.redraw()}}else{if(this.backgroundPageShape!=null){this.backgroundPageShape.destroy();this.backgroundPageShape=null}}this.validateBackgroundStyles()}};mxGraphView.prototype.validateBackgroundStyles=function(){var q=this.graph;var k=(q.background==null||q.background==mxConstants.NONE)?"#ffffff":q.background;var o=(this.gridColor!=k.toLowerCase())?this.gridColor:"#ffffff";var j="none";var l="";if(q.isGridEnabled()){var p=10;if(mxClient.IS_SVG){j=unescape(encodeURIComponent(this.createSvgGrid(o)));j=(window.btoa)?btoa(j):Base64.encode(j,true);j="url(data:image/svg+xml;base64,"+j+")";p=q.gridSize*this.scale*this.gridSteps}else{j="url("+this.gridImage+")"}var i=0;var n=0;if(q.view.backgroundPageShape!=null){var m=this.getBackgroundPageBounds();i=1+m.x;n=1+m.y}l=-Math.round(p-mxUtils.mod(this.translate.x*this.scale-i,p))+"px "+-Math.round(p-mxUtils.mod(this.translate.y*this.scale-n,p))+"px"}var h=q.view.canvas;if(h.ownerSVGElement!=null){h=h.ownerSVGElement}if(q.view.backgroundPageShape!=null){q.view.backgroundPageShape.node.style.backgroundPosition=l;q.view.backgroundPageShape.node.style.backgroundImage=j;q.view.backgroundPageShape.node.style.backgroundColor=k;q.container.className="geDiagramContainer geDiagramBackdrop";h.style.backgroundImage="none";h.style.backgroundColor=""}else{q.container.className="geDiagramContainer";h.style.backgroundPosition=l;h.style.backgroundColor=k;h.style.backgroundImage=j}};mxGraphView.prototype.createSvgGrid=function(j){var n=this.graph.gridSize*this.scale;while(n<this.minGridSize){n*=2}var o=this.gridSteps*n;var p=[];for(var m=1;m<this.gridSteps;m++){var l=m*n;p.push("M 0 "+l+" L "+o+" "+l+" M "+l+" 0 L "+l+" "+o)}var k=o;var h='<svg width="'+k+'" height="'+k+'" xmlns="'+mxConstants.NS_SVG+'"><defs><pattern id="grid" width="'+o+'" height="'+o+'" patternUnits="userSpaceOnUse"><path d="'+p.join(" ")+'" fill="none" stroke="'+j+'" opacity="0.2" stroke-width="1"/><path d="M '+o+" 0 L 0 0 0 "+o+'" fill="none" stroke="'+j+'" stroke-width="1"/></pattern></defs><rect width="100%" height="100%" fill="url(#grid)"/></svg>';return h};var c=mxGraph.prototype.panGraph;mxGraph.prototype.panGraph=function(k,j){c.apply(this,arguments);if(this.shiftPreview1!=null){var l=this.view.canvas;if(l.ownerSVGElement!=null){l=l.ownerSVGElement}var i=this.gridSize*this.view.scale*this.view.gridSteps;var h=-Math.round(i-mxUtils.mod(this.view.translate.x*this.view.scale+k,i))+"px "+-Math.round(i-mxUtils.mod(this.view.translate.y*this.view.scale+j,i))+"px";l.style.backgroundPosition=h}};mxGraph.prototype.updatePageBreaks=function(q,m,u){var r=this.view.scale;var s=this.view.translate;var o=this.pageFormat;var j=r*this.pageScale;var k=this.view.getBackgroundPageBounds();m=k.width;u=k.height;var i=new mxRectangle(r*s.x,r*s.y,o.width*j,o.height*j);q=q&&Math.min(i.width,i.height)>this.minPageBreakDist;var l=(q)?Math.ceil(u/i.height)-1:0;var n=(q)?Math.ceil(m/i.width)-1:0;var t=k.x+m;var h=k.y+u;if(this.horizontalPageBreaks==null&&l>0){this.horizontalPageBreaks=[]}if(this.verticalPageBreaks==null&&n>0){this.verticalPageBreaks=[]}var p=mxUtils.bind(this,function(y){if(y!=null){var x=(y==this.horizontalPageBreaks)?l:n;for(var w=0;w<=x;w++){var z=(y==this.horizontalPageBreaks)?[new mxPoint(Math.round(k.x),Math.round(k.y+(w+1)*i.height)),new mxPoint(Math.round(t),Math.round(k.y+(w+1)*i.height))]:[new mxPoint(Math.round(k.x+(w+1)*i.width),Math.round(k.y)),new mxPoint(Math.round(k.x+(w+1)*i.width),Math.round(h))];if(y[w]!=null){y[w].points=z;y[w].redraw()}else{var v=new mxPolyline(z,this.pageBreakColor);v.dialect=this.dialect;v.isDashed=this.pageBreakDashed;v.pointerEvents=false;v.init(this.view.backgroundPane);v.redraw();y[w]=v}}for(var w=x;w<y.length;w++){y[w].destroy()}y.splice(x,y.length-x)}});p(this.horizontalPageBreaks);p(this.verticalPageBreaks)};var b=mxGraphHandler.prototype.shouldRemoveCellsFromParent;mxGraphHandler.prototype.shouldRemoveCellsFromParent=function(l,j,h){for(var k=0;k<j.length;k++){if(this.graph.getModel().isVertex(j[k])){var m=this.graph.getCellGeometry(j[k]);if(m!=null&&m.relative){return false}}}return b.apply(this,arguments)};var a=mxConnectionHandler.prototype.createMarker;mxConnectionHandler.prototype.createMarker=function(){var h=a.apply(this,arguments);h.intersects=mxUtils.bind(this,function(j,i){if(this.isConnecting()){return true}return mxCellMarker.prototype.intersects.apply(h,arguments)});return h};mxGraphView.prototype.createBackgroundPageShape=function(h){return new mxRectangleShape(h,"#ffffff","#cacaca")};mxGraphView.prototype.getBackgroundPageBounds=function(){var z=this.getGraphBounds();var r=(z.width>0)?z.x/this.scale-this.translate.x:0;var q=(z.height>0)?z.y/this.scale-this.translate.y:0;var t=z.width/this.scale;var m=z.height/this.scale;var l=this.graph.pageFormat;var j=this.graph.pageScale;var v=l.width*j;var o=l.height*j;var k=Math.floor(Math.min(0,r)/v);var s=Math.floor(Math.min(0,q)/o);var u=Math.ceil(Math.max(1,r+t)/v);var n=Math.ceil(Math.max(1,q+m)/o);var A=u-k;var p=n-s;var i=new mxRectangle(this.scale*(this.translate.x+k*v),this.scale*(this.translate.y+s*o),this.scale*A*v,this.scale*p*o);return i};var d=mxGraph.prototype.panGraph;mxGraph.prototype.panGraph=function(i,h){d.apply(this,arguments);if((this.dialect!=mxConstants.DIALECT_SVG&&this.view.backgroundPageShape!=null)&&(!this.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.container))){this.view.backgroundPageShape.node.style.marginLeft=i+"px";this.view.backgroundPageShape.node.style.marginTop=h+"px"}};var g=mxPopupMenu.prototype.addItem;mxPopupMenu.prototype.addItem=function(n,m,i,l,k,j){var h=g.apply(this,arguments);if(j!=null&&!j){mxEvent.addListener(h,"mousedown",function(o){mxEvent.consume(o)})}return h};var f=mxGraphHandler.prototype.getInitialCellForEvent;mxGraphHandler.prototype.getInitialCellForEvent=function(l){var j=this.graph.getModel();var i=j.getParent(this.graph.getSelectionCell());var h=f.apply(this,arguments);var k=j.getParent(h);if(i==null||(i!=h&&i!=k)){while(!this.graph.isCellSelected(h)&&!this.graph.isCellSelected(k)&&j.isVertex(k)&&!this.graph.isContainer(k)){h=k;k=this.graph.getModel().getParent(h)}}return h};var e=mxGraphHandler.prototype.isDelayedSelection;mxGraphHandler.prototype.isDelayedSelection=function(i,l){var h=e.apply(this,arguments);if(!h){var j=this.graph.getModel();var k=j.getParent(i);while(k!=null){if(this.graph.isCellSelected(k)&&j.isVertex(k)){h=true;break}k=j.getParent(k)}}return h};mxGraphHandler.prototype.selectDelayed=function(k){if(!this.graph.popupMenuHandler.isPopupTrigger(k)){var h=k.getCell();if(h==null){h=this.cell}var l=this.graph.view.getState(h);if(l!=null&&k.isSource(l.control)){this.graph.selectCellForEvent(h,k.getEvent())}else{var i=this.graph.getModel();var j=i.getParent(h);while(!this.graph.isCellSelected(j)&&i.isVertex(j)){h=j;j=i.getParent(h)}this.graph.selectCellForEvent(h,k.getEvent())}}};mxPopupMenuHandler.prototype.getCellForPopupEvent=function(k){var h=k.getCell();var i=this.graph.getModel();var j=i.getParent(h);while(i.isVertex(j)&&!this.graph.isContainer(j)){if(this.graph.isCellSelected(j)){h=j}j=i.getParent(j)}return h}})();EditorUi=function(e,q,c){mxEventSource.call(this);this.destroyFunctions=[];this.editor=e||new Editor();this.container=q||document.body;var b=this.editor.graph;b.lightbox=c;if(mxClient.IS_SVG){mxPopupMenu.prototype.submenuImage="data:image/gif;base64,R0lGODlhCQAJAIAAAP///zMzMyH5BAEAAAAALAAAAAAJAAkAAAIPhI8WebHsHopSOVgb26AAADs="}else{new Image().src=mxPopupMenu.prototype.submenuImage}if(!mxClient.IS_SVG&&mxConnectionHandler.prototype.connectImage!=null){new Image().src=mxConnectionHandler.prototype.connectImage.src}if(this.editor.chromeless){this.footerHeight=0;b.isEnabled=function(){return false};b.panningHandler.isForcePanningEvent=function(i){return !mxEvent.isPopupTrigger(i.getEvent())}}this.actions=new Actions(this);this.menus=this.createMenus();this.createDivs();this.createUi();this.refresh();var z=mxUtils.bind(this,function(i){if(i==null){i=window.event}return this.isSelectionAllowed(i)||b.isEditing()});if(this.container==document.body){this.menubarContainer.onselectstart=z;this.menubarContainer.onmousedown=z;this.toolbarContainer.onselectstart=z;this.toolbarContainer.onmousedown=z;this.diagramContainer.onselectstart=z;this.diagramContainer.onmousedown=z;this.sidebarContainer.onselectstart=z;this.sidebarContainer.onmousedown=z;this.formatContainer.onselectstart=z;this.formatContainer.onmousedown=z;this.footerContainer.onselectstart=z;this.footerContainer.onmousedown=z;if(this.tabContainer!=null){this.tabContainer.onselectstart=z}}if(!this.editor.chromeless){if(mxClient.IS_IE&&(typeof(document.documentMode)==="undefined"||document.documentMode<9)){mxEvent.addListener(this.diagramContainer,"contextmenu",z)}else{this.diagramContainer.oncontextmenu=z}}else{b.panningHandler.usePopupTrigger=false}b.init(this.diagramContainer);this.hoverIcons=this.createHoverIcons();mxEvent.addListener(this.diagramContainer,"mousemove",mxUtils.bind(this,function(i){var j=mxUtils.getOffset(this.diagramContainer);if(mxEvent.getClientX(i)-j.x-this.diagramContainer.clientWidth>0||mxEvent.getClientY(i)-j.y-this.diagramContainer.clientHeight>0){this.diagramContainer.setAttribute("title",mxResources.get("panTooltip"))}else{this.diagramContainer.removeAttribute("title")}}));var C=false;var o=this.hoverIcons.isResetEvent;this.hoverIcons.isResetEvent=function(i,j){return C||o.apply(this,arguments)};this.keydownHandler=mxUtils.bind(this,function(i){if(i.which==32){C=true;this.hoverIcons.reset();b.container.style.cursor="move";if(!b.isEditing()&&mxEvent.getSource(i)==b.container){mxEvent.consume(i)}}else{if(!mxEvent.isConsumed(i)&&i.keyCode==27){this.hideDialog()}}});mxEvent.addListener(document,"keydown",this.keydownHandler);this.keyupHandler=mxUtils.bind(this,function(i){b.container.style.cursor="";C=false});mxEvent.addListener(document,"keyup",this.keyupHandler);var A=b.panningHandler.isForcePanningEvent;b.panningHandler.isForcePanningEvent=function(i){return A.apply(this,arguments)||C||(mxEvent.isMouseEvent(i.getEvent())&&(this.usePopupTrigger||!mxEvent.isPopupTrigger(i.getEvent()))&&((!mxEvent.isControlDown(i.getEvent())&&mxEvent.isRightMouseButton(i.getEvent()))||mxEvent.isMiddleMouseButton(i.getEvent())))};var d=b.cellEditor.isStopEditingEvent;b.cellEditor.isStopEditingEvent=function(i){return d.apply(this,arguments)||(i.keyCode==13&&((!mxClient.IS_SF&&mxEvent.isControlDown(i))||(mxClient.IS_MAC&&mxEvent.isMetaDown(i))||(mxClient.IS_SF&&mxEvent.isShiftDown(i))))};var p=false;var t=null;var h=null;var u=null;var g=mxUtils.bind(this,function(){if(p!=b.cellEditor.isContentEditing()){var H=this.toolbar.container.firstChild;var j=[];while(H!=null){var E=H.nextSibling;if(mxUtils.indexOf(this.toolbar.staticElements,H)<0){H.parentNode.removeChild(H);j.push(H)}H=E}var G=this.toolbar.fontMenu;var F=this.toolbar.sizeMenu;if(u==null){this.toolbar.createTextToolbar()}else{for(var D=0;D<u.length;D++){this.toolbar.container.appendChild(u[D])}this.toolbar.fontMenu=t;this.toolbar.sizeMenu=h}p=b.cellEditor.isContentEditing();t=G;h=F;u=j}});var s=this;var f=b.cellEditor.startEditing;b.cellEditor.startEditing=function(){f.apply(this,arguments);g();if(b.cellEditor.isContentEditing()){var i=false;var j=function(){if(!i){i=true;window.setTimeout(function(){var G=b.getSelectedElement();var F=G;while(F!=null&&F.nodeType!=mxConstants.NODETYPE_ELEMENT){F=F.parentNode}if(F!=null){var E=mxUtils.getCurrentStyle(F);if(E!=null&&s.toolbar!=null){var D=E.fontFamily;if(D.charAt(0)=="'"){D=D.substring(1)}if(D.charAt(D.length-1)=="'"){D=D.substring(0,D.length-1)}s.toolbar.setFontName(D);s.toolbar.setFontSize(parseInt(E.fontSize))}}i=false},0)}};mxEvent.addListener(b.cellEditor.textarea,"input",j);mxEvent.addListener(b.cellEditor.textarea,"touchend",j);mxEvent.addListener(b.cellEditor.textarea,"mouseup",j);mxEvent.addListener(b.cellEditor.textarea,"keyup",j);j()}};var r=b.cellEditor.stopEditing;b.cellEditor.stopEditing=function(i,j){r.apply(this,arguments);g()};b.container.setAttribute("tabindex","0");b.container.style.cursor="default";if(window.self===window.top&&b.container.parentNode!=null){b.container.focus()}var k=b.fireMouseEvent;b.fireMouseEvent=function(D,j,i){if(D==mxEvent.MOUSE_DOWN){this.container.focus()}k.apply(this,arguments)};b.popupMenuHandler.autoExpand=true;if(this.menus!=null){b.popupMenuHandler.factoryMethod=mxUtils.bind(this,function(D,i,j){this.menus.createPopupMenu(D,i,j)})}mxEvent.addGestureListeners(document,mxUtils.bind(this,function(i){b.popupMenuHandler.hideMenu()}));this.keyHandler=this.createKeyHandler(e);this.getKeyHandler=function(){return keyHandler};var m=["rounded","shadow","glass","dashed","dashPattern","comic","labelBackgroundColor"];var a=["shape","edgeStyle","curved","rounded","elbow","comic"];this.setDefaultStyle=function(M){var j=b.view.getState(M);if(j!=null){var H=M.clone();H.style="";var N=b.getCellStyle(H);var L=[];var O=[];for(var K in j.style){if(N[K]!=j.style[K]){L.push(j.style[K]);O.push(K)}}var D=b.getModel().getStyle(j.cell);var G=(D!=null)?D.split(";"):[];for(var F=0;F<G.length;F++){var E=G[F];var I=E.indexOf("=");if(I>=0){var K=E.substring(0,I);var J=E.substring(I+1);if(N[K]!=null&&J=="none"){L.push(J);O.push(K)}}}if(b.getModel().isEdge(j.cell)){b.currentEdgeStyle={}}else{b.currentVertexStyle={}}this.fireEvent(new mxEventObject("styleChanged","keys",O,"values",L,"cells",[j.cell]))}};this.clearDefaultStyle=function(){b.currentEdgeStyle=b.defaultEdgeStyle;b.currentVertexStyle={};this.fireEvent(new mxEventObject("styleChanged","keys",[],"values",[],"cells",[]))};var B=["fontFamily","fontSize","fontColor"];var v=["edgeStyle","startArrow","startFill","startSize","endArrow","endFill","endSize","jettySize","orthogonalLoop"];var n=[["startArrow","startFill","startSize","endArrow","endFill","endSize","jettySize","orthogonalLoop"],["strokeColor","strokeWidth"],["fillColor","gradientColor"],B,["align"],["html"]];for(var y=0;y<n.length;y++){for(var x=0;x<n[y].length;x++){m.push(n[y][x])}}for(var y=0;y<a.length;y++){m.push(a[y])}var w=function(E,N){b.getModel().beginUpdate();try{if(N){var G=b.getModel().isEdge(D);var O=(G)?b.currentEdgeStyle:b.currentVertexStyle;var U=["fontSize","fontFamily","fontColor"];for(var S=0;S<U.length;S++){var P=O[U[S]];if(P!=null){b.setCellStyles(U[S],P,E)}}}else{for(var T=0;T<E.length;T++){var D=E[T];var V=b.getModel().getStyle(D);var M=(V!=null)?V.split(";"):[];var K=m.slice();for(var S=0;S<M.length;S++){var W=M[S];var H=W.indexOf("=");if(H>=0){var X=W.substring(0,H);var I=mxUtils.indexOf(K,X);if(I>=0){K.splice(I,1)}for(var R=0;R<n.length;R++){var J=n[R];if(mxUtils.indexOf(J,X)>=0){for(var Q=0;Q<J.length;Q++){var F=mxUtils.indexOf(K,J[Q]);if(F>=0){K.splice(F,1)}}}}}}var G=b.getModel().isEdge(D);var O=(G)?b.currentEdgeStyle:b.currentVertexStyle;for(var S=0;S<K.length;S++){var X=K[S];var L=O[X];if(L!=null&&(X!="shape"||G)){if(!G||mxUtils.indexOf(a,X)<0){b.setCellStyles(X,L,[D])}}}}}}finally{b.getModel().endUpdate()}};b.addListener("cellsInserted",function(j,i){w(i.getProperty("cells"))});b.addListener("textInserted",function(j,i){w(i.getProperty("cells"),true)});b.connectionHandler.addListener(mxEvent.CONNECT,function(D,i){var j=[i.getProperty("cell")];if(i.getProperty("terminalInserted")){j.push(i.getProperty("terminal"))}w(j)});this.addListener("styleChanged",mxUtils.bind(this,function(E,M){var O=M.getProperty("cells");var H=false;var j=false;if(O.length>0){for(var F=0;F<O.length;F++){H=b.getModel().isVertex(O[F])||H;j=b.getModel().isEdge(O[F])||j;if(j&&H){break}}}else{H=true;j=true}var N=M.getProperty("keys");var L=M.getProperty("values");for(var F=0;F<N.length;F++){var I=mxUtils.indexOf(B,N[F])>=0;if(N[F]!="strokeColor"||(L[F]!=null&&L[F]!="none")){if(mxUtils.indexOf(a,N[F])>=0){if(j||mxUtils.indexOf(v,N[F])>=0){if(L[F]==null){delete b.currentEdgeStyle[N[F]]}else{b.currentEdgeStyle[N[F]]=L[F]}}else{if(H&&mxUtils.indexOf(m,N[F])>=0){if(L[F]==null){delete b.currentVertexStyle[N[F]]}else{b.currentVertexStyle[N[F]]=L[F]}}}}else{if(mxUtils.indexOf(m,N[F])>=0){if(H||I){if(L[F]==null){delete b.currentVertexStyle[N[F]]}else{b.currentVertexStyle[N[F]]=L[F]}}if(j||I||mxUtils.indexOf(v,N[F])>=0){if(L[F]==null){delete b.currentEdgeStyle[N[F]]}else{b.currentEdgeStyle[N[F]]=L[F]}}}}}}if(this.toolbar!=null){this.toolbar.setFontName(b.currentVertexStyle.fontFamily||Menus.prototype.defaultFont);this.toolbar.setFontSize(b.currentVertexStyle.fontSize||Menus.prototype.defaultFontSize);if(this.toolbar.edgeStyleMenu!=null){var J=this.toolbar.edgeStyleMenu.getElementsByTagName("div")[0];if(b.currentEdgeStyle.edgeStyle=="orthogonalEdgeStyle"&&b.currentEdgeStyle.curved=="1"){J.className="geSprite geSprite-curved"}else{if(b.currentEdgeStyle.edgeStyle=="straight"||b.currentEdgeStyle.edgeStyle=="none"||b.currentEdgeStyle.edgeStyle==null){J.className="geSprite geSprite-straight"}else{if(b.currentEdgeStyle.edgeStyle=="entityRelationEdgeStyle"){J.className="geSprite geSprite-entity"}else{if(b.currentEdgeStyle.edgeStyle=="elbowEdgeStyle"){J.className="geSprite geSprite-"+((b.currentEdgeStyle.elbow=="vertical")?"verticalelbow":"horizontalelbow")}else{if(b.currentEdgeStyle.edgeStyle=="isometricEdgeStyle"){J.className="geSprite geSprite-"+((b.currentEdgeStyle.elbow=="vertical")?"verticalisometric":"horizontalisometric")}else{J.className="geSprite geSprite-orthogonal"}}}}}}if(this.toolbar.edgeShapeMenu!=null){var G=this.toolbar.edgeShapeMenu.getElementsByTagName("div")[0];if(b.currentEdgeStyle.shape=="link"){G.className="geSprite geSprite-linkedge"}else{if(b.currentEdgeStyle.shape=="flexArrow"){G.className="geSprite geSprite-arrow"}else{if(b.currentEdgeStyle.shape=="arrow"){G.className="geSprite geSprite-simplearrow"}else{G.className="geSprite geSprite-connection"}}}}if(this.toolbar.lineStartMenu!=null){var K=this.toolbar.lineStartMenu.getElementsByTagName("div")[0];K.className=this.getCssClassForMarker("start",b.currentEdgeStyle.shape,b.currentEdgeStyle[mxConstants.STYLE_STARTARROW],mxUtils.getValue(b.currentEdgeStyle,"startFill","1"))}if(this.toolbar.lineEndMenu!=null){var D=this.toolbar.lineEndMenu.getElementsByTagName("div")[0];D.className=this.getCssClassForMarker("end",b.currentEdgeStyle.shape,b.currentEdgeStyle[mxConstants.STYLE_ENDARROW],mxUtils.getValue(b.currentEdgeStyle,"endFill","1"))}}}));if(this.toolbar!=null){var l=mxUtils.bind(this,function(){var j=b.currentVertexStyle.fontFamily||"Helvetica";var i=String(b.currentVertexStyle.fontSize||"12");var D=b.getView().getState(b.getSelectionCell());if(D!=null){j=D.style[mxConstants.STYLE_FONTFAMILY]||j;i=D.style[mxConstants.STYLE_FONTSIZE]||i;if(j.length>10){j=j.substring(0,8)+"..."}}this.toolbar.setFontName(j);this.toolbar.setFontSize(i)});b.getSelectionModel().addListener(mxEvent.CHANGE,l);b.getModel().addListener(mxEvent.CHANGE,l)}b.addListener(mxEvent.CELLS_ADDED,function(D,i){var j=i.getProperty("cells");var E=i.getProperty("parent");if(b.getModel().isLayer(E)&&!b.isCellVisible(E)&&j!=null&&j.length>0){b.getModel().setVisible(E,true)}});this.gestureHandler=mxUtils.bind(this,function(i){if(this.currentMenu!=null&&mxEvent.getSource(i)!=this.currentMenu.div){this.hideCurrentMenu()}});mxEvent.addGestureListeners(document,this.gestureHandler);this.resizeHandler=mxUtils.bind(this,function(){window.setTimeout(mxUtils.bind(this,function(){this.refresh()}),0)});mxEvent.addListener(window,"resize",this.resizeHandler);this.orientationChangeHandler=mxUtils.bind(this,function(){this.refresh()});mxEvent.addListener(window,"orientationchange",this.orientationChangeHandler);if(mxClient.IS_IOS&&!window.navigator.standalone){this.scrollHandler=mxUtils.bind(this,function(){window.scrollTo(0,0)});mxEvent.addListener(window,"scroll",this.scrollHandler)}this.editor.addListener("resetGraphView",mxUtils.bind(this,function(){this.resetScrollbars()}));this.addListener("gridEnabledChanged",mxUtils.bind(this,function(){b.view.validateBackground()}));this.addListener("backgroundColorChanged",mxUtils.bind(this,function(){b.view.validateBackground()}));b.addListener("gridSizeChanged",mxUtils.bind(this,function(){if(b.isGridEnabled()){b.view.validateBackground()}}));this.editor.resetGraph();this.init();this.open()};mxUtils.extend(EditorUi,mxEventSource);EditorUi.compactUi=true;EditorUi.prototype.splitSize=(mxClient.IS_TOUCH||mxClient.IS_POINTER)?12:8;EditorUi.prototype.menubarHeight=30;EditorUi.prototype.formatEnabled=true;EditorUi.prototype.formatWidth=240;EditorUi.prototype.toolbarHeight=34;EditorUi.prototype.footerHeight=28;EditorUi.prototype.sidebarFooterHeight=34;EditorUi.prototype.editButtonLink=null;EditorUi.prototype.hsplitPosition=(screen.width<=500)?116:208;EditorUi.prototype.allowAnimation=true;EditorUi.prototype.init=function(){var b=this.editor.graph;mxEvent.addListener(b.container,"keydown",mxUtils.bind(this,function(d){if(d.which==9&&b.isEnabled()&&!mxEvent.isAltDown(d)){if(b.isEditing()){b.stopEditing(false)}else{b.selectCell(!mxEvent.isShiftDown(d))}mxEvent.consume(d)}}));mxEvent.addListener(b.container,"keypress",mxUtils.bind(this,function(d){if(this.isImmediateEditingEvent(d)&&!b.isEditing()&&!b.isSelectionEmpty()&&d.which!==0&&!mxEvent.isAltDown(d)&&!mxEvent.isControlDown(d)&&!mxEvent.isMetaDown(d)){b.escape();b.startEditing();if(mxClient.IS_FF){var g=b.cellEditor;g.textarea.innerHTML=String.fromCharCode(d.which);var e=document.createRange();e.selectNodeContents(g.textarea);e.collapse(false);var f=window.getSelection();f.removeAllRanges();f.addRange(e)}}}));this.addUndoListener();this.addBeforeUnloadListener();b.getSelectionModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.updateActionStates()}));b.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.updateActionStates()}));var c=b.setDefaultParent;var a=this;this.editor.graph.setDefaultParent=function(){c.apply(this,arguments);a.updateActionStates()};b.editLink=a.actions.get("editLink").funct;this.updateActionStates();this.initClipboard();this.initCanvas();if(this.format!=null){this.format.init()}};EditorUi.prototype.isImmediateEditingEvent=function(a){return true};EditorUi.prototype.getCssClassForMarker=function(d,c,b,e){var a="";if(c=="flexArrow"){a=(b!=null&&b!=mxConstants.NONE)?"geSprite geSprite-"+d+"blocktrans":"geSprite geSprite-noarrow"}else{if(b==mxConstants.ARROW_CLASSIC){a=(e=="1")?"geSprite geSprite-"+d+"classic":"geSprite geSprite-"+d+"classictrans"}else{if(b==mxConstants.ARROW_CLASSIC_THIN){a=(e=="1")?"geSprite geSprite-"+d+"classicthin":"geSprite geSprite-"+d+"classicthintrans"}else{if(b==mxConstants.ARROW_OPEN){a="geSprite geSprite-"+d+"open"}else{if(b==mxConstants.ARROW_OPEN_THIN){a="geSprite geSprite-"+d+"openthin"}else{if(b==mxConstants.ARROW_BLOCK){a=(e=="1")?"geSprite geSprite-"+d+"block":"geSprite geSprite-"+d+"blocktrans"}else{if(b==mxConstants.ARROW_BLOCK_THIN){a=(e=="1")?"geSprite geSprite-"+d+"blockthin":"geSprite geSprite-"+d+"blockthintrans"}else{if(b==mxConstants.ARROW_OVAL){a=(e=="1")?"geSprite geSprite-"+d+"oval":"geSprite geSprite-"+d+"ovaltrans"}else{if(b==mxConstants.ARROW_DIAMOND){a=(e=="1")?"geSprite geSprite-"+d+"diamond":"geSprite geSprite-"+d+"diamondtrans"}else{if(b==mxConstants.ARROW_DIAMOND_THIN){a=(e=="1")?"geSprite geSprite-"+d+"thindiamond":"geSprite geSprite-"+d+"thindiamondtrans"}else{if(b=="openAsync"){a="geSprite geSprite-"+d+"openasync"}else{if(b=="dash"){a="geSprite geSprite-"+d+"dash"}else{if(b=="cross"){a="geSprite geSprite-"+d+"cross"}else{if(b=="async"){a=(e=="1")?"geSprite geSprite-"+d+"async":"geSprite geSprite-"+d+"asynctrans"}else{if(b=="circle"||b=="circlePlus"){a=(e=="1"||b=="circle")?"geSprite geSprite-"+d+"circle":"geSprite geSprite-"+d+"circleplus"}else{if(b=="ERone"){a="geSprite geSprite-"+d+"erone"}else{if(b=="ERmandOne"){a="geSprite geSprite-"+d+"eronetoone"}else{if(b=="ERmany"){a="geSprite geSprite-"+d+"ermany"}else{if(b=="ERoneToMany"){a="geSprite geSprite-"+d+"eronetomany"}else{if(b=="ERzeroToOne"){a="geSprite geSprite-"+d+"eroneopt"}else{if(b=="ERzeroToMany"){a="geSprite geSprite-"+d+"ermanyopt"}else{a="geSprite geSprite-noarrow"}}}}}}}}}}}}}}}}}}}}}return a};EditorUi.prototype.createMenus=function(){return null};EditorUi.prototype.updatePasteActionStates=function(){var c=this.editor.graph;var b=this.actions.get("paste");var a=this.actions.get("pasteHere");b.setEnabled(this.editor.graph.cellEditor.isContentEditing()||(!mxClipboard.isEmpty()&&c.isEnabled()&&!c.isCellLocked(c.getDefaultParent())));a.setEnabled(b.isEnabled())};EditorUi.prototype.initClipboard=function(){var d=this;var b=mxClipboard.cut;mxClipboard.cut=function(g){if(g.cellEditor.isContentEditing()){document.execCommand("cut",false,null)}else{b.apply(this,arguments)}d.updatePasteActionStates()};var e=mxClipboard.copy;mxClipboard.copy=function(g){if(g.cellEditor.isContentEditing()){document.execCommand("copy",false,null)}else{e.apply(this,arguments)}d.updatePasteActionStates()};var c=mxClipboard.paste;mxClipboard.paste=function(h){var g=null;if(h.cellEditor.isContentEditing()){document.execCommand("paste",false,null)}else{g=c.apply(this,arguments)}d.updatePasteActionStates();return g};var a=this.editor.graph.cellEditor.startEditing;this.editor.graph.cellEditor.startEditing=function(){a.apply(this,arguments);d.updatePasteActionStates()};var f=this.editor.graph.cellEditor.stopEditing;this.editor.graph.cellEditor.stopEditing=function(g,h){f.apply(this,arguments);d.updatePasteActionStates()};this.updatePasteActionStates()};EditorUi.prototype.initCanvas=function(){var c=this.editor.graph;var c=this.editor.graph;c.timerAutoScroll=true;c.getPagePadding=function(){return new mxPoint(Math.max(0,Math.round((c.container.offsetWidth-34)/c.view.scale)),Math.max(0,Math.round((c.container.offsetHeight-34)/c.view.scale)))};c.view.getBackgroundPageBounds=function(){var w=this.graph.getPageLayout();var x=this.graph.getPageSize();return new mxRectangle(this.scale*(this.translate.x+w.x*x.width),this.scale*(this.translate.y+w.y*x.height),this.scale*w.width*x.width,this.scale*w.height*x.height)};c.getPreferredPageSize=function(A,z,x){var w=this.getPageLayout();var y=this.getPageSize();return new mxRectangle(0,0,w.width*y.width,w.height*y.height)};var s=null;if(this.editor.chromeless){s=mxUtils.bind(this,function(x){if(c.container!=null){var D=(c.pageVisible)?c.view.getBackgroundPageBounds():c.getGraphBounds();var A=c.view.translate;var H=c.view.scale;D=mxRectangle.fromRectangle(D);D.x=D.x/H-A.x;D.y=D.y/H-A.y;D.width/=H;D.height/=H;var F=c.container.scrollTop;var y=c.container.scrollLeft;var C=(mxClient.IS_QUIRKS||document.documentMode>=8)?20:14;if(document.documentMode==8||document.documentMode==9){C+=3}var z=c.container.offsetWidth-C;var w=c.container.offsetHeight-C;var B=(x)?Math.max(0.3,Math.min(1,z/D.width)):H;var G=Math.max((z-B*D.width)/2,0)/B;var E=Math.max((w-B*D.height)/4,0)/B;c.view.scaleAndTranslate(B,G-D.x,E-D.y);c.container.scrollTop=F*B/H;c.container.scrollLeft=y*B/H}});this.chromelessResize=s;var v=mxUtils.bind(this,function(){s(false)});mxEvent.addListener(window,"resize",v);this.destroyFunctions.push(function(){mxEvent.removeListener(window,"resize",v)});this.editor.addListener("resetGraphView",mxUtils.bind(this,function(){s(true)}));this.actions.get("zoomIn").funct=function(w){c.zoomIn();s(false)};this.actions.get("zoomOut").funct=function(w){c.zoomOut();s(false)};this.chromelessToolbar=document.createElement("div");this.chromelessToolbar.style.position="fixed";this.chromelessToolbar.style.overflow="hidden";this.chromelessToolbar.style.boxSizing="border-box";this.chromelessToolbar.style.whiteSpace="nowrap";this.chromelessToolbar.style.backgroundColor="#000000";this.chromelessToolbar.style.padding="10px 10px 8px 10px";this.chromelessToolbar.style.left="50%";mxUtils.setPrefixedStyle(this.chromelessToolbar.style,"borderRadius","20px");mxUtils.setPrefixedStyle(this.chromelessToolbar.style,"transition","opacity 600ms ease-in-out");var l=mxUtils.bind(this,function(){var w=mxUtils.getCurrentStyle(c.container);this.chromelessToolbar.style.bottom=((w!=null)?parseInt(w["margin-bottom"]||0):0)+((this.tabContainer!=null)?(20+parseInt(this.tabContainer.style.height)):20)+"px"});this.editor.addListener("resetGraphView",l);l();var a=0;var n=mxUtils.bind(this,function(z,y,A){a++;var w=document.createElement("span");w.style.paddingLeft="8px";w.style.paddingRight="8px";w.style.cursor="pointer";mxEvent.addListener(w,"click",z);if(A!=null){w.setAttribute("title",A)}var x=document.createElement("img");x.setAttribute("border","0");x.setAttribute("src",y);w.appendChild(x);this.chromelessToolbar.appendChild(w);return w});var u=n(mxUtils.bind(this,function(w){this.actions.get("previousPage").funct();mxEvent.consume(w)}),Editor.previousLargeImage,mxResources.get("previousPage")||"Previous Page");var d=document.createElement("div");d.style.display="inline-block";d.style.verticalAlign="top";d.style.fontFamily="Helvetica,Arial";d.style.marginTop="8px";d.style.color="#ffffff";this.chromelessToolbar.appendChild(d);var i=n(mxUtils.bind(this,function(w){this.actions.get("nextPage").funct();mxEvent.consume(w)}),Editor.nextLargeImage,mxResources.get("nextPage")||"Next Page");var g=mxUtils.bind(this,function(){if(this.pages!=null&&this.pages.length>1&&this.currentPage!=null){d.innerHTML="";mxUtils.write(d,(mxUtils.indexOf(this.pages,this.currentPage)+1)+" / "+this.pages.length)}});u.style.paddingLeft="0px";u.style.paddingRight="4px";i.style.paddingLeft="4px";i.style.paddingRight="0px";var m=mxUtils.bind(this,function(){if(this.pages!=null&&this.pages.length>1&&this.currentPage!=null){i.style.display="";u.style.display="";d.style.display="inline-block"}else{i.style.display="none";u.style.display="none";d.style.display="none"}g()});this.editor.addListener("resetGraphView",m);this.editor.addListener("pageSelected",g);n(mxUtils.bind(this,function(w){this.actions.get("zoomOut").funct();mxEvent.consume(w)}),Editor.zoomOutLargeImage,(mxResources.get("zoomOut")||"Zoom Out")+" (Alt+Mousewheel)");n(mxUtils.bind(this,function(w){this.actions.get("zoomIn").funct();mxEvent.consume(w)}),Editor.zoomInLargeImage,(mxResources.get("zoomIn")||"Zoom In")+" (Alt+Mousewheel)");n(mxUtils.bind(this,function(w){if(c.lightbox){if(c.view.scale==1){this.lightboxFit()}else{c.zoomTo(1)}s(false)}else{s(true)}mxEvent.consume(w)}),Editor.actualSizeLargeImage,mxResources.get("fit")||"Fit");var h=null;var p=null;var b=mxUtils.bind(this,function(w){if(h!=null){window.clearTimeout(h);fadeThead=null}if(p!=null){window.clearTimeout(p);fadeThead2=null}h=window.setTimeout(mxUtils.bind(this,function(){mxUtils.setOpacity(this.chromelessToolbar,0);h=null;p=window.setTimeout(mxUtils.bind(this,function(){this.chromelessToolbar.style.display="none";p=null}),600)}),w||200)});var k=mxUtils.bind(this,function(w){if(h!=null){window.clearTimeout(h);fadeThead=null}if(p!=null){window.clearTimeout(p);fadeThead2=null}this.chromelessToolbar.style.display="";mxUtils.setOpacity(this.chromelessToolbar,w||30)});if(urlParams.layers=="1"){this.layersDialog=null;var r=n(mxUtils.bind(this,function(w){if(this.layersDialog!=null){this.layersDialog.parentNode.removeChild(this.layersDialog);this.layersDialog=null}else{this.layersDialog=c.createLayersDialog();mxEvent.addListener(this.layersDialog,"mouseleave",mxUtils.bind(this,function(){this.layersDialog.parentNode.removeChild(this.layersDialog);this.layersDialog=null}));var y=r.getBoundingClientRect();mxUtils.setPrefixedStyle(this.layersDialog.style,"borderRadius","5px");this.layersDialog.style.position="fixed";this.layersDialog.style.fontFamily="Helvetica,Arial";this.layersDialog.style.backgroundColor="#000000";this.layersDialog.style.width="160px";this.layersDialog.style.padding="4px 2px 4px 2px";this.layersDialog.style.color="#ffffff";mxUtils.setOpacity(this.layersDialog,70);this.layersDialog.style.left=y.left+"px";this.layersDialog.style.bottom=parseInt(this.chromelessToolbar.style.bottom)+this.chromelessToolbar.offsetHeight+4+"px";var x=mxUtils.getCurrentStyle(this.editor.graph.container);this.layersDialog.style.zIndex=x.zIndex;document.body.appendChild(this.layersDialog)}mxEvent.consume(w)}),Editor.layersLargeImage,mxResources.get("layers")||"Layers");var e=c.getModel();e.addListener(mxEvent.CHANGE,function(){r.style.display=(e.getChildCount(e.root)>1)?"":"none"})}if(this.editor.editButtonLink!=null){n(mxUtils.bind(this,function(w){if(this.editor.editButtonLink=="_blank"){this.editor.editAsNew(this.getEditBlankXml(),null,true)}else{window.open(this.editor.editButtonLink,"editWindow")}mxEvent.consume(w)}),Editor.editLargeImage,mxResources.get("openInNewWindow")||"Open in New Window")}if(c.lightbox&&this.container!=document.body){n(mxUtils.bind(this,function(w){if(urlParams.close=="1"){window.close()}else{this.destroy();mxEvent.consume(w)}}),Editor.closeLargeImage,(mxResources.get("close")||"Close")+" (Escape)")}this.chromelessToolbar.style.display="none";c.container.appendChild(this.chromelessToolbar);this.chromelessToolbar.style.marginLeft=-(a*24+10)+"px";this.addChromelessClickHandler();mxEvent.addListener(c.container,(mxClient.IS_POINTER)?"pointermove":"mousemove",mxUtils.bind(this,function(w){if(!mxEvent.isTouchEvent(w)){if(!mxEvent.isShiftDown(w)){k(30)}b()}}));mxEvent.addListener(this.chromelessToolbar,(mxClient.IS_POINTER)?"pointermove":"mousemove",function(w){mxEvent.consume(w)});mxEvent.addListener(this.chromelessToolbar,"mouseenter",mxUtils.bind(this,function(w){if(!mxEvent.isShiftDown(w)){k(100)}else{b()}}));mxEvent.addListener(this.chromelessToolbar,"mousemove",mxUtils.bind(this,function(w){if(!mxEvent.isShiftDown(w)){k(100)}else{b()}mxEvent.consume(w)}));mxEvent.addListener(this.chromelessToolbar,"mouseleave",mxUtils.bind(this,function(w){if(!mxEvent.isTouchEvent(w)){k(30)}}));var o=c.getTolerance();var j=this;c.addMouseListener({startX:0,startY:0,scrollLeft:0,scrollTop:0,mouseDown:function(w,x){this.startX=x.getGraphX();this.startY=x.getGraphY();this.scrollLeft=c.container.scrollLeft;this.scrollTop=c.container.scrollTop},mouseMove:function(w,x){},mouseUp:function(w,x){if(mxEvent.isTouchEvent(x.getEvent())){if((Math.abs(this.scrollLeft-c.container.scrollLeft)<o&&Math.abs(this.scrollTop-c.container.scrollTop)<o)&&(Math.abs(this.startX-x.getGraphX())<o&&Math.abs(this.startY-x.getGraphY())<o)){if(parseFloat(j.chromelessToolbar.style.opacity||0)>0){b()}else{k(30)}}}}})}else{if(this.editor.extendCanvas){var t=c.view.validate;c.view.validate=function(){if(this.graph.container!=null&&mxUtils.hasScrollbars(this.graph.container)){var z=this.graph.getPagePadding();var y=this.graph.getPageSize();var x=this.translate.x;var w=this.translate.y;this.translate.x=z.x-(this.x0||0)*y.width;this.translate.y=z.y-(this.y0||0)*y.height}t.apply(this,arguments)};var f=c.sizeDidChange;c.sizeDidChange=function(){if(this.container!=null&&mxUtils.hasScrollbars(this.container)){var w=this.getPageLayout();var x=this.getPagePadding();var E=this.getPageSize();var C=Math.ceil(2*x.x+w.width*E.width);var B=Math.ceil(2*x.y+w.height*E.height);var z=c.minimumGraphSize;if(z==null||z.width!=C||z.height!=B){c.minimumGraphSize=new mxRectangle(0,0,C,B)}var F=x.x-w.x*E.width;var D=x.y-w.y*E.height;if(!this.autoTranslate&&(this.view.translate.x!=F||this.view.translate.y!=D)){this.autoTranslate=true;this.view.x0=w.x;this.view.y0=w.y;var A=c.view.translate.x;var y=c.view.translate.y;c.view.setTranslate(F,D);c.container.scrollLeft+=Math.round((F-A)*c.view.scale);c.container.scrollTop+=Math.round((D-y)*c.view.scale);this.autoTranslate=false;return}f.apply(this,arguments)}}}}c.updateZoomTimeout=null;c.cumulativeZoomFactor=1;var q=null;c.lazyZoom=function(w){if(this.updateZoomTimeout!=null){window.clearTimeout(this.updateZoomTimeout)}if(w){if(this.view.scale*this.cumulativeZoomFactor<0.15){this.cumulativeZoomFactor=(this.view.scale+0.01)/this.view.scale}else{this.cumulativeZoomFactor*=this.zoomFactor;this.cumulativeZoomFactor=Math.round(this.view.scale*this.cumulativeZoomFactor*20)/20/this.view.scale}}else{if(this.view.scale*this.cumulativeZoomFactor<=0.15){this.cumulativeZoomFactor=(this.view.scale-0.01)/this.view.scale}else{this.cumulativeZoomFactor/=this.zoomFactor;this.cumulativeZoomFactor=Math.round(this.view.scale*this.cumulativeZoomFactor*20)/20/this.view.scale}}this.cumulativeZoomFactor=Math.max(0.01,Math.min(this.view.scale*this.cumulativeZoomFactor,160)/this.view.scale);this.updateZoomTimeout=window.setTimeout(mxUtils.bind(this,function(){this.zoom(this.cumulativeZoomFactor);if(s!=null){s(false)}if(q!=null&&mxUtils.hasScrollbars(c.container)){var z=mxUtils.getOffset(c.container);var y=c.container.offsetWidth/2-q.x+z.x;var x=c.container.offsetHeight/2-q.y+z.y;c.container.scrollLeft-=y*(this.cumulativeZoomFactor-1);c.container.scrollTop-=x*(this.cumulativeZoomFactor-1)}this.cumulativeZoomFactor=1;this.updateZoomTimeout=null}),20)};mxEvent.addMouseWheelListener(mxUtils.bind(this,function(x,w){if((mxEvent.isAltDown(x)||(mxEvent.isControlDown(x)&&!mxClient.IS_MAC)||c.panningHandler.isActive())&&(this.dialogs==null||this.dialogs.length==0)){var y=mxEvent.getSource(x);while(y!=null){if(y==c.container){q=new mxPoint(mxEvent.getClientX(x),mxEvent.getClientY(x));c.lazyZoom(w);mxEvent.consume(x);return}y=y.parentNode}}}))};EditorUi.prototype.createTemporaryGraph=function(a){var b=new Graph(document.createElement("div"),null,null,a);b.resetViewOnRootChange=false;b.setConnectable(false);b.gridEnabled=false;b.autoScroll=false;b.setTooltips(false);b.setEnabled(false);b.container.style.visibility="hidden";b.container.style.position="absolute";b.container.style.overflow="hidden";b.container.style.height="1px";b.container.style.width="1px";return b};EditorUi.prototype.addChromelessClickHandler=function(){var a=urlParams.highlight;if(a!=null&&a.length>0){a="#"+a}this.editor.graph.addClickHandler(a)};EditorUi.prototype.toggleFormatPanel=function(a){this.formatWidth=(a||this.formatWidth>0)?0:240;this.formatContainer.style.display=(a||this.formatWidth>0)?"":"none";this.refresh();this.format.refresh();this.fireEvent(new mxEventObject("formatWidthChanged"))};EditorUi.prototype.lightboxFit=function(){this.editor.graph.maxFitScale=2;this.editor.graph.fit(60);this.editor.graph.maxFitScale=null};EditorUi.prototype.isSelectionAllowed=function(a){return mxEvent.getSource(a).nodeName=="SELECT"||(mxEvent.getSource(a).nodeName=="INPUT"&&mxUtils.isAncestorNode(this.formatContainer,mxEvent.getSource(a)))};EditorUi.prototype.addBeforeUnloadListener=function(){window.onbeforeunload=mxUtils.bind(this,function(){if(!this.editor.chromeless){return this.onBeforeUnload()}})};EditorUi.prototype.onBeforeUnload=function(){if(this.editor.modified){return mxResources.get("allChangesLost")}};EditorUi.prototype.open=function(){try{if(window.opener!=null&&window.opener.openFile!=null){window.opener.openFile.setConsumer(mxUtils.bind(this,function(c,b){try{var f=mxUtils.parseXml(c);this.editor.setGraphXml(f.documentElement);this.editor.setModified(false);this.editor.undoManager.clear();if(b!=null){this.editor.setFilename(b);this.updateDocumentTitle()}return}catch(d){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+d.message)}}))}}catch(a){}this.editor.graph.view.validate();this.editor.graph.sizeDidChange();this.editor.fireEvent(new mxEventObject("resetGraphView"))};EditorUi.prototype.setCurrentMenu=function(b,a){this.currentMenuElt=a;this.currentMenu=b};EditorUi.prototype.resetCurrentMenu=function(){this.currentMenuElt=null;this.currentMenu=null};EditorUi.prototype.hideCurrentMenu=function(b,a){if(this.currentMenu!=null){this.currentMenu.hideMenu();this.resetCurrentMenu()}};EditorUi.prototype.updateDocumentTitle=function(){var a=this.editor.getOrCreateFilename();if(this.editor.appName!=null){a+=" - "+this.editor.appName}document.title=a};EditorUi.prototype.createHoverIcons=function(){return new HoverIcons(this.editor.graph)};EditorUi.prototype.redo=function(){try{var a=this.editor.graph;if(a.isEditing()){document.execCommand("redo",false,null)}else{this.editor.undoManager.redo()}}catch(b){}};EditorUi.prototype.undo=function(){try{var b=this.editor.graph;if(b.isEditing()){var a=b.cellEditor.textarea.innerHTML;document.execCommand("undo",false,null);if(a==b.cellEditor.textarea.innerHTML){b.stopEditing(true);this.editor.undoManager.undo()}}else{this.editor.undoManager.undo()}}catch(c){}};EditorUi.prototype.canRedo=function(){return this.editor.graph.isEditing()||this.editor.undoManager.canRedo()};EditorUi.prototype.canUndo=function(){return this.editor.graph.isEditing()||this.editor.undoManager.canUndo()};EditorUi.prototype.getEditBlankXml=function(){return mxUtils.getXml(this.getGraphXml())};EditorUi.prototype.getUrl=function(d){var a=(d!=null)?d:window.location.pathname;var c=(a.indexOf("?")>0)?1:0;for(var b in urlParams){if(c==0){a+="?"}else{a+="&"}a+=b+"="+urlParams[b];c++}return a};EditorUi.prototype.setScrollbars=function(f){var e=this.editor.graph;var d=e.container.style.overflow;e.scrollbars=f;this.editor.updateGraphComponents();if(d!=e.container.style.overflow){if(e.container.style.overflow=="hidden"){var c=e.view.translate;e.view.setTranslate(c.x-e.container.scrollLeft/e.view.scale,c.y-e.container.scrollTop/e.view.scale);e.container.scrollLeft=0;e.container.scrollTop=0;e.minimumGraphSize=null;e.sizeDidChange()}else{var b=e.view.translate.x;var a=e.view.translate.y;e.view.translate.x=0;e.view.translate.y=0;e.sizeDidChange();e.container.scrollLeft-=Math.round(b*e.view.scale);e.container.scrollTop-=Math.round(a*e.view.scale)}}this.fireEvent(new mxEventObject("scrollbarsChanged"))};EditorUi.prototype.hasScrollbars=function(){return this.editor.graph.scrollbars};EditorUi.prototype.resetScrollbars=function(){var f=this.editor.graph;if(!this.editor.extendCanvas){f.container.scrollTop=0;f.container.scrollLeft=0;if(!mxUtils.hasScrollbars(f.container)){f.view.setTranslate(0,0)}}else{if(!this.editor.chromeless){if(mxUtils.hasScrollbars(f.container)){if(f.pageVisible){var g=f.getPagePadding();f.container.scrollTop=Math.floor(g.y-this.editor.initialTopSpacing);f.container.scrollLeft=Math.floor(Math.min(g.x,(f.container.scrollWidth-f.container.clientWidth)/2));var e=f.getGraphBounds();if(e.width>0&&e.height>0){if(e.x>f.container.scrollLeft+f.container.clientWidth*0.9){f.container.scrollLeft=Math.min(e.x+e.width-f.container.clientWidth,e.x-10)}if(e.y>f.container.scrollTop+f.container.clientHeight*0.9){f.container.scrollTop=Math.min(e.y+e.height-f.container.clientHeight,e.y-10)}}}else{var e=f.getGraphBounds();var d=Math.max(e.width,f.scrollTileSize.width*f.view.scale);var c=Math.max(e.height,f.scrollTileSize.height*f.view.scale);f.container.scrollTop=Math.floor(Math.max(0,e.y-Math.max(20,(f.container.clientHeight-c)/4)));f.container.scrollLeft=Math.floor(Math.max(0,e.x-Math.max(0,(f.container.clientWidth-d)/2)))}}else{if(f.pageVisible){var a=f.view.getBackgroundPageBounds();f.view.setTranslate(Math.floor(Math.max(0,(f.container.clientWidth-a.width)/2)-a.x),Math.floor(Math.max(0,(f.container.clientHeight-a.height)/2)-a.y))}else{var e=f.getGraphBounds();f.view.setTranslate(Math.floor(Math.max(0,Math.max(0,(f.container.clientWidth-e.width)/2)-e.x)),Math.floor(Math.max(0,Math.max(20,(f.container.clientHeight-e.height)/4))-e.y))}}}}};EditorUi.prototype.setPageVisible=function(e){var d=this.editor.graph;var f=mxUtils.hasScrollbars(d.container);var b=0;var a=0;if(f){b=d.view.translate.x*d.view.scale-d.container.scrollLeft;a=d.view.translate.y*d.view.scale-d.container.scrollTop}d.pageVisible=e;d.pageBreaksVisible=e;d.preferPageSize=e;d.view.validateBackground();if(f){var c=d.getSelectionCells();d.clearSelection();d.setSelectionCells(c)}d.sizeDidChange();if(f){d.container.scrollLeft=d.view.translate.x*d.view.scale-b;d.container.scrollTop=d.view.translate.y*d.view.scale-a}this.fireEvent(new mxEventObject("pageViewChanged"))};EditorUi.prototype.setBackgroundColor=function(a){this.editor.graph.background=a;this.editor.graph.view.validateBackground();this.fireEvent(new mxEventObject("backgroundColorChanged"))};EditorUi.prototype.setFoldingEnabled=function(a){this.editor.graph.foldingEnabled=a;this.editor.graph.view.revalidate();this.fireEvent(new mxEventObject("foldingEnabledChanged"))};EditorUi.prototype.setPageFormat=function(a){this.editor.graph.pageFormat=a;if(!this.editor.graph.pageVisible){this.actions.get("pageView").funct()}else{this.editor.graph.view.validateBackground();this.editor.graph.sizeDidChange()}this.fireEvent(new mxEventObject("pageFormatChanged"))};EditorUi.prototype.setPageScale=function(a){this.editor.graph.pageScale=a;if(!this.editor.graph.pageVisible){this.actions.get("pageView").funct()}else{this.editor.graph.view.validateBackground();this.editor.graph.sizeDidChange()}this.fireEvent(new mxEventObject("pageScaleChanged"))};EditorUi.prototype.setGridColor=function(a){this.editor.graph.view.gridColor=a;this.editor.graph.view.validateBackground();this.fireEvent(new mxEventObject("gridColorChanged"))};EditorUi.prototype.addUndoListener=function(){var b=this.actions.get("undo");var c=this.actions.get("redo");var e=this.editor.undoManager;var d=mxUtils.bind(this,function(){b.setEnabled(this.canUndo());c.setEnabled(this.canRedo())});e.addListener(mxEvent.ADD,d);e.addListener(mxEvent.UNDO,d);e.addListener(mxEvent.REDO,d);e.addListener(mxEvent.CLEAR,d);var a=this.editor.graph.cellEditor.startEditing;this.editor.graph.cellEditor.startEditing=function(){a.apply(this,arguments);d()};var f=this.editor.graph.cellEditor.stopEditing;this.editor.graph.cellEditor.stopEditing=function(g,h){f.apply(this,arguments);d()};d()};EditorUi.prototype.updateActionStates=function(){var j=this.editor.graph;var c=!j.isSelectionEmpty();var k=false;var d=false;var l=j.getSelectionCells();if(l!=null){for(var e=0;e<l.length;e++){var h=l[e];if(j.getModel().isEdge(h)){d=true}if(j.getModel().isVertex(h)){k=true}if(d&&k){break}}}var b=["cut","copy","bold","italic","underline","delete","duplicate","editStyle","editTooltip","editLink","backgroundColor","borderColor","edit","toFront","toBack","lockUnlock","solid","dashed","dotted","fillColor","gradientColor","shadow","fontColor","formattedText","rounded","toggleRounded","sharp","strokeColor"];for(var e=0;e<b.length;e++){this.actions.get(b[e]).setEnabled(c)}this.actions.get("setAsDefaultStyle").setEnabled(j.getSelectionCount()==1);this.actions.get("clearWaypoints").setEnabled(!j.isSelectionEmpty());this.actions.get("turn").setEnabled(!j.isSelectionEmpty());this.actions.get("curved").setEnabled(d);this.actions.get("rotation").setEnabled(k);this.actions.get("wordWrap").setEnabled(k);this.actions.get("autosize").setEnabled(k);this.actions.get("collapsible").setEnabled(k);var g=k&&j.getSelectionCount()==1;this.actions.get("group").setEnabled(j.getSelectionCount()>1||(g&&!j.isContainer(j.getSelectionCell())));this.actions.get("ungroup").setEnabled(j.getSelectionCount()==1&&(j.getModel().getChildCount(j.getSelectionCell())>0||(g&&j.isContainer(j.getSelectionCell()))));this.actions.get("removeFromGroup").setEnabled(g&&j.getModel().isVertex(j.getModel().getParent(j.getSelectionCell())));var a=j.view.getState(j.getSelectionCell());this.menus.get("navigation").setEnabled(c||j.view.currentRoot!=null);this.actions.get("collapsible").setEnabled(k&&j.getSelectionCount()==1&&(j.isContainer(j.getSelectionCell())||j.model.getChildCount(j.getSelectionCell())>0));this.actions.get("home").setEnabled(j.view.currentRoot!=null);this.actions.get("exitGroup").setEnabled(j.view.currentRoot!=null);this.actions.get("enterGroup").setEnabled(j.getSelectionCount()==1&&j.isValidRoot(j.getSelectionCell()));var f=j.getSelectionCount()==1&&j.isCellFoldable(j.getSelectionCell());this.actions.get("expand").setEnabled(f);this.actions.get("collapse").setEnabled(f);this.actions.get("editLink").setEnabled(j.getSelectionCount()==1);this.actions.get("openLink").setEnabled(j.getSelectionCount()==1&&j.getLinkForCell(j.getSelectionCell())!=null);this.actions.get("guides").setEnabled(j.isEnabled());this.actions.get("grid").setEnabled(!this.editor.chromeless);var m=j.isEnabled()&&!j.isCellLocked(j.getDefaultParent());this.menus.get("layout").setEnabled(m);this.menus.get("insert").setEnabled(m);this.menus.get("direction").setEnabled(m&&k);this.menus.get("align").setEnabled(m&&k&&j.getSelectionCount()>1);this.menus.get("distribute").setEnabled(m&&k&&j.getSelectionCount()>1);this.actions.get("selectVertices").setEnabled(m);this.actions.get("selectEdges").setEnabled(m);this.actions.get("selectAll").setEnabled(m);this.actions.get("selectNone").setEnabled(m);this.updatePasteActionStates()};EditorUi.prototype.refresh=function(b){b=(b!=null)?b:true;var k=mxClient.IS_IE&&(document.documentMode==null||document.documentMode==5);var n=this.container.clientWidth;var j=this.container.clientHeight;if(this.container==document.body){n=document.body.clientWidth||document.documentElement.clientWidth;j=(k)?document.body.clientHeight||document.documentElement.clientHeight:document.documentElement.clientHeight}var f=0;if(mxClient.IS_IOS&&!window.navigator.standalone){if(window.innerHeight!=document.documentElement.clientHeight){f=document.documentElement.clientHeight-window.innerHeight;window.scrollTo(0,0)}}var l=Math.max(0,Math.min(this.hsplitPosition,n-this.splitSize-20));var i=0;if(this.menubar!=null){this.menubarContainer.style.height=this.menubarHeight+"px";i+=this.menubarHeight}if(this.toolbar!=null){this.toolbarContainer.style.top=this.menubarHeight+"px";this.toolbarContainer.style.height=this.toolbarHeight+"px";i+=this.toolbarHeight}if(i>0&&!mxClient.IS_QUIRKS){i+=1}var m=0;if(this.sidebarFooterContainer!=null){var a=this.footerHeight+f;m=Math.max(0,Math.min(j-i-a,this.sidebarFooterHeight));this.sidebarFooterContainer.style.width=l+"px";this.sidebarFooterContainer.style.height=m+"px";this.sidebarFooterContainer.style.bottom=a+"px"}var g=(this.format!=null)?this.formatWidth:0;this.sidebarContainer.style.top=i+"px";this.sidebarContainer.style.width=l+"px";this.formatContainer.style.top=i+"px";this.formatContainer.style.width=g+"px";this.formatContainer.style.display=(this.format!=null)?"":"none";this.diagramContainer.style.left=(this.hsplit.parentNode!=null)?(l+this.splitSize)+"px":"0px";this.diagramContainer.style.top=this.sidebarContainer.style.top;this.footerContainer.style.height=this.footerHeight+"px";this.hsplit.style.top=this.sidebarContainer.style.top;this.hsplit.style.bottom=(this.footerHeight+f)+"px";this.hsplit.style.left=l+"px";if(this.tabContainer!=null){this.tabContainer.style.left=this.diagramContainer.style.left}if(k){this.menubarContainer.style.width=n+"px";this.toolbarContainer.style.width=this.menubarContainer.style.width;var e=Math.max(0,j-this.footerHeight-this.menubarHeight-this.toolbarHeight);this.sidebarContainer.style.height=(e-m)+"px";this.formatContainer.style.height=e+"px";this.diagramContainer.style.width=(this.hsplit.parentNode!=null)?Math.max(0,n-l-this.splitSize-g)+"px":n+"px";this.footerContainer.style.width=this.menubarContainer.style.width;var d=Math.max(0,j-this.footerHeight-this.menubarHeight-this.toolbarHeight);if(this.tabContainer!=null){this.tabContainer.style.width=this.diagramContainer.style.width;this.tabContainer.style.bottom=(this.footerHeight+f)+"px";d-=this.tabContainer.clientHeight}this.diagramContainer.style.height=d+"px";this.hsplit.style.height=d+"px"}else{if(this.footerHeight>0){this.footerContainer.style.bottom=f+"px"}this.diagramContainer.style.right=g+"px";var c=0;if(this.tabContainer!=null){this.tabContainer.style.bottom=(this.footerHeight+f)+"px";this.tabContainer.style.right=this.diagramContainer.style.right;c=this.tabContainer.clientHeight}this.sidebarContainer.style.bottom=(this.footerHeight+m+f)+"px";this.formatContainer.style.bottom=(this.footerHeight+f)+"px";this.diagramContainer.style.bottom=(this.footerHeight+f+c)+"px"}if(b){this.editor.graph.sizeDidChange()}};EditorUi.prototype.createTabContainer=function(){return null};EditorUi.prototype.createDivs=function(){this.menubarContainer=this.createDiv("geMenubarContainer");this.toolbarContainer=this.createDiv("geToolbarContainer");this.sidebarContainer=this.createDiv("geSidebarContainer");this.formatContainer=this.createDiv("geSidebarContainer");this.diagramContainer=this.createDiv("geDiagramContainer");this.footerContainer=this.createDiv("geFooterContainer");this.hsplit=this.createDiv("geHsplit");this.hsplit.setAttribute("title",mxResources.get("collapseExpand"));this.menubarContainer.style.top="0px";this.menubarContainer.style.left="0px";this.menubarContainer.style.right="0px";this.toolbarContainer.style.left="0px";this.toolbarContainer.style.right="0px";this.sidebarContainer.style.left="0px";this.formatContainer.style.right="0px";this.formatContainer.style.zIndex="1";this.diagramContainer.style.right=((this.format!=null)?this.formatWidth:0)+"px";this.footerContainer.style.left="0px";this.footerContainer.style.right="0px";this.footerContainer.style.bottom="0px";this.footerContainer.style.zIndex=mxPopupMenu.prototype.zIndex-2;this.hsplit.style.width=this.splitSize+"px";this.formatContainer.style.backgroundColor="whiteSmoke";this.formatContainer.style.overflowX="hidden";this.formatContainer.style.overflowY="auto";this.formatContainer.style.fontSize="12px";this.sidebarFooterContainer=this.createSidebarFooterContainer();if(this.sidebarFooterContainer){this.sidebarFooterContainer.style.left="0px"}if(!this.editor.chromeless){this.tabContainer=this.createTabContainer()}};EditorUi.prototype.createSidebarFooterContainer=function(){return null};EditorUi.prototype.createUi=function(){this.menubar=(this.editor.chromeless)?null:this.menus.createMenubar(this.createDiv("geMenubar"));if(this.menubar!=null){this.menubarContainer.appendChild(this.menubar.container)}if(this.menubar!=null){this.statusContainer=this.createStatusContainer();this.editor.addListener("statusChanged",mxUtils.bind(this,function(){this.setStatusText(this.editor.getStatus())}));this.setStatusText(this.editor.getStatus());this.menubar.container.appendChild(this.statusContainer);this.container.appendChild(this.menubarContainer)}this.sidebar=(this.editor.chromeless)?null:this.createSidebar(this.sidebarContainer);if(this.sidebar!=null){this.container.appendChild(this.sidebarContainer)}this.format=(this.editor.chromeless||!this.formatEnabled)?null:this.createFormat(this.formatContainer);if(this.format!=null){this.container.appendChild(this.formatContainer)}var a=(this.editor.chromeless)?null:this.createFooter();if(a!=null){this.footerContainer.appendChild(a);this.container.appendChild(this.footerContainer)}if(this.sidebar!=null&&this.sidebarFooterContainer){this.container.appendChild(this.sidebarFooterContainer)}this.container.appendChild(this.diagramContainer);if(this.container!=null&&this.tabContainer!=null){this.container.appendChild(this.tabContainer)}this.toolbar=(this.editor.chromeless)?null:this.createToolbar(this.createDiv("geToolbar"));if(this.toolbar!=null){this.toolbarContainer.appendChild(this.toolbar.container);this.container.appendChild(this.toolbarContainer)}if(this.sidebar!=null){this.container.appendChild(this.hsplit);this.addSplitHandler(this.hsplit,true,0,mxUtils.bind(this,function(b){this.hsplitPosition=b;this.refresh()}))}};EditorUi.prototype.createStatusContainer=function(){var a=document.createElement("a");a.className="geItem geStatus";return a};EditorUi.prototype.setStatusText=function(a){this.statusContainer.innerHTML=a};EditorUi.prototype.createToolbar=function(a){return new Toolbar(this,a)};EditorUi.prototype.createSidebar=function(a){return new Sidebar(this,a)};EditorUi.prototype.createFormat=function(a){return new Format(this,a)};EditorUi.prototype.createFooter=function(){return this.createDiv("geFooter")};EditorUi.prototype.createDiv=function(b){var a=document.createElement("div");a.className=b;return a};EditorUi.prototype.addSplitHandler=function(d,a,j,h){var c=null;var g=null;var k=true;var i=null;if(mxClient.IS_POINTER){d.style.touchAction="none"}var e=mxUtils.bind(this,function(){var l=parseInt(((a)?d.style.left:d.style.bottom));if(!a){l=l+j-this.footerHeight}return l});function f(l){if(c!=null){var m=new mxPoint(mxEvent.getClientX(l),mxEvent.getClientY(l));h(Math.max(0,g+((a)?(m.x-c.x):(c.y-m.y))-j));mxEvent.consume(l);if(g!=e()){k=true;i=null}}}function b(l){f(l);g=null;c=null}mxEvent.addGestureListeners(d,function(l){c=new mxPoint(mxEvent.getClientX(l),mxEvent.getClientY(l));g=e();k=false;mxEvent.consume(l)});mxEvent.addListener(d,"click",function(l){if(!k){var m=(i!=null)?i-j:0;i=e();h(m);mxEvent.consume(l)}});mxEvent.addGestureListeners(document,null,f,b);this.destroyFunctions.push(function(){mxEvent.removeGestureListeners(document,null,f,b)})};EditorUi.prototype.showDialog=function(c,b,e,f,d,a){this.editor.graph.tooltipHandler.hideTooltip();if(this.dialogs==null){this.dialogs=[]}this.dialog=new Dialog(this,c,b,e,f,d,a);this.dialogs.push(this.dialog)};EditorUi.prototype.hideDialog=function(a){if(this.dialogs!=null&&this.dialogs.length>0){var b=this.dialogs.pop();b.close(a);this.dialog=(this.dialogs.length>0)?this.dialogs[this.dialogs.length-1]:null;if(this.dialog==null&&this.editor.graph.container.style.visibility!="hidden"){this.editor.graph.container.focus()}this.editor.fireEvent(new mxEventObject("hideDialog"))}};EditorUi.prototype.pickColor=function(b,a){var d=this.editor.graph;var c=d.cellEditor.saveSelection();var e=new ColorDialog(this,b||"none",function(f){d.cellEditor.restoreSelection(c);a(f)},function(){d.cellEditor.restoreSelection(c)});this.showDialog(e.container,220,430,true,false);e.init()};EditorUi.prototype.openFile=function(){window.openFile=new OpenFile(mxUtils.bind(this,function(a){this.hideDialog(a)}));this.showDialog(new OpenDialog(this).container,(Editor.useLocalStorage)?640:320,(Editor.useLocalStorage)?480:220,true,true,function(){window.openFile=null})};EditorUi.prototype.extractGraphModelFromHtml=function(d){var b=null;try{var a=d.indexOf("&lt;mxGraphModel ");if(a>=0){var c=d.lastIndexOf("&lt;/mxGraphModel&gt;");if(c>a){b=d.substring(a,c+21).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/\\&quot;/g,'"').replace(/\n/g,"")}}}catch(f){}return b};EditorUi.prototype.extractGraphModelFromEvent=function(b){var a=null;var d=null;if(b!=null){var e=(b.dataTransfer!=null)?b.dataTransfer:b.clipboardData;if(e!=null){if(document.documentMode==10||document.documentMode==11){d=e.getData("Text")}else{d=(mxUtils.indexOf(e.types,"text/html")>=0)?e.getData("text/html"):null;if(mxUtils.indexOf(e.types,"text/plain"&&(d==null||d.length==0))){d=e.getData("text/plain")}}if(d!=null){d=this.editor.graph.zapGremlins(mxUtils.trim(d));var c=this.extractGraphModelFromHtml(d);if(c!=null){d=c}}}}if(d!=null&&this.isCompatibleString(d)){a=d}return a};EditorUi.prototype.isCompatibleString=function(a){return false};EditorUi.prototype.saveFile=function(a){if(!a&&this.editor.filename!=null){this.save(this.editor.getOrCreateFilename())}else{var b=new FilenameDialog(this,this.editor.getOrCreateFilename(),mxResources.get("save"),mxUtils.bind(this,function(c){this.save(c)}),null,mxUtils.bind(this,function(c){if(c!=null&&c.length>0){return true}mxUtils.confirm(mxResources.get("invalidName"));return false}));this.showDialog(b.container,300,100,true,true);b.init()}};EditorUi.prototype.save=function(b){if(b!=null){if(this.editor.graph.isEditing()){this.editor.graph.stopEditing()}var a=mxUtils.getXml(this.editor.getGraphXml());try{if(Editor.useLocalStorage){if(localStorage.getItem(b)!=null&&!mxUtils.confirm(mxResources.get("replaceIt",[b]))){return}localStorage.setItem(b,a);this.editor.setStatus(mxUtils.htmlEntities(mxResources.get("saved"))+" "+new Date())}else{if(a.length<MAX_REQUEST_SIZE){new mxXmlRequest(SAVE_URL,"filename="+encodeURIComponent(b)+"&xml="+encodeURIComponent(a)).simulate(document,"_blank")}else{mxUtils.alert(mxResources.get("drawingTooLarge"));mxUtils.popup(a);return}}this.editor.setModified(false);this.editor.setFilename(b);this.updateDocumentTitle()}catch(c){this.editor.setStatus(mxUtils.htmlEntities(mxResources.get("errorSavingFile")))}}};EditorUi.prototype.executeLayout=function(a,b,c){var f=this.editor.graph;if(f.isEnabled()){f.getModel().beginUpdate();try{a()}catch(g){throw g}finally{if(this.allowAnimation&&b&&navigator.userAgent.indexOf("Camino")<0){var d=new mxMorphing(f);d.addListener(mxEvent.DONE,mxUtils.bind(this,function(){f.getModel().endUpdate();if(c!=null){c()}}));d.startAnimation()}else{f.getModel().endUpdate();if(c!=null){c()}}}}};EditorUi.prototype.showImageDialog=function(h,f,d,a){var c=this.editor.graph.cellEditor;var e=c.saveSelection();var g=mxUtils.prompt(h,f);c.restoreSelection(e);if(g!=null&&g.length>0){var b=new Image();b.onload=function(){d(g,b.width,b.height)};b.onerror=function(){d(null);mxUtils.alert(mxResources.get("fileNotFound"))};b.src=g}else{d(null)}};EditorUi.prototype.showLinkDialog=function(c,a,b){var d=new LinkDialog(this,c,a,b);this.showDialog(d.container,420,90,true,true);d.init()};EditorUi.prototype.showBackgroundImageDialog=function(b){b=(b!=null)?b:mxUtils.bind(this,function(d){this.setBackgroundImage(d)});var c=mxUtils.prompt(mxResources.get("backgroundImage"),"");if(c!=null&&c.length>0){var a=new Image();a.onload=function(){b(new mxImage(c,a.width,a.height))};a.onerror=function(){b(null);mxUtils.alert(mxResources.get("fileNotFound"))};a.src=c}else{b(null)}};EditorUi.prototype.setBackgroundImage=function(a){this.editor.graph.setBackgroundImage(a);this.editor.graph.view.validateBackgroundImage();this.fireEvent(new mxEventObject("backgroundImageChanged"))};EditorUi.prototype.confirm=function(c,b,a){if(mxUtils.confirm(c)){if(b!=null){b()}}else{if(a!=null){a()}}};EditorUi.prototype.createOutline=function(b){var a=new mxOutline(this.editor.graph);a.border=20;mxEvent.addListener(window,"resize",function(){a.update()});this.addListener("pageFormatChanged",function(){a.update()});return a};EditorUi.prototype.createKeyHandler=function(f){var k=this;var l=this.editor.graph;var c=new mxKeyHandler(l);var m=c.isEventIgnored;c.isEventIgnored=function(n){return(!this.isControlDown(n)||mxEvent.isShiftDown(n)||(n.keyCode!=90&&n.keyCode!=89&&n.keyCode!=188&&n.keyCode!=190&&n.keyCode!=85))&&((n.keyCode!=66&&n.keyCode!=73)||!this.isControlDown(n)||(this.graph.cellEditor.isContentEditing()&&!mxClient.IS_FF&&!mxClient.IS_SF))&&m.apply(this,arguments)};c.isEnabledForEvent=function(n){return(!mxEvent.isConsumed(n)&&this.isGraphEvent(n)&&this.isEnabled())};c.isControlDown=function(n){return mxEvent.isControlDown(n)||(mxClient.IS_MAC&&n.metaKey)};var e=[];var h=null;function b(p,n,o){e.push(function(){if(!l.isSelectionEmpty()&&l.isEnabled()){n=(n!=null)?n:1;if(o){l.getModel().beginUpdate();try{var x=l.getSelectionCells();for(var r=0;r<x.length;r++){if(l.getModel().isVertex(x[r])&&l.isCellResizable(x[r])){var q=l.getCellGeometry(x[r]);if(q!=null){q=q.clone();if(p==37){q.width=Math.max(0,q.width-n)}else{if(p==38){q.height=Math.max(0,q.height-n)}else{if(p==39){q.width+=n}else{if(p==40){q.height+=n}}}}l.getModel().setGeometry(x[r],q)}}}}finally{l.getModel().endUpdate()}}else{var v=l.getSelectionCell();var u=l.model.getParent(v);var s=null;if(l.getSelectionCount()==1&&l.model.isVertex(v)&&l.layoutManager!=null&&!l.isCellLocked(v)){s=l.layoutManager.getLayout(u)}if(s!=null&&s.constructor==mxStackLayout){var t=u.getIndex(v);if(p==37||p==38){l.model.add(u,v,Math.max(0,t-1))}else{if(p==39||p==40){l.model.add(u,v,Math.min(l.model.getChildCount(u),t+1))}}}else{var y=0;var w=0;if(p==37){y=-n}else{if(p==38){w=-n}else{if(p==39){y=n}else{if(p==40){w=n}}}}l.moveCells(l.getMovableCells(l.getSelectionCells()),y,w)}}}});if(h!=null){window.clearTimeout(h)}h=window.setTimeout(function(){if(e.length>0){l.getModel().beginUpdate();try{for(var q=0;q<e.length;q++){e[q]()}e=[]}finally{l.getModel().endUpdate()}l.scrollCellToVisible(l.getSelectionCell())}},200)}var i={37:mxConstants.DIRECTION_WEST,38:mxConstants.DIRECTION_NORTH,39:mxConstants.DIRECTION_EAST,40:mxConstants.DIRECTION_SOUTH};var g=c.getFunction;var d={67:this.actions.get("clearWaypoints")};mxKeyHandler.prototype.getFunction=function(n){if(l.isEnabled()){if(!l.isSelectionEmpty()&&mxEvent.isShiftDown(n)&&mxEvent.isAltDown(n)){var o=d[n.keyCode];if(o!=null){return o.funct}}if(n.keyCode==9&&mxEvent.isAltDown(n)){if(mxEvent.isShiftDown(n)){return function(){l.selectParentCell()}}else{return function(){l.selectChildCell()}}}else{if(i[n.keyCode]!=null&&!l.isSelectionEmpty()){if(mxEvent.isShiftDown(n)&&mxEvent.isAltDown(n)){if(l.model.isVertex(l.getSelectionCell())){return function(){var p=l.connectVertex(l.getSelectionCell(),i[n.keyCode],l.defaultEdgeLength,n,true);if(p!=null&&p.length>0){if(p.length==1&&l.model.isEdge(p[0])){l.setSelectionCell(l.model.getTerminal(p[0],false))}else{l.setSelectionCell(p[p.length-1])}if(k.hoverIcons!=null){k.hoverIcons.update(l.view.getState(l.getSelectionCell()))}}}}}else{if(this.isControlDown(n)){return function(){b(n.keyCode,(mxEvent.isShiftDown(n))?l.gridSize:null,true)}}else{return function(){b(n.keyCode,(mxEvent.isShiftDown(n))?l.gridSize:null)}}}}}}return g.apply(this,arguments)};c.bindAction=mxUtils.bind(this,function(p,s,o,n){var r=this.actions.get(o);if(r!=null){var q=function(){if(r.isEnabled()){r.funct()}};if(s){if(n){c.bindControlShiftKey(p,q)}else{c.bindControlKey(p,q)}}else{if(n){c.bindShiftKey(p,q)}else{c.bindKey(p,q)}}}});var j=this;var a=c.escape;c.escape=function(n){a.apply(this,arguments)};c.enter=function(){};c.bindControlShiftKey(36,function(){l.exitGroup()});c.bindControlShiftKey(35,function(){l.enterGroup()});c.bindKey(36,function(){l.home()});c.bindKey(35,function(){l.refresh()});c.bindAction(107,true,"zoomIn");c.bindAction(109,true,"zoomOut");c.bindAction(80,true,"print");c.bindAction(79,true,"outline",true);c.bindAction(112,false,"about");if(!this.editor.chromeless){c.bindControlKey(36,function(){if(l.isEnabled()){l.foldCells(true)}});c.bindControlKey(35,function(){if(l.isEnabled()){l.foldCells(false)}});c.bindControlKey(13,function(){if(l.isEnabled()){l.setSelectionCells(l.duplicateCells(l.getSelectionCells(),false))}});c.bindAction(8,false,"delete");c.bindAction(8,true,"deleteAll");c.bindAction(46,false,"delete");c.bindAction(46,true,"deleteAll");c.bindAction(72,true,"resetView");c.bindAction(72,true,"fitWindow",true);c.bindAction(74,true,"fitPage");c.bindAction(74,true,"fitTwoPages",true);c.bindAction(48,true,"customZoom");c.bindAction(82,true,"turn");c.bindAction(82,true,"clearDefaultStyle",true);c.bindAction(83,true,"save");c.bindAction(83,true,"saveAs",true);c.bindAction(65,true,"selectAll");c.bindAction(65,true,"selectNone",true);c.bindAction(73,true,"selectVertices",true);c.bindAction(69,true,"selectEdges",true);c.bindAction(69,true,"editStyle");c.bindAction(66,true,"bold");c.bindAction(66,true,"toBack",true);c.bindAction(70,true,"toFront",true);c.bindAction(68,true,"duplicate");c.bindAction(68,true,"setAsDefaultStyle",true);c.bindAction(90,true,"undo");c.bindAction(89,true,"autosize",true);c.bindAction(88,true,"cut");c.bindAction(67,true,"copy");c.bindAction(81,true,"connectionArrows");c.bindAction(81,true,"connectionPoints",true);c.bindAction(86,true,"paste");c.bindAction(71,true,"group");c.bindAction(77,true,"editData");c.bindAction(71,true,"grid",true);c.bindAction(73,true,"italic");c.bindAction(76,true,"lockUnlock");c.bindAction(76,true,"layers",true);c.bindAction(80,true,"formatPanel",true);c.bindAction(85,true,"underline");c.bindAction(85,true,"ungroup",true);c.bindAction(190,true,"superscript");c.bindAction(188,true,"subscript");c.bindKey(13,function(){if(l.isEnabled()){l.startEditingAtCell()}});c.bindKey(113,function(){if(l.isEnabled()){l.startEditingAtCell()}})}if(!mxClient.IS_WIN){c.bindAction(90,true,"redo",true)}else{c.bindAction(89,true,"redo")}return c};EditorUi.prototype.destroy=function(){if(this.editor!=null){this.editor.destroy();this.editor=null}if(this.menubar!=null){this.menubar.destroy();this.menubar=null}if(this.toolbar!=null){this.toolbar.destroy();this.toolbar=null}if(this.sidebar!=null){this.sidebar.destroy();this.sidebar=null}if(this.keyHandler!=null){this.keyHandler.destroy();this.keyHandler=null}if(this.keydownHandler!=null){mxEvent.removeListener(document,"keydown",this.keydownHandler);this.keydownHandler=null}if(this.keyupHandler!=null){mxEvent.removeListener(document,"keyup",this.keyupHandler);this.keyupHandler=null}if(this.resizeHandler!=null){mxEvent.removeListener(window,"resize",this.resizeHandler);this.resizeHandler=null}if(this.gestureHandler!=null){mxEvent.removeGestureListeners(document,this.gestureHandler);this.gestureHandler=null}if(this.orientationChangeHandler!=null){mxEvent.removeListener(window,"orientationchange",this.orientationChangeHandler);this.orientationChangeHandler=null}if(this.scrollHandler!=null){mxEvent.removeListener(window,"scroll",this.scrollHandler);this.scrollHandler=null}if(this.destroyFunctions!=null){for(var a=0;a<this.destroyFunctions.length;a++){this.destroyFunctions[a]()}this.destroyFunctions=null}var b=[this.menubarContainer,this.toolbarContainer,this.sidebarContainer,this.formatContainer,this.diagramContainer,this.footerContainer,this.chromelessToolbar,this.hsplit,this.sidebarFooterContainer,this.layersDialog];for(var a=0;a<b.length;a++){if(b[a]!=null&&b[a].parentNode!=null){b[a].parentNode.removeChild(b[a])}}};Format=function(b,a){this.editorUi=b;this.container=a};Format.prototype.labelIndex=0;Format.prototype.currentIndex=0;Format.prototype.init=function(){var c=this.editorUi;var a=c.editor;var b=a.graph;this.update=mxUtils.bind(this,function(e,d){this.clearSelectionState();this.refresh()});b.getSelectionModel().addListener(mxEvent.CHANGE,this.update);b.addListener(mxEvent.EDITING_STARTED,this.update);b.addListener(mxEvent.EDITING_STOPPED,this.update);b.getModel().addListener(mxEvent.CHANGE,this.update);b.addListener(mxEvent.ROOT,mxUtils.bind(this,function(){this.refresh()}));this.refresh()};Format.prototype.clearSelectionState=function(){this.selectionState=null};Format.prototype.getSelectionState=function(){if(this.selectionState==null){this.selectionState=this.createSelectionState()}return this.selectionState};Format.prototype.createSelectionState=function(){var b=this.editorUi.editor.graph.getSelectionCells();var a=this.initSelectionState();for(var c=0;c<b.length;c++){this.updateSelectionStateForCell(a,b[c],b)}return a};Format.prototype.initSelectionState=function(){return{vertices:[],edges:[],x:null,y:null,width:null,height:null,style:{},containsImage:false,containsLabel:false,fill:true,glass:true,rounded:true,comic:true,autoSize:false,image:true,shadow:true}};Format.prototype.updateSelectionStateForCell=function(k,h,j){var i=this.editorUi.editor.graph;if(i.getModel().isVertex(h)){k.vertices.push(h);var b=i.getCellGeometry(h);if(b!=null){if(b.width>0){if(k.width==null){k.width=b.width}else{if(k.width!=b.width){k.width=""}}}else{k.containsLabel=true}if(b.height>0){if(k.height==null){k.height=b.height}else{if(k.height!=b.height){k.height=""}}}else{k.containsLabel=true}if(!b.relative||b.offset!=null){var e=(b.relative)?b.offset.x:b.x;var d=(b.relative)?b.offset.y:b.y;if(k.x==null){k.x=e}else{if(k.x!=e){k.x=""}}if(k.y==null){k.y=d}else{if(k.y!=d){k.y=""}}}}}else{if(i.getModel().isEdge(h)){k.edges.push(h)}}var a=i.view.getState(h);if(a!=null){k.autoSize=k.autoSize||this.isAutoSizeState(a);k.glass=k.glass&&this.isGlassState(a);k.rounded=k.rounded&&this.isRoundedState(a);k.comic=k.comic&&this.isComicState(a);k.image=k.image&&this.isImageState(a);k.shadow=k.shadow&&this.isShadowState(a);k.fill=k.fill&&this.isFillState(a);var c=mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE,null);k.containsImage=k.containsImage||c=="image";for(var g in a.style){var f=a.style[g];if(f!=null){if(k.style[g]==null){k.style[g]=f}else{if(k.style[g]!=f){k.style[g]=""}}}}}};Format.prototype.isFillState=function(a){return a.view.graph.model.isVertex(a.cell)||mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE,null)=="arrow"||mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE,null)=="flexArrow"};Format.prototype.isGlassState=function(b){var a=mxUtils.getValue(b.style,mxConstants.STYLE_SHAPE,null);return(a=="label"||a=="rectangle"||a=="internalStorage"||a=="ext"||a=="umlLifeline"||a=="swimlane"||a=="process")};Format.prototype.isRoundedState=function(b){var a=mxUtils.getValue(b.style,mxConstants.STYLE_SHAPE,null);return(a=="label"||a=="rectangle"||a=="internalStorage"||a=="corner"||a=="parallelogram"||a=="swimlane"||a=="triangle"||a=="trapezoid"||a=="ext"||a=="step"||a=="tee"||a=="process"||a=="link"||a=="rhombus"||a=="offPageConnector"||a=="loopLimit"||a=="hexagon"||a=="manualInput"||a=="curlyBracket"||a=="singleArrow"||a=="doubleArrow"||a=="flexArrow"||a=="card"||a=="umlLifeline")};Format.prototype.isComicState=function(b){var a=mxUtils.getValue(b.style,mxConstants.STYLE_SHAPE,null);return mxUtils.indexOf(["label","rectangle","internalStorage","corner","parallelogram","note","collate","swimlane","triangle","trapezoid","ext","step","tee","process","link","rhombus","offPageConnector","loopLimit","hexagon","manualInput","singleArrow","doubleArrow","flexArrow","card","umlLifeline","connector","folder","component","sortShape","cross","umlFrame","cube","isoCube","isoRectangle"],a)>=0};Format.prototype.isAutoSizeState=function(a){return mxUtils.getValue(a.style,mxConstants.STYLE_AUTOSIZE,null)=="1"};Format.prototype.isImageState=function(b){var a=mxUtils.getValue(b.style,mxConstants.STYLE_SHAPE,null);return(a=="label"||a=="image")};Format.prototype.isShadowState=function(b){var a=mxUtils.getValue(b.style,mxConstants.STYLE_SHAPE,null);return(a!="image")};Format.prototype.clear=function(){this.container.innerHTML="";if(this.panels!=null){for(var a=0;a<this.panels.length;a++){this.panels[a].destroy()}}this.panels=[]};Format.prototype.refresh=function(){if(this.container.style.width=="0px"){return}this.clear();var k=this.editorUi;var o=k.editor.graph;var a=document.createElement("div");a.style.whiteSpace="nowrap";a.style.color="rgb(112, 112, 112)";a.style.textAlign="left";a.style.cursor="default";var l=document.createElement("div");l.style.border="1px solid #c0c0c0";l.style.borderWidth="0px 0px 1px 0px";l.style.textAlign="center";l.style.fontWeight="bold";l.style.overflow="hidden";l.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block";l.style.paddingTop="8px";l.style.height=(mxClient.IS_QUIRKS)?"34px":"25px";l.style.width="100%";this.container.appendChild(a);if(o.isSelectionEmpty()){mxUtils.write(l,mxResources.get("diagram"));var g=document.createElement("img");g.setAttribute("border","0");g.setAttribute("src",Dialog.prototype.closeImage);g.setAttribute("title",mxResources.get("hide"));g.style.position="absolute";g.style.display="block";g.style.right="0px";g.style.top="8px";g.style.cursor="pointer";g.style.marginTop="1px";g.style.marginRight="17px";g.style.border="1px solid transparent";g.style.padding="1px";g.style.opacity=0.5;l.appendChild(g);mxEvent.addListener(g,"click",function(){k.actions.get("formatPanel").funct()});a.appendChild(l);this.panels.push(new DiagramFormatPanel(this,k,a))}else{if(o.isEditing()){mxUtils.write(l,mxResources.get("text"));a.appendChild(l);this.panels.push(new TextFormatPanel(this,k,a))}else{var i=this.getSelectionState().containsLabel;var n=null;var b=null;var f=mxUtils.bind(this,function(r,p,q){var s=mxUtils.bind(this,function(t){if(n!=r){if(i){this.labelIndex=q}else{this.currentIndex=q}if(n!=null){n.style.backgroundColor="#d7d7d7";n.style.borderBottomWidth="1px"}n=r;n.style.backgroundColor="";n.style.borderBottomWidth="0px";if(b!=p){if(b!=null){b.style.display="none"}b=p;b.style.display=""}}});mxEvent.addListener(r,"click",s);if(q==((i)?this.labelIndex:this.currentIndex)){s()}});var m=0;l.style.backgroundColor="#d7d7d7";l.style.borderLeftWidth="1px";l.style.width=(i)?"50%":"33.3%";l.style.width=(i)?"50%":"33.3%";var e=l.cloneNode(false);var d=e.cloneNode(false);e.style.backgroundColor="#d7d7d7";d.style.backgroundColor="#d7d7d7";if(i){e.style.borderLeftWidth="0px"}else{l.style.borderLeftWidth="0px";mxUtils.write(l,mxResources.get("style"));a.appendChild(l);var c=a.cloneNode(false);c.style.display="none";this.panels.push(new StyleFormatPanel(this,k,c));this.container.appendChild(c);f(l,c,m++)}mxUtils.write(e,mxResources.get("text"));a.appendChild(e);var h=a.cloneNode(false);h.style.display="none";this.panels.push(new TextFormatPanel(this,k,h));this.container.appendChild(h);mxUtils.write(d,mxResources.get("arrange"));a.appendChild(d);var j=a.cloneNode(false);j.style.display="none";this.panels.push(new ArrangePanel(this,k,j));this.container.appendChild(j);f(e,h,m++);f(d,j,m++)}}};BaseFormatPanel=function(c,b,a){this.format=c;this.editorUi=b;this.container=a;this.listeners=[]};BaseFormatPanel.prototype.getSelectionState=function(){var f=this.editorUi.editor.graph;var b=f.getSelectionCells();var a=null;for(var d=0;d<b.length;d++){var e=f.view.getState(b[d]);if(e!=null){var c=mxUtils.getValue(e.style,mxConstants.STYLE_SHAPE,null);if(c!=null){if(a==null){a=c}else{if(a!=c){return null}}}}}return a};BaseFormatPanel.prototype.installInputHandler=function(j,l,f,e,h,k,c,b){k=(k!=null)?k:"";b=(b!=null)?b:false;var g=this.editorUi;var m=g.editor.graph;e=(e!=null)?e:1;h=(h!=null)?h:999;var a=null;var i=false;var d=mxUtils.bind(this,function(o){var s=(b)?parseFloat(j.value):parseInt(j.value);if(!isNaN(s)&&l==mxConstants.STYLE_ROTATION){s=mxUtils.mod(Math.round(s*100),36000)/100}s=Math.min(h,Math.max(e,(isNaN(s))?f:s));if(m.cellEditor.isContentEditing()&&c){if(!i){i=true;if(a!=null){m.cellEditor.restoreSelection(a);a=null}c(s);j.value=s+k;i=false}}else{if(s!=mxUtils.getValue(this.format.getSelectionState().style,l,f)){if(m.isEditing()){m.stopEditing(true)}m.getModel().beginUpdate();try{m.setCellStyles(l,s,m.getSelectionCells());if(l==mxConstants.STYLE_FONTSIZE){var q=m.getSelectionCells();for(var r=0;r<q.length;r++){var n=q[r];if(m.isHtmlLabel(n)){var u=document.createElement("div");u.innerHTML=m.convertValueToString(n);var t=u.getElementsByTagName("font");for(var p=0;p<t.length;p++){t[p].removeAttribute("size");t[p].style.fontSize=s+"px"}m.cellLabelChanged(n,u.innerHTML)}}}}finally{m.getModel().endUpdate()}g.fireEvent(new mxEventObject("styleChanged","keys",[l],"values",[s],"cells",m.getSelectionCells()))}}j.value=s+k;mxEvent.consume(o)});if(c&&m.cellEditor.isContentEditing()){mxEvent.addListener(j,"mousedown",function(){a=m.cellEditor.saveSelection()});mxEvent.addListener(j,"touchstart",function(){a=m.cellEditor.saveSelection()})}mxEvent.addListener(j,"change",d);mxEvent.addListener(j,"blur",d);return d};BaseFormatPanel.prototype.createPanel=function(){var a=document.createElement("div");a.style.padding="12px 0px 12px 18px";a.style.borderBottom="1px solid #c0c0c0";return a};BaseFormatPanel.prototype.createTitle=function(a){var b=document.createElement("div");b.style.padding="0px 0px 6px 0px";b.style.whiteSpace="nowrap";b.style.overflow="hidden";b.style.width="200px";b.style.fontWeight="bold";mxUtils.write(b,a);return b};BaseFormatPanel.prototype.createStepper=function(g,d,a,i,j,f){a=(a!=null)?a:1;i=(i!=null)?i:8;if(mxClient.IS_QUIRKS){i=i-2}else{if(mxClient.IS_MT||document.documentMode>=8){i=i+1}}var c=document.createElement("div");mxUtils.setPrefixedStyle(c.style,"borderRadius","3px");c.style.border="1px solid rgb(192, 192, 192)";c.style.position="absolute";var e=document.createElement("div");e.style.borderBottom="1px solid rgb(192, 192, 192)";e.style.position="relative";e.style.height=i+"px";e.style.width="10px";e.className="geBtnUp";c.appendChild(e);var h=e.cloneNode(false);h.style.border="none";h.style.height=i+"px";h.className="geBtnDown";c.appendChild(h);mxEvent.addListener(h,"click",function(k){if(g.value==""){g.value=f||"2"}var l=parseInt(g.value);if(!isNaN(l)){g.value=l-a;if(d!=null){d(k)}}mxEvent.consume(k)});mxEvent.addListener(e,"click",function(k){if(g.value==""){g.value=f||"0"}var l=parseInt(g.value);if(!isNaN(l)){g.value=l+a;if(d!=null){d(k)}}mxEvent.consume(k)});if(j){var b=null;mxEvent.addGestureListeners(c,function(k){if(mxClient.IS_QUIRKS||document.documentMode==8){b=document.selection.createRange()}mxEvent.consume(k)},null,function(k){if(b!=null){try{b.select()}catch(l){}b=null;mxEvent.consume(k)}})}return c};BaseFormatPanel.prototype.createOption=function(f,b,e,c){var a=document.createElement("div");a.style.padding="6px 0px 1px 0px";a.style.whiteSpace="nowrap";a.style.overflow="hidden";a.style.width="200px";a.style.height=(mxClient.IS_QUIRKS)?"27px":"18px";var d=document.createElement("input");d.setAttribute("type","checkbox");d.style.margin="0px 6px 0px 0px";a.appendChild(d);var i=document.createElement("span");mxUtils.write(i,f);a.appendChild(i);var h=false;var g=b();var j=function(k){if(!h){h=true;if(k){d.setAttribute("checked","checked");d.defaultChecked=true;d.checked=true}else{d.removeAttribute("checked");d.defaultChecked=false;d.checked=false}if(g!=k){g=k;if(b()!=g){e(g)}}h=false}};mxEvent.addListener(a,"click",function(k){var l=mxEvent.getSource(k);if(l==a||l==i){d.checked=!d.checked}j(d.checked)});j(g);if(c!=null){c.install(j);this.listeners.push(c)}return a};BaseFormatPanel.prototype.createCellOption=function(h,i,e,d,k,g,b,a){d=(d!=null)?((d=="null")?null:d):"1";k=(k!=null)?((k=="null")?null:k):"0";var f=this.editorUi;var c=f.editor;var j=c.graph;return this.createOption(h,function(){var l=j.view.getState(j.getSelectionCell());if(l!=null){return mxUtils.getValue(l.style,i,e)!=k}return null},function(l){if(a){j.stopEditing()}if(b!=null){b.funct()}else{j.getModel().beginUpdate();try{var m=(l)?d:k;j.setCellStyles(i,m,j.getSelectionCells());if(g!=null){g(j.getSelectionCells(),m)}f.fireEvent(new mxEventObject("styleChanged","keys",[i],"values",[m],"cells",j.getSelectionCells()))}finally{j.getModel().endUpdate()}}},{install:function(l){this.listener=function(){var m=j.view.getState(j.getSelectionCell());if(m!=null){l(mxUtils.getValue(m.style,i,e)!=k)}};j.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){j.getModel().removeListener(this.listener)}})};BaseFormatPanel.prototype.createColorOption=function(j,i,h,c,d,g,f){var a=document.createElement("div");a.style.padding="6px 0px 1px 0px";a.style.whiteSpace="nowrap";a.style.overflow="hidden";a.style.width="200px";a.style.height=(mxClient.IS_QUIRKS)?"27px":"18px";var e=document.createElement("input");e.setAttribute("type","checkbox");e.style.margin="0px 6px 0px 0px";if(!f){a.appendChild(e)}var m=document.createElement("span");mxUtils.write(m,j);a.appendChild(m);var l=false;var k=i();var b=null;var n=function(o,p){if(!l){l=true;b.innerHTML='<div style="width:'+((mxClient.IS_QUIRKS)?"30":"36")+"px;height:12px;margin:3px;border:1px solid black;background-color:"+((o!=null&&o!=mxConstants.NONE)?o:c)+';"></div>';if(mxClient.IS_MT||mxClient.IS_QUIRKS||document.documentMode==8){b.firstChild.style.margin="0px"}if(o!=null&&o!=mxConstants.NONE){e.setAttribute("checked","checked");e.defaultChecked=true;e.checked=true}else{e.removeAttribute("checked");e.defaultChecked=false;e.checked=false}b.style.display=(e.checked||f)?"":"none";if(g!=null){g(o)}if(!p&&(f||k!=o)){k=o;if(f||i()!=k){h(k)}}l=false}};b=mxUtils.button("",mxUtils.bind(this,function(o){this.editorUi.pickColor(k,n);mxEvent.consume(o)}));b.style.position="absolute";b.style.marginTop="-4px";b.style.right=(mxClient.IS_QUIRKS)?"0px":"20px";b.style.height="22px";b.className="geColorBtn";b.style.display=(e.checked||f)?"":"none";a.appendChild(b);mxEvent.addListener(a,"click",function(o){var p=mxEvent.getSource(o);if(p==e||p.nodeName!="INPUT"){if(p!=e){e.checked=!e.checked}if(!e.checked&&k!=null&&k!=mxConstants.NONE&&c!=mxConstants.NONE){c=k}n((e.checked)?c:mxConstants.NONE)}});n(k,true);if(d!=null){d.install(n);this.listeners.push(d)}return a};BaseFormatPanel.prototype.createCellColorOption=function(b,h,f,a,g){var e=this.editorUi;var c=e.editor;var d=c.graph;return this.createColorOption(b,function(){var i=d.view.getState(d.getSelectionCell());if(i!=null){return mxUtils.getValue(i.style,h,null)}return null},function(i){d.getModel().beginUpdate();try{if(g!=null){g(i)}d.setCellStyles(h,i,d.getSelectionCells());e.fireEvent(new mxEventObject("styleChanged","keys",[h],"values",[i],"cells",d.getSelectionCells()))}finally{d.getModel().endUpdate()}},f||mxConstants.NONE,{install:function(i){this.listener=function(){var j=d.view.getState(d.getSelectionCell());if(j!=null){i(mxUtils.getValue(j.style,h,null))}};d.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){d.getModel().removeListener(this.listener)}},a)};BaseFormatPanel.prototype.addArrow=function(c,b){b=(b!=null)?b:10;var e=document.createElement("div");e.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block";e.style.padding="6px";e.style.paddingRight="4px";var a=(10-b);if(a==2){e.style.paddingTop=6+"px"}else{if(a>0){e.style.paddingTop=(6-a)+"px"}else{e.style.marginTop="-2px"}}e.style.height=b+"px";e.style.borderLeft="1px solid #a0a0a0";e.innerHTML='<img border="0" src="'+((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHBJREFUeNpidHB2ZyAGsACxDRBPIKCuA6TwCBB/h2rABu4A8SYmKCcXiP/iUFgAxL9gCi8A8SwsirZCMQMTkmANEH9E4v+CmsaArvAdyNFI/FlQ92EoBIE+qCRIUz168DBgsU4OqhinQpgHMABAgAEALY4XLIsJ20oAAAAASUVORK5CYII=":IMAGE_PATH+"/dropdown.png")+'" style="margin-bottom:4px;">';mxUtils.setOpacity(e,70);var d=c.getElementsByTagName("div")[0];if(d!=null){d.style.paddingRight="6px";d.style.marginLeft="4px";d.style.marginTop="-1px";d.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block";mxUtils.setOpacity(d,60)}mxUtils.setOpacity(c,100);c.style.border="1px solid #a0a0a0";c.style.backgroundColor="white";c.style.backgroundImage="none";c.style.width="auto";c.className+=" geColorBtn";mxUtils.setPrefixedStyle(c.style,"borderRadius","3px");c.appendChild(e);return d};BaseFormatPanel.prototype.addUnitInput=function(a,h,i,c,f,d,b,j){b=(b!=null)?b:0;var g=document.createElement("input");g.style.position="absolute";g.style.textAlign="right";g.style.marginTop="-2px";g.style.right=(i+12)+"px";g.style.width=c+"px";a.appendChild(g);var e=this.createStepper(g,f,d,null,j);e.style.marginTop=(b-2)+"px";e.style.right=i+"px";a.appendChild(e);return g};BaseFormatPanel.prototype.createRelativeOption=function(f,g,b,j,i){b=(b!=null)?b:44;var h=this.editorUi.editor.graph;var a=this.createPanel();a.style.paddingTop="10px";a.style.paddingBottom="10px";mxUtils.write(a,f);a.style.fontWeight="bold";function d(k){if(j!=null){j(e)}else{var m=parseInt(e.value);m=Math.min(100,Math.max(0,(isNaN(m))?100:m));var l=h.view.getState(h.getSelectionCell());if(l!=null&&m!=mxUtils.getValue(l.style,g,100)){if(m==100){m=null}h.setCellStyles(g,m,h.getSelectionCells())}e.value=((m!=null)?m:"100")+" %"}mxEvent.consume(k)}var e=this.addUnitInput(a,"%",20,b,d,10,-15,j!=null);if(g!=null){var c=mxUtils.bind(this,function(n,k,o){if(o||e!=document.activeElement){var m=this.format.getSelectionState();var l=parseInt(mxUtils.getValue(m.style,g,100));e.value=(isNaN(l))?"":l+" %"}});mxEvent.addListener(e,"keydown",function(k){if(k.keyCode==13){h.container.focus();mxEvent.consume(k)}else{if(k.keyCode==27){c(null,null,true);h.container.focus();mxEvent.consume(k)}}});h.getModel().addListener(mxEvent.CHANGE,c);this.listeners.push({destroy:function(){h.getModel().removeListener(c)}});c()}mxEvent.addListener(e,"blur",d);mxEvent.addListener(e,"change",d);if(i!=null){i(e)}return a};BaseFormatPanel.prototype.addLabel=function(e,d,b,c){c=(c!=null)?c:61;var a=document.createElement("div");mxUtils.write(a,d);a.style.position="absolute";a.style.right=b+"px";a.style.width=c+"px";a.style.marginTop="6px";a.style.textAlign="center";e.appendChild(a)};BaseFormatPanel.prototype.addKeyHandler=function(a,b){mxEvent.addListener(a,"keydown",mxUtils.bind(this,function(c){if(c.keyCode==13){this.editorUi.editor.graph.container.focus();mxEvent.consume(c)}else{if(c.keyCode==27){if(b!=null){b(null,null,true)}this.editorUi.editor.graph.container.focus();mxEvent.consume(c)}}}))};BaseFormatPanel.prototype.styleButtons=function(b){for(var a=0;a<b.length;a++){mxUtils.setPrefixedStyle(b[a].style,"borderRadius","3px");mxUtils.setOpacity(b[a],100);b[a].style.border="1px solid #a0a0a0";b[a].style.padding="4px";b[a].style.paddingTop="3px";b[a].style.paddingRight="1px";b[a].style.margin="1px";b[a].style.width="24px";b[a].style.height="20px";b[a].className+=" geColorBtn"}};BaseFormatPanel.prototype.destroy=function(){if(this.listeners!=null){for(var a=0;a<this.listeners.length;a++){this.listeners[a].destroy()}this.listeners=null}};ArrangePanel=function(c,b,a){BaseFormatPanel.call(this,c,b,a);this.init()};mxUtils.extend(ArrangePanel,BaseFormatPanel);ArrangePanel.prototype.init=function(){var b=this.editorUi.editor.graph;var a=this.format.getSelectionState();this.container.appendChild(this.addLayerOps(this.createPanel()));this.addGeometry(this.container);this.addEdgeGeometry(this.container);if(!a.containsLabel||a.edges.length==0){this.container.appendChild(this.addAngle(this.createPanel()))}if(!a.containsLabel&&a.edges.length==0){this.container.appendChild(this.addFlip(this.createPanel()))}if(a.vertices.length>1){this.container.appendChild(this.addAlign(this.createPanel()));this.container.appendChild(this.addDistribute(this.createPanel()))}this.container.appendChild(this.addGroupOps(this.createPanel()))};ArrangePanel.prototype.addLayerOps=function(c){var b=this.editorUi;var a=mxUtils.button(mxResources.get("toFront"),function(d){b.actions.get("toFront").funct()});a.setAttribute("title",mxResources.get("toFront")+" ("+this.editorUi.actions.get("toFront").shortcut+")");a.style.width="100px";a.style.marginRight="2px";c.appendChild(a);var a=mxUtils.button(mxResources.get("toBack"),function(d){b.actions.get("toBack").funct()});a.setAttribute("title",mxResources.get("toBack")+" ("+this.editorUi.actions.get("toBack").shortcut+")");a.style.width="100px";c.appendChild(a);return c};ArrangePanel.prototype.addGroupOps=function(f){var e=this.editorUi;var d=e.editor.graph;var a=d.getSelectionCell();var b=this.format.getSelectionState();var c=0;f.style.paddingTop="8px";f.style.paddingBottom="6px";if(d.getSelectionCount()>1){btn=mxUtils.button(mxResources.get("group"),function(g){e.actions.get("group").funct()});btn.setAttribute("title",mxResources.get("group")+" ("+this.editorUi.actions.get("group").shortcut+")");btn.style.width="202px";btn.style.marginBottom="2px";f.appendChild(btn);c++}else{if(d.getSelectionCount()==1&&!d.getModel().isEdge(a)&&!d.isSwimlane(a)&&d.getModel().getChildCount(a)>0){btn=mxUtils.button(mxResources.get("ungroup"),function(g){e.actions.get("ungroup").funct()});btn.setAttribute("title",mxResources.get("ungroup")+" ("+this.editorUi.actions.get("ungroup").shortcut+")");btn.style.width="202px";btn.style.marginBottom="2px";f.appendChild(btn);c++}}if(d.getSelectionCount()==1&&d.getModel().isVertex(a)&&d.getModel().isVertex(d.getModel().getParent(a))){if(c>0){mxUtils.br(f)}btn=mxUtils.button(mxResources.get("removeFromGroup"),function(g){e.actions.get("removeFromGroup").funct()});btn.setAttribute("title",mxResources.get("removeFromGroup"));btn.style.width="202px";btn.style.marginBottom="2px";f.appendChild(btn);c++}else{if(d.getSelectionCount()>0){if(c>0){mxUtils.br(f)}btn=mxUtils.button(mxResources.get("clearWaypoints"),mxUtils.bind(this,function(g){this.editorUi.actions.get("clearWaypoints").funct()}));btn.setAttribute("title",mxResources.get("clearWaypoints")+" ("+this.editorUi.actions.get("clearWaypoints").shortcut+")");btn.style.width="202px";btn.style.marginBottom="2px";f.appendChild(btn);c++}}if(d.getSelectionCount()==1){if(c>0){mxUtils.br(f)}btn=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(g){this.editorUi.actions.get("editData").funct()}));btn.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")");btn.style.width="100px";btn.style.marginBottom="2px";f.appendChild(btn);c++;btn=mxUtils.button(mxResources.get("editLink"),mxUtils.bind(this,function(g){this.editorUi.actions.get("editLink").funct()}));btn.setAttribute("title",mxResources.get("editLink"));btn.style.width="100px";btn.style.marginLeft="2px";btn.style.marginBottom="2px";f.appendChild(btn);c++}if(c==0){f.style.display="none"}return f};ArrangePanel.prototype.addAlign=function(c){var h=this.editorUi.editor.graph;c.style.paddingTop="6px";c.style.paddingBottom="12px";c.appendChild(this.createTitle(mxResources.get("align")));var d=document.createElement("div");d.style.position="relative";d.style.paddingLeft="0px";d.style.borderWidth="0px";d.className="geToolbarContainer";if(mxClient.IS_QUIRKS){c.style.height="60px"}var e=this.editorUi.toolbar.addButton("geSprite-alignleft",mxResources.get("left"),function(){h.alignCells(mxConstants.ALIGN_LEFT)},d);var b=this.editorUi.toolbar.addButton("geSprite-aligncenter",mxResources.get("center"),function(){h.alignCells(mxConstants.ALIGN_CENTER)},d);var g=this.editorUi.toolbar.addButton("geSprite-alignright",mxResources.get("right"),function(){h.alignCells(mxConstants.ALIGN_RIGHT)},d);var f=this.editorUi.toolbar.addButton("geSprite-aligntop",mxResources.get("top"),function(){h.alignCells(mxConstants.ALIGN_TOP)},d);var i=this.editorUi.toolbar.addButton("geSprite-alignmiddle",mxResources.get("middle"),function(){h.alignCells(mxConstants.ALIGN_MIDDLE)},d);var a=this.editorUi.toolbar.addButton("geSprite-alignbottom",mxResources.get("bottom"),function(){h.alignCells(mxConstants.ALIGN_BOTTOM)},d);this.styleButtons([e,b,g,f,i,a]);g.style.marginRight="6px";c.appendChild(d);return c};ArrangePanel.prototype.addFlip=function(f){var e=this.editorUi;var c=e.editor;var d=c.graph;f.style.paddingTop="6px";f.style.paddingBottom="10px";var b=document.createElement("div");b.style.marginTop="2px";b.style.marginBottom="8px";b.style.fontWeight="bold";mxUtils.write(b,mxResources.get("flip"));f.appendChild(b);var a=mxUtils.button(mxResources.get("horizontal"),function(g){d.toggleCellStyles(mxConstants.STYLE_FLIPH,false)});a.setAttribute("title",mxResources.get("horizontal"));a.style.width="100px";a.style.marginRight="2px";f.appendChild(a);var a=mxUtils.button(mxResources.get("vertical"),function(g){d.toggleCellStyles(mxConstants.STYLE_FLIPV,false)});a.setAttribute("title",mxResources.get("vertical"));a.style.width="100px";f.appendChild(a);return f};ArrangePanel.prototype.addDistribute=function(e){var d=this.editorUi;var b=d.editor;var c=b.graph;e.style.paddingTop="6px";e.style.paddingBottom="12px";e.appendChild(this.createTitle(mxResources.get("distribute")));var a=mxUtils.button(mxResources.get("horizontal"),function(f){c.distributeCells(true)});a.setAttribute("title",mxResources.get("horizontal"));a.style.width="100px";a.style.marginRight="2px";e.appendChild(a);var a=mxUtils.button(mxResources.get("vertical"),function(f){c.distributeCells(false)});a.setAttribute("title",mxResources.get("vertical"));a.style.width="100px";e.appendChild(a);return e};ArrangePanel.prototype.addAngle=function(a){var f=this.editorUi;var e=f.editor;var j=e.graph;var k=this.format.getSelectionState();a.style.paddingBottom="8px";var i=document.createElement("div");i.style.position="absolute";i.style.width="70px";i.style.marginTop="0px";i.style.fontWeight="bold";var h=null;var d=null;var b=null;if(k.edges.length==0){mxUtils.write(i,mxResources.get("angle"));a.appendChild(i);h=this.addUnitInput(a,"°",20,44,function(){d.apply(this,arguments)});mxUtils.br(a);a.style.paddingTop="10px"}else{a.style.paddingTop="8px"}if(!k.containsLabel){var g=mxResources.get("reverse");if(k.vertices.length>0&&k.edges.length>0){g=mxResources.get("turn")+" / "+g}else{if(k.vertices.length>0){g=mxResources.get("turn")}}b=mxUtils.button(g,function(l){f.actions.get("turn").funct()});b.setAttribute("title",g+" ("+this.editorUi.actions.get("turn").shortcut+")");b.style.width="202px";a.appendChild(b);if(h!=null){b.style.marginTop="8px"}}if(h!=null){var c=mxUtils.bind(this,function(n,l,o){if(o||document.activeElement!=h){k=this.format.getSelectionState();var m=parseFloat(mxUtils.getValue(k.style,mxConstants.STYLE_ROTATION,0));h.value=(isNaN(m))?"":m+"°"}});d=this.installInputHandler(h,mxConstants.STYLE_ROTATION,0,0,360,"°",null,true);this.addKeyHandler(h,c);j.getModel().addListener(mxEvent.CHANGE,c);this.listeners.push({destroy:function(){j.getModel().removeListener(c)}});c()}return a};ArrangePanel.prototype.addGeometry=function(j){var n=this.editorUi;var d=n.editor.graph;var b=this.format.getSelectionState();var k=this.createPanel();k.style.paddingBottom="8px";var q=document.createElement("div");q.style.position="absolute";q.style.width="50px";q.style.marginTop="0px";q.style.fontWeight="bold";mxUtils.write(q,mxResources.get("size"));k.appendChild(q);var i,o,s,r;var p=this.addUnitInput(k,"pt",84,44,function(){i.apply(this,arguments)});var m=this.addUnitInput(k,"pt",20,44,function(){o.apply(this,arguments)});var g=document.createElement("div");g.className="geSprite geSprite-fit";g.setAttribute("title",mxResources.get("autosize")+" ("+this.editorUi.actions.get("autosize").shortcut+")");g.style.position="relative";g.style.cursor="pointer";g.style.marginTop="-3px";g.style.border="0px";g.style.left="52px";mxUtils.setOpacity(g,50);mxEvent.addListener(g,"mouseenter",function(){mxUtils.setOpacity(g,100)});mxEvent.addListener(g,"mouseleave",function(){mxUtils.setOpacity(g,50)});mxEvent.addListener(g,"click",function(){n.actions.get("autosize").funct()});k.appendChild(g);this.addLabel(k,mxResources.get("width"),84);this.addLabel(k,mxResources.get("height"),20);mxUtils.br(k);var h=document.createElement("div");h.style.paddingTop="8px";h.style.paddingRight="20px";h.style.whiteSpace="nowrap";h.style.textAlign="right";var a=this.createCellOption(mxResources.get("constrainProportions"),mxConstants.STYLE_ASPECT,null,"fixed","null");a.style.width="100%";h.appendChild(a);k.appendChild(h);this.addKeyHandler(p,e);this.addKeyHandler(m,e);i=this.addGeometryHandler(p,function(u,t){if(u.width>0){u.width=Math.max(1,t)}});o=this.addGeometryHandler(m,function(u,t){if(u.height>0){u.height=Math.max(1,t)}});j.appendChild(k);var c=this.createPanel();c.style.paddingBottom="30px";var q=document.createElement("div");q.style.position="absolute";q.style.width="70px";q.style.marginTop="0px";q.style.fontWeight="bold";mxUtils.write(q,mxResources.get("position"));c.appendChild(q);var f=this.addUnitInput(c,"pt",84,44,function(){s.apply(this,arguments)});var l=this.addUnitInput(c,"pt",20,44,function(){r.apply(this,arguments)});mxUtils.br(c);this.addLabel(c,mxResources.get("left"),84);this.addLabel(c,mxResources.get("top"),20);var e=mxUtils.bind(this,function(u,t,v){b=this.format.getSelectionState();if(!b.containsLabel&&b.vertices.length==d.getSelectionCount()&&b.width!=null&&b.height!=null){k.style.display="";if(v||document.activeElement!=p){p.value=b.width+((b.width=="")?"":" pt")}if(v||document.activeElement!=m){m.value=b.height+((b.height=="")?"":" pt")}}else{k.style.display="none"}if(b.vertices.length==d.getSelectionCount()&&b.x!=null&&b.y!=null){c.style.display="";if(v||document.activeElement!=f){f.value=b.x+((b.x=="")?"":" pt")}if(v||document.activeElement!=l){l.value=b.y+((b.y=="")?"":" pt")}}else{c.style.display="none"}});this.addKeyHandler(f,e);this.addKeyHandler(l,e);d.getModel().addListener(mxEvent.CHANGE,e);this.listeners.push({destroy:function(){d.getModel().removeListener(e)}});e();s=this.addGeometryHandler(f,function(u,t){if(u.relative){u.offset.x=t}else{u.x=t}});r=this.addGeometryHandler(l,function(u,t){if(u.relative){u.offset.y=t}else{u.y=t}});j.appendChild(c)};ArrangePanel.prototype.addGeometryHandler=function(b,c){var e=this.editorUi;var d=e.editor.graph;var a=null;function f(g){if(b.value!=""){var k=parseFloat(b.value);if(k!=a){d.getModel().beginUpdate();try{var h=d.getSelectionCells();for(var j=0;j<h.length;j++){if(d.getModel().isVertex(h[j])){var l=d.getCellGeometry(h[j]);if(l!=null){l=l.clone();c(l,k);d.getModel().setGeometry(h[j],l)}}}}finally{d.getModel().endUpdate()}a=k;b.value=k+" pt"}else{if(isNaN(k)){b.value=a+" pt"}}}mxEvent.consume(g)}mxEvent.addListener(b,"blur",f);mxEvent.addListener(b,"change",f);mxEvent.addListener(b,"focus",function(){a=b.value});return f};ArrangePanel.prototype.addEdgeGeometry=function(b){var h=this.editorUi;var k=h.editor.graph;var i=this.format.getSelectionState();var a=this.createPanel();var j=document.createElement("div");j.style.position="absolute";j.style.width="70px";j.style.marginTop="0px";j.style.fontWeight="bold";mxUtils.write(j,mxResources.get("width"));a.appendChild(j);var e,f,g;var c=this.addUnitInput(a,"pt",20,44,function(){e.apply(this,arguments)});mxUtils.br(a);this.addKeyHandler(c,d);function e(l){var m=parseInt(c.value);m=Math.min(999,Math.max(1,(isNaN(m))?1:m));if(m!=mxUtils.getValue(i.style,"width",mxCellRenderer.prototype.defaultShapes.flexArrow.prototype.defaultWidth)){k.setCellStyles("width",m,k.getSelectionCells());h.fireEvent(new mxEventObject("styleChanged","keys",["width"],"values",[m],"cells",k.getSelectionCells()))}c.value=m+" pt";mxEvent.consume(l)}mxEvent.addListener(c,"blur",e);mxEvent.addListener(c,"change",e);b.appendChild(a);var d=mxUtils.bind(this,function(m,l,o){i=this.format.getSelectionState();if(i.style.shape=="link"||i.style.shape=="flexArrow"){a.style.display="";if(o||document.activeElement!=c){var n=mxUtils.getValue(i.style,"width",mxCellRenderer.prototype.defaultShapes.flexArrow.prototype.defaultWidth);c.value=n+" pt"}}else{a.style.display="none"}});k.getModel().addListener(mxEvent.CHANGE,d);this.listeners.push({destroy:function(){k.getModel().removeListener(d)}});d()};TextFormatPanel=function(c,b,a){BaseFormatPanel.call(this,c,b,a);this.init()};mxUtils.extend(TextFormatPanel,BaseFormatPanel);TextFormatPanel.prototype.init=function(){this.container.style.borderBottom="none";this.addFont(this.container)};TextFormatPanel.prototype.addFont=function(af){var J=this.editorUi;var B=J.editor;var al=B.graph;var ag=this.format.getSelectionState();var o=this.createTitle(mxResources.get("font"));o.style.paddingLeft="18px";o.style.paddingTop="10px";o.style.paddingBottom="6px";af.appendChild(o);var h=this.createPanel();h.style.paddingTop="2px";h.style.paddingBottom="2px";h.style.position="relative";h.style.marginLeft="-2px";h.style.borderWidth="0px";h.className="geToolbarContainer";if(mxClient.IS_QUIRKS){h.style.display="block"}if(al.cellEditor.isContentEditing()){var ac=h.cloneNode();var az=this.editorUi.toolbar.addMenu(mxResources.get("style"),mxResources.get("style"),true,"formatBlock",ac);az.style.color="rgb(112, 112, 112)";az.style.whiteSpace="nowrap";az.style.overflow="hidden";az.style.margin="0px";this.addArrow(az);az.style.width="192px";az.style.height="15px";var L=az.getElementsByTagName("div")[0];L.style.cssFloat="right";af.appendChild(ac)}af.appendChild(h);var an=this.createPanel();an.style.marginTop="8px";an.style.borderTop="1px solid #c0c0c0";an.style.paddingTop="6px";an.style.paddingBottom="6px";var G=this.editorUi.toolbar.addMenu("Helvetica",mxResources.get("fontFamily"),true,"fontFamily",h);G.style.color="rgb(112, 112, 112)";G.style.whiteSpace="nowrap";G.style.overflow="hidden";G.style.margin="0px";this.addArrow(G);G.style.width="192px";G.style.height="15px";if(mxClient.IS_FF){G.getElementsByTagName("div")[0].style.marginTop="-18px"}var a=h.cloneNode(false);a.style.marginLeft="-3px";var aA=this.editorUi.toolbar.addItems(["bold","italic","underline"],a,true);aA[0].setAttribute("title",mxResources.get("bold")+" ("+this.editorUi.actions.get("bold").shortcut+")");aA[1].setAttribute("title",mxResources.get("italic")+" ("+this.editorUi.actions.get("italic").shortcut+")");aA[2].setAttribute("title",mxResources.get("underline")+" ("+this.editorUi.actions.get("underline").shortcut+")");var t=this.editorUi.toolbar.addItems(["vertical"],a,true)[0];if(mxClient.IS_QUIRKS){mxUtils.br(af)}af.appendChild(a);this.styleButtons(aA);this.styleButtons([t]);var aE=h.cloneNode(false);aE.style.marginLeft="-3px";aE.style.paddingBottom="0px";var O=this.editorUi.toolbar.addButton("geSprite-left",mxResources.get("left"),(al.cellEditor.isContentEditing())?function(){document.execCommand("justifyleft",false,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT]),aE);var Z=this.editorUi.toolbar.addButton("geSprite-center",mxResources.get("center"),(al.cellEditor.isContentEditing())?function(){document.execCommand("justifycenter",false,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER]),aE);var Q=this.editorUi.toolbar.addButton("geSprite-right",mxResources.get("right"),(al.cellEditor.isContentEditing())?function(){document.execCommand("justifyright",false,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT]),aE);this.styleButtons([O,Z,Q]);if(al.cellEditor.isContentEditing()){var ab=this.editorUi.toolbar.addButton("geSprite-removeformat",mxResources.get("removeFormat"),function(){document.execCommand("removeformat",false,null)},a);this.styleButtons([ab])}var ai=this.editorUi.toolbar.addButton("geSprite-top",mxResources.get("top"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP]),aE);var X=this.editorUi.toolbar.addButton("geSprite-middle",mxResources.get("middle"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE]),aE);var l=this.editorUi.toolbar.addButton("geSprite-bottom",mxResources.get("bottom"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM]),aE);this.styleButtons([ai,X,l]);if(mxClient.IS_QUIRKS){mxUtils.br(af)}af.appendChild(aE);var at,am,au,b,ak,C,p;if(al.cellEditor.isContentEditing()){ai.style.display="none";X.style.display="none";l.style.display="none";t.style.display="none";au=this.editorUi.toolbar.addButton("geSprite-justifyfull",null,function(){document.execCommand("justifyfull",false,null)},aE);this.styleButtons([au,at=this.editorUi.toolbar.addButton("geSprite-subscript",mxResources.get("subscript")+" (Ctrl+,)",function(){document.execCommand("subscript",false,null)},aE),am=this.editorUi.toolbar.addButton("geSprite-superscript",mxResources.get("superscript")+" (Ctrl+.)",function(){document.execCommand("superscript",false,null)},aE)]);au.style.marginRight="9px";var f=aE.cloneNode(false);f.style.paddingTop="4px";var K=[this.editorUi.toolbar.addButton("geSprite-orderedlist",mxResources.get("numberedList"),function(){document.execCommand("insertorderedlist",false,null)},f),this.editorUi.toolbar.addButton("geSprite-unorderedlist",mxResources.get("bulletedList"),function(){document.execCommand("insertunorderedlist",false,null)},f),this.editorUi.toolbar.addButton("geSprite-outdent",mxResources.get("decreaseIndent"),function(){document.execCommand("outdent",false,null)},f),this.editorUi.toolbar.addButton("geSprite-indent",mxResources.get("increaseIndent"),function(){document.execCommand("indent",false,null)},f),this.editorUi.toolbar.addButton("geSprite-code",mxResources.get("html"),function(){al.cellEditor.toggleViewMode()},f)];this.styleButtons(K);K[K.length-1].style.marginLeft="9px";if(mxClient.IS_QUIRKS){mxUtils.br(af);f.style.height="40"}af.appendChild(f)}else{aA[2].style.marginRight="9px";Q.style.marginRight="9px"}var aD=h.cloneNode(false);aD.style.marginLeft="0px";aD.style.paddingTop="8px";aD.style.paddingBottom="4px";aD.style.fontWeight="normal";mxUtils.write(aD,mxResources.get("position"));var Y=document.createElement("select");Y.style.position="absolute";Y.style.right="20px";Y.style.width="97px";Y.style.marginTop="-2px";var V=["topLeft","top","topRight","left","center","right","bottomLeft","bottom","bottomRight"];var q={topLeft:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_TOP,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_BOTTOM],top:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_TOP,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_BOTTOM],topRight:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_TOP,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_BOTTOM],left:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_MIDDLE],center:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE],right:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_MIDDLE],bottomLeft:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_TOP],bottom:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_TOP],bottomRight:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_TOP]};for(var I=0;I<V.length;I++){var g=document.createElement("option");g.setAttribute("value",V[I]);mxUtils.write(g,mxResources.get(V[I]));Y.appendChild(g)}aD.appendChild(Y);var aC=h.cloneNode(false);aC.style.marginLeft="0px";aC.style.paddingTop="4px";aC.style.paddingBottom="4px";aC.style.fontWeight="normal";mxUtils.write(aC,mxResources.get("writingDirection"));var E=document.createElement("select");E.style.position="absolute";E.style.right="20px";E.style.width="97px";E.style.marginTop="-2px";var r=["automatic","leftToRight","rightToLeft"];var n={automatic:null,leftToRight:mxConstants.TEXT_DIRECTION_LTR,rightToLeft:mxConstants.TEXT_DIRECTION_RTL};for(var I=0;I<r.length;I++){var aq=document.createElement("option");aq.setAttribute("value",r[I]);mxUtils.write(aq,mxResources.get(r[I]));E.appendChild(aq)}aC.appendChild(E);if(!al.isEditing()){af.appendChild(aD);mxEvent.addListener(Y,"change",function(i){al.getModel().beginUpdate();try{var aF=q[Y.value];if(aF!=null){al.setCellStyles(mxConstants.STYLE_LABEL_POSITION,aF[0],al.getSelectionCells());al.setCellStyles(mxConstants.STYLE_VERTICAL_LABEL_POSITION,aF[1],al.getSelectionCells());al.setCellStyles(mxConstants.STYLE_ALIGN,aF[2],al.getSelectionCells());al.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,aF[3],al.getSelectionCells())}}finally{al.getModel().endUpdate()}mxEvent.consume(i)});af.appendChild(aC);mxEvent.addListener(E,"change",function(i){al.setCellStyles(mxConstants.STYLE_TEXT_DIRECTION,n[E.value],al.getSelectionCells());mxEvent.consume(i)})}var aB=document.createElement("input");aB.style.textAlign="right";aB.style.marginTop="4px";if(!mxClient.IS_QUIRKS){aB.style.position="absolute";aB.style.right="32px"}aB.style.width="46px";aB.style.height=(mxClient.IS_QUIRKS)?"21px":"17px";a.appendChild(aB);var A=null;var H=this.installInputHandler(aB,mxConstants.STYLE_FONTSIZE,Menus.prototype.defaultFontSize,1,999," pt",function(aH){A=aH;document.execCommand("fontSize",false,"4");var aG=al.cellEditor.textarea.getElementsByTagName("font");for(var aF=0;aF<aG.length;aF++){if(aG[aF].getAttribute("size")=="4"){aG[aF].removeAttribute("size");aG[aF].style.fontSize=A+"px";window.setTimeout(function(){aB.value=A+" pt";A=null},0);break}}},true);var aw=this.createStepper(aB,H,1,10,true,Menus.prototype.defaultFontSize);aw.style.display=aB.style.display;aw.style.marginTop="4px";if(!mxClient.IS_QUIRKS){aw.style.right="20px"}a.appendChild(aw);var L=G.getElementsByTagName("div")[0];L.style.cssFloat="right";var av=null;var aj="#ffffff";var ao=null;var S="#000000";var ae=(al.cellEditor.isContentEditing())?this.createColorOption(mxResources.get("backgroundColor"),function(){return aj},function(i){document.execCommand("backcolor",false,(i!=mxConstants.NONE)?i:"transparent")},"#ffffff",{install:function(i){av=i},destroy:function(){av=null}},null,true):this.createCellColorOption(mxResources.get("backgroundColor"),mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"#ffffff");ae.style.fontWeight="bold";var w=this.createCellColorOption(mxResources.get("borderColor"),mxConstants.STYLE_LABEL_BORDERCOLOR,"#000000");w.style.fontWeight="bold";var c=(al.cellEditor.isContentEditing())?this.createColorOption(mxResources.get("fontColor"),function(){return S},function(i){document.execCommand("forecolor",false,(i!=mxConstants.NONE)?i:"transparent")},"#000000",{install:function(i){ao=i},destroy:function(){ao=null}},null,true):this.createCellColorOption(mxResources.get("fontColor"),mxConstants.STYLE_FONTCOLOR,"#000000",function(i){if(i==null||i==mxConstants.NONE){ae.style.display="none"}else{ae.style.display=""}w.style.display=ae.style.display},function(i){if(i==null||i==mxConstants.NONE){al.setCellStyles(mxConstants.STYLE_NOLABEL,"1",al.getSelectionCells())}else{al.setCellStyles(mxConstants.STYLE_NOLABEL,null,al.getSelectionCells())}});c.style.fontWeight="bold";an.appendChild(c);an.appendChild(ae);if(!al.cellEditor.isContentEditing()){an.appendChild(w)}af.appendChild(an);var U=this.createPanel();U.style.paddingTop="2px";U.style.paddingBottom="4px";var F=this.createCellOption(mxResources.get("wordWrap"),mxConstants.STYLE_WHITE_SPACE,null,"wrap","null",null,null,true);F.style.fontWeight="bold";if(!ag.containsLabel&&!ag.autoSize&&ag.edges.length==0){U.appendChild(F)}var R=this.createCellOption(mxResources.get("formattedText"),"html","0",null,null,null,J.actions.get("formattedText"));R.style.fontWeight="bold";U.appendChild(R);var ap=this.createPanel();ap.style.paddingTop="10px";ap.style.paddingBottom="28px";ap.style.fontWeight="normal";var m=document.createElement("div");m.style.position="absolute";m.style.width="70px";m.style.marginTop="0px";m.style.fontWeight="bold";mxUtils.write(m,mxResources.get("spacing"));ap.appendChild(m);var T,z,ad,aa,e;var ax=this.addUnitInput(ap,"pt",91,44,function(){T.apply(this,arguments)});var s=this.addUnitInput(ap,"pt",20,44,function(){z.apply(this,arguments)});mxUtils.br(ap);this.addLabel(ap,mxResources.get("top"),91);this.addLabel(ap,mxResources.get("global"),20);mxUtils.br(ap);mxUtils.br(ap);var v=this.addUnitInput(ap,"pt",162,44,function(){ad.apply(this,arguments)});var D=this.addUnitInput(ap,"pt",91,44,function(){aa.apply(this,arguments)});var x=this.addUnitInput(ap,"pt",20,44,function(){e.apply(this,arguments)});mxUtils.br(ap);this.addLabel(ap,mxResources.get("left"),162);this.addLabel(ap,mxResources.get("bottom"),91);this.addLabel(ap,mxResources.get("right"),20);if(!al.cellEditor.isContentEditing()){af.appendChild(U);af.appendChild(this.createRelativeOption(mxResources.get("opacity"),mxConstants.STYLE_TEXT_OPACITY));af.appendChild(ap)}else{var N=null;var ar=null;af.appendChild(this.createRelativeOption(mxResources.get("lineheight"),null,null,function(i){var aG=(i.value=="")?120:parseInt(i.value);aG=Math.max(120,(isNaN(aG))?120:aG);if(N!=null){al.cellEditor.restoreSelection(N);N=null}var aH=al.getSelectedElement();var aF=aH;while(aF!=null&&aF.nodeType!=mxConstants.NODETYPE_ELEMENT){aF=aF.parentNode}if(aF!=null&&aF==al.cellEditor.textarea&&al.cellEditor.textarea.firstChild!=null){if(al.cellEditor.textarea.firstChild.nodeName!="FONT"){al.cellEditor.textarea.innerHTML="<font>"+al.cellEditor.textarea.innerHTML+"</font>"}aF=al.cellEditor.textarea.firstChild}if(aF!=null&&aF!=al.cellEditor.textarea){aF.style.lineHeight=aG+"%"}i.value=aG+" %"},function(i){ar=i;mxEvent.addListener(i,"mousedown",function(){N=al.cellEditor.saveSelection()});mxEvent.addListener(i,"touchstart",function(){N=al.cellEditor.saveSelection()});i.value="120 %"}));var P=h.cloneNode(false);P.style.paddingLeft="0px";var u=this.editorUi.toolbar.addItems(["link","image"],P,true);var K=[this.editorUi.toolbar.addButton("geSprite-horizontalrule",mxResources.get("insertHorizontalRule"),function(){document.execCommand("inserthorizontalrule",false,null)},P),this.editorUi.toolbar.addMenuFunctionInContainer(P,"geSprite-table",mxResources.get("table"),false,mxUtils.bind(this,function(i){this.editorUi.menus.addInsertTableItem(i)}))];this.styleButtons(u);this.styleButtons(K);var k=this.createPanel();k.style.paddingTop="10px";k.style.paddingBottom="10px";k.appendChild(this.createTitle(mxResources.get("insert")));k.appendChild(P);af.appendChild(k);if(mxClient.IS_QUIRKS){k.style.height="70"}var d=h.cloneNode(false);d.style.paddingLeft="0px";var K=[this.editorUi.toolbar.addButton("geSprite-insertcolumnbefore",mxResources.get("insertColumnBefore"),function(){try{if(ak!=null){al.selectNode(al.insertColumn(ak,(C!=null)?C.cellIndex:0))}}catch(i){alert(i)}},d),this.editorUi.toolbar.addButton("geSprite-insertcolumnafter",mxResources.get("insertColumnAfter"),function(){try{if(ak!=null){al.selectNode(al.insertColumn(ak,(C!=null)?C.cellIndex+1:-1))}}catch(i){alert(i)}},d),this.editorUi.toolbar.addButton("geSprite-deletecolumn",mxResources.get("deleteColumn"),function(){try{if(ak!=null&&C!=null){al.deleteColumn(ak,C.cellIndex)}}catch(i){alert(i)}},d),this.editorUi.toolbar.addButton("geSprite-insertrowbefore",mxResources.get("insertRowBefore"),function(){try{if(ak!=null&&p!=null){al.selectNode(al.insertRow(ak,p.sectionRowIndex))}}catch(i){alert(i)}},d),this.editorUi.toolbar.addButton("geSprite-insertrowafter",mxResources.get("insertRowAfter"),function(){try{if(ak!=null&&p!=null){al.selectNode(al.insertRow(ak,p.sectionRowIndex+1))}}catch(i){alert(i)}},d),this.editorUi.toolbar.addButton("geSprite-deleterow",mxResources.get("deleteRow"),function(){try{if(ak!=null&&p!=null){al.deleteRow(ak,p.sectionRowIndex)}}catch(i){alert(i)}},d)];this.styleButtons(K);K[2].style.marginRight="9px";var j=this.createPanel();j.style.paddingTop="10px";j.style.paddingBottom="10px";j.appendChild(this.createTitle(mxResources.get("table")));j.appendChild(d);if(mxClient.IS_QUIRKS){mxUtils.br(af);j.style.height="70"}var M=h.cloneNode(false);M.style.paddingLeft="0px";var K=[this.editorUi.toolbar.addButton("geSprite-strokecolor",mxResources.get("borderColor"),mxUtils.bind(this,function(){if(ak!=null){var i=ak.style.borderColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(aG,aF,aI,aH){return"#"+("0"+Number(aF).toString(16)).substr(-2)+("0"+Number(aI).toString(16)).substr(-2)+("0"+Number(aH).toString(16)).substr(-2)});this.editorUi.pickColor(i,function(aF){if(aF==null||aF==mxConstants.NONE){ak.removeAttribute("border");ak.style.border="";ak.style.borderCollapse=""}else{ak.setAttribute("border","1");ak.style.border="1px solid "+aF;ak.style.borderCollapse="collapse"}})}}),M),this.editorUi.toolbar.addButton("geSprite-fillcolor",mxResources.get("backgroundColor"),mxUtils.bind(this,function(){if(ak!=null){var i=ak.style.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(aG,aF,aI,aH){return"#"+("0"+Number(aF).toString(16)).substr(-2)+("0"+Number(aI).toString(16)).substr(-2)+("0"+Number(aH).toString(16)).substr(-2)});this.editorUi.pickColor(i,function(aF){if(aF==null||aF==mxConstants.NONE){ak.style.backgroundColor=""}else{ak.style.backgroundColor=aF}})}}),M),this.editorUi.toolbar.addButton("geSprite-fit",mxResources.get("spacing"),function(){if(ak!=null){var i=ak.getAttribute("cellPadding")||0;var aF=new FilenameDialog(J,i,mxResources.get("apply"),mxUtils.bind(this,function(aG){if(aG!=null&&aG.length>0){ak.setAttribute("cellPadding",aG)}else{ak.removeAttribute("cellPadding")}}),mxResources.get("spacing"));J.showDialog(aF.container,300,80,true,true);aF.init()}},M),this.editorUi.toolbar.addButton("geSprite-left",mxResources.get("left"),function(){if(ak!=null){ak.setAttribute("align","left")}},M),this.editorUi.toolbar.addButton("geSprite-center",mxResources.get("center"),function(){if(ak!=null){ak.setAttribute("align","center")}},M),this.editorUi.toolbar.addButton("geSprite-right",mxResources.get("right"),function(){if(ak!=null){ak.setAttribute("align","right")}},M)];this.styleButtons(K);K[2].style.marginRight="9px";if(mxClient.IS_QUIRKS){mxUtils.br(j);mxUtils.br(j)}j.appendChild(M);af.appendChild(j);b=j}function ah(i,aF){if(mxClient.IS_IE&&(mxClient.IS_QUIRKS||document.documentMode<10)){i.style.filter=(aF)?"progid:DXImageTransform.Microsoft.Gradient(StartColorStr='#c5ecff', EndColorStr='#87d4fb', GradientType=0)":""}else{i.style.backgroundImage=(aF)?"linear-gradient(#c5ecff 0px,#87d4fb 100%)":""}}var ay=mxUtils.bind(this,function(aH,aM,i){ag=this.format.getSelectionState();var aG=mxUtils.getValue(ag.style,mxConstants.STYLE_FONTSTYLE,0);ah(aA[0],(aG&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD);ah(aA[1],(aG&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC);ah(aA[2],(aG&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE);G.firstChild.nodeValue=mxUtils.htmlEntities(mxUtils.getValue(ag.style,mxConstants.STYLE_FONTFAMILY,Menus.prototype.defaultFont));ah(t,mxUtils.getValue(ag.style,mxConstants.STYLE_HORIZONTAL,"1")=="0");if(i||document.activeElement!=aB){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_FONTSIZE,Menus.prototype.defaultFontSize));aB.value=(isNaN(aI))?"":aI+" pt"}var aJ=mxUtils.getValue(ag.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER);ah(O,aJ==mxConstants.ALIGN_LEFT);ah(Z,aJ==mxConstants.ALIGN_CENTER);ah(Q,aJ==mxConstants.ALIGN_RIGHT);var aL=mxUtils.getValue(ag.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE);ah(ai,aL==mxConstants.ALIGN_TOP);ah(X,aL==mxConstants.ALIGN_MIDDLE);ah(l,aL==mxConstants.ALIGN_BOTTOM);var aK=mxUtils.getValue(ag.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);var aN=mxUtils.getValue(ag.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(aK==mxConstants.ALIGN_LEFT&&aN==mxConstants.ALIGN_TOP){Y.value="topLeft"}else{if(aK==mxConstants.ALIGN_CENTER&&aN==mxConstants.ALIGN_TOP){Y.value="top"}else{if(aK==mxConstants.ALIGN_RIGHT&&aN==mxConstants.ALIGN_TOP){Y.value="topRight"}else{if(aK==mxConstants.ALIGN_LEFT&&aN==mxConstants.ALIGN_BOTTOM){Y.value="bottomLeft"}else{if(aK==mxConstants.ALIGN_CENTER&&aN==mxConstants.ALIGN_BOTTOM){Y.value="bottom"}else{if(aK==mxConstants.ALIGN_RIGHT&&aN==mxConstants.ALIGN_BOTTOM){Y.value="bottomRight"}else{if(aK==mxConstants.ALIGN_LEFT){Y.value="left"}else{if(aK==mxConstants.ALIGN_RIGHT){Y.value="right"}else{Y.value="center"}}}}}}}}var aF=mxUtils.getValue(ag.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION);if(aF==mxConstants.TEXT_DIRECTION_RTL){E.value="rightToLeft"}else{if(aF==mxConstants.TEXT_DIRECTION_LTR){E.value="leftToRight"}else{if(aF==mxConstants.TEXT_DIRECTION_AUTO){E.value="automatic"}}}if(i||document.activeElement!=s){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_SPACING,2));s.value=(isNaN(aI))?"":aI+" pt"}if(i||document.activeElement!=ax){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_SPACING_TOP,0));ax.value=(isNaN(aI))?"":aI+" pt"}if(i||document.activeElement!=x){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_SPACING_RIGHT,0));x.value=(isNaN(aI))?"":aI+" pt"}if(i||document.activeElement!=D){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_SPACING_BOTTOM,0));D.value=(isNaN(aI))?"":aI+" pt"}if(i||document.activeElement!=v){var aI=parseFloat(mxUtils.getValue(ag.style,mxConstants.STYLE_SPACING_LEFT,0));v.value=(isNaN(aI))?"":aI+" pt"}});z=this.installInputHandler(s,mxConstants.STYLE_SPACING,2,-999,999," pt");T=this.installInputHandler(ax,mxConstants.STYLE_SPACING_TOP,0,-999,999," pt");e=this.installInputHandler(x,mxConstants.STYLE_SPACING_RIGHT,0,-999,999," pt");aa=this.installInputHandler(D,mxConstants.STYLE_SPACING_BOTTOM,0,-999,999," pt");ad=this.installInputHandler(v,mxConstants.STYLE_SPACING_LEFT,0,-999,999," pt");this.addKeyHandler(aB,ay);this.addKeyHandler(s,ay);this.addKeyHandler(ax,ay);this.addKeyHandler(x,ay);this.addKeyHandler(D,ay);this.addKeyHandler(v,ay);al.getModel().addListener(mxEvent.CHANGE,ay);this.listeners.push({destroy:function(){al.getModel().removeListener(ay)}});ay();if(al.cellEditor.isContentEditing()){var y=false;var W=function(){if(!y){y=true;window.setTimeout(function(){var aL=al.getSelectedElement();var aK=aL;while(aK!=null&&aK.nodeType!=mxConstants.NODETYPE_ELEMENT){aK=aK.parentNode}if(aK!=null){var aJ=mxUtils.getCurrentStyle(aK);if(aJ!=null){ah(aA[0],aJ.fontWeight=="bold"||al.getParentByName(aK,"B",al.cellEditor.textarea)!=null);ah(aA[1],aJ.fontStyle=="italic"||al.getParentByName(aK,"I",al.cellEditor.textarea)!=null);ah(aA[2],al.getParentByName(aK,"U",al.cellEditor.textarea)!=null);ah(O,aJ.textAlign=="left");ah(Z,aJ.textAlign=="center");ah(Q,aJ.textAlign=="right");ah(au,aJ.textAlign=="justify");ah(am,al.getParentByName(aK,"SUP",al.cellEditor.textarea)!=null);ah(at,al.getParentByName(aK,"SUB",al.cellEditor.textarea)!=null);ak=al.getParentByName(aK,"TABLE",al.cellEditor.textarea);p=(ak==null)?null:al.getParentByName(aK,"TR",ak);C=(ak==null)?null:al.getParentByName(aK,"TD",ak);b.style.display=(ak!=null)?"":"none";if(document.activeElement!=aB){if(aK.nodeName=="FONT"&&aK.getAttribute("size")=="4"&&A!=null){aK.removeAttribute("size");aK.style.fontSize=A+"px";A=null}else{aB.value=parseFloat(aJ.fontSize)+" pt"}var aI=aK.style.lineHeight||aJ.lineHeight;var aF=parseFloat(aI);if(aI.substring(aI.length-2)=="px"){aF=aF/parseFloat(aJ.fontSize)}if(aI.substring(aI.length-1)!="%"){aF*=100}ar.value=aF+" %"}var aH=aJ.color.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(aN,aM,aP,aO){return"#"+("0"+Number(aM).toString(16)).substr(-2)+("0"+Number(aP).toString(16)).substr(-2)+("0"+Number(aO).toString(16)).substr(-2)});var i=aJ.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(aN,aM,aP,aO){return"#"+("0"+Number(aM).toString(16)).substr(-2)+("0"+Number(aP).toString(16)).substr(-2)+("0"+Number(aO).toString(16)).substr(-2)});if(ao!=null){if(aH.charAt(0)=="#"){S=aH}else{S="#000000"}ao(S,true)}if(av!=null){if(i.charAt(0)=="#"){aj=i}else{aj=null}av(aj,true)}if(G.firstChild!=null){var aG=aJ.fontFamily;if(aG.charAt(0)=="'"){aG=aG.substring(1)}if(aG.charAt(aG.length-1)=="'"){aG=aG.substring(0,aG.length-1)}G.firstChild.nodeValue=aG}}}y=false},0)}};mxEvent.addListener(al.cellEditor.textarea,"input",W);mxEvent.addListener(al.cellEditor.textarea,"touchend",W);mxEvent.addListener(al.cellEditor.textarea,"mouseup",W);mxEvent.addListener(al.cellEditor.textarea,"keyup",W);this.listeners.push({destroy:function(){}});W()}return af};StyleFormatPanel=function(c,b,a){BaseFormatPanel.call(this,c,b,a);this.init()};mxUtils.extend(StyleFormatPanel,BaseFormatPanel);StyleFormatPanel.prototype.init=function(){var f=this.editorUi;var c=f.editor;var e=c.graph;var b=this.format.getSelectionState();if(!b.containsImage||b.style.shape=="image"){this.container.appendChild(this.addFill(this.createPanel()))}this.container.appendChild(this.addStroke(this.createPanel()));var d=this.createRelativeOption(mxResources.get("opacity"),mxConstants.STYLE_OPACITY,41);d.style.paddingTop="8px";d.style.paddingBottom="8px";this.container.appendChild(d);this.container.appendChild(this.addEffects(this.createPanel()));var a=this.addEditOps(this.createPanel());if(a.firstChild!=null){mxUtils.br(a)}this.container.appendChild(this.addStyleOps(a))};StyleFormatPanel.prototype.addEditOps=function(d){var b=this.format.getSelectionState();var a=null;if(this.editorUi.editor.graph.getSelectionCount()==1){a=mxUtils.button(mxResources.get("editStyle"),mxUtils.bind(this,function(e){this.editorUi.actions.get("editStyle").funct()}));a.setAttribute("title",mxResources.get("editStyle")+" ("+this.editorUi.actions.get("editStyle").shortcut+")");a.style.width="202px";a.style.marginBottom="2px";d.appendChild(a)}if(b.image){var c=mxUtils.button(mxResources.get("editImage"),mxUtils.bind(this,function(e){this.editorUi.actions.get("image").funct()}));c.setAttribute("title",mxResources.get("editImage"));c.style.marginBottom="2px";if(a==null){c.style.width="202px"}else{a.style.width="100px";c.style.width="100px";c.style.marginLeft="2px"}d.appendChild(c)}return d};StyleFormatPanel.prototype.addFill=function(a){var j=this.editorUi;var m=j.editor.graph;var n=this.format.getSelectionState();a.style.paddingTop="6px";a.style.paddingBottom="6px";var e=document.createElement("select");e.style.position="absolute";e.style.marginTop="-2px";e.style.right=(mxClient.IS_QUIRKS)?"52px":"72px";e.style.width="70px";mxEvent.addListener(e,"click",function(i){mxEvent.consume(i)});var g=this.createCellColorOption(mxResources.get("gradient"),mxConstants.STYLE_GRADIENTCOLOR,"#ffffff",function(i){if(i==null||i==mxConstants.NONE){e.style.display="none"}else{e.style.display=""}});var l=(n.style.shape=="image")?mxConstants.STYLE_IMAGE_BACKGROUND:mxConstants.STYLE_FILLCOLOR;var k=this.createCellColorOption(mxResources.get("fill"),l,"#ffffff");k.style.fontWeight="bold";var h=mxUtils.getValue(n.style,l,null);g.style.display=(h!=null&&h!=mxConstants.NONE&&n.fill&&n.style.shape!="image")?"":"none";var f=[mxConstants.DIRECTION_NORTH,mxConstants.DIRECTION_EAST,mxConstants.DIRECTION_SOUTH,mxConstants.DIRECTION_WEST];for(var d=0;d<f.length;d++){var c=document.createElement("option");c.setAttribute("value",f[d]);mxUtils.write(c,mxResources.get(f[d]));e.appendChild(c)}g.appendChild(e);var b=mxUtils.bind(this,function(){n=this.format.getSelectionState();var i=mxUtils.getValue(n.style,mxConstants.STYLE_GRADIENT_DIRECTION,mxConstants.DIRECTION_SOUTH);if(i==""){i=mxConstants.DIRECTION_SOUTH}e.value=i;a.style.display=(n.fill)?"":"none";var o=mxUtils.getValue(n.style,mxConstants.STYLE_FILLCOLOR,null);if(!n.fill||n.containsImage||o==null||o==mxConstants.NONE){g.style.display="none"}else{g.style.display=""}});m.getModel().addListener(mxEvent.CHANGE,b);this.listeners.push({destroy:function(){m.getModel().removeListener(b)}});b();mxEvent.addListener(e,"change",function(i){m.setCellStyles(mxConstants.STYLE_GRADIENT_DIRECTION,e.value,m.getSelectionCells());mxEvent.consume(i)});a.appendChild(k);a.appendChild(g);if(n.style.shape=="swimlane"){a.appendChild(this.createCellColorOption(mxResources.get("laneColor"),"swimlaneFillColor","#ffffff"))}return a};StyleFormatPanel.prototype.addStroke=function(z){var C=this.editorUi;var D=C.editor.graph;var d=this.format.getSelectionState();z.style.paddingTop="4px";z.style.paddingBottom="4px";z.style.whiteSpace="normal";var r=document.createElement("div");r.style.fontWeight="bold";var I=document.createElement("select");I.style.position="absolute";I.style.marginTop="-2px";I.style.right="72px";I.style.width="80px";var v=["sharp","rounded","curved"];for(var M=0;M<v.length;M++){var F=document.createElement("option");F.setAttribute("value",v[M]);mxUtils.write(F,mxResources.get(v[M]));I.appendChild(F)}mxEvent.addListener(I,"change",function(V){D.getModel().beginUpdate();try{var Y=[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED];var W=["0",null];if(I.value=="rounded"){W=["1",null]}else{if(I.value=="curved"){W=[null,"1"]}}for(var X=0;X<Y.length;X++){D.setCellStyles(Y[X],W[X],D.getSelectionCells())}C.fireEvent(new mxEventObject("styleChanged","keys",Y,"values",W,"cells",D.getSelectionCells()))}finally{D.getModel().endUpdate()}mxEvent.consume(V)});mxEvent.addListener(I,"click",function(i){mxEvent.consume(i)});var P=(d.style.shape=="image")?mxConstants.STYLE_IMAGE_BORDER:mxConstants.STYLE_STROKECOLOR;var S=this.createCellColorOption(mxResources.get("line"),P,"#000000");S.appendChild(I);r.appendChild(S);var g=r.cloneNode(false);g.style.fontWeight="normal";g.style.whiteSpace="nowrap";g.style.position="relative";g.style.paddingLeft="16px";g.style.marginBottom="2px";g.style.marginTop="2px";g.className="geToolbarContainer";var Q=mxUtils.bind(this,function(Z,W,aa,Y,i){var X=this.editorUi.menus.styleChange(Z,"",Y,i,"geIcon",null);var V=document.createElement("div");V.style.width=W+"px";V.style.height="1px";V.style.borderBottom="1px "+aa+" black";V.style.paddingTop="6px";X.firstChild.firstChild.style.padding="0px 4px 0px 4px";X.firstChild.firstChild.style.width=W+"px";X.firstChild.firstChild.appendChild(V);return X});var b=this.editorUi.toolbar.addMenuFunctionInContainer(g,"geSprite-orthogonal",mxResources.get("pattern"),false,mxUtils.bind(this,function(i){Q(i,75,"solid",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],[null,null]).setAttribute("title",mxResources.get("solid"));Q(i,75,"dashed",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1",null]).setAttribute("title",mxResources.get("dashed"));Q(i,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 1"]).setAttribute("title",mxResources.get("dotted")+" (1)");Q(i,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 2"]).setAttribute("title",mxResources.get("dotted")+" (2)");Q(i,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 4"]).setAttribute("title",mxResources.get("dotted")+" (3)")}));var q=g.cloneNode(false);var l=this.editorUi.toolbar.addMenuFunctionInContainer(q,"geSprite-connection",mxResources.get("connection"),false,mxUtils.bind(this,function(i){this.editorUi.menus.styleChange(i,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],[null,null,null,null],"geIcon geSprite geSprite-connection",null,true).setAttribute("title",mxResources.get("line"));this.editorUi.menus.styleChange(i,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["link",null,null,null],"geIcon geSprite geSprite-linkedge",null,true).setAttribute("title",mxResources.get("link"));this.editorUi.menus.styleChange(i,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["flexArrow",null,null,null],"geIcon geSprite geSprite-arrow",null,true).setAttribute("title",mxResources.get("arrow"));this.editorUi.menus.styleChange(i,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["arrow",null,null,null],"geIcon geSprite geSprite-simplearrow",null,true).setAttribute("title",mxResources.get("simpleArrow"))}));var h=this.editorUi.toolbar.addMenuFunctionInContainer(q,"geSprite-orthogonal",mxResources.get("pattern"),false,mxUtils.bind(this,function(i){Q(i,33,"solid",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],[null,null]).setAttribute("title",mxResources.get("solid"));Q(i,33,"dashed",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1",null]).setAttribute("title",mxResources.get("dashed"));Q(i,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 1"]).setAttribute("title",mxResources.get("dotted")+" (1)");Q(i,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 2"]).setAttribute("title",mxResources.get("dotted")+" (2)");Q(i,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 4"]).setAttribute("title",mxResources.get("dotted")+" (3)")}));var U=g.cloneNode(false);var a=document.createElement("input");a.style.textAlign="right";a.style.marginTop="2px";a.style.width="41px";a.setAttribute("title",mxResources.get("linewidth"));g.appendChild(a);var u=a.cloneNode(true);q.appendChild(u);function w(i){var V=parseInt(a.value);V=Math.min(999,Math.max(1,(isNaN(V))?1:V));if(V!=mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1)){D.setCellStyles(mxConstants.STYLE_STROKEWIDTH,V,D.getSelectionCells());C.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_STROKEWIDTH],"values",[V],"cells",D.getSelectionCells()))}a.value=V+" pt";mxEvent.consume(i)}function c(i){var V=parseInt(u.value);V=Math.min(999,Math.max(1,(isNaN(V))?1:V));if(V!=mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1)){D.setCellStyles(mxConstants.STYLE_STROKEWIDTH,V,D.getSelectionCells());C.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_STROKEWIDTH],"values",[V],"cells",D.getSelectionCells()))}u.value=V+" pt";mxEvent.consume(i)}var j=this.createStepper(a,w,1,9);j.style.display=a.style.display;j.style.marginTop="2px";g.appendChild(j);var t=this.createStepper(u,c,1,9);t.style.display=u.style.display;t.style.marginTop="2px";q.appendChild(t);if(!mxClient.IS_QUIRKS){a.style.position="absolute";a.style.right="32px";a.style.height="15px";j.style.right="20px";u.style.position="absolute";u.style.right="32px";u.style.height="15px";t.style.right="20px"}else{a.style.height="17px";u.style.height="17px"}mxEvent.addListener(a,"blur",w);mxEvent.addListener(a,"change",w);mxEvent.addListener(u,"blur",c);mxEvent.addListener(u,"change",c);if(mxClient.IS_QUIRKS){mxUtils.br(U);mxUtils.br(U)}var G=this.editorUi.toolbar.addMenuFunctionInContainer(U,"geSprite-orthogonal",mxResources.get("waypoints"),false,mxUtils.bind(this,function(i){if(d.style.shape!="arrow"){this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",null,true).setAttribute("title",mxResources.get("straight"));this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",null,true).setAttribute("title",mxResources.get("orthogonal"));this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",null,true).setAttribute("title",mxResources.get("simple"));this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",null,true).setAttribute("title",mxResources.get("simple"));this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",null,true).setAttribute("title",mxResources.get("isometric"));this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",null,true).setAttribute("title",mxResources.get("isometric"));if(d.style.shape=="connector"){this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",null,true).setAttribute("title",mxResources.get("curved"))}this.editorUi.menus.edgeStyleChange(i,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",null,true).setAttribute("title",mxResources.get("entityRelation"))}}));var O=this.editorUi.toolbar.addMenuFunctionInContainer(U,"geSprite-startclassic",mxResources.get("linestart"),false,mxUtils.bind(this,function(V){if(d.style.shape=="connector"||d.style.shape=="flexArrow"){var i=this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.NONE,0],"geIcon",null,false);i.setAttribute("title",mxResources.get("none"));i.firstChild.firstChild.innerHTML='<font style="font-size:10px;">'+mxUtils.htmlEntities(mxResources.get("none"))+"</font>";if(d.style.shape=="connector"){this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-startclassic",null,false).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC_THIN,1],"geIcon geSprite geSprite-startclassicthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN,0],"geIcon geSprite geSprite-startopen",null,false).setAttribute("title",mxResources.get("openArrow"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN_THIN,0],"geIcon geSprite geSprite-startopenthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["openAsync",0],"geIcon geSprite geSprite-startopenasync",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-startblock",null,false).setAttribute("title",mxResources.get("block"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK_THIN,1],"geIcon geSprite geSprite-startblockthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["async",1],"geIcon geSprite geSprite-startasync",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-startoval",null,false).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-startdiamond",null,false).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-startthindiamond",null,false).setAttribute("title",mxResources.get("diamondThin"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-startclassictrans",null,false).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC_THIN,0],"geIcon geSprite geSprite-startclassicthintrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-startblocktrans",null,false).setAttribute("title",mxResources.get("block"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK_THIN,0],"geIcon geSprite geSprite-startblockthintrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["async",0],"geIcon geSprite geSprite-startasynctrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-startovaltrans",null,false).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-startdiamondtrans",null,false).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-startthindiamondtrans",null,false).setAttribute("title",mxResources.get("diamondThin"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["dash",0],"geIcon geSprite geSprite-startdash",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["cross",0],"geIcon geSprite geSprite-startcross",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["circlePlus",0],"geIcon geSprite geSprite-startcircleplus",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["circle",1],"geIcon geSprite geSprite-startcircle",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERone",0],"geIcon geSprite geSprite-starterone",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERmandOne",0],"geIcon geSprite geSprite-starteronetoone",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERmany",0],"geIcon geSprite geSprite-startermany",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERoneToMany",0],"geIcon geSprite geSprite-starteronetomany",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERzeroToOne",1],"geIcon geSprite geSprite-starteroneopt",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERzeroToMany",1],"geIcon geSprite geSprite-startermanyopt",null,false)}else{this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_BLOCK],"geIcon geSprite geSprite-startblocktrans",null,false).setAttribute("title",mxResources.get("block"))}}}));var N=this.editorUi.toolbar.addMenuFunctionInContainer(U,"geSprite-endclassic",mxResources.get("lineend"),false,mxUtils.bind(this,function(V){if(d.style.shape=="connector"||d.style.shape=="flexArrow"){var i=this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.NONE,0],"geIcon",null,false);i.setAttribute("title",mxResources.get("none"));i.firstChild.firstChild.innerHTML='<font style="font-size:10px;">'+mxUtils.htmlEntities(mxResources.get("none"))+"</font>";if(d.style.shape=="connector"){this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-endclassic",null,false).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC_THIN,1],"geIcon geSprite geSprite-endclassicthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN,0],"geIcon geSprite geSprite-endopen",null,false).setAttribute("title",mxResources.get("openArrow"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN_THIN,0],"geIcon geSprite geSprite-endopenthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["openAsync",0],"geIcon geSprite geSprite-endopenasync",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-endblock",null,false).setAttribute("title",mxResources.get("block"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK_THIN,1],"geIcon geSprite geSprite-endblockthin",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["async",1],"geIcon geSprite geSprite-endasync",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-endoval",null,false).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-enddiamond",null,false).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-endthindiamond",null,false).setAttribute("title",mxResources.get("diamondThin"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-endclassictrans",null,false).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC_THIN,0],"geIcon geSprite geSprite-endclassicthintrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-endblocktrans",null,false).setAttribute("title",mxResources.get("block"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK_THIN,0],"geIcon geSprite geSprite-endblockthintrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["async",0],"geIcon geSprite geSprite-endasynctrans",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-endovaltrans",null,false).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-enddiamondtrans",null,false).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-endthindiamondtrans",null,false).setAttribute("title",mxResources.get("diamondThin"));this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["dash",0],"geIcon geSprite geSprite-enddash",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["cross",0],"geIcon geSprite geSprite-endcross",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["circlePlus",0],"geIcon geSprite geSprite-endcircleplus",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["circle",1],"geIcon geSprite geSprite-endcircle",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERone",0],"geIcon geSprite geSprite-enderone",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERmandOne",0],"geIcon geSprite geSprite-enderonetoone",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERmany",0],"geIcon geSprite geSprite-endermany",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERoneToMany",0],"geIcon geSprite geSprite-enderonetomany",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERzeroToOne",1],"geIcon geSprite geSprite-enderoneopt",null,false);this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERzeroToMany",1],"geIcon geSprite geSprite-endermanyopt",null,false)}else{this.editorUi.menus.edgeStyleChange(V,"",[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_BLOCK],"geIcon geSprite geSprite-endblocktrans",null,false).setAttribute("title",mxResources.get("block"))}}}));this.addArrow(l,8);this.addArrow(G);this.addArrow(O);this.addArrow(N);var f=this.addArrow(b,9);f.className="geIcon";f.style.width="84px";var H=this.addArrow(h,9);H.className="geIcon";H.style.width="22px";var e=document.createElement("div");e.style.width="85px";e.style.height="1px";e.style.borderBottom="1px solid black";e.style.marginBottom="9px";f.appendChild(e);var E=document.createElement("div");E.style.width="23px";E.style.height="1px";E.style.borderBottom="1px solid black";E.style.marginBottom="9px";H.appendChild(E);b.style.height="15px";h.style.height="15px";l.style.height="15px";G.style.height="17px";O.style.marginLeft="3px";O.style.height="17px";N.style.marginLeft="3px";N.style.height="17px";z.appendChild(r);z.appendChild(q);z.appendChild(g);var o=g.cloneNode(false);o.style.paddingBottom="6px";o.style.paddingTop="4px";o.style.fontWeight="normal";var m=document.createElement("div");m.style.position="absolute";m.style.marginLeft="3px";m.style.marginBottom="12px";m.style.marginTop="2px";m.style.fontWeight="normal";m.style.width="76px";mxUtils.write(m,mxResources.get("lineend"));o.appendChild(m);var n,x;var y=this.addUnitInput(o,"pt",74,33,function(){n.apply(this,arguments)});var B=this.addUnitInput(o,"pt",20,33,function(){x.apply(this,arguments)});mxUtils.br(o);var L=document.createElement("div");L.style.height="8px";o.appendChild(L);m=m.cloneNode(false);mxUtils.write(m,mxResources.get("linestart"));o.appendChild(m);var s,K;var k=this.addUnitInput(o,"pt",74,33,function(){s.apply(this,arguments)});var p=this.addUnitInput(o,"pt",20,33,function(){K.apply(this,arguments)});mxUtils.br(o);this.addLabel(o,mxResources.get("spacing"),74,50);this.addLabel(o,mxResources.get("size"),20,50);mxUtils.br(o);var A=r.cloneNode(false);A.style.fontWeight="normal";A.style.position="relative";A.style.paddingLeft="16px";A.style.marginBottom="2px";A.style.marginTop="6px";A.style.borderWidth="0px";A.style.paddingBottom="18px";var m=document.createElement("div");m.style.position="absolute";m.style.marginLeft="3px";m.style.marginBottom="12px";m.style.marginTop="1px";m.style.fontWeight="normal";m.style.width="120px";mxUtils.write(m,mxResources.get("perimeter"));A.appendChild(m);var R;var T=this.addUnitInput(A,"pt",20,41,function(){R.apply(this,arguments)});if(d.edges.length==D.getSelectionCount()){z.appendChild(U);if(mxClient.IS_QUIRKS){mxUtils.br(z);mxUtils.br(z)}z.appendChild(o)}else{if(d.vertices.length==D.getSelectionCount()){if(mxClient.IS_QUIRKS){mxUtils.br(z)}z.appendChild(A)}}var J=mxUtils.bind(this,function(X,ae,i){d=this.format.getSelectionState();var W=mxUtils.getValue(d.style,P,null);if(i||document.activeElement!=a){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1));a.value=(isNaN(Y))?"":Y+" pt"}if(i||document.activeElement!=u){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_STROKEWIDTH,1));u.value=(isNaN(Y))?"":Y+" pt"}I.style.visibility=(d.style.shape=="connector")?"":"hidden";if(mxUtils.getValue(d.style,mxConstants.STYLE_CURVED,null)=="1"){I.value="curved"}else{if(mxUtils.getValue(d.style,mxConstants.STYLE_ROUNDED,null)=="1"){I.value="rounded"}}if(mxUtils.getValue(d.style,mxConstants.STYLE_DASHED,null)=="1"){if(mxUtils.getValue(d.style,mxConstants.STYLE_DASH_PATTERN,null)==null){e.style.borderBottom="1px dashed black"}else{e.style.borderBottom="1px dotted black"}}else{e.style.borderBottom="1px solid black"}E.style.borderBottom=e.style.borderBottom;var ac=G.getElementsByTagName("div")[0];var ad=mxUtils.getValue(d.style,mxConstants.STYLE_EDGE,null);if(mxUtils.getValue(d.style,mxConstants.STYLE_NOEDGESTYLE,null)=="1"){ad=null}if(ad=="orthogonalEdgeStyle"&&mxUtils.getValue(d.style,mxConstants.STYLE_CURVED,null)=="1"){ac.className="geSprite geSprite-curved"}else{if(ad=="straight"||ad=="none"||ad==null){ac.className="geSprite geSprite-straight"}else{if(ad=="entityRelationEdgeStyle"){ac.className="geSprite geSprite-entity"}else{if(ad=="elbowEdgeStyle"){ac.className="geSprite "+((mxUtils.getValue(d.style,mxConstants.STYLE_ELBOW,null)=="vertical")?"geSprite-verticalelbow":"geSprite-horizontalelbow")}else{if(ad=="isometricEdgeStyle"){ac.className="geSprite "+((mxUtils.getValue(d.style,mxConstants.STYLE_ELBOW,null)=="vertical")?"geSprite-verticalisometric":"geSprite-horizontalisometric")}else{ac.className="geSprite geSprite-orthogonal"}}}}}var aa=l.getElementsByTagName("div")[0];if(d.style.shape=="link"){aa.className="geSprite geSprite-linkedge"}else{if(d.style.shape=="flexArrow"){aa.className="geSprite geSprite-arrow"}else{if(d.style.shape=="arrow"){aa.className="geSprite geSprite-simplearrow"}else{aa.className="geSprite geSprite-connection"}}}if(d.edges.length==D.getSelectionCount()){q.style.display="";g.style.display="none"}else{q.style.display="none";g.style.display=""}function ab(af,aj,ah,ai){var ag=ah.getElementsByTagName("div")[0];ag.className=C.getCssClassForMarker(ai,d.style.shape,af,aj);if(ag.className=="geSprite geSprite-noarrow"){ag.innerHTML=mxUtils.htmlEntities(mxResources.get("none"));ag.style.backgroundImage="none";ag.style.verticalAlign="top";ag.style.marginTop="5px";ag.style.fontSize="10px";ag.nextSibling.style.marginTop="0px"}return ag}var Z=ab(mxUtils.getValue(d.style,mxConstants.STYLE_STARTARROW,null),mxUtils.getValue(d.style,"startFill","1"),O,"start");var V=ab(mxUtils.getValue(d.style,mxConstants.STYLE_ENDARROW,null),mxUtils.getValue(d.style,"endFill","1"),N,"end");if(d.style.shape=="arrow"){Z.className="geSprite geSprite-noarrow";V.className="geSprite geSprite-endblocktrans"}else{if(d.style.shape=="link"){Z.className="geSprite geSprite-noarrow";V.className="geSprite geSprite-noarrow"}}mxUtils.setOpacity(G,(d.style.shape=="arrow")?30:100);if(d.style.shape!="connector"&&d.style.shape!="flexArrow"){mxUtils.setOpacity(O,30);mxUtils.setOpacity(N,30)}else{mxUtils.setOpacity(O,100);mxUtils.setOpacity(N,100)}if(i||document.activeElement!=p){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE));p.value=(isNaN(Y))?"":Y+" pt"}if(i||document.activeElement!=k){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_SOURCE_PERIMETER_SPACING,0));k.value=(isNaN(Y))?"":Y+" pt"}if(i||document.activeElement!=B){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE));B.value=(isNaN(Y))?"":Y+" pt"}if(i||document.activeElement!=k){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_TARGET_PERIMETER_SPACING,0));y.value=(isNaN(Y))?"":Y+" pt"}if(i||document.activeElement!=T){var Y=parseInt(mxUtils.getValue(d.style,mxConstants.STYLE_PERIMETER_SPACING,0));T.value=(isNaN(Y))?"":Y+" pt"}});K=this.installInputHandler(p,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE,0,999," pt");s=this.installInputHandler(k,mxConstants.STYLE_SOURCE_PERIMETER_SPACING,0,-999,999," pt");x=this.installInputHandler(B,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE,0,999," pt");n=this.installInputHandler(y,mxConstants.STYLE_TARGET_PERIMETER_SPACING,0,-999,999," pt");R=this.installInputHandler(T,mxConstants.STYLE_PERIMETER_SPACING,0,0,999," pt");this.addKeyHandler(a,J);this.addKeyHandler(p,J);this.addKeyHandler(k,J);this.addKeyHandler(B,J);this.addKeyHandler(y,J);this.addKeyHandler(T,J);D.getModel().addListener(mxEvent.CHANGE,J);this.listeners.push({destroy:function(){D.getModel().removeListener(J)}});J();return z};StyleFormatPanel.prototype.addEffects=function(a){var h=this.editorUi;var f=h.editor;var k=f.graph;var n=this.format.getSelectionState();a.style.paddingTop="0px";a.style.paddingBottom="2px";var l=document.createElement("table");if(mxClient.IS_QUIRKS){l.style.fontSize="1em"}l.style.width="100%";l.style.fontWeight="bold";l.style.paddingRight="20px";var d=document.createElement("tbody");var m=document.createElement("tr");m.style.padding="0px";var c=document.createElement("td");c.style.padding="0px";c.style.width="50%";c.setAttribute("valign","top");var j=c.cloneNode(true);j.style.paddingLeft="8px";m.appendChild(c);m.appendChild(j);d.appendChild(m);l.appendChild(d);a.appendChild(l);var g=c;var e=0;var i=mxUtils.bind(this,function(p,r,o){var q=this.createCellOption(p,r,o);q.style.width="100%";g.appendChild(q);g=(g==c)?j:c;e++});var b=mxUtils.bind(this,function(p,o,q){n=this.format.getSelectionState();c.innerHTML="";j.innerHTML="";g=c;if(n.rounded){i(mxResources.get("rounded"),mxConstants.STYLE_ROUNDED,0)}if(n.style.shape=="swimlane"){i(mxResources.get("divider"),"swimlaneLine",1)}if(!n.containsImage){i(mxResources.get("shadow"),mxConstants.STYLE_SHADOW,0)}if(n.glass){i(mxResources.get("glass"),mxConstants.STYLE_GLASS,0)}if(n.comic){i(mxResources.get("comic"),"comic",0)}if(e==0){a.style.display="none"}});k.getModel().addListener(mxEvent.CHANGE,b);this.listeners.push({destroy:function(){k.getModel().removeListener(b)}});b();return a};StyleFormatPanel.prototype.addStyleOps=function(b){b.style.paddingTop="10px";b.style.paddingBottom="10px";var a=mxUtils.button(mxResources.get("setAsDefaultStyle"),mxUtils.bind(this,function(c){this.editorUi.actions.get("setAsDefaultStyle").funct()}));a.setAttribute("title",mxResources.get("setAsDefaultStyle")+" ("+this.editorUi.actions.get("setAsDefaultStyle").shortcut+")");a.style.width="202px";b.appendChild(a);return b};DiagramFormatPanel=function(c,b,a){BaseFormatPanel.call(this,c,b,a);this.init()};mxUtils.extend(DiagramFormatPanel,BaseFormatPanel);DiagramFormatPanel.prototype.showBackgroundImageOption=true;DiagramFormatPanel.prototype.init=function(){var c=this.editorUi;var a=c.editor;var b=a.graph;this.container.appendChild(this.addView(this.createPanel()));if(b.isEnabled()){this.container.appendChild(this.addOptions(this.createPanel()));this.container.appendChild(this.addPaperSize(this.createPanel()));this.container.appendChild(this.addStyleOps(this.createPanel()))}};DiagramFormatPanel.prototype.addView=function(f){var e=this.editorUi;var c=e.editor;var d=c.graph;f.appendChild(this.createTitle(mxResources.get("view")));this.addGridOption(f);if(d.isEnabled()){f.appendChild(this.createOption(mxResources.get("guides"),function(){return d.graphHandler.guidesEnabled},function(g){e.actions.get("guides").funct()},{install:function(g){this.listener=function(){g(d.graphHandler.guidesEnabled)};e.addListener("guidesEnabledChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}}));f.appendChild(this.createOption(mxResources.get("pageView"),function(){return d.pageVisible},function(g){e.actions.get("pageView").funct()},{install:function(g){this.listener=function(){g(d.pageVisible)};e.addListener("pageViewChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}}));var b=this.createColorOption(mxResources.get("background"),function(){return d.background},function(g){e.setBackgroundColor(g)},"#ffffff",{install:function(g){this.listener=function(){g(d.background)};e.addListener("backgroundColorChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}});if(this.showBackgroundImageOption){var a=mxUtils.button(mxResources.get("image"),function(g){e.showBackgroundImageDialog();mxEvent.consume(g)});a.style.position="absolute";a.className="geColorBtn";a.style.marginTop="-4px";a.style.paddingBottom=(document.documentMode==11||mxClient.IS_MT)?"0px":"2px";a.style.height="22px";a.style.right=(mxClient.IS_QUIRKS)?"52px":"72px";a.style.width="56px";b.appendChild(a)}f.appendChild(b)}return f};DiagramFormatPanel.prototype.addOptions=function(d){var c=this.editorUi;var a=c.editor;var b=a.graph;d.appendChild(this.createTitle(mxResources.get("options")));if(b.isEnabled()){d.appendChild(this.createOption(mxResources.get("connectionArrows"),function(){return b.connectionArrowsEnabled},function(e){c.actions.get("connectionArrows").funct()},{install:function(e){this.listener=function(){e(b.connectionArrowsEnabled)};c.addListener("connectionArrowsChanged",this.listener)},destroy:function(){c.removeListener(this.listener)}}));d.appendChild(this.createOption(mxResources.get("connectionPoints"),function(){return b.connectionHandler.isEnabled()},function(e){c.actions.get("connectionPoints").funct()},{install:function(e){this.listener=function(){e(b.connectionHandler.isEnabled())};c.addListener("connectionPointsChanged",this.listener)},destroy:function(){c.removeListener(this.listener)}}))}return d};DiagramFormatPanel.prototype.addGridOption=function(c){var f=this.editorUi;var e=f.editor.graph;var d=document.createElement("input");d.style.position="absolute";d.style.textAlign="right";d.style.width="38px";d.value=e.getGridSize()+" pt";var a=this.createStepper(d,g);d.style.display=(e.isGridEnabled())?"":"none";a.style.display=d.style.display;mxEvent.addListener(d,"keydown",function(h){if(h.keyCode==13){e.container.focus();mxEvent.consume(h)}else{if(h.keyCode==27){d.value=e.getGridSize();e.container.focus();mxEvent.consume(h)}}});function g(h){var i=parseInt(d.value);i=Math.max(1,(isNaN(i))?10:i);if(i!=e.getGridSize()){e.setGridSize(i)}d.value=i+" pt";mxEvent.consume(h)}mxEvent.addListener(d,"blur",g);mxEvent.addListener(d,"change",g);if(mxClient.IS_SVG){d.style.marginTop="-2px";d.style.right="84px";a.style.marginTop="-16px";a.style.right="72px";var b=this.createColorOption(mxResources.get("grid"),function(){var h=e.view.gridColor;return(e.isGridEnabled())?h:null},function(h){if(h==mxConstants.NONE){e.setGridEnabled(false);f.fireEvent(new mxEventObject("gridEnabledChanged"))}else{e.setGridEnabled(true);f.setGridColor(h)}d.style.display=(e.isGridEnabled())?"":"none";a.style.display=d.style.display},"#e0e0e0",{install:function(h){this.listener=function(){h((e.isGridEnabled())?e.view.gridColor:null)};f.addListener("gridColorChanged",this.listener);f.addListener("gridEnabledChanged",this.listener)},destroy:function(){f.removeListener(this.listener)}});b.appendChild(d);b.appendChild(a);c.appendChild(b)}else{d.style.marginTop="2px";d.style.right="32px";a.style.marginTop="2px";a.style.right="20px";c.appendChild(d);c.appendChild(a);c.appendChild(this.createOption(mxResources.get("grid"),function(){return e.isGridEnabled()},function(h){e.setGridEnabled(h);if(e.isGridEnabled()){e.view.gridColor="#e0e0e0"}f.fireEvent(new mxEventObject("gridEnabledChanged"))},{install:function(h){this.listener=function(){d.style.display=(e.isGridEnabled())?"":"none";a.style.display=d.style.display;h(e.isGridEnabled())};f.addListener("gridEnabledChanged",this.listener)},destroy:function(){f.removeListener(this.listener)}}))}};DiagramFormatPanel.prototype.addDocumentProperties=function(d){var c=this.editorUi;var a=c.editor;var b=a.graph;d.appendChild(this.createTitle(mxResources.get("options")));return d};DiagramFormatPanel.prototype.addPaperSize=function(f){var e=this.editorUi;var b=e.editor;var d=b.graph;f.appendChild(this.createTitle(mxResources.get("paperSize")));var a=PageSetupDialog.addPageFormatPanel(f,"formatpanel",d.pageFormat,function(g){if(d.pageFormat==null||d.pageFormat.width!=g.width||d.pageFormat.height!=g.height){e.setPageFormat(g)}});this.addKeyHandler(a.widthInput,function(){console.log("here",d.pageFormat);a.set(d.pageFormat)});-this.addKeyHandler(a.heightInput,function(){a.set(d.pageFormat)});var c=function(){a.set(d.pageFormat)};e.addListener("pageFormatChanged",c);this.listeners.push({destroy:function(){e.removeListener(c)}});d.getModel().addListener(mxEvent.CHANGE,c);this.listeners.push({destroy:function(){d.getModel().removeListener(c)}});return f};DiagramFormatPanel.prototype.addStyleOps=function(b){var a=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(c){this.editorUi.actions.get("editData").funct()}));a.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")");a.style.width="202px";a.style.marginBottom="2px";b.appendChild(a);mxUtils.br(b);a=mxUtils.button(mxResources.get("clearDefaultStyle"),mxUtils.bind(this,function(c){this.editorUi.actions.get("clearDefaultStyle").funct()}));a.setAttribute("title",mxResources.get("clearDefaultStyle")+" ("+this.editorUi.actions.get("clearDefaultStyle").shortcut+")");a.style.width="202px";b.appendChild(a);return b};DiagramFormatPanel.prototype.destroy=function(){BaseFormatPanel.prototype.destroy.apply(this,arguments);if(this.gridEnabledListener){this.editorUi.removeListener(this.gridEnabledListener);this.gridEnabledListener=null}};if(typeof html4!=="undefined"){html4.ATTRIBS["a::target"]=0}mxConstants.SHADOW_OPACITY=0.25;mxConstants.SHADOWCOLOR="#000000";mxConstants.VML_SHADOWCOLOR="#d0d0d0";mxGraph.prototype.pageBreakColor="#c0c0c0";mxGraph.prototype.pageScale=1;(function(){try{if(navigator!=null&&navigator.language!=null){var b=navigator.language.toLowerCase();mxGraph.prototype.pageFormat=(b==="en-us"||b==="en-ca"||b==="es-mx")?mxConstants.PAGE_FORMAT_LETTER_PORTRAIT:mxConstants.PAGE_FORMAT_A4_PORTRAIT}}catch(a){}})();mxText.prototype.baseSpacingTop=5;mxText.prototype.baseSpacingBottom=1;mxGraphModel.prototype.ignoreRelativeEdgeParent=false;mxGraphView.prototype.gridImage=(mxClient.IS_SVG)?"data:image/gif;base64,R0lGODlhCgAKAJEAAAAAAP///8zMzP///yH5BAEAAAMALAAAAAAKAAoAAAIJ1I6py+0Po2wFADs=":IMAGE_PATH+"/grid.gif";mxGraphView.prototype.gridSteps=4;mxGraphView.prototype.minGridSize=4;mxGraphView.prototype.gridColor="#e0e0e0";mxSvgCanvas2D.prototype.foAltText="[Not supported by viewer]";Graph=function(n,k,i,v,t){mxGraph.call(this,n,k,i,v);this.themes=t||this.defaultThemes;var x=this.baseUrl;var r=x.indexOf("//");this.domainUrl="";this.domainPathUrl="";if(r>0){var w=x.indexOf("/",r+2);if(w>0){this.domainUrl=x.substring(0,w)}w=x.lastIndexOf("/");if(w>0){this.domainPathUrl=x.substring(0,w+1)}}this.isHtmlLabel=function(b){var p=this.view.getState(b);var d=(p!=null)?p.style:this.getCellStyle(b);return d.html=="1"||d[mxConstants.STYLE_WHITE_SPACE]=="wrap"};if(this.edgeMode){var l={point:null,event:null,state:null,handle:null,selected:false};this.addListener(mxEvent.FIRE_MOUSE_EVENT,mxUtils.bind(this,function(d,b){if(b.getProperty("eventName")=="mouseDown"&&this.isEnabled()){var B=b.getProperty("event");if(!mxEvent.isControlDown(B.getEvent())&&!mxEvent.isShiftDown(B.getEvent())){var C=B.getState();if(C!=null){if(this.model.isEdge(C.cell)){l.point=new mxPoint(B.getGraphX(),B.getGraphY());l.selected=this.isCellSelected(C.cell);l.state=C;l.event=B;if(C.text!=null&&C.text.boundingBox!=null&&mxUtils.contains(C.text.boundingBox,B.getGraphX(),B.getGraphY())){l.handle=mxEvent.LABEL_HANDLE}else{var p=this.selectionCellsHandler.getHandler(C.cell);if(p!=null&&p.bends!=null&&p.bends.length>0){l.handle=p.getHandleForEvent(B)}}}}}}}));var z=null;this.addMouseListener({mouseDown:function(b,d){},mouseMove:mxUtils.bind(this,function(B,F){if(this.isEnabled()&&!this.panningHandler.isActive()&&!mxEvent.isControlDown(F.getEvent())&&!mxEvent.isShiftDown(F.getEvent())&&!mxEvent.isAltDown(F.getEvent())){var J=this.tolerance;if(l.point!=null&&l.state!=null&&l.event!=null){var b=l.state;if(Math.abs(l.point.x-F.getGraphX())>J*this.view.scale||Math.abs(l.point.y-F.getGraphY())>J*this.view.scale){if(!this.isCellSelected(b.cell)){this.setSelectionCell(b.cell)}var K=this.selectionCellsHandler.getHandler(b.cell);if(K!=null&&K.bends!=null&&K.bends.length>0){var E=K.getHandleForEvent(l.event);var D=this.view.getEdgeStyle(b);var d=D==mxEdgeStyle.EntityRelation;if(!l.selected&&l.handle==mxEvent.LABEL_HANDLE){E=l.handle}if(!d||E==0||E==K.bends.length-1||E==mxEvent.LABEL_HANDLE){if(E==mxEvent.LABEL_HANDLE||E==0||b.visibleSourceState!=null||E==K.bends.length-1||b.visibleTargetState!=null){if(!d&&E!=mxEvent.LABEL_HANDLE){var L=b.absolutePoints;if(L!=null&&((D==null&&E==null)||D==mxEdgeStyle.OrthConnector)){E=l.handle;if(E==null){var C=new mxRectangle(l.point.x,l.point.y);C.grow(mxEdgeHandler.prototype.handleImage.width/2);if(mxUtils.contains(C,L[0].x,L[0].y)){E=0}else{if(mxUtils.contains(C,L[L.length-1].x,L[L.length-1].y)){E=K.bends.length-1}else{var H=D!=null&&(L.length==2||(L.length==3&&((Math.round(L[0].x-L[1].x)==0&&Math.round(L[1].x-L[2].x)==0)||(Math.round(L[0].y-L[1].y)==0&&Math.round(L[1].y-L[2].y)==0))));if(H){E=2}else{E=mxUtils.findNearestSegment(b,l.point.x,l.point.y);if(D==null){E=mxEvent.VIRTUAL_HANDLE-E}else{E+=1}}}}}}if(E==null){E=mxEvent.VIRTUAL_HANDLE}}K.start(F.getGraphX(),F.getGraphX(),E);l.state=null;l.event=null;l.point=null;l.handle=null;l.selected=false;F.consume();this.graphHandler.reset()}}else{if(d&&(b.visibleSourceState!=null||b.visibleTargetState!=null)){this.graphHandler.reset();F.consume()}}}}}else{var b=F.getState();if(b!=null){if(this.model.isEdge(b.cell)){var I=null;var L=b.absolutePoints;if(L!=null){var C=new mxRectangle(F.getGraphX(),F.getGraphY());C.grow(mxEdgeHandler.prototype.handleImage.width/2);if(b.text!=null&&b.text.boundingBox!=null&&mxUtils.contains(b.text.boundingBox,F.getGraphX(),F.getGraphY())){I="move"}else{if(mxUtils.contains(C,L[0].x,L[0].y)||mxUtils.contains(C,L[L.length-1].x,L[L.length-1].y)){I="pointer"}else{if(b.visibleSourceState!=null||b.visibleTargetState!=null){var p=this.view.getEdgeStyle(b);I="crosshair";if(p!=mxEdgeStyle.EntityRelation&&this.isOrthogonal(b)){var G=mxUtils.findNearestSegment(b,F.getGraphX(),F.getGraphY());if(G<L.length-1&&G>=0){I=(Math.round(L[G].x-L[G+1].x)==0)?"col-resize":"row-resize"}}}}}}if(I!=null){b.setCursor(I)}}}}}}),mouseUp:mxUtils.bind(this,function(b,d){l.state=null;l.event=null;l.point=null;l.handle=null})})}this.cellRenderer.getLabelValue=function(d){var b=mxCellRenderer.prototype.getLabelValue.apply(this,arguments);if(d.view.graph.isHtmlLabel(d.cell)){if(d.style.html!=1){b=mxUtils.htmlEntities(b,false)}else{b=d.view.graph.sanitizeHtml(b)}}return b};if(typeof mxVertexHandler!=="undefined"){this.setConnectable(true);this.setDropEnabled(true);this.setPanning(true);this.setTooltips(true);this.setAllowLoops(true);this.allowAutoPanning=true;this.resetEdgesOnConnect=false;this.constrainChildren=false;this.constrainRelativeChildren=true;this.graphHandler.scrollOnMove=false;this.graphHandler.scaleGrid=true;this.connectionHandler.setCreateTarget(false);this.connectionHandler.insertBeforeSource=true;this.connectionHandler.isValidSource=function(b,d){return false};this.alternateEdgeStyle="vertical";if(v==null){this.loadStylesheet()}var q=this.graphHandler.getGuideStates;this.graphHandler.getGuideStates=function(){var I=q.apply(this,arguments);if(this.graph.pageVisible){var E=[];var D=this.graph.pageFormat;var b=this.graph.pageScale;var F=D.width*b;var C=D.height*b;var G=this.graph.view.translate;var H=this.graph.view.scale;var B=this.graph.getPageLayout();for(var p=0;p<B.width;p++){E.push(new mxRectangle(((B.x+p)*F+G.x)*H,(B.y*C+G.y)*H,F*H,C*H))}for(var d=0;d<B.height;d++){E.push(new mxRectangle((B.x*F+G.x)*H,((B.y+d)*C+G.y)*H,F*H,C*H))}I=E.concat(I)}return I};mxDragSource.prototype.dragElementZIndex=mxPopupMenu.prototype.zIndex;mxGuide.prototype.getGuideColor=function(d,b){return(d.cell==null)?"#ffa500":mxConstants.GUIDE_COLOR};this.graphHandler.createPreviewShape=function(b){this.previewColor=(this.graph.background=="#000000")?"#ffffff":mxGraphHandler.prototype.previewColor;return mxGraphHandler.prototype.createPreviewShape.apply(this,arguments)};this.graphHandler.getCells=function(B){var b=mxGraphHandler.prototype.getCells.apply(this,arguments);var p=[];for(var d=0;d<b.length;d++){var E=this.graph.view.getState(b[d]);var D=(E!=null)?E.style:this.graph.getCellStyle(b[d]);if(mxUtils.getValue(D,"part","0")=="1"){var C=this.graph.model.getParent(b[d]);if(this.graph.model.isVertex(C)&&mxUtils.indexOf(b,C)<0){p.push(C)}}else{p.push(b[d])}}return p};this.connectionHandler.createTargetVertex=function(b,C){var B=this.graph.view.getState(C);var p=(B!=null)?B.style:this.graph.getCellStyle(C);if(mxUtils.getValue(p,"part",false)){var d=this.graph.model.getParent(C);if(this.graph.model.isVertex(d)){C=d}}return mxConnectionHandler.prototype.createTargetVertex.apply(this,arguments)};var u=new mxRubberband(this);this.getRubberband=function(){return u};var o=new Date().getTime();var a=0;var h=this.connectionHandler.mouseMove;this.connectionHandler.mouseMove=function(){var b=this.currentState;h.apply(this,arguments);if(b!=this.currentState){o=new Date().getTime();a=0}else{a=new Date().getTime()-o}};var j=this.connectionHandler.isOutlineConnectEvent;this.connectionHandler.isOutlineConnectEvent=function(b){return(this.currentState!=null&&b.getState()==this.currentState&&a>2000)||((this.currentState==null||mxUtils.getValue(this.currentState.style,"outlineConnect","1")!="0")&&j.apply(this,arguments))};var y=this.isToggleEvent;this.isToggleEvent=function(b){return y.apply(this,arguments)||mxEvent.isShiftDown(b)};var f=u.isForceRubberbandEvent;u.isForceRubberbandEvent=function(b){return f.apply(this,arguments)||(mxUtils.hasScrollbars(this.graph.container)&&mxClient.IS_FF&&mxClient.IS_WIN&&b.getState()==null&&mxEvent.isTouchEvent(b.getEvent()))};var g=null;this.panningHandler.addListener(mxEvent.PAN_START,mxUtils.bind(this,function(){if(this.isEnabled()){g=this.container.style.cursor;this.container.style.cursor="move"}}));this.panningHandler.addListener(mxEvent.PAN_END,mxUtils.bind(this,function(){if(this.isEnabled()){this.container.style.cursor=g}}));this.popupMenuHandler.autoExpand=true;this.popupMenuHandler.isSelectOnPopup=function(b){return mxEvent.isMouseEvent(b.getEvent())};var s=this.click;this.click=function(p){if(!this.isEnabled()&&!p.isConsumed()){var b=p.getCell();if(b!=null){var d=this.getLinkForCell(b);if(d!=null){window.open(d)}}}else{return s.apply(this,arguments)}};var A=this.getCursorForCell;this.getCursorForCell=function(b){if(!this.isEnabled()){var d=this.getLinkForCell(b);if(d!=null){return"pointer"}}else{return A.apply(this,arguments)}};this.selectRegion=function(p,b){var d=this.getAllCells(p.x,p.y,p.width,p.height);this.selectCellsForEvent(d,b);return d};this.getAllCells=function(H,G,B,L,I,M){M=(M!=null)?M:[];if(B>0||L>0){var F=this.getModel();var K=H+B;var b=G+L;if(I==null){I=this.getCurrentRoot();if(I==null){I=F.getRoot()}}if(I!=null){var C=F.getChildCount(I);for(var D=0;D<C;D++){var J=F.getChildAt(I,D);var d=this.view.getState(J);if(d!=null&&this.isCellVisible(J)&&mxUtils.getValue(d.style,"locked","0")!="1"){var p=mxUtils.getValue(d.style,mxConstants.STYLE_ROTATION)||0;var E=d;if(p!=0){E=mxUtils.getBoundingBox(E,p)}if((F.isEdge(J)||F.isVertex(J))&&E.x>=H&&E.y+E.height<=b&&E.y>=G&&E.x+E.width<=K){M.push(J)}this.getAllCells(H,G,B,L,J,M)}}}}return M};var m=this.graphHandler.shouldRemoveCellsFromParent;this.graphHandler.shouldRemoveCellsFromParent=function(p,d,b){if(this.graph.isCellSelected(p)){return false}return m.apply(this,arguments)};this.isCellLocked=function(b){var d=this.view.getState(b);while(d!=null){if(mxUtils.getValue(d.style,"locked","0")=="1"){return true}d=this.view.getState(this.model.getParent(d.cell))}return false};var e=null;this.addListener(mxEvent.FIRE_MOUSE_EVENT,mxUtils.bind(this,function(d,b){if(b.getProperty("eventName")=="mouseDown"){var p=b.getProperty("event");var B=p.getState();if(B!=null&&!this.isSelectionEmpty()&&!this.isCellSelected(B.cell)){e=this.getSelectionCells()}else{e=null}}}));this.addListener(mxEvent.TAP_AND_HOLD,mxUtils.bind(this,function(p,d){if(!mxEvent.isMultiTouchEvent(d)){var B=d.getProperty("event");var b=d.getProperty("cell");if(b==null){var C=mxUtils.convertPoint(this.container,mxEvent.getClientX(B),mxEvent.getClientY(B));u.start(C.x,C.y)}else{if(e!=null){this.addSelectionCells(e)}else{if(this.getSelectionCount()>1&&this.isCellSelected(b)){this.removeSelectionCell(b)}}}e=null;d.consume()}}));this.connectionHandler.selectCells=function(b,d){this.graph.setSelectionCell(d||b)};this.connectionHandler.constraintHandler.isStateIgnored=function(d,b){return b&&d.view.graph.isCellSelected(d.cell)};this.selectionModel.addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){var b=this.connectionHandler.constraintHandler;if(b.currentFocus!=null&&b.isStateIgnored(b.currentFocus,true)){b.currentFocus=null;b.constraints=null;b.destroyIcons()}b.destroyFocusHighlight()}));if(Graph.touchStyle){this.initTouch()}var c=this.updateMouseEvent;this.updateMouseEvent=function(b){b=c.apply(this,arguments);if(this.isCellLocked(b.getCell())){b.state=null}return b}}};Graph.touchStyle=mxClient.IS_TOUCH||(mxClient.IS_FF&&mxClient.IS_WIN)||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0||window.urlParams==null||urlParams.touch=="1";Graph.fileSupport=window.File!=null&&window.FileReader!=null&&window.FileList!=null&&(window.urlParams==null||urlParams.filesupport!="0");mxUtils.extend(Graph,mxGraph);Graph.prototype.minFitScale=null;Graph.prototype.maxFitScale=null;Graph.prototype.linkPolicy=(urlParams.target=="frame")?"blank":(urlParams.target||"auto");Graph.prototype.linkTarget=(urlParams.target=="frame")?"_self":"_blank";Graph.prototype.defaultScrollbars=!mxClient.IS_IOS;Graph.prototype.defaultPageVisible=true;Graph.prototype.lightbox=false;Graph.prototype.defaultGraphBackground="#ffffff";Graph.prototype.scrollTileSize=new mxRectangle(0,0,400,400);Graph.prototype.transparentBackground=true;Graph.prototype.defaultEdgeLength=80;Graph.prototype.edgeMode=false;Graph.prototype.connectionArrowsEnabled=true;Graph.prototype.placeholderPattern=new RegExp("%(date{.*}|[^%^{^}]+)%","g");Graph.prototype.absoluteUrlPattern=new RegExp("^(?:[a-z]+:)?//","i");Graph.prototype.defaultThemeName="default";Graph.prototype.defaultThemes={};Graph.prototype.baseUrl=(window!=window.top)?document.referrer:document.location.toString();Graph.prototype.init=function(a){mxGraph.prototype.init.apply(this,arguments);this.cellRenderer.initializeLabel=function(c,b){mxCellRenderer.prototype.initializeLabel.apply(this,arguments);mxEvent.addListener(b.node,"click",mxUtils.bind(this,function(d){var f=mxEvent.getSource(d);while(f!=null&&f!=b.node){if(f.nodeName=="A"){var e=f.getAttribute("href");if(e!=null){var g=c.view.graph.isBlankLink(e)?c.view.graph.linkTarget:"_top";e=c.view.graph.getAbsoluteUrl(e);if(g=="_self"&&window!=window.top){window.location.href=e}else{window.open(e,g)}mxEvent.consume(d)}break}f=f.parentNode}}))};this.initLayoutManager()};Graph.prototype.initLayoutManager=function(){this.layoutManager=new mxLayoutManager(this);this.layoutManager.getLayout=function(a){var e=this.graph.view.getState(a);var d=(e!=null)?e.style:this.graph.getCellStyle(a);if(d.childLayout=="stackLayout"){var f=new mxStackLayout(this.graph,true);f.resizeParentMax=true;f.horizontal=mxUtils.getValue(d,"horizontalStack","1")=="1";f.resizeParent=mxUtils.getValue(d,"resizeParent","1")=="1";f.resizeLast=mxUtils.getValue(d,"resizeLast","0")=="1";f.marginLeft=d.marginLeft||0;f.marginRight=d.marginRight||0;f.marginTop=d.marginTop||0;f.marginBottom=d.marginBottom||0;f.fill=true;return f}else{if(d.childLayout=="treeLayout"){var c=new mxCompactTreeLayout(this.graph);c.horizontal=mxUtils.getValue(d,"horizontalTree","1")=="1";c.resizeParent=mxUtils.getValue(d,"resizeParent","1")=="1";c.groupPadding=mxUtils.getValue(d,"parentPadding",20);c.levelDistance=mxUtils.getValue(d,"treeLevelDistance",30);c.maintainParentLocation=true;c.edgeRouting=false;c.resetEdges=false;return c}else{if(d.childLayout=="flowLayout"){var b=new mxHierarchicalLayout(this.graph,mxUtils.getValue(d,"flowOrientation",mxConstants.DIRECTION_EAST));b.resizeParent=mxUtils.getValue(d,"resizeParent","1")=="1";b.parentBorder=mxUtils.getValue(d,"parentPadding",20);b.maintainParentLocation=true;b.intraCellSpacing=mxUtils.getValue(d,"intraCellSpacing",mxHierarchicalLayout.prototype.intraCellSpacing);b.interRankCellSpacing=mxUtils.getValue(d,"interRankCellSpacing",mxHierarchicalLayout.prototype.interRankCellSpacing);b.interHierarchySpacing=mxUtils.getValue(d,"interHierarchySpacing",mxHierarchicalLayout.prototype.interHierarchySpacing);b.parallelEdgeSpacing=mxUtils.getValue(d,"parallelEdgeSpacing",mxHierarchicalLayout.prototype.parallelEdgeSpacing);return b}}}return null}};Graph.prototype.getPageSize=function(){return(this.pageVisible)?new mxRectangle(0,0,this.pageFormat.width*this.pageScale,this.pageFormat.height*this.pageScale):this.scrollTileSize};Graph.prototype.getPageLayout=function(){var k=this.getPageSize();var a=this.getGraphBounds();if(a.width==0||a.height==0){return new mxRectangle(0,0,1,1)}else{var g=Math.ceil(a.x/this.view.scale-this.view.translate.x);var f=Math.ceil(a.y/this.view.scale-this.view.translate.y);var j=Math.floor(a.width/this.view.scale);var c=Math.floor(a.height/this.view.scale);var b=Math.floor(g/k.width);var i=Math.floor(f/k.height);var d=Math.ceil((g+j)/k.width)-b;var e=Math.ceil((f+c)/k.height)-i;return new mxRectangle(b,i,d,e)}};Graph.prototype.sanitizeHtml=function(c,a){function b(e){if(e!=null&&e.toString().toLowerCase().substring(0,11)!=="javascript:"){return e}return null}function d(e){return e}return html_sanitize(c,b,d)};Graph.prototype.updatePlaceholders=function(){var b=this.model;var d=false;for(var c in this.model.cells){var a=this.model.cells[c];if(this.isReplacePlaceholders(a)){this.view.invalidate(a,false,false);d=true}}if(d){this.view.validate()}};Graph.prototype.isReplacePlaceholders=function(a){return a.value!=null&&typeof(a.value)=="object"&&a.value.getAttribute("placeholders")=="1"};Graph.prototype.isIgnoreTerminalEvent=function(a){return mxEvent.isShiftDown(a)&&mxEvent.isControlDown(a)};Graph.prototype.isSplitTarget=function(c,b,a){return !mxEvent.isShiftDown(a)&&mxGraph.prototype.isSplitTarget.apply(this,arguments)};Graph.prototype.getLabel=function(b){var a=mxGraph.prototype.getLabel.apply(this,arguments);if(a!=null&&this.isReplacePlaceholders(b)&&b.getAttribute("placeholder")==null){a=this.replacePlaceholders(b,a)}return a};Graph.prototype.isLabelMovable=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return !this.isCellLocked(a)&&((this.model.isEdge(a)&&this.edgeLabelsMovable)||(this.model.isVertex(a)&&(this.vertexLabelsMovable||mxUtils.getValue(b,"labelMovable","0")=="1")))};mxGraph.prototype.setGridSize=function(a){this.gridSize=a;this.fireEvent(new mxEventObject("gridSizeChanged"))};Graph.prototype.getGlobalVariable=function(b){var c=null;if(b=="date"){c=new Date().toLocaleDateString()}else{if(b=="time"){c=new Date().toLocaleTimeString()}else{if(b=="timestamp"){c=new Date().toLocaleString()}else{if(b.substring(0,5)=="date{"){var a=b.substring(5,b.length-1);c=this.formatDate(new Date(),a)}}}}return c};Graph.prototype.formatDate=function(v,q,a){if(this.dateFormatCache==null){this.dateFormatCache={i18n:{dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},masks:{"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"}}}var j=this.dateFormatCache;var c=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,n=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,u=/[^-+\dA-Z]/g,r=function(m,d){m=String(m);d=d||2;while(m.length<d){m="0"+m}return m};if(arguments.length==1&&Object.prototype.toString.call(v)=="[object String]"&&!/\d/.test(v)){q=v;v=undefined}v=v?new Date(v):new Date;if(isNaN(v)){throw SyntaxError("invalid date")}q=String(j.masks[q]||q||j.masks["default"]);if(q.slice(0,4)=="UTC:"){q=q.slice(4);a=true}var w=a?"getUTC":"get",t=v[w+"Date"](),k=v[w+"Day"](),p=v[w+"Month"](),g=v[w+"FullYear"](),h=v[w+"Hours"](),e=v[w+"Minutes"](),i=v[w+"Seconds"](),f=v[w+"Milliseconds"](),l=a?0:v.getTimezoneOffset(),b={d:t,dd:r(t),ddd:j.i18n.dayNames[k],dddd:j.i18n.dayNames[k+7],m:p+1,mm:r(p+1),mmm:j.i18n.monthNames[p],mmmm:j.i18n.monthNames[p+12],yy:String(g).slice(2),yyyy:g,h:h%12||12,hh:r(h%12||12),H:h,HH:r(h),M:e,MM:r(e),s:i,ss:r(i),l:r(f,3),L:r(f>99?Math.round(f/10):f),t:h<12?"a":"p",tt:h<12?"am":"pm",T:h<12?"A":"P",TT:h<12?"AM":"PM",Z:a?"UTC":(String(v).match(n)||[""]).pop().replace(u,""),o:(l>0?"-":"+")+r(Math.floor(Math.abs(l)/60)*100+Math.abs(l)%60,4),S:["th","st","nd","rd"][t%10>3?0:(t%100-t%10!=10)*t%10]};return q.replace(c,function(d){return d in b?b[d]:d.slice(1,d.length-1)})};Graph.prototype.createLayersDialog=function(){var d=document.createElement("div");d.style.position="absolute";var b=this.getModel();var a=b.getChildCount(b.root);for(var c=0;c<a;c++){(function(f){var g=document.createElement("div");g.style.overflow="hidden";g.style.textOverflow="ellipsis";g.style.padding="2px";g.style.whiteSpace="nowrap";var e=document.createElement("input");e.setAttribute("type","checkbox");if(b.isVisible(f)){e.setAttribute("checked","checked");e.defaultChecked=true}g.appendChild(e);var h=f.value||(mxResources.get("background")||"Background");g.setAttribute("title",h);mxUtils.write(g,h);d.appendChild(g);mxEvent.addListener(e,"click",function(){if(e.getAttribute("checked")!=null){e.removeAttribute("checked")}else{e.setAttribute("checked","checked")}b.setVisible(f,e.checked)})}(b.getChildAt(b.root,c)))}return d};Graph.prototype.replacePlaceholders=function(b,h){var a=[];var e=0;while(match=this.placeholderPattern.exec(h)){var g=match[0];if(g.length>2&&g!="%label%"&&g!="%tooltip%"){var d=null;if(match.index>e&&h.charAt(match.index-1)=="%"){d=g.substring(1)}else{var c=g.substring(1,g.length-1);if(c.indexOf("{")<0){var f=b;while(d==null&&f!=null){if(f.value!=null&&typeof(f.value)=="object"){d=(f.hasAttribute(c))?((f.getAttribute(c)!=null)?f.getAttribute(c):""):null}f=this.model.getParent(f)}}if(d==null){d=this.getGlobalVariable(c)}}a.push(h.substring(e,match.index)+((d!=null)?d:g));e=match.index+g.length}}a.push(h.substring(e));return a.join("")};Graph.prototype.selectCellsForConnectVertex=function(b,a,c){if(b.length==2&&this.model.isVertex(b[1])){this.setSelectionCell(b[1]);if(c!=null){if(mxEvent.isTouchEvent(a)){c.update(c.getState(this.view.getState(b[1])))}else{c.reset()}}this.scrollCellToVisible(b[1])}else{this.setSelectionCells(b)}};Graph.prototype.connectVertex=function(v,B,e,q,c){var u=(v.geometry.relative&&v.parent.geometry!=null)?new mxPoint(v.parent.geometry.width*v.geometry.x,v.parent.geometry.height*v.geometry.y):new mxPoint(v.geometry.x,v.geometry.y);if(B==mxConstants.DIRECTION_NORTH){u.x+=v.geometry.width/2;u.y-=e}else{if(B==mxConstants.DIRECTION_SOUTH){u.x+=v.geometry.width/2;u.y+=v.geometry.height+e}else{if(B==mxConstants.DIRECTION_WEST){u.x-=e;u.y+=v.geometry.height/2}else{u.x+=v.geometry.width+e;u.y+=v.geometry.height/2}}}var a=this.view.getState(this.model.getParent(v));var o=this.view.scale;var n=this.view.translate;var m=n.x*o;var l=n.y*o;if(this.model.isVertex(a.cell)){m=a.x;l=a.y}if(this.model.isVertex(v.parent)&&v.geometry.relative){u.x+=v.parent.geometry.x;u.y+=v.parent.geometry.y}var C=(mxEvent.isControlDown(q)&&!c)?null:this.getCellAt(m+u.x*o,l+u.y*o);if(this.model.isAncestor(C,v)){C=null}var z=C;while(z!=null){if(this.isCellLocked(z)){C=null;break}z=this.model.getParent(z)}if(C!=null){var d=this.view.getState(v);var x=this.view.getState(C);if(d!=null&&x!=null&&mxUtils.intersects(d,x)){C=null}}var b=!mxEvent.isShiftDown(q)||c;if(b){if(B==mxConstants.DIRECTION_NORTH){u.y-=v.geometry.height/2}else{if(B==mxConstants.DIRECTION_SOUTH){u.y+=v.geometry.height/2}else{if(B==mxConstants.DIRECTION_WEST){u.x-=v.geometry.width/2}else{u.x+=v.geometry.width/2}}}}if(C!=null&&!this.isCellConnectable(C)){var j=this.getModel().getParent(C);if(this.getModel().isVertex(j)&&this.isCellConnectable(j)){C=j}}if(C==v||this.model.isEdge(C)||!this.isCellConnectable(C)){C=null}var k=[];this.model.beginUpdate();try{var p=C;if(p==null&&b){var r=v;var D=this.getCellGeometry(v);while(D!=null&&D.relative){r=this.getModel().getParent(r);D=this.getCellGeometry(r)}var f=this.view.getState(r);var w=(f!=null)?f.style:this.getCellStyle(r);if(mxUtils.getValue(w,"part",false)){var i=this.model.getParent(r);if(this.model.isVertex(i)){r=i}}p=this.duplicateCells([r],false)[0];var D=this.getCellGeometry(p);if(D!=null){D.x=u.x-D.width/2;D.y=u.y-D.height/2}}var y=null;if(this.layoutManager!=null){y=this.layoutManager.getLayout(this.model.getParent(v))}var g=((mxEvent.isControlDown(q)&&b)||(C==null&&y!=null&&y.constructor==mxStackLayout))?null:this.insertEdge(this.model.getParent(v),null,"",v,p,this.createCurrentEdgeStyle());if(g!=null&&this.connectionHandler.insertBeforeSource){var h=null;var A=v;while(A.parent!=null&&A.geometry!=null&&A.geometry.relative&&A.parent!=g.parent){A=this.model.getParent(A)}if(A!=null&&A.parent!=null&&A.parent==g.parent){var h=A.parent.getIndex(A);A.parent.insert(g,h)}}if(C==null&&p!=null&&y!=null&&v.parent!=null&&y.constructor==mxStackLayout&&B==mxConstants.DIRECTION_WEST){var h=v.parent.getIndex(v);v.parent.insert(p,h)}if(g!=null){k.push(g)}if(C==null&&p!=null){k.push(p)}if(p==null&&g!=null){g.geometry.setTerminalPoint(u,false)}if(g!=null){this.fireEvent(new mxEventObject("cellsInserted","cells",[g]))}}finally{this.model.endUpdate()}return k};Graph.prototype.getIndexableText=function(){var d=document.createElement("div");var e=[];var b="";for(var c in this.model.cells){var a=this.model.cells[c];if(this.model.isVertex(a)||this.model.isEdge(a)){if(this.isHtmlLabel(a)){d.innerHTML=this.getLabel(a);b=mxUtils.extractTextWithWhitespace([d])}else{b=this.getLabel(a)}b=mxUtils.trim(b.replace(/[\x00-\x1F\x7F-\x9F]|\s+/g," "));if(b.length>0){e.push(b)}}}return e.join(" ")};Graph.prototype.convertValueToString=function(b){if(b.value!=null&&typeof(b.value)=="object"){if(this.isReplacePlaceholders(b)&&b.getAttribute("placeholder")!=null){var c=b.getAttribute("placeholder");var d=b;var a=null;while(a==null&&d!=null){if(d.value!=null&&typeof(d.value)=="object"){a=(d.hasAttribute(c))?((d.getAttribute(c)!=null)?d.getAttribute(c):""):null}d=this.model.getParent(d)}return a||""}else{return b.value.getAttribute("label")}}return mxGraph.prototype.convertValueToString.apply(this,arguments)};Graph.prototype.getLinkForCell=function(a){if(a.value!=null&&typeof(a.value)=="object"){var b=a.value.getAttribute("link");if(b!=null&&b.toLowerCase().substring(0,11)==="javascript:"){b=b.substring(11)}return b}return null};Graph.prototype.getCellStyle=function(a){var c=mxGraph.prototype.getCellStyle.apply(this,arguments);if(a!=null&&this.layoutManager!=null){var b=this.model.getParent(a);if(this.model.isVertex(b)&&this.isCellCollapsed(a)){var d=this.layoutManager.getLayout(b);if(d!=null&&d.constructor==mxStackLayout){c[mxConstants.STYLE_HORIZONTAL]=!d.horizontal}}}return c};Graph.prototype.updateAlternateBounds=function(a,d,c){if(a!=null&&d!=null&&this.layoutManager!=null&&d.alternateBounds!=null){var b=this.layoutManager.getLayout(this.model.getParent(a));if(b!=null&&b.constructor==mxStackLayout){if(b.horizontal){d.alternateBounds.height=0}else{d.alternateBounds.width=0}}}mxGraph.prototype.updateAlternateBounds.apply(this,arguments)};Graph.prototype.isMoveCellsEvent=function(a){return mxEvent.isShiftDown(a)};Graph.prototype.foldCells=function(g,b,l,f,j){b=(b!=null)?b:false;if(l==null){l=this.getFoldableCells(this.getSelectionCells(),g)}if(l!=null){this.model.beginUpdate();try{mxGraph.prototype.foldCells.apply(this,arguments);if(this.layoutManager!=null){for(var d=0;d<l.length;d++){var a=this.view.getState(l[d]);var c=this.getCellGeometry(l[d]);if(a!=null&&c!=null){var m=Math.round(c.width-a.width/this.view.scale);var k=Math.round(c.height-a.height/this.view.scale);if(k!=0||m!=0){var h=this.model.getParent(l[d]);var e=this.layoutManager.getLayout(h);if(e==null){if(j!=null&&this.isMoveCellsEvent(j)){this.moveSiblings(a,h,m,k)}}else{if((j==null||!mxEvent.isAltDown(j))&&e.constructor==mxStackLayout&&!e.resizeLast){this.resizeParentStacks(h,e,m,k)}}}}}}}finally{this.model.endUpdate()}if(this.isEnabled()){this.setSelectionCells(l)}}};Graph.prototype.moveSiblings=function(g,f,b,a){this.model.beginUpdate();try{var c=this.getCellsBeyond(g.x,g.y,f,true,true);for(var e=0;e<c.length;e++){if(c[e]!=g.cell){var d=this.view.getState(c[e]);var h=this.getCellGeometry(c[e]);if(d!=null&&h!=null){h=h.clone();h.translate(Math.round(b*Math.max(0,Math.min(1,(d.x-g.x)/g.width))),Math.round(a*Math.max(0,Math.min(1,(d.y-g.y)/g.height))));this.model.setGeometry(c[e],h)}}}}finally{this.model.endUpdate()}};Graph.prototype.resizeParentStacks=function(e,f,c,a){if(this.layoutManager!=null&&f!=null&&f.constructor==mxStackLayout&&!f.resizeLast){this.model.beginUpdate();try{var d=f.horizontal;while(e!=null&&f!=null&&f.constructor==mxStackLayout&&f.horizontal==d&&!f.resizeLast){var b=this.getCellGeometry(e);var g=this.view.getState(e);if(g!=null&&b!=null){b=b.clone();if(f.horizontal){b.width+=c+Math.min(0,g.width/this.view.scale-b.width)}else{b.height+=a+Math.min(0,g.height/this.view.scale-b.height)}this.model.setGeometry(e,b)}e=this.model.getParent(e);f=this.layoutManager.getLayout(e)}}finally{this.model.endUpdate()}}};Graph.prototype.isContainer=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);if(this.isSwimlane(a)){return b.container!="0"}else{return b.container=="1"}};Graph.prototype.isCellConnectable=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return(b.connectable!=null)?b.connectable!="0":mxGraph.prototype.isCellConnectable.apply(this,arguments)};Graph.prototype.selectAll=function(a){a=a||this.getDefaultParent();if(!this.isCellLocked(a)){mxGraph.prototype.selectAll.apply(this,arguments)}};Graph.prototype.selectCells=function(b,a,c){c=c||this.getDefaultParent();if(!this.isCellLocked(c)){mxGraph.prototype.selectCells.apply(this,arguments)}};Graph.prototype.getSwimlaneAt=function(a,c,b){b=b||this.getDefaultParent();if(!this.isCellLocked(b)){return mxGraph.prototype.getSwimlaneAt.apply(this,arguments)}return null};Graph.prototype.isCellFoldable=function(a){var c=this.view.getState(a);var b=(c!=null)?c.style:this.getCellStyle(a);return this.foldingEnabled&&!this.isCellLocked(a)&&((this.isContainer(a)&&b.collapsible!="0")||(!this.isContainer(a)&&b.collapsible=="1"))};Graph.prototype.reset=function(){if(this.isEditing()){this.stopEditing(true)}this.escape();if(!this.isSelectionEmpty()){this.clearSelection()}};Graph.prototype.zoom=function(b,a){b=Math.max(0.01,Math.min(this.view.scale*b,160))/this.view.scale;mxGraph.prototype.zoom.apply(this,arguments)};Graph.prototype.zoomIn=function(){if(this.view.scale<0.15){this.zoom((this.view.scale+0.01)/this.view.scale)}else{this.zoom((Math.round(this.view.scale*this.zoomFactor*20)/20)/this.view.scale)}};Graph.prototype.zoomOut=function(){if(this.view.scale<=0.15){this.zoom((this.view.scale-0.01)/this.view.scale)}else{this.zoom((Math.round(this.view.scale*(1/this.zoomFactor)*20)/20)/this.view.scale)}};Graph.prototype.getTooltipForCell=function(a){var f="";if(mxUtils.isNode(a.value)){var e=a.value.getAttribute("tooltip");if(e!=null){if(e!=null&&this.isReplacePlaceholders(a)){e=this.replacePlaceholders(a,e)}f=this.sanitizeHtml(e)}else{var b=["label","tooltip","placeholders","placeholder"];var c=a.value.attributes;if(this.isEnabled()){b.push("link")}for(var d=0;d<c.length;d++){if(mxUtils.indexOf(b,c[d].nodeName)<0&&c[d].nodeValue.length>0){f+=((c[d].nodeName!="link")?c[d].nodeName+":":"")+mxUtils.htmlEntities(c[d].nodeValue)+"\n"}}if(f.length>0){f=f.substring(0,f.length-1)}}}return f};Graph.prototype.stringToBytes=function(c){var a=new Array(c.length);for(var b=0;b<c.length;b++){a[b]=c.charCodeAt(b)}return a};Graph.prototype.bytesToString=function(b){var a=new Array(b.length);for(var c=0;c<b.length;c++){a[c]=String.fromCharCode(b[c])}return a.join("")};Graph.prototype.compress=function(b){if(b==null||b.length==0||typeof(pako)==="undefined"){return b}else{var a=this.bytesToString(pako.deflateRaw(encodeURIComponent(b)));return(window.btoa)?btoa(a):Base64.encode(a,true)}};Graph.prototype.decompress=function(b){if(b==null||b.length==0||typeof(pako)==="undefined"){return b}else{var a=(window.atob)?atob(b):Base64.decode(b,true);return this.zapGremlins(decodeURIComponent(this.bytesToString(pako.inflateRaw(a))))}};Graph.prototype.zapGremlins=function(d){var c=[];for(var a=0;a<d.length;a++){var b=d.charCodeAt(a);if(b>=32||b==9||b==10||b==13){c.push(d.charAt(a))}}return c.join("")};HoverIcons=function(a){this.graph=a;this.init()};HoverIcons.prototype.arrowSpacing=6;HoverIcons.prototype.updateDelay=500;HoverIcons.prototype.activationDelay=140;HoverIcons.prototype.currentState=null;HoverIcons.prototype.activeArrow=null;HoverIcons.prototype.inactiveOpacity=15;HoverIcons.prototype.checkCollisions=true;HoverIcons.prototype.triangleUp=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAOCAYAAAAxDQxDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0ZBN0E3M0U5NjZGMTFFNTg5NTRDNzQwMTgwNDlEQzQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0ZBN0E3M0Y5NjZGMTFFNTg5NTRDNzQwMTgwNDlEQzQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3RkE3QTczQzk2NkYxMUU1ODk1NEM3NDAxODA0OURDNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3RkE3QTczRDk2NkYxMUU1ODk1NEM3NDAxODA0OURDNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pj625P8AAACySURBVHjaYmRY956BROABxF+A+AgpmpjIsGQjEO8CYidaWeQHtYQNiDmBeAspljGRYMlqqCUwALPMg1oWhWCxBNmyjVCHUGQRyJKlOCyBATaoQ/zItSgciFcQsATdshBSLYqC+oSZhMTCBnVYFLEWgRQuItESGGCG6o0iZFECBZagW5aAyyKQxBwKLUG2bD4Qp6FblAyVoIYlyGAmzDIWKGMmA+0AyGw2RjIKVbIAQIABAFJRHSSk2rPoAAAAAElFTkSuQmCC":IMAGE_PATH+"/triangle-up.png",26,14);HoverIcons.prototype.triangleRight=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAaCAYAAACHD21cAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NThDQzc5RTU5NjZGMTFFNTg5NTRDNzQwMTgwNDlEQzQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NThDQzc5RTY5NjZGMTFFNTg5NTRDNzQwMTgwNDlEQzQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1OENDNzlFMzk2NkYxMUU1ODk1NEM3NDAxODA0OURDNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1OENDNzlFNDk2NkYxMUU1ODk1NEM3NDAxODA0OURDNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PrHdKTUAAADDSURBVHjanNTBCgFRFIfxMeTZyEKkiBSRxbwREZGiNFZKWSnvY6OUUv6n7ilZaL459XVXv6a5c+cWovQeaSZqFoGJwzpVozzQZq4GeSDCv7AYcJ9Cx0vVpdDxWrUpdLxVLQr/4jjDBpYDblDoeKdqFDpOHRP4jSsU2rzVg8KnqqpbDFFdXck7vlRTXciuOjqT72ioo07k5Nju9dSRnFVHB/J3GBqqPf0fx2pDbwBDK3Ln2MdN1CLraSiFNcn6JJ+PAAMAbnMl1tyDPD8AAAAASUVORK5CYII=":IMAGE_PATH+"/triangle-right.png",14,26);HoverIcons.prototype.triangleDown=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAOCAYAAAAxDQxDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NThDQzc5RTk5NjZGMTFFNTg5NTRDNzQwMTgwNDlEQzQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NThDQzc5RUE5NjZGMTFFNTg5NTRDNzQwMTgwNDlEQzQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1OENDNzlFNzk2NkYxMUU1ODk1NEM3NDAxODA0OURDNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1OENDNzlFODk2NkYxMUU1ODk1NEM3NDAxODA0OURDNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv9xyy0AAADESURBVHjaYmRY956BHoAJiHOA+D+NcRrIoilAnEVDz6QD8SwWKGc6EP8F4plUtiQRiBfAgg4GZkEl/lLBgr/IlqBbxACViKPQMgxLQIAFi8JlUHoREDOTYUkckhkMuHyEbFkEEP8i0ZJobJbgswgE1gBxKJGW/YI6bCW+fIQPbCLCsl9Qn6whlGEZiLDMH4i/47AklJAlxFoEAjuA2AfNMpglm4gtgogF+5As+wX15SZiNbOQmHxBlrkBMQ/Ul0QDgAADAC8qRII7g4RyAAAAAElFTkSuQmCC":IMAGE_PATH+"/triangle-down.png",26,14);HoverIcons.prototype.triangleLeft=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAaCAYAAACHD21cAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0ZBN0E3M0E5NjZGMTFFNTg5NTRDNzQwMTgwNDlEQzQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0ZBN0E3M0I5NjZGMTFFNTg5NTRDNzQwMTgwNDlEQzQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1OENDNzlFQjk2NkYxMUU1ODk1NEM3NDAxODA0OURDNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1OENDNzlFQzk2NkYxMUU1ODk1NEM3NDAxODA0OURDNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pi1fu2cAAADXSURBVHjalNTRB8JQFMfxVROxPyl6iuipRJFS2kv/TU89lY0piyw9pP6r3iP6He7Ndd3de87haxMfd+1ua0TVOxLOCuVNIdqiHZ1I4AbtUUsC6fIO6jzhwoWB/hOCU5Tpy+PCCTq5kA+OfKgODlGJ2r7/YMMBqkLIhn0uMmEP3VGH+zQQ7KKnBGmY+O6eD77QGH2kkOYhxeZdJTzjYnsfb2jOwbHjt6s6ltJHTmNa+SuFNBe0rMOh9/GM1i7M+QIUKLVxzNy2XB0zyYomTqUr6jnqLfoJMADoxSMHt6pxsAAAAABJRU5ErkJggg==":IMAGE_PATH+"/triangle-left.png",14,26);HoverIcons.prototype.roundDrop=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTgxRjYzRTU1MDRFMTFFNEExQ0VFNDQwNDhGNzg2RDkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTgxRjYzRTY1MDRFMTFFNEExQ0VFNDQwNDhGNzg2RDkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFODFGNjNFMzUwNEUxMUU0QTFDRUU0NDA0OEY3ODZEOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFODFGNjNFNDUwNEUxMUU0QTFDRUU0NDA0OEY3ODZEOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuJ657wAAAE0SURBVHjaYvz//z8DPQATA50AC4zBuP4DLjXaQOwMxJZArAfE8lDxh0B8CYiPA/FeIL6KTfP/QAFUi7AABSBOAOJoIFbBIq8FxRFAfAeIlwLxAiB+gNdHaMABiIuB2IfIkAE5pB6IjYG4F4gPEBNHIEtaSLAEGfhA9ToQskgB6hNrCuLdGmqGAj6LEsj0CTafJeCySBsa8dQC0VAzMSxyxpG6yAUqUDMxLLKkQT61xGaRHg0s0sNmkTwNLJKne1mHbNFDGpj/EJtFl2hg0SVsFh2ngUXHsVm0F1oKUwvcgZqJYdFVaFFPLbAUuY5CT3Wg+mQLFSzZAjULZ6H6AFqfHKXAkqNQMx4Qqo9AlVYNmT7bAtV7gNga9gDURWfxVOXoEY+3KmeENbdo3ThhHHbtOoAAAwDmEETshQ0fBAAAAABJRU5ErkJggg==":IMAGE_PATH+"/round-drop.png",26,26);HoverIcons.prototype.refreshTarget=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NDQxNERDRTU1QjY1MTFFNDkzNTRFQTVEMTdGMTdBQjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NDQxNERDRTY1QjY1MTFFNDkzNTRFQTVEMTdGMTdBQjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0NDE0RENFMzVCNjUxMUU0OTM1NEVBNUQxN0YxN0FCNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0NDE0RENFNDVCNjUxMUU0OTM1NEVBNUQxN0YxN0FCNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsvuX50AAANaSURBVHja7FjRZ1tRGD9ZJ1NCyIQSwrivI4Q8hCpjlFDyFEoYfSp9Ko1QWnmo0If+BSXkIfo0QirTMUpeGo2EPfWllFYjZMLKLDJn53d3biU337m5J223bPbxk5t7v+/c3/2+73znO8fDOWezKM/YjMpz68Lj8ejY+QTeCCwLxOS9qPxtyN+6wAeBTwJ31CCO0cJDjXBGBN4LfIepSwykTUT1bgpuib0SONIgo8KRHOtRiCFcvUcgZeGrHPNBxLIyFPyRgTGz0xLbegJCdmzpElue5KlAIMDX19d5uVzm5+fnfDAYmMA17uEZdOx2Yvb/sHlu2S0xwymn5ufneTab5b1ej08S6EAXNrDd2dnhiUTim21MvMtwQ6yiIrWwsMDPzs64rsBmf3/fvM7n89TYlUnEllSkQqEQv7q64g+Vk5MTVXosORErU0Zer5f0FEIlw2N6MxwO82QyaXql2+2SxDqdjopYWUUsqEp45IldqtWq6UWVh/1+P7+8vCTJ4QMUJSRIEXuneoH96w8PDyeWAnhSJfCqwm6NIlaklFdXV0cGhRcQ2mlJQXK5nMq2YPEZbnteU1U2lUqN/D84OGD9fl+5fgnSrFarsUwmw0qlEru4uBjTicViTk3Cr27HSnxR+Doyz0ZE1CAWiUTusbu7y9rttlZv5fP5WDQavYfIMba4uEipfhF8XtqJoZXx/uH+sC/4vPg7OljZZQbsCmLtYzc3N6zRaJhotVrmfx0xDINtbm6athYUeXpHdbBNaqZUKpWxWXV7e2vex+xaWVnhc3NzjrPUXgexyCt0m67LBV7uJMITjqRE4o8tZeg8FPpFitgapYxiOC0poFgsji1jKNo6BZZckrAGUtJsNk1vqAihCBcKhTE7hNWhqw2qFnGy5UFOUYJVIJ1OjzSE+BCEilon0URavRmBqnbbQ00AXbm+vnZc9O1tj72OnQoc2+cwygRkb2+P1et17ZoEm3g87lRmjgWZ00kbXkNuse6/Bu2wlegIxfb2tuvWGroO4bO2c4bbzUh60mxDXm1sbJhhxkQYnhS4h2fUZoRAWnf7lv8N27f8P7Xhnekjgpk+VKGOoQbsiY+hhhtF3YO7twIJ+ULvUGv+GQ2fQEvWxI/THNx5/p/BaspPAQYAqStgiSQwCDoAAAAASUVORK5CYII=":IMAGE_PATH+"/refresh.png",38,38);HoverIcons.prototype.init=function(){this.arrowUp=this.createArrow(this.triangleUp,mxResources.get("plusTooltip"));this.arrowRight=this.createArrow(this.triangleRight,mxResources.get("plusTooltip"));this.arrowDown=this.createArrow(this.triangleDown,mxResources.get("plusTooltip"));this.arrowLeft=this.createArrow(this.triangleLeft,mxResources.get("plusTooltip"));this.elts=[this.arrowUp,this.arrowRight,this.arrowDown,this.arrowLeft];this.repaintHandler=mxUtils.bind(this,function(){this.repaint()});this.graph.selectionModel.addListener(mxEvent.CHANGE,this.repaintHandler);this.graph.model.addListener(mxEvent.CHANGE,this.repaintHandler);this.graph.view.addListener(mxEvent.SCALE_AND_TRANSLATE,this.repaintHandler);this.graph.view.addListener(mxEvent.TRANSLATE,this.repaintHandler);this.graph.view.addListener(mxEvent.SCALE,this.repaintHandler);this.graph.view.addListener(mxEvent.DOWN,this.repaintHandler);this.graph.view.addListener(mxEvent.UP,this.repaintHandler);this.graph.addListener(mxEvent.ROOT,this.repaintHandler);this.graph.addListener(mxEvent.ESCAPE,mxUtils.bind(this,function(){this.mouseDownPoint=null}));mxEvent.addListener(this.graph.container,"mouseleave",mxUtils.bind(this,function(c){if(c.relatedTarget!=null&&mxEvent.getSource(c)==this.graph.container){this.setDisplay("none")}}));var b=this.graph.click;this.graph.click=mxUtils.bind(this,function(c){b.apply(this.graph,arguments);if(this.currentState!=null&&!this.graph.isCellSelected(this.currentState.cell)&&mxEvent.isTouchEvent(c.getEvent())&&!this.graph.model.isVertex(c.getCell())){this.reset()}});var a=false;this.graph.addMouseListener({mouseDown:mxUtils.bind(this,function(d,e){a=false;var c=e.getEvent();if(this.isResetEvent(c)){this.reset()}else{if(!this.isActive()){var f=this.getState(e.getState());if(f!=null||!mxEvent.isTouchEvent(c)){this.update(f)}}}this.setDisplay("none")}),mouseMove:mxUtils.bind(this,function(d,e){var c=e.getEvent();if(this.isResetEvent(c)){this.reset()}else{if(!this.graph.isMouseDown&&!mxEvent.isTouchEvent(c)){this.update(this.getState(e.getState()),e.getGraphX(),e.getGraphY())}}if(this.graph.connectionHandler!=null&&this.graph.connectionHandler.shape!=null){a=true}}),mouseUp:mxUtils.bind(this,function(d,e){var c=e.getEvent();if(this.isResetEvent(c)){this.reset()}else{if(this.isActive()&&this.mouseDownPoint!=null&&Math.abs(e.getGraphX()-this.mouseDownPoint.x)<this.graph.tolerance&&Math.abs(e.getGraphY()-this.mouseDownPoint.y)<this.graph.tolerance){if(!a){this.click(this.currentState,this.getDirection(),e)}}else{if(this.isActive()){if(this.graph.getSelectionCount()!=1||!this.graph.model.isEdge(this.graph.getSelectionCell())){this.update(this.getState(this.graph.view.getState(this.graph.getCellAt(e.getGraphX(),e.getGraphY()))))}else{this.reset()}}else{if(mxEvent.isTouchEvent(c)||(this.bbox!=null&&mxUtils.contains(this.bbox,e.getGraphX(),e.getGraphY()))){this.setDisplay("");this.repaint()}else{if(!mxEvent.isTouchEvent(c)){this.reset()}}}}}a=false;this.resetActiveArrow()})})};HoverIcons.prototype.isResetEvent=function(a,b){return mxEvent.isAltDown(a)||(this.activeArrow==null&&mxEvent.isShiftDown(a))||mxEvent.isMetaDown(a)||(mxEvent.isPopupTrigger(a)&&!mxEvent.isControlDown(a))};HoverIcons.prototype.createArrow=function(a,c){var b=null;if(mxClient.IS_IE&&!mxClient.IS_SVG){if(mxClient.IS_IE6&&document.compatMode!="CSS1Compat"){b=document.createElement(mxClient.VML_PREFIX+":image");b.setAttribute("src",a.src);b.style.borderStyle="none"}else{b=document.createElement("div");b.style.backgroundImage="url("+a.src+")";b.style.backgroundPosition="center";b.style.backgroundRepeat="no-repeat"}b.style.width=(a.width+4)+"px";b.style.height=(a.height+4)+"px";b.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block"}else{b=mxUtils.createImage(a.src);b.style.width=a.width+"px";b.style.height=a.height+"px"}if(c!=null){b.setAttribute("title",c)}b.style.position="absolute";b.style.cursor="crosshair";mxEvent.addGestureListeners(b,mxUtils.bind(this,function(d){if(this.currentState!=null&&!this.isResetEvent(d)){this.mouseDownPoint=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(d),mxEvent.getClientY(d));this.drag(d,this.mouseDownPoint.x,this.mouseDownPoint.y);this.activeArrow=b;this.setDisplay("none");mxEvent.consume(d)}}));mxEvent.redirectMouseEvents(b,this.graph,this.currentState);mxEvent.addListener(b,"mouseenter",mxUtils.bind(this,function(d){if(mxEvent.isMouseEvent(d)){if(this.activeArrow!=null&&this.activeArrow!=b){mxUtils.setOpacity(this.activeArrow,this.inactiveOpacity)}this.graph.connectionHandler.constraintHandler.reset();mxUtils.setOpacity(b,100);this.activeArrow=b}}));mxEvent.addListener(b,"mouseleave",mxUtils.bind(this,function(d){if(!this.graph.isMouseDown){this.resetActiveArrow()}}));return b};HoverIcons.prototype.resetActiveArrow=function(){if(this.activeArrow!=null){mxUtils.setOpacity(this.activeArrow,this.inactiveOpacity);this.activeArrow=null}};HoverIcons.prototype.getDirection=function(){var a=mxConstants.DIRECTION_EAST;if(this.activeArrow==this.arrowUp){a=mxConstants.DIRECTION_NORTH}else{if(this.activeArrow==this.arrowDown){a=mxConstants.DIRECTION_SOUTH}else{if(this.activeArrow==this.arrowLeft){a=mxConstants.DIRECTION_WEST}}}return a};HoverIcons.prototype.visitNodes=function(b){for(var a=0;a<this.elts.length;a++){if(this.elts[a]!=null){b(this.elts[a])}}};HoverIcons.prototype.removeNodes=function(){this.visitNodes(function(a){if(a.parentNode!=null){a.parentNode.removeChild(a)}})};HoverIcons.prototype.setDisplay=function(a){this.visitNodes(function(b){b.style.display=a})};HoverIcons.prototype.isActive=function(){return this.activeArrow!=null&&this.currentState!=null};HoverIcons.prototype.drag=function(b,a,d){this.graph.popupMenuHandler.hideMenu();this.graph.stopEditing(false);if(this.currentState!=null){this.graph.connectionHandler.start(this.currentState,a,d);this.graph.isMouseTrigger=mxEvent.isMouseEvent(b);this.graph.isMouseDown=true;var c=this.graph.selectionCellsHandler.getHandler(this.currentState.cell);if(c!=null){c.setHandlesVisible(false)}}};HoverIcons.prototype.click=function(g,d,f){var b=f.getEvent();var a=f.getGraphX();var h=f.getGraphY();var e=this.graph.view.getState(this.graph.getCellAt(a,h));if(e!=null&&this.graph.model.isEdge(e.cell)&&!mxEvent.isControlDown(b)&&(e.getVisibleTerminalState(true)==g||e.getVisibleTerminalState(false)==g)){this.graph.setSelectionCell(e.cell);this.reset()}else{if(g!=null){var c=this.graph.connectVertex(g.cell,d,this.graph.defaultEdgeLength,b);this.graph.selectCellsForConnectVertex(c,b,this);if(c.length==2&&this.graph.model.isVertex(c[1])){this.graph.setSelectionCell(c[1]);if(mxEvent.isTouchEvent(b)){this.update(this.getState(this.graph.view.getState(c[1])))}else{this.reset()}this.graph.scrollCellToVisible(c[1])}else{this.graph.setSelectionCells(c)}}}f.consume()};HoverIcons.prototype.reset=function(a){a=(a==null)?true:a;if(a&&this.updateThread!=null){window.clearTimeout(this.updateThread)}this.mouseDownPoint=null;this.currentState=null;this.activeArrow=null;this.removeNodes();this.bbox=null};HoverIcons.prototype.repaint=function(){this.bbox=null;if(this.currentState!=null){this.currentState=this.getState(this.currentState);if(this.currentState!=null&&this.graph.model.isVertex(this.currentState.cell)&&this.graph.isCellConnectable(this.currentState.cell)){var a=mxRectangle.fromRectangle(this.currentState);if(this.currentState.shape!=null&&this.currentState.shape.boundingBox!=null){a=mxRectangle.fromRectangle(this.currentState.shape.boundingBox)}a.grow(this.graph.tolerance);a.grow(this.arrowSpacing);var d=this.graph.selectionCellsHandler.getHandler(this.currentState.cell);if(d!=null){a.x-=d.horizontalOffset/2;a.y-=d.verticalOffset/2;a.width+=d.horizontalOffset;a.height+=d.verticalOffset;if(d.rotationShape!=null&&d.rotationShape.node!=null&&d.rotationShape.node.style.visibility!="hidden"&&d.rotationShape.node.style.display!="none"&&d.rotationShape.boundingBox!=null){a.add(d.rotationShape.boundingBox)}}this.arrowUp.style.left=Math.round(this.currentState.getCenterX()-this.triangleUp.width/2)+"px";this.arrowUp.style.top=Math.round(a.y-this.triangleUp.height)+"px";mxUtils.setOpacity(this.arrowUp,this.inactiveOpacity);this.arrowRight.style.left=Math.round(a.x+a.width)+"px";this.arrowRight.style.top=Math.round(this.currentState.getCenterY()-this.triangleRight.height/2)+"px";mxUtils.setOpacity(this.arrowRight,this.inactiveOpacity);this.arrowDown.style.left=this.arrowUp.style.left;this.arrowDown.style.top=Math.round(a.y+a.height)+"px";mxUtils.setOpacity(this.arrowDown,this.inactiveOpacity);this.arrowLeft.style.left=Math.round(a.x-this.triangleLeft.width)+"px";this.arrowLeft.style.top=this.arrowRight.style.top;mxUtils.setOpacity(this.arrowLeft,this.inactiveOpacity);if(this.checkCollisions){var c=this.graph.getCellAt(a.x+a.width+this.triangleRight.width/2,this.currentState.getCenterY());var f=this.graph.getCellAt(a.x-this.triangleLeft.width/2,this.currentState.getCenterY());var e=this.graph.getCellAt(this.currentState.getCenterX(),a.y-this.triangleUp.height/2);var b=this.graph.getCellAt(this.currentState.getCenterX(),a.y+a.height+this.triangleDown.height/2);if(c!=null&&c==f&&f==e&&e==b){c=null;f=null;e=null;b=null}if(c!=null&&!this.graph.model.isAncestor(c,this.currentState.cell)){this.arrowRight.style.visibility="hidden"}else{this.arrowRight.style.visibility="visible"}if(f!=null&&!this.graph.model.isAncestor(f,this.currentState.cell)){this.arrowLeft.style.visibility="hidden"}else{this.arrowLeft.style.visibility="visible"}if(e!=null&&!this.graph.model.isAncestor(e,this.currentState.cell)){this.arrowUp.style.visibility="hidden"}else{this.arrowUp.style.visibility="visible"}if(b!=null&&!this.graph.model.isAncestor(b,this.currentState.cell)){this.arrowDown.style.visibility="hidden"}else{this.arrowDown.style.visibility="visible"}}else{this.arrowLeft.style.visibility="visible";this.arrowRight.style.visibility="visible";this.arrowUp.style.visibility="visible";this.arrowDown.style.visibility="visible"}if(this.graph.tooltipHandler.isEnabled()){this.arrowLeft.setAttribute("title",mxResources.get("plusTooltip"));this.arrowRight.setAttribute("title",mxResources.get("plusTooltip"));this.arrowUp.setAttribute("title",mxResources.get("plusTooltip"));this.arrowDown.setAttribute("title",mxResources.get("plusTooltip"))}else{this.arrowLeft.removeAttribute("title");this.arrowRight.removeAttribute("title");this.arrowUp.removeAttribute("title");this.arrowDown.removeAttribute("title")}}else{this.reset()}if(this.currentState!=null){this.bbox=this.computeBoundingBox();if(this.bbox!=null){this.bbox.grow(10)}}}};HoverIcons.prototype.computeBoundingBox=function(){var a=(!this.graph.model.isEdge(this.currentState.cell))?mxRectangle.fromRectangle(this.currentState):null;this.visitNodes(function(b){if(b.parentNode!=null){var c=new mxRectangle(b.offsetLeft,b.offsetTop,b.offsetWidth,b.offsetHeight);if(a==null){a=c}else{a.add(c)}}});return a};HoverIcons.prototype.getState=function(c){if(c!=null){var a=c.cell;if(this.graph.getModel().isVertex(a)&&!this.graph.isCellConnectable(a)){var b=this.graph.getModel().getParent(a);if(this.graph.getModel().isVertex(b)&&this.graph.isCellConnectable(b)){a=b}}if(this.graph.isCellLocked(a)||this.graph.model.isEdge(a)){a=null}c=this.graph.view.getState(a)}return c};HoverIcons.prototype.update=function(c,a,d){if(!this.graph.connectionArrowsEnabled){this.reset()}else{var b=null;if(this.prev!=c||this.isActive()){this.startTime=new Date().getTime();this.prev=c;b=0;if(this.updateThread!=null){window.clearTimeout(this.updateThread)}if(c!=null){this.updateThread=window.setTimeout(mxUtils.bind(this,function(){if(!this.isActive()&&!this.graph.isMouseDown&&!this.graph.panningHandler.isActive()){this.prev=c;this.update(c,a,d)}}),this.updateDelay+10)}}else{if(this.startTime!=null){b=new Date().getTime()-this.startTime}}this.setDisplay("");if(this.currentState!=null&&this.currentState!=c&&b<this.activationDelay&&this.bbox!=null&&!mxUtils.contains(this.bbox,a,d)){this.reset(false)}else{if(this.currentState!=null||b>this.activationDelay){if(this.currentState!=c&&((b>this.updateDelay&&c!=null)||this.bbox==null||a==null||d==null||!mxUtils.contains(this.bbox,a,d))){if(c!=null&&this.graph.isEnabled()){this.removeNodes();this.setCurrentState(c);this.repaint();if(this.graph.connectionHandler.constraintHandler.currentFocus!=c){this.graph.connectionHandler.constraintHandler.reset()}}else{this.reset()}}}}}};HoverIcons.prototype.setCurrentState=function(a){if(a.style.portConstraint!="eastwest"){this.graph.container.appendChild(this.arrowUp);this.graph.container.appendChild(this.arrowDown)}this.graph.container.appendChild(this.arrowRight);this.graph.container.appendChild(this.arrowLeft);this.currentState=a};(function(){var a=mxGraphView.prototype.updateFloatingTerminalPoint;mxGraphView.prototype.updateFloatingTerminalPoint=function(k,j,g,p){if(j!=null&&k!=null&&(j.style.snapToPoint=="1"||k.style.snapToPoint=="1")){j=this.getTerminalPort(k,j,p);var m=this.getNextPoint(k,g,p);var t=this.graph.isOrthogonal(k);var h=mxUtils.toRadians(Number(j.style[mxConstants.STYLE_ROTATION]||"0"));var v=new mxPoint(j.getCenterX(),j.getCenterY());if(h!=0){var e=Math.cos(-h);var d=Math.sin(-h);m=mxUtils.getRotatedPoint(m,e,d,v)}var q=parseFloat(k.style[mxConstants.STYLE_PERIMETER_SPACING]||0);q+=parseFloat(k.style[(p)?mxConstants.STYLE_SOURCE_PERIMETER_SPACING:mxConstants.STYLE_TARGET_PERIMETER_SPACING]||0);var n=this.getPerimeterPoint(j,m,h==0&&t,q);if(h!=0){var e=Math.cos(h);var d=Math.sin(h);n=mxUtils.getRotatedPoint(n,e,d,v)}if(j!=null){var r=this.graph.getAllConnectionConstraints(j);var f=null;var o=null;for(var s=0;s<r.length;s++){var l=this.graph.getConnectionPoint(j,r[s]);if(l!=null){var u=(l.x-n.x)*(l.x-n.x)+(l.y-n.y)*(l.y-n.y);if(o==null||u<o){f=l;o=u}}}if(f!=null){n=f}}k.setAbsoluteTerminalPoint(n,p)}else{a.apply(this,arguments)}};var c=mxStencil.prototype.evaluateTextAttribute;mxStencil.prototype.evaluateTextAttribute=function(h,g,f){var d=c.apply(this,arguments);var e=h.getAttribute("placeholders");if(e=="1"&&f.state!=null){d=f.state.view.graph.replacePlaceholders(f.state.cell,d)}return d};var b=mxCellRenderer.prototype.createShape;mxCellRenderer.prototype.createShape=function(g){if(g.style!=null&&typeof(pako)!=="undefined"){var d=mxUtils.getValue(g.style,mxConstants.STYLE_SHAPE,null);if(d!=null&&d.substring(0,8)=="stencil("){try{var f=d.substring(8,d.length-1);var i=mxUtils.parseXml(g.view.graph.decompress(f));return new mxShape(new mxStencil(i.documentElement))}catch(h){if(window.console!=null){console.log("Error in shape: "+h)}}}}return b.apply(this,arguments)}})();mxStencilRegistry.libraries={};mxStencilRegistry.dynamicLoading=true;mxStencilRegistry.packages=[];mxStencilRegistry.getStencil=function(name){var result=mxStencilRegistry.stencils[name];if(result==null&&mxCellRenderer.prototype.defaultShapes[name]==null&&mxStencilRegistry.dynamicLoading){var basename=mxStencilRegistry.getBasenameForStencil(name);if(basename!=null){var libs=mxStencilRegistry.libraries[basename];if(libs!=null){if(mxStencilRegistry.packages[basename]==null){mxStencilRegistry.packages[basename]=1;for(var i=0;i<libs.length;i++){var fname=libs[i];if(fname.toLowerCase().substring(fname.length-4,fname.length)==".xml"){mxStencilRegistry.loadStencilSet(fname,null)}else{if(fname.toLowerCase().substring(fname.length-3,fname.length)==".js"){try{var req=mxUtils.load(fname);if(req!=null&&req.getStatus()>=200&&req.getStatus()<=299){eval.call(window,req.getText())}}catch(e){if(window.console!=null){console.log("error in getStencil:",fname,e)}}}else{}}}}}else{basename=basename.replace("_-_","_");mxStencilRegistry.loadStencilSet(STENCIL_PATH+"/"+basename+".xml",null)}result=mxStencilRegistry.stencils[name]}}return result};mxStencilRegistry.getBasenameForStencil=function(a){var c=null;if(a!=null){var d=a.split(".");if(d.length>0&&d[0]=="mxgraph"){c=d[1];for(var b=2;b<d.length-1;b++){c+="/"+d[b]}}}return c};mxStencilRegistry.loadStencilSet=function(a,c,h,b){h=(h!=null)?h:false;var g=mxStencilRegistry.packages[a];if(h||g==null){var f=false;if(g==null){try{if(b){var d=mxUtils.get(a,mxUtils.bind(this,function(e){if(e.getStatus()>=200&&e.getStatus()<=299){g=e.getXml();mxStencilRegistry.packages[a]=g;f=true;if(g!=null&&g.documentElement!=null){mxStencilRegistry.parseStencilSet(g.documentElement,c,f)}}}));return}else{var d=mxUtils.load(a);g=d.getXml();mxStencilRegistry.packages[a]=g;f=true}}catch(i){if(window.console!=null){console.log("error in loadStencilSet:",a,i)}}}if(g!=null&&g.documentElement!=null){mxStencilRegistry.parseStencilSet(g.documentElement,c,f)}}};mxStencilRegistry.parseStencilSets=function(b){for(var a=0;a<b.length;a++){mxStencilRegistry.parseStencilSet(mxUtils.parseXml(b[a]).documentElement)}};mxStencilRegistry.parseStencilSet=function(j,e,d){if(j.nodeName=="stencils"){var c=j.firstChild;while(c!=null){if(c.nodeName=="shapes"){mxStencilRegistry.parseStencilSet(c,e,d)}c=c.nextSibling}}else{d=(d!=null)?d:true;var i=j.firstChild;var a="";var b=j.getAttribute("name");if(b!=null){a=b+"."}while(i!=null){if(i.nodeType==mxConstants.NODETYPE_ELEMENT){b=i.getAttribute("name");if(b!=null){a=a.toLowerCase();var f=b.replace(/ /g,"_");if(d){mxStencilRegistry.addStencil(a+f.toLowerCase(),new mxStencil(i))}if(e!=null){var k=i.getAttribute("w");var g=i.getAttribute("h");k=(k==null)?80:parseInt(k,10);g=(g==null)?80:parseInt(g,10);e(a,f,b,k,g)}}}i=i.nextSibling}}};if(typeof mxVertexHandler!="undefined"){(function(){mxConstants.HANDLE_FILLCOLOR="#99ccff";mxConstants.HANDLE_STROKECOLOR="#0088cf";mxConstants.VERTEX_SELECTION_COLOR="#00a8ff";mxConstants.OUTLINE_COLOR="#00a8ff";mxConstants.OUTLINE_HANDLE_FILLCOLOR="#99ccff";mxConstants.OUTLINE_HANDLE_STROKECOLOR="#00a8ff";mxConstants.CONNECT_HANDLE_FILLCOLOR="#cee7ff";mxConstants.EDGE_SELECTION_COLOR="#00a8ff";mxConstants.DEFAULT_VALID_COLOR="#00a8ff";mxConstants.LABEL_HANDLE_FILLCOLOR="#cee7ff";mxConstants.GUIDE_COLOR="#0088cf";mxConstants.HIGHLIGHT_OPACITY=30;mxConstants.HIGHLIGHT_SIZE=8;mxEdgeHandler.prototype.snapToTerminals=true;mxGraphHandler.prototype.guidesEnabled=true;mxGuide.prototype.isEnabledForEvent=function(I){return !mxEvent.isAltDown(I)};var b=mxConnectionHandler.prototype.isCreateTarget;mxConnectionHandler.prototype.isCreateTarget=function(I){return mxEvent.isControlDown(I)||b.apply(this,arguments)};mxConstraintHandler.prototype.createHighlightShape=function(){var I=new mxEllipse(null,this.highlightColor,this.highlightColor,0);I.opacity=mxConstants.HIGHLIGHT_OPACITY;return I};mxConnectionHandler.prototype.livePreview=true;mxConnectionHandler.prototype.cursor="crosshair";mxConnectionHandler.prototype.createEdgeState=function(L){var J=this.graph.createCurrentEdgeStyle();var K=this.graph.createEdge(null,null,null,null,null,J);var M=new mxCellState(this.graph.view,K,this.graph.getCellStyle(K));for(var I in this.graph.currentEdgeStyle){M.style[I]=this.graph.currentEdgeStyle[I]}return M};var j=mxConnectionHandler.prototype.createShape;mxConnectionHandler.prototype.createShape=function(){var I=j.apply(this,arguments);I.isDashed=this.graph.currentEdgeStyle[mxConstants.STYLE_DASHED]=="1";return I};mxConnectionHandler.prototype.updatePreview=function(I){};var t=mxConnectionHandler.prototype.createMarker;mxConnectionHandler.prototype.createMarker=function(){var I=t.apply(this,arguments);var J=I.getCell;I.getCell=mxUtils.bind(this,function(L){var K=J.apply(this,arguments);this.error=null;return K});return I};Graph.prototype.defaultEdgeStyle={edgeStyle:"orthogonalEdgeStyle",rounded:"0",html:"1",jettySize:"auto",orthogonalLoop:"1"};Graph.prototype.currentEdgeStyle=Graph.prototype.defaultEdgeStyle;Graph.prototype.currentVertexStyle={};Graph.prototype.createCurrentEdgeStyle=function(){var I="edgeStyle="+(this.currentEdgeStyle.edgeStyle||"none")+";";if(this.currentEdgeStyle.shape!=null){I+="shape="+this.currentEdgeStyle.shape+";"}if(this.currentEdgeStyle.curved!=null){I+="curved="+this.currentEdgeStyle.curved+";"}if(this.currentEdgeStyle.rounded!=null){I+="rounded="+this.currentEdgeStyle.rounded+";"}if(this.currentEdgeStyle.comic!=null){I+="comic="+this.currentEdgeStyle.comic+";"}if(this.currentEdgeStyle.edgeStyle=="elbowEdgeStyle"&&this.currentEdgeStyle.elbow!=null){I+="elbow="+this.currentEdgeStyle.elbow+";"}if(this.currentEdgeStyle.html!=null){I+="html="+this.currentEdgeStyle.html+";"}else{I+="html=1;"}return I};Graph.prototype.getPagePadding=function(){return new mxPoint(0,0)};Graph.prototype.loadStylesheet=function(){var I=(this.themes!=null)?this.themes[this.defaultThemeName]:(!mxStyleRegistry.dynamicLoading)?null:mxUtils.load(STYLE_PATH+"/default.xml").getDocumentElement();if(I!=null){var J=new mxCodec(I.ownerDocument);J.decode(I,this.getStylesheet())}};Graph.prototype.getAllConnectionConstraints=function(L,M){if(L!=null){var P=mxUtils.getValue(L.style,"points",null);if(P!=null){var I=[];try{var O=JSON.parse(P);for(var K=0;K<O.length;K++){var J=O[K];I.push(new mxConnectionConstraint(new mxPoint(J[0],J[1]),(J.length>2)?J[2]!="0":true))}}catch(N){}return I}else{if(L.shape!=null){if(L.shape.stencil!=null){if(L.shape.stencil!=null){return L.shape.stencil.constraints}}else{if(L.shape.constraints!=null){return L.shape.constraints}}}}}return null};Graph.prototype.flipEdge=function(K){if(K!=null){var M=this.view.getState(K);var J=(M!=null)?M.style:this.getCellStyle(K);if(J!=null){var I=mxUtils.getValue(J,mxConstants.STYLE_ELBOW,mxConstants.ELBOW_HORIZONTAL);var L=(I==mxConstants.ELBOW_HORIZONTAL)?mxConstants.ELBOW_VERTICAL:mxConstants.ELBOW_HORIZONTAL;this.setCellStyles(mxConstants.STYLE_ELBOW,L,[K])}}};Graph.prototype.isValidRoot=function(I){var J=this.model.getChildCount(I);var L=0;for(var K=0;K<J;K++){var N=this.model.getChildAt(I,K);if(this.model.isVertex(N)){var M=this.getCellGeometry(N);if(M!=null&&!M.relative){L++}}}return L>0||this.isContainer(I)};Graph.prototype.isValidDropTarget=function(I){var K=this.view.getState(I);var J=(K!=null)?K.style:this.getCellStyle(I);return mxUtils.getValue(J,"part","0")!="1"&&(this.isContainer(I)||(mxGraph.prototype.isValidDropTarget.apply(this,arguments)&&mxUtils.getValue(J,"dropTarget","1")!="0"))};Graph.prototype.createGroupCell=function(){var I=mxGraph.prototype.createGroupCell.apply(this,arguments);I.setStyle("group");return I};Graph.prototype.isExtendParentsOnAdd=function(J){var I=mxGraph.prototype.isExtendParentsOnAdd.apply(this,arguments);if(I&&J!=null&&this.layoutManager!=null){var K=this.model.getParent(J);if(K!=null){var L=this.layoutManager.getLayout(K);if(L!=null&&L.constructor==mxStackLayout){I=false}}}return I};Graph.prototype.getPreferredSizeForCell=function(J){var I=mxGraph.prototype.getPreferredSizeForCell.apply(this,arguments);if(I!=null){I.width+=10;I.height+=4;if(this.gridEnabled){I.width=this.snap(I.width);I.height=this.snap(I.height)}}return I};Graph.prototype.turnShapes=function(M){var N=this.getModel();var S=[];N.beginUpdate();try{for(var U=0;U<M.length;U++){var J=M[U];if(N.isEdge(J)){var P=N.getTerminal(J,true);var W=N.getTerminal(J,false);N.setTerminal(J,W,true);N.setTerminal(J,P,false);var Z=N.getGeometry(J);if(Z!=null){Z=Z.clone();if(Z.points!=null){Z.points.reverse()}var V=Z.getTerminalPoint(true);var K=Z.getTerminalPoint(false);Z.setTerminalPoint(V,false);Z.setTerminalPoint(K,true);N.setGeometry(J,Z);var T=this.view.getState(J);var L=this.view.getState(P);var X=this.view.getState(W);if(T!=null){var I=(L!=null)?this.getConnectionConstraint(T,L,true):null;var Q=(X!=null)?this.getConnectionConstraint(T,X,false):null;this.setConnectionConstraint(J,P,true,Q);this.setConnectionConstraint(J,W,false,I)}S.push(J)}}else{if(N.isVertex(J)){var Z=this.getCellGeometry(J);if(Z!=null){Z=Z.clone();Z.x+=Z.width/2-Z.height/2;Z.y+=Z.height/2-Z.width/2;var Y=Z.width;Z.width=Z.height;Z.height=Y;N.setGeometry(J,Z);var O=this.view.getState(J);if(O!=null){var R=O.style[mxConstants.STYLE_DIRECTION]||"east";if(R=="east"){R="south"}else{if(R=="south"){R="west"}else{if(R=="west"){R="north"}else{if(R=="north"){R="east"}}}}this.setCellStyles(mxConstants.STYLE_DIRECTION,R,[J])}S.push(J)}}}}}finally{N.endUpdate()}return S};Graph.prototype.processChange=function(K){mxGraph.prototype.processChange.apply(this,arguments);if(K instanceof mxValueChange&&K.cell.value!=null&&typeof(K.cell.value)=="object"){var J=this.model.getDescendants(K.cell);if(J.length>0){for(var I=0;I<J.length;I++){if(this.isReplacePlaceholders(J[I])){this.view.invalidate(J[I],false,false)}}}}};Graph.prototype.cellLabelChanged=function(J,M,I){M=this.zapGremlins(M);this.model.beginUpdate();try{if(J.value!=null&&typeof J.value=="object"){if(this.isReplacePlaceholders(J)&&J.getAttribute("placeholder")!=null){var K=J.getAttribute("placeholder");var N=J;while(N!=null){if(N==this.model.getRoot()||(N.value!=null&&typeof(N.value)=="object"&&N.hasAttribute(K))){this.setAttributeForCell(N,K,M);break}N=this.model.getParent(N)}}var L=J.value.cloneNode(true);L.setAttribute("label",M);M=L}mxGraph.prototype.cellLabelChanged.apply(this,arguments)}finally{this.model.endUpdate()}};Graph.prototype.removeCellsAfterUngroup=function(I){var K=[];for(var J=0;J<I.length;J++){if(this.isCellDeletable(I[J])){var L=this.view.getState(I[J]);if(L!=null){var N=mxUtils.getValue(L.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE);var M=mxUtils.getValue(L.style,mxConstants.STYLE_FILLCOLOR,mxConstants.NONE);if(N==mxConstants.NONE&&M==mxConstants.NONE){K.push(I[J])}}}}I=K;mxGraph.prototype.removeCellsAfterUngroup.apply(this,arguments)};Graph.prototype.setLinkForCell=function(I,J){this.setAttributeForCell(I,"link",J)};Graph.prototype.setTooltipForCell=function(I,J){this.setAttributeForCell(I,"tooltip",J)};Graph.prototype.setAttributeForCell=function(I,J,K){var L=null;if(I.value!=null&&typeof(I.value)=="object"){L=I.value.cloneNode(true)}else{var M=mxUtils.createXmlDocument();L=M.createElement("UserObject");L.setAttribute("label",I.value||"")}if(K!=null&&K.length>0){L.setAttribute(J,K)}else{L.removeAttribute(J)}this.model.setValue(I,L)};Graph.prototype.getDropTarget=function(L,J,I,N){var K=this.getModel();if(mxEvent.isAltDown(J)){return null}for(var M=0;M<L.length;M++){if(this.model.isEdge(this.model.getParent(L[M]))){return null}}return mxGraph.prototype.getDropTarget.apply(this,arguments)};Graph.prototype.click=function(I){mxGraph.prototype.click.call(this,I);this.firstClickState=I.getState();this.firstClickSource=I.getSource()};Graph.prototype.dblClick=function(J,I){if(this.isEnabled()){var L=mxUtils.convertPoint(this.container,mxEvent.getClientX(J),mxEvent.getClientY(J));if(J!=null&&!this.model.isVertex(I)){var K=(this.model.isEdge(I))?this.view.getState(I):null;var M=mxEvent.getSource(J);if(this.firstClickState==K&&this.firstClickSource==M){if(K==null||(K.text==null||K.text.node==null||(!mxUtils.contains(K.text.boundingBox,L.x,L.y)&&!mxUtils.isAncestorNode(K.text.node,mxEvent.getSource(J))))){if((K==null&&!this.isCellLocked(this.getDefaultParent()))||(K!=null&&!this.isCellLocked(K.cell))){if(K!=null||(mxClient.IS_VML&&M==this.view.getCanvas())||(mxClient.IS_SVG&&M==this.view.getCanvas().ownerSVGElement)){I=this.addText(L.x,L.y,K)}}}}}mxGraph.prototype.dblClick.call(this,J,I)}};Graph.prototype.getInsertPoint=function(){var K=this.getGridSize();var J=this.container.scrollLeft/this.view.scale-this.view.translate.x;var I=this.container.scrollTop/this.view.scale-this.view.translate.y;if(this.pageVisible){var L=this.getPageLayout();var M=this.getPageSize();J=Math.max(J,L.x*M.width);I=Math.max(I,L.y*M.height)}return new mxPoint(this.snap(J+K),this.snap(I+K))};Graph.prototype.getFreeInsertPoint=function(){var K=this.view;var J=this.getGraphBounds();var L=this.getInsertPoint();var I=this.snap(Math.round(Math.max(L.x,J.x/K.scale-K.translate.x+((J.width==0)?this.gridSize:0))));var M=this.snap(Math.round(Math.max(L.y,(J.y+J.height)/K.scale-K.translate.y+((J.height==0)?1:2)*this.gridSize)));return new mxPoint(I,M)};Graph.prototype.isMouseInsertPoint=function(){return false};Graph.prototype.addText=function(I,O,L){var J=new mxCell();J.value="Text";J.style="text;html=1;resizable=0;points=[];";J.geometry=new mxGeometry(0,0,0,0);J.vertex=true;if(L!=null){J.style+="align=center;verticalAlign=middle;labelBackgroundColor=#ffffff;";J.geometry.relative=true;J.connectable=false;var M=this.view.getRelativePoint(L,I,O);J.geometry.x=Math.round(M.x*10000)/10000;J.geometry.y=Math.round(M.y);J.geometry.offset=new mxPoint(0,0);M=this.view.getPoint(L,J.geometry);var N=this.view.scale;J.geometry.offset=new mxPoint(Math.round((I-M.x)/N),Math.round((O-M.y)/N))}else{J.style+="autosize=1;align=left;verticalAlign=top;spacingTop=-4;";var K=this.view.translate;J.geometry.width=40;J.geometry.height=20;J.geometry.x=Math.round(I/this.view.scale)-K.x;J.geometry.y=Math.round(O/this.view.scale)-K.y}this.getModel().beginUpdate();try{this.addCells([J],(L!=null)?L.cell:null);this.fireEvent(new mxEventObject("textInserted","cells",[J]));this.autoSizeCell(J)}finally{this.getModel().endUpdate()}return J};Graph.prototype.getAbsoluteUrl=function(I){if(I!=null&&this.isRelativeUrl(I)){if(I.charAt(0)=="#"){I=this.baseUrl+I}else{if(I.charAt(0)=="/"){I=this.domainUrl+I}else{I=this.domainPathUrl+I}}}return I};Graph.prototype.isExternalProtocol=function(I){return I.substring(0,7)==="mailto:"};Graph.prototype.isBlankLink=function(I){return !this.isExternalProtocol(I)&&(this.linkPolicy==="blank"||(this.linkPolicy!=="self"&&!this.isRelativeUrl(I)&&I.substring(0,this.domainUrl.length)!==this.domainUrl))};Graph.prototype.isRelativeUrl=function(I){return I!=null&&!this.absoluteUrlPattern.test(I)&&I.substring(0,5)!=="data:"&&!this.isExternalProtocol(I)};Graph.prototype.addClickHandler=function(K,L,P){var I=mxUtils.bind(this,function(){var R=this.container.getElementsByTagName("a");if(R!=null){for(var S=0;S<R.length;S++){var Q=this.getAbsoluteUrl(R[S].getAttribute("href"));if(Q!=null){R[S].setAttribute("href",Q);if(L!=null){mxEvent.addListener(R[S],"click",L)}}}}});this.model.addListener(mxEvent.CHANGE,I);I();var O=this.container.style.cursor;var J=this.getTolerance();var M=this;var N={currentState:null,currentLink:null,highlight:(K!=null&&K!=""&&K!=mxConstants.NONE)?new mxCellHighlight(M,K,4):null,startX:0,startY:0,scrollLeft:0,scrollTop:0,updateCurrentState:function(R){var Q=M.view.getState(R.getCell());if(Q!=this.currentState){if(this.currentState!=null){this.clear()}this.currentState=Q;if(this.currentState!=null){this.activate(this.currentState)}}},mouseDown:function(Q,R){this.startX=R.getGraphX();this.startY=R.getGraphY();this.scrollLeft=M.container.scrollLeft;this.scrollTop=M.container.scrollTop;if(this.currentLink==null&&M.container.style.overflow=="auto"){M.container.style.cursor="move"}this.updateCurrentState(R)},mouseMove:function(S,T){if(M.isMouseDown){if(this.currentLink!=null){var R=Math.abs(this.startX-T.getGraphX());var Q=Math.abs(this.startY-T.getGraphY());if(R>J||Q>J){this.clear()}}}else{if(T.getSource().nodeName.toLowerCase()=="a"){this.clear()}else{if(this.currentState!=null&&(T.getState()==this.currentState||T.getState()==null)&&M.intersects(this.currentState,T.getGraphX(),T.getGraphY())){return}this.updateCurrentState(T)}}},mouseUp:function(Q,R){var S=R.getSource();if(S.nodeName.toLowerCase()!="a"&&!R.isConsumed()&&(R.getState()==null||!R.isSource(R.getState().control))&&(mxEvent.isLeftMouseButton(R.getEvent())||mxEvent.isTouchEvent(R.getEvent()))){if(this.currentLink!=null){var U=M.isBlankLink(this.currentLink);if(!U&&L!=null){L(R.getEvent())}var T=(U)?M.linkTarget:"_top";if(T=="_self"&&window!=window.top){window.location.href=this.currentLink}else{window.open(this.currentLink,T)}R.consume()}else{if(P!=null&&!R.isConsumed()&&(Math.abs(this.scrollLeft-M.container.scrollLeft)<J&&Math.abs(this.scrollTop-M.container.scrollTop)<J)&&(Math.abs(this.startX-R.getGraphX())<J&&Math.abs(this.startY-R.getGraphY())<J)){P(R.getEvent())}}}this.clear()},activate:function(Q){this.currentLink=M.getAbsoluteUrl(M.getLinkForCell(Q.cell));if(this.currentLink!=null){M.container.style.cursor="pointer";if(this.highlight!=null){this.highlight.highlight(Q)}}},clear:function(){if(M.container!=null){M.container.style.cursor=O}this.currentState=null;this.currentLink=null;if(this.highlight!=null){this.highlight.hide()}}};M.click=function(Q){};M.addMouseListener(N);mxEvent.addListener(document,"mouseleave",function(Q){N.clear()})};Graph.prototype.duplicateCells=function(Q,J){Q=(Q!=null)?Q:this.getSelectionCells();J=(J!=null)?J:true;Q=this.model.getTopmostCells(Q);var L=this.getModel();var R=this.gridSize;var N=[];L.beginUpdate();try{var O=this.cloneCells(Q,false);for(var K=0;K<Q.length;K++){var P=L.getParent(Q[K]);var I=this.moveCells([O[K]],R,R,false,P)[0];N.push(I);if(J){L.add(P,O[K])}else{var M=P.getIndex(Q[K]);L.add(P,O[K],M+1)}}}finally{L.endUpdate()}return N};Graph.prototype.insertImage=function(N,J,M){if(N!=null){var L=this.cellEditor.textarea.getElementsByTagName("img");var O=[];for(var K=0;K<L.length;K++){O.push(L[K])}document.execCommand("insertimage",false,N);var I=this.cellEditor.textarea.getElementsByTagName("img");if(I.length==O.length+1){for(var K=I.length-1;K>=0;K--){if(K==0||I[K]!=O[K-1]){I[K].setAttribute("width",J);I[K].setAttribute("height",M);break}}}}};Graph.prototype.insertLink=function(I){if(I.length==0){document.execCommand("unlink",false)}else{document.execCommand("createlink",false,mxUtils.trim(I))}};Graph.prototype.isCellResizable=function(J){var I=mxGraph.prototype.isCellResizable.apply(this,arguments);var L=this.view.getState(J);var K=(L!=null)?L.style:this.getCellStyle(J);return I||(mxUtils.getValue(K,mxConstants.STYLE_RESIZABLE,"1")!="0"&&K[mxConstants.STYLE_WHITE_SPACE]=="wrap")};Graph.prototype.distributeCells=function(J,U){if(U==null){U=this.getSelectionCells()}if(U!=null&&U.length>1){var R=[];var S=null;var L=null;for(var O=0;O<U.length;O++){if(this.getModel().isVertex(U[O])){var I=this.view.getState(U[O]);if(I!=null){var P=(J)?I.getCenterX():I.getCenterY();S=(S!=null)?Math.max(S,P):P;L=(L!=null)?Math.min(L,P):P;R.push(I)}}}if(R.length>2){R.sort(function(X,W){return(J)?X.x-W.x:X.y-W.y});var T=this.view.translate;var V=this.view.scale;L=L/V-((J)?T.x:T.y);S=S/V-((J)?T.x:T.y);this.getModel().beginUpdate();try{var K=(S-L)/(R.length-1);var Q=L;for(var O=1;O<R.length-1;O++){var N=this.view.getState(this.model.getParent(R[O].cell));var M=this.getCellGeometry(R[O].cell);Q+=K;if(M!=null&&N!=null){M=M.clone();if(J){M.x=Math.round(Q-M.width/2)-N.origin.x}else{M.y=Math.round(Q-M.height/2)-N.origin.y}this.getModel().setGeometry(R[O].cell,M)}}}finally{this.getModel().endUpdate()}}}return U};Graph.prototype.isCloneEvent=function(I){return(mxClient.IS_MAC&&mxEvent.isMetaDown(I))||mxEvent.isControlDown(I)};Graph.prototype.encodeCells=function(Q){var P=this.cloneCells(Q);var J=new mxDictionary();for(var L=0;L<Q.length;L++){J.put(Q[L],true)}for(var L=0;L<P.length;L++){var I=this.view.getState(Q[L]);if(I!=null){var K=this.getCellGeometry(P[L]);if(K!=null&&K.relative&&!this.model.isEdge(Q[L])&&!J.get(this.model.getParent(Q[L]))){K.relative=false;K.x=I.x/I.view.scale-I.view.translate.x;K.y=I.y/I.view.scale-I.view.translate.y}}}var N=new mxCodec();var M=new mxGraphModel();var O=M.getChildAt(M.getRoot(),0);for(var L=0;L<Q.length;L++){M.add(O,P[L])}return N.encode(M)};Graph.prototype.createSvgImageExport=function(){var I=new mxImageExport();I.getLinkForCellState=mxUtils.bind(this,function(K,J){return this.getLinkForCell(K.cell)});return I};Graph.prototype.getSvg=function(aa,ad,Y,N,ac,U,J){ad=(ad!=null)?ad:1;Y=(Y!=null)?Y:0;ac=(ac!=null)?ac:true;U=(U!=null)?U:true;J=(J!=null)?J:true;var P=(U||N)?this.getGraphBounds():this.getBoundingBox(this.getSelectionCells());if(P==null){throw Error(mxResources.get("drawingEmpty"))}var Z=this.view.scale;var T=mxUtils.createXmlDocument();var W=(T.createElementNS!=null)?T.createElementNS(mxConstants.NS_SVG,"svg"):T.createElement("svg");if(aa!=null){if(W.style!=null){W.style.backgroundColor=aa}else{W.setAttribute("style","background-color:"+aa)}}if(T.createElementNS==null){W.setAttribute("xmlns",mxConstants.NS_SVG);W.setAttribute("xmlns:xlink",mxConstants.NS_XLINK)}else{W.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",mxConstants.NS_XLINK)}var S=ad/Z;W.setAttribute("width",Math.max(1,Math.ceil(P.width*S)+2*Y)+"px");W.setAttribute("height",Math.max(1,Math.ceil(P.height*S)+2*Y)+"px");W.setAttribute("version","1.1");var V=W;if(ac){var Q=(T.createElementNS!=null)?T.createElementNS(mxConstants.NS_SVG,"g"):T.createElement("g");Q.setAttribute("transform","translate(0.5,0.5)");W.appendChild(Q);T.appendChild(W);V=Q}else{T.appendChild(W)}var X=this.createSvgCanvas(V);X.foOffset=(ac)?-0.5:0;X.textOffset=(ac)?-0.5:0;X.imageOffset=(ac)?-0.5:0;X.translate(Math.floor((Y/ad-P.x)/Z),Math.floor((Y/ad-P.y)/Z));var O=X.createAlternateContent;X.createAlternateContent=function(al,ao,am,aq,ai,ak,aj,an,ae,ap,ag,af,ar){var at=this.state;if(this.foAltText!=null&&(aq==0||(at.fontSize!=0&&ak.length<(aq*5)/at.fontSize))){var ah=this.createElement("text");ah.setAttribute("x",Math.round(aq/2));ah.setAttribute("y",Math.round((ai+at.fontSize)/2));ah.setAttribute("fill",at.fontColor||"black");ah.setAttribute("text-anchor","middle");ah.setAttribute("font-size",Math.round(at.fontSize)+"px");ah.setAttribute("font-family",at.fontFamily);if((at.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD){ah.setAttribute("font-weight","bold")}if((at.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC){ah.setAttribute("font-style","italic")}if((at.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE){ah.setAttribute("text-decoration","underline")}mxUtils.write(ah,ak);return ah}else{return O.apply(this,arguments)}};var M=this.backgroundImage;if(M!=null){var L=Z/ad;var K=this.view.translate;var ab=new mxRectangle(K.x*L,K.y*L,M.width*L,M.height*L);if(mxUtils.intersects(P,ab)){X.image(K.x,K.y,M.width,M.height,M.src,true)}}X.scale(S);X.textEnabled=J;var I=this.createSvgImageExport();var R=I.drawCellState;I.drawCellState=function(af,ae){if(U||af.view.graph.isCellSelected(af.cell)){R.apply(this,arguments)}};I.drawState(this.getView().getState(this.model.root),X);return W};Graph.prototype.createSvgCanvas=function(I){return new mxSvgCanvas2D(I)};Graph.prototype.getSelectedElement=function(){var J=null;if(window.getSelection){var K=window.getSelection();if(K.getRangeAt&&K.rangeCount){var I=K.getRangeAt(0);J=I.commonAncestorContainer}}else{if(document.selection){J=document.selection.createRange().parentElement()}}return J};Graph.prototype.getParentByName=function(K,J,I){while(K!=null){if(K.nodeName==J){return K}if(K==I){return null}K=K.parentNode}return K};Graph.prototype.selectNode=function(J){var L=null;if(window.getSelection){L=window.getSelection();if(L.getRangeAt&&L.rangeCount){var I=document.createRange();I.selectNode(J);L.removeAllRanges();L.addRange(I)}}else{if((L=document.selection)&&L.type!="Control"){var K=L.createRange();K.collapse(true);var I=L.createRange();I.setEndPoint("StartToStart",K);I.select()}}};Graph.prototype.insertRow=function(K,I){var L=K.tBodies[0];var M=(L.rows.length>0)?L.rows[0].cells.length:1;var N=L.insertRow(I);for(var J=0;J<M;J++){mxUtils.br(N.insertCell(-1))}return N.cells[0]};Graph.prototype.deleteRow=function(J,I){J.tBodies[0].deleteRow(I)};Graph.prototype.insertColumn=function(N,J){var P=N.tHead;if(P!=null){for(var L=0;L<P.rows.length;L++){var M=document.createElement("th");P.rows[L].appendChild(M);mxUtils.br(M)}}var O=N.tBodies[0];for(var K=0;K<O.rows.length;K++){var I=O.rows[K].insertCell(J);mxUtils.br(I)}return O.rows[0].cells[(J>=0)?J:O.rows[0].cells.length-1]};Graph.prototype.deleteColumn=function(K,I){if(I>=0){var M=K.tBodies[0];var L=M.rows;for(var J=0;J<L.length;J++){if(L[J].cells.length>I){L[J].deleteCell(I)}}}};Graph.prototype.pasteHtmlAtCaret=function(J){var M,I;if(window.getSelection){M=window.getSelection();if(M.getRangeAt&&M.rangeCount){I=M.getRangeAt(0);I.deleteContents();var K=document.createElement("div");K.innerHTML=J;var N=document.createDocumentFragment(),L;while((L=K.firstChild)){lastNode=N.appendChild(L)}I.insertNode(N)}}else{if((M=document.selection)&&M.type!="Control"){M.createRange().pasteHTML(J)}}};Graph.prototype.initTouch=function(){this.connectionHandler.marker.isEnabled=function(){return this.graph.connectionHandler.first!=null};this.addListener(mxEvent.START_EDITING,function(O,N){this.popupMenuHandler.hideMenu()});var M=this.updateMouseEvent;this.updateMouseEvent=function(O){O=M.apply(this,arguments);if(mxEvent.isTouchEvent(O.getEvent())&&O.getState()==null){var N=this.getCellAt(O.graphX,O.graphY);if(N!=null&&this.isSwimlane(N)&&this.hitsSwimlaneContent(N,O.graphX,O.graphY)){N=null}else{O.state=this.view.getState(N);if(O.state!=null&&O.state.shape!=null){this.container.style.cursor=O.state.shape.node.style.cursor}}}if(O.getState()==null&&this.isEnabled()){this.container.style.cursor="default"}return O};var L=false;var K=false;var I=false;var J=this.fireMouseEvent;this.fireMouseEvent=function(P,O,N){if(P==mxEvent.MOUSE_DOWN){O=this.updateMouseEvent(O);L=this.isCellSelected(O.getCell());K=this.isSelectionEmpty();I=this.popupMenuHandler.isMenuShowing()}J.apply(this,arguments)};this.popupMenuHandler.mouseUp=mxUtils.bind(this,function(N,O){this.popupMenuHandler.popupTrigger=!this.isEditing()&&this.isEnabled()&&(O.getState()==null||!O.isSource(O.getState().control))&&(this.popupMenuHandler.popupTrigger||(!I&&!mxEvent.isMouseEvent(O.getEvent())&&((K&&O.getCell()==null&&this.isSelectionEmpty())||(L&&this.isCellSelected(O.getCell())))));mxPopupMenuHandler.prototype.mouseUp.apply(this.popupMenuHandler,arguments)})};mxCellEditor.prototype.isContentEditing=function(){var I=this.graph.view.getState(this.editingCell);return I!=null&&I.style.html==1};mxCellEditor.prototype.saveSelection=function(){if(window.getSelection){sel=window.getSelection();if(sel.getRangeAt&&sel.rangeCount){var J=[];for(var K=0,I=sel.rangeCount;K<I;++K){J.push(sel.getRangeAt(K))}return J}}else{if(document.selection&&document.selection.createRange){return document.selection.createRange()}}return null};mxCellEditor.prototype.restoreSelection=function(K){try{if(K){if(window.getSelection){sel=window.getSelection();sel.removeAllRanges();for(var J=0,I=K.length;J<I;++J){sel.addRange(K[J])}}else{if(document.selection&&K.select){K.select()}}}}catch(L){}};var A=mxCellRenderer.prototype.initializeLabel;mxCellRenderer.prototype.initializeLabel=function(I){if(I.text!=null){I.text.replaceLinefeeds=mxUtils.getValue(I.style,"nl2Br","1")!="0"}A.apply(this,arguments)};var e=mxConstraintHandler.prototype.update;mxConstraintHandler.prototype.update=function(I,J){if(this.isKeepFocusEvent(I)||!mxEvent.isAltDown(I.getEvent())){e.apply(this,arguments)}else{this.reset()}};mxGuide.prototype.createGuideShape=function(J){var I=new mxPolyline([],mxConstants.GUIDE_COLOR,mxConstants.GUIDE_STROKEWIDTH);return I};mxCellEditor.prototype.escapeCancelsEditing=false;var E=mxCellEditor.prototype.startEditing;mxCellEditor.prototype.startEditing=function(I,J){E.apply(this,arguments);var L=this.graph.view.getState(I);if(L!=null&&L.style.html==1){this.textarea.className="mxCellEditor geContentEditable"}else{this.textarea.className="mxCellEditor mxPlainTextEditor"}this.codeViewMode=false;this.switchSelectionState=null;this.graph.setSelectionCell(I);var K=this.graph.getModel().getParent(I);var M=this.graph.getCellGeometry(I);if((this.graph.getModel().isEdge(K)&&M!=null&&M.relative)||this.graph.getModel().isEdge(I)){if(mxClient.IS_QUIRKS){this.textarea.style.border="gray dotted 1px"}else{if(mxClient.IS_IE||mxClient.IS_IE11||(mxClient.IS_FF&&mxClient.IS_WIN)){this.textarea.style.outline="gray dotted 1px"}else{this.textarea.style.outline=""}}}else{if(mxClient.IS_QUIRKS){this.textarea.style.outline="none";this.textarea.style.border=""}}};var u=mxCellEditor.prototype.installListeners;mxCellEditor.prototype.installListeners=function(K){u.apply(this,arguments);function I(M,O){O.originalNode=M;M=M.firstChild;var N=O.firstChild;while(M!=null&&N!=null){I(M,N);M=M.nextSibling;N=N.nextSibling}return O}function J(N,O){if(N!=null){if(O.originalNode!=N){L(N)}else{N=N.firstChild;O=O.firstChild;while(N!=null){var M=N.nextSibling;if(O==null){L(N)}else{J(N,O);O=O.nextSibling}N=M}}}}function L(N){var O=N.firstChild;while(O!=null){var M=O.nextSibling;L(O);O=M}if((N.nodeType!=1||(N.nodeName!=="BR"&&N.firstChild==null))&&(N.nodeType!=3||mxUtils.trim(mxUtils.getTextContent(N)).length==0)){N.parentNode.removeChild(N)}else{if(N.nodeType==3){mxUtils.setTextContent(N,mxUtils.getTextContent(N).replace(/\n|\r/g,""))}if(N.nodeType==1){N.removeAttribute("style");N.removeAttribute("class");N.removeAttribute("width");N.removeAttribute("cellpadding");N.removeAttribute("cellspacing");N.removeAttribute("border")}}}if(!mxClient.IS_QUIRKS&&document.documentMode!==7&&document.documentMode!==8){mxEvent.addListener(this.textarea,"paste",mxUtils.bind(this,function(M){var N=I(this.textarea,this.textarea.cloneNode(true));window.setTimeout(mxUtils.bind(this,function(){J(this.textarea,N)}),0)}))}};mxCellEditor.prototype.toggleViewMode=function(){var I=this.graph.view.getState(this.editingCell);var J=I!=null&&mxUtils.getValue(I.style,"nl2Br","1")!="0";var L=this.saveSelection();if(!this.codeViewMode){if(this.clearOnChange&&this.textarea.innerHTML==this.getEmptyLabelText()){this.clearOnChange=false;this.textarea.innerHTML=""}var O=mxUtils.htmlEntities(this.textarea.innerHTML);if(!mxClient.IS_QUIRKS&&document.documentMode!=8){O=mxUtils.replaceTrailingNewlines(O,"<div><br></div>")}O=this.graph.sanitizeHtml((J)?O.replace(/\n/g,"").replace(/&lt;br\s*.?&gt;/g,"<br>"):O,true);this.textarea.className="mxCellEditor mxPlainTextEditor";var R=mxConstants.DEFAULT_FONTSIZE;this.textarea.style.lineHeight=(mxConstants.ABSOLUTE_LINE_HEIGHT)?Math.round(R*mxConstants.LINE_HEIGHT)+"px":mxConstants.LINE_HEIGHT;this.textarea.style.fontSize=Math.round(R)+"px";this.textarea.style.textDecoration="";this.textarea.style.fontWeight="normal";this.textarea.style.fontStyle="";this.textarea.style.fontFamily=mxConstants.DEFAULT_FONTFAMILY;this.textarea.style.textAlign="left";this.textarea.style.padding="2px";if(this.textarea.innerHTML!=O){this.textarea.innerHTML=O}this.codeViewMode=true}else{var O=mxUtils.extractTextWithWhitespace(this.textarea.childNodes);if(O.length>0&&O.charAt(O.length-1)=="\n"){O=O.substring(0,O.length-1)}O=this.graph.sanitizeHtml((J)?O.replace(/\n/g,"<br/>"):O,true);this.textarea.className="mxCellEditor geContentEditable";var R=mxUtils.getValue(I.style,mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE);var K=mxUtils.getValue(I.style,mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY);var N=mxUtils.getValue(I.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT);var P=(mxUtils.getValue(I.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD;var M=(mxUtils.getValue(I.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC;var Q=(mxUtils.getValue(I.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE;this.textarea.style.lineHeight=(mxConstants.ABSOLUTE_LINE_HEIGHT)?Math.round(R*mxConstants.LINE_HEIGHT)+"px":mxConstants.LINE_HEIGHT;this.textarea.style.fontSize=Math.round(R)+"px";this.textarea.style.textDecoration=(Q)?"underline":"";this.textarea.style.fontWeight=(P)?"bold":"normal";this.textarea.style.fontStyle=(M)?"italic":"";this.textarea.style.fontFamily=K;this.textarea.style.textAlign=N;this.textarea.style.padding="0px";if(this.textarea.innerHTML!=O){this.textarea.innerHTML=O;if(this.textarea.innerHTML.length==0){this.textarea.innerHTML=this.getEmptyLabelText();this.clearOnChange=this.textarea.innerHTML.length>0}}this.codeViewMode=false}this.textarea.focus();if(this.switchSelectionState!=null){this.restoreSelection(this.switchSelectionState)}this.switchSelectionState=L;this.resize()};var d=mxCellEditor.prototype.resize;mxCellEditor.prototype.resize=function(K,J){if(this.textarea!=null){var K=this.graph.getView().getState(this.editingCell);if(this.codeViewMode&&K!=null){var L=K.view.scale;this.bounds=mxRectangle.fromRectangle(K);if(this.bounds.width==0&&this.bounds.height==0){this.bounds.width=160*L;this.bounds.height=60*L;var I=(K.text!=null)?K.text.margin:null;if(I==null){I=mxUtils.getAlignmentAsPoint(mxUtils.getValue(K.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER),mxUtils.getValue(K.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE))}this.bounds.x+=I.x*this.bounds.width;this.bounds.y+=I.y*this.bounds.height}this.textarea.style.width=Math.round((this.bounds.width-4)/L)+"px";this.textarea.style.height=Math.round((this.bounds.height-4)/L)+"px";this.textarea.style.overflow="auto";if(this.textarea.clientHeight<this.textarea.offsetHeight){this.textarea.style.height=Math.round((this.bounds.height/L))+(this.textarea.offsetHeight-this.textarea.clientHeight)+"px";this.bounds.height=parseInt(this.textarea.style.height)*L}if(this.textarea.clientWidth<this.textarea.offsetWidth){this.textarea.style.width=Math.round((this.bounds.width/L))+(this.textarea.offsetWidth-this.textarea.clientWidth)+"px";this.bounds.width=parseInt(this.textarea.style.width)*L}this.textarea.style.left=Math.round(this.bounds.x)+"px";this.textarea.style.top=Math.round(this.bounds.y)+"px";if(mxClient.IS_VML){this.textarea.style.zoom=L}else{mxUtils.setPrefixedStyle(this.textarea.style,"transform","scale("+L+","+L+")")}}else{this.textarea.style.height="";this.textarea.style.overflow="";d.apply(this,arguments)}}};mxCellEditorGetInitialValue=mxCellEditor.prototype.getInitialValue;mxCellEditor.prototype.getInitialValue=function(K,J){if(mxUtils.getValue(K.style,"html","0")=="0"){return mxCellEditorGetInitialValue.apply(this,arguments)}else{var I=this.graph.getEditingValue(K.cell,J);if(mxUtils.getValue(K.style,"nl2Br","1")=="1"){I=I.replace(/\n/g,"<br/>")}I=this.graph.sanitizeHtml(I,true);return I}};mxCellEditorGetCurrentValue=mxCellEditor.prototype.getCurrentValue;mxCellEditor.prototype.getCurrentValue=function(J){if(mxUtils.getValue(J.style,"html","0")=="0"){return mxCellEditorGetCurrentValue.apply(this,arguments)}else{var I=this.graph.sanitizeHtml(this.textarea.innerHTML,true);if(mxUtils.getValue(J.style,"nl2Br","1")=="1"){I=I.replace(/\r\n/g,"<br/>").replace(/\n/g,"<br/>")}else{I=I.replace(/\r\n/g,"").replace(/\n/g,"")}return I}};var G=mxCellEditor.prototype.stopEditing;mxCellEditor.prototype.stopEditing=function(I){if(this.codeViewMode){this.toggleViewMode()}G.apply(this,arguments);try{this.graph.container.focus()}catch(J){}};var m=mxCellEditor.prototype.applyValue;mxCellEditor.prototype.applyValue=function(J,I){this.graph.getModel().beginUpdate();try{m.apply(this,arguments);if(this.graph.isCellDeletable(J.cell)){var L=mxUtils.getValue(J.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE);var K=mxUtils.getValue(J.style,mxConstants.STYLE_FILLCOLOR,mxConstants.NONE);if(mxUtils.trim(I||"")==""&&L==mxConstants.NONE&&K==mxConstants.NONE){this.graph.removeCells([J.cell],false)}}}finally{this.graph.getModel().endUpdate()}};mxCellEditor.prototype.getBackgroundColor=function(J){var I=null;if(this.graph.getModel().isEdge(J.cell)||this.graph.getModel().isEdge(this.graph.getModel().getParent(J.cell))){var I=mxUtils.getValue(J.style,mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,null);if(I==mxConstants.NONE){I=null}}return I};mxCellEditor.prototype.getMinimumSize=function(I){var J=this.graph.getView().scale;return new mxRectangle(0,0,(I.text==null)?30:I.text.size*J+20,30)};var k=mxGraphHandler.prototype.moveCells;mxGraphHandler.prototype.moveCells=function(L,K,J,N,M,I){if(mxEvent.isAltDown(I)){M=null}k.apply(this,arguments)};function F(){var I=document.createElement("div");I.className="geHint";I.style.whiteSpace="nowrap";I.style.position="absolute";return I}mxGraphHandler.prototype.updateHint=function(L){if(this.shape!=null){if(this.hint==null){this.hint=F();this.graph.container.appendChild(this.hint)}var J=this.graph.view.translate;var K=this.graph.view.scale;var I=this.roundLength((this.bounds.x+this.currentDx)/K-J.x);var M=this.roundLength((this.bounds.y+this.currentDy)/K-J.y);this.hint.innerHTML=I+", "+M;this.hint.style.left=(this.shape.bounds.x+Math.round((this.shape.bounds.width-this.hint.clientWidth)/2))+"px";this.hint.style.top=(this.shape.bounds.y+this.shape.bounds.height+12)+"px"}};mxGraphHandler.prototype.removeHint=function(){if(this.hint!=null){this.hint.parentNode.removeChild(this.hint);this.hint=null}};mxVertexHandler.prototype.isRecursiveResize=function(J,I){return !this.graph.isSwimlane(J.cell)&&this.graph.model.getChildCount(J.cell)>0&&!mxEvent.isControlDown(I.getEvent())&&!this.graph.isCellCollapsed(J.cell)&&mxUtils.getValue(J.style,"recursiveResize","1")=="1"&&mxUtils.getValue(J.style,"childLayout",null)==null};mxVertexHandler.prototype.isCenteredEvent=function(J,I){return(!(!this.graph.isSwimlane(J.cell)&&this.graph.model.getChildCount(J.cell)>0&&!this.graph.isCellCollapsed(J.cell)&&mxUtils.getValue(J.style,"recursiveResize","1")=="1"&&mxUtils.getValue(J.style,"childLayout",null)==null)&&mxEvent.isControlDown(I.getEvent()))||mxEvent.isMetaDown(I.getEvent())};var w=mxVertexHandler.prototype.getHandlePadding;mxVertexHandler.prototype.getHandlePadding=function(){var I=new mxPoint(0,0);var J=this.tolerance;if(this.graph.cellEditor.getEditingCell()==this.state.cell&&this.sizers!=null&&this.sizers.length>0&&this.sizers[0]!=null){J/=2;I.x=this.sizers[0].bounds.width+J;I.y=this.sizers[0].bounds.height+J}else{I=w.apply(this,arguments)}return I};mxVertexHandler.prototype.updateHint=function(K){if(this.index!=mxEvent.LABEL_HANDLE){if(this.hint==null){this.hint=F();this.state.view.graph.container.appendChild(this.hint)}if(this.index==mxEvent.ROTATION_HANDLE){this.hint.innerHTML=this.currentAlpha+"&deg;"}else{var J=this.state.view.scale;this.hint.innerHTML=this.roundLength(this.bounds.width/J)+" x "+this.roundLength(this.bounds.height/J)}var I=(this.currentAlpha!=null)?this.currentAlpha:this.state.style[mxConstants.STYLE_ROTATION]||"0";var L=mxUtils.getBoundingBox(this.bounds,I);if(L==null){L=this.bounds}this.hint.style.left=L.x+Math.round((L.width-this.hint.clientWidth)/2)+"px";this.hint.style.top=(L.y+L.height+12)+"px"}};mxVertexHandler.prototype.removeHint=mxGraphHandler.prototype.removeHint;mxEdgeHandler.prototype.updateHint=function(M,J){if(this.hint==null){this.hint=F();this.state.view.graph.container.appendChild(this.hint)}var K=this.graph.view.translate;var L=this.graph.view.scale;var I=this.roundLength(J.x/L-K.x);var O=this.roundLength(J.y/L-K.y);this.hint.innerHTML=I+", "+O;this.hint.style.visibility="visible";if(this.isSource||this.isTarget){if(this.constraintHandler.currentConstraint!=null&&this.constraintHandler.currentFocus!=null){var N=this.constraintHandler.currentConstraint.point;this.hint.innerHTML="["+Math.round(N.x*100)+"%, "+Math.round(N.y*100)+"%]"}else{if(this.marker.hasValidState()){this.hint.style.visibility="hidden"}}}this.hint.style.left=Math.round(M.getGraphX()-this.hint.clientWidth/2)+"px";this.hint.style.top=(Math.max(M.getGraphY(),J.y)+this.state.view.graph.gridSize)+"px";if(this.hideEdgeHintThread!=null){window.clearTimeout(this.hideEdgeHintThread)}this.hideEdgeHintThread=window.setTimeout(mxUtils.bind(this,function(){if(this.hint!=null){this.hint.style.visibility="hidden"}}),500)};mxEdgeHandler.prototype.removeHint=mxGraphHandler.prototype.removeHint;HoverIcons.prototype.mainHandle=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABLUlEQVQ4y61US4rCQBBNeojiRrLSnbMOWWU3V1FPouARcgc9hyLOCSSbYZw5gRCIkM9KbevJaycS4zCOBY+iq6pf1y+xrNtiE6oEY/tVzMUXgSNoCJrUDu3qHpldutwSuIKOoEvt0m7I7DoCvNj2fb8XRdEojuN5lmVraJxhh59xFSLFF9phGL7lef6hRb63R73aHM8aAjv8JHJ47yqLlud5r0VRbHa51sPZQVuT/QU4ww4/4ljaJRubrC5SxouD6TWBQV/sEIkbs0eOIVGssSO1L5D6LQID+BHHZjdMSYpj7KZpun7/uk8CP5rNqTXLJP/OpNyTMWruP9CTP08nCILKdCp7gkCzJ8vPnz2BvW5PKhuLjJBykiQLaWIEjTP3o3Zjn/LtPO0rfvh/cgKu7z6wtPPltQAAAABJRU5ErkJggg==":IMAGE_PATH+"/handle-main.png",17,17);HoverIcons.prototype.fixedHandle=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkE1NkU4Njk2QjI1MTFFNEFDMjFGQTcyODkzNTc3NkYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkE1NkU4NkE2QjI1MTFFNEFDMjFGQTcyODkzNTc3NkYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2QTU2RTg2NzZCMjUxMUU0QUMyMUZBNzI4OTM1Nzc2RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2QTU2RTg2ODZCMjUxMUU0QUMyMUZBNzI4OTM1Nzc2RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pmuk6K8AAAGBSURBVHjarFRBSsNQEM3/atNs6qLowixcKELoqjuXoqfQeoF6BMEj9BCC1YIXcCGlV8hGLNZlBKWlCk1JSs13Xvw/nca6UDrwmMzMy8tk/iTCWmwi52Eq53+QeWwg2bXSSNi1WiRibgRWCTahwEQmhJgw1WJGML2BC6wQnEqlsuH7fr3f7zdHo9EdPGLkUdc8mX8TJNYIpUajsR+G4YMie3pNVKebpB6GPOrgab7kr5F24Hne9ng87r6HStUuP5V1Mc2AGHnUwWMdCck6sVut1onjOHtnt4nV7M0fAuI65VEnXk3PTFq5Eyi4rnvUe1PW9fO3QOdUzvkbyqNOvEM2dMEHK2zbLr98zJ5+cJWkAvDGUC8Wi2X28Gww6bnHcTzYWp+JGAHTCQz1KIoGfFckCyZBELR3N4V1vCOyTrhHHnXw9N5kQn8+nWq1Onc6C/cERLMn7cfZniD/257wbjDxEjqiDT0fDof3tLE+PGK9HyXNy7pYyrez9K/43/+TLwEGAMb7AY6w980DAAAAAElFTkSuQmCC":IMAGE_PATH+"/handle-fixed.png",17,17);HoverIcons.prototype.terminalHandle=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MEMzRUVERTk2NzU1MTFFNTg5NjNEMjREQ0FFNENFQzgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MEMzRUVERUE2NzU1MTFFNTg5NjNEMjREQ0FFNENFQzgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowQzNFRURFNzY3NTUxMUU1ODk2M0QyNERDQUU0Q0VDOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowQzNFRURFODY3NTUxMUU1ODk2M0QyNERDQUU0Q0VDOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poj8AGUAAAF6SURBVHjarFTBSsNAEM2u2jSXeCh6sAcPilB6ys2j6Fdo/YH6CYKf0I8QrBb8AQ9S+gu5iMV6jKC0VCEJTalZ54VNnMR4ULrwmJ2Zt5PZmdkIo3yJgsRSBfmDzPUUku2VRsz2qixIehBYJZiECgsyJ0SEhQ6WBkwO8AArBKvZbG64rtsej8dd3/fvIKHDDr/myeJNYFgj2J1OZz8IggdF6+k1VoNhnEgs2OEHT/Mlv0aSQaPR2A7DcPgeKNW6/FTGxSIDdNjhB49lJCTLxOz1eieWZe2d3cZGd5RvAvQ22eEnXkvXTBqFDlTq9frR6E0Z18+qtO83ZIefeIes6IIXVpimWXv5yB8cnMqcDn+1Wq2xj2eFSfoeRdFkaz0f5OAqzunwz2azCZ8VyZS553n93U1hHO+I0uvADj94em6yQH/ujuM4ue6UzgmI6Zz0H7/nBPbf5oRng4rbyIgm9Hw6nd7TxLqQ0PV82JqXZbGUt7P0V/zv/8mXAAMASSz1f9Cd7ycAAAAASUVORK5CYII=":IMAGE_PATH+"/handle-terminal.png",17,17);HoverIcons.prototype.secondaryHandle=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MEJBMUVERjNEMkZDMTFFM0I0Qzc5RkE1RTc2NjI0OUIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MEJBMUVERjREMkZDMTFFM0I0Qzc5RkE1RTc2NjI0OUIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowQkExRURGMUQyRkMxMUUzQjRDNzlGQTVFNzY2MjQ5QiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowQkExRURGMkQyRkMxMUUzQjRDNzlGQTVFNzY2MjQ5QiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvXDOj4AAAFqSURBVHjarFTNToNAEN5FLeiBmDRe7MGLF4IXbp71KapP4CPoO/QdvKiv4ME0PkAvJI2J0SueIHgAAk3b7XxkwSlgE38mmSwz8+3HsPMtUnSbbKww1VhbYB5XbrBnpX3JnlUXSbURvk1ukvcYyYy8IJ9rsoqw3MAJtsh3Xdc98H3/KgzDuyRJHrEiRh51jTOaX4LEDrk9Go1O0zR9UWTL9E0to+dyhSGPOnAab/DPKDtwHOcoy7LXz1SpxeRSzW9F7YiRRx041pGsSMC6Ty1f442LycUawRfRsOyIcDfA632ST6A3GAzOVfYu1PS+c+5q+iBQJ9wZO3TJD1aaptkX+YfYaFS3LKvPXl4fTDn3oigiYR1uJqF6nucR14rBglkQBGO5dyzkybBbxpRHHTitm5rox9PxPK81nZZOAKx1Eo5rnSD/nU54NzhxGx1hjHEcP5FifayItT5sjVvTyJ/vzr/f4l//T1YCDAC4VAdLL1OIRAAAAABJRU5ErkJggg==":IMAGE_PATH+"/handle-secondary.png",17,17);HoverIcons.prototype.rotationHandle=new mxImage((mxClient.IS_SVG)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAVCAYAAACkCdXRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAA6ZJREFUeNqM001IY1cUB/D/fYmm2sbR2lC1zYlgoRG6MpEyBlpxM9iFIGKFIm3s0lCKjOByhCLZCFqLBF1YFVJdSRbdFHRhBbULtRuFVBTzYRpJgo2mY5OX5N9Fo2TG+eiFA/dd3vvd8+65ByTxshARTdf1JySp6/oTEdFe9T5eg5lIcnBwkCSZyWS+exX40oyur68/KxaLf5Okw+H4X+A9JBaLfUySZ2dnnJqaosPhIAACeC34DJRKpb7IZrMcHx+nwWCgUopGo/EOKwf9fn/1CzERUevr6+9ls1mOjIwQAH0+H4PBIKPR6D2ofAQCgToRUeVYJUkuLy8TANfW1kiS8/PzCy84Mw4MDBAAZ2dnmc/nub+/X0MSEBF1cHDwMJVKsaGhgV6vl+l0mqOjo1+KyKfl1dze3l4NBoM/PZ+diFSLiIKIGBOJxA9bW1sEwNXVVSaTyQMRaRaRxrOzs+9J8ujoaE5EPhQRq67rcZ/PRwD0+/3Udf03EdEgIqZisZibnJykwWDg4eEhd3Z2xkXELCJvPpdBrYjUiEhL+Xo4HH4sIhUaAKNSqiIcDsNkMqG+vh6RSOQQQM7tdhsAQCkFAHC73UUATxcWFqypVApmsxnDw8OwWq2TADQNgAYAFosF+XweyWQSdru9BUBxcXFRB/4rEgDcPouIIx6P4+bmBi0tLSCpAzBqAIqnp6c/dnZ2IpfLYXNzE62traMADACKNputpr+/v8lms9UAKAAwiMjXe3t7KBQKqKurQy6Xi6K0i2l6evpROp1mbW0t29vbGY/Hb8/IVIqq2zlJXl1dsaOjg2azmefn5wwEAl+JSBVExCgi75PkzMwMlVJsbGxkIpFgPp8PX15ePopEIs3JZPITXdf/iEajbGpqolKKExMT1HWdHo/nIxGpgIgoEXnQ3d39kCTHxsYIgC6Xi3NzcwyHw8xkMozFYlxaWmJbWxuVUuzt7WUul6PX6/1cRN4WEe2uA0SkaWVl5XGpRVhdXU0A1DSNlZWVdz3qdDrZ09PDWCzG4+Pjn0XEWvp9KJKw2WwKwBsA3gHQHAqFfr24uMDGxgZ2d3cRiUQAAHa7HU6nE319fTg5Ofmlq6vrGwB/AngaCoWK6rbsNptNA1AJoA7Aux6Pp3NoaMhjsVg+QNmIRqO/u1yubwFEASRKUAEA7rASqABUAKgC8KAUb5XWCOAfAFcA/gJwDSB7C93DylCtdM8qABhLc5TumV6KQigUeubjfwcAHkQJ94ndWeYAAAAASUVORK5CYII=":IMAGE_PATH+"/handle-rotate.png",19,21);mxVertexHandler.prototype.handleImage=HoverIcons.prototype.mainHandle;mxVertexHandler.prototype.secondaryHandleImage=HoverIcons.prototype.secondaryHandle;mxEdgeHandler.prototype.handleImage=HoverIcons.prototype.mainHandle;mxEdgeHandler.prototype.terminalHandleImage=HoverIcons.prototype.terminalHandle;mxEdgeHandler.prototype.fixedHandleImage=HoverIcons.prototype.fixedHandle;mxEdgeHandler.prototype.labelHandleImage=HoverIcons.prototype.secondaryHandle;mxOutline.prototype.sizerImage=HoverIcons.prototype.mainHandle;if(window.Sidebar!=null){Sidebar.prototype.triangleUp=HoverIcons.prototype.triangleUp;Sidebar.prototype.triangleRight=HoverIcons.prototype.triangleRight;Sidebar.prototype.triangleDown=HoverIcons.prototype.triangleDown;Sidebar.prototype.triangleLeft=HoverIcons.prototype.triangleLeft;Sidebar.prototype.refreshTarget=HoverIcons.prototype.refreshTarget;Sidebar.prototype.roundDrop=HoverIcons.prototype.roundDrop}if(!mxClient.IS_SVG){new Image().src=HoverIcons.prototype.mainHandle.src;new Image().src=HoverIcons.prototype.fixedHandle.src;new Image().src=HoverIcons.prototype.terminalHandle.src;new Image().src=HoverIcons.prototype.secondaryHandle.src;new Image().src=HoverIcons.prototype.rotationHandle.src;new Image().src=HoverIcons.prototype.triangleUp.src;new Image().src=HoverIcons.prototype.triangleRight.src;new Image().src=HoverIcons.prototype.triangleDown.src;new Image().src=HoverIcons.prototype.triangleLeft.src;new Image().src=HoverIcons.prototype.refreshTarget.src;new Image().src=HoverIcons.prototype.roundDrop.src}mxVertexHandler.prototype.rotationEnabled=true;mxVertexHandler.prototype.manageSizers=true;mxVertexHandler.prototype.livePreview=true;mxRubberband.prototype.defaultOpacity=30;mxConnectionHandler.prototype.outlineConnect=true;mxCellHighlight.prototype.keepOnTop=true;mxVertexHandler.prototype.parentHighlightEnabled=true;mxVertexHandler.prototype.rotationHandleVSpacing=-20;mxEdgeHandler.prototype.parentHighlightEnabled=true;mxEdgeHandler.prototype.dblClickRemoveEnabled=true;mxEdgeHandler.prototype.straightRemoveEnabled=true;mxEdgeHandler.prototype.virtualBendsEnabled=true;mxEdgeHandler.prototype.mergeRemoveEnabled=true;mxEdgeHandler.prototype.manageLabelHandle=true;mxEdgeHandler.prototype.outlineConnect=true;mxEdgeHandler.prototype.isAddVirtualBendEvent=function(I){return !mxEvent.isShiftDown(I.getEvent())};mxEdgeHandler.prototype.isCustomHandleEvent=function(I){return !mxEvent.isShiftDown(I.getEvent())};if(Graph.touchStyle){if(mxClient.IS_TOUCH||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0){mxShape.prototype.svgStrokeTolerance=18;mxVertexHandler.prototype.tolerance=12;mxEdgeHandler.prototype.tolerance=12;Graph.prototype.tolerance=12;mxVertexHandler.prototype.rotationHandleVSpacing=-24;mxConstraintHandler.prototype.getTolerance=function(I){return(mxEvent.isMouseEvent(I.getEvent()))?4:this.graph.getTolerance()}}mxPanningHandler.prototype.isPanningTrigger=function(J){var I=J.getEvent();return(J.getState()==null&&!mxEvent.isMouseEvent(I))||(mxEvent.isPopupTrigger(I)&&(J.getState()==null||mxEvent.isControlDown(I)||mxEvent.isShiftDown(I)))};var q=mxGraphHandler.prototype.mouseDown;mxGraphHandler.prototype.mouseDown=function(I,J){q.apply(this,arguments);if(mxEvent.isTouchEvent(J.getEvent())&&this.graph.isCellSelected(J.getCell())&&this.graph.getSelectionCount()>1){this.delayedSelection=false}}}else{mxPanningHandler.prototype.isPanningTrigger=function(J){var I=J.getEvent();return(mxEvent.isLeftMouseButton(I)&&((this.useLeftButtonForPanning&&J.getState()==null)||(mxEvent.isControlDown(I)&&!mxEvent.isShiftDown(I))))||(this.usePopupTrigger&&mxEvent.isPopupTrigger(I))}}mxRubberband.prototype.isSpaceEvent=function(I){return this.graph.isEnabled()&&!this.graph.isCellLocked(this.graph.getDefaultParent())&&mxEvent.isControlDown(I.getEvent())&&mxEvent.isShiftDown(I.getEvent())};mxRubberband.prototype.mouseUp=function(M,N){var O=this.div!=null&&this.div.style.display!="none";var I=null;var Q=null;var T=null;var S=null;if(this.first!=null&&this.currentX!=null&&this.currentY!=null){I=this.first.x;Q=this.first.y;T=(this.currentX-I)/this.graph.view.scale;S=(this.currentY-Q)/this.graph.view.scale;if(!mxEvent.isAltDown(N.getEvent())){T=this.graph.snap(T);S=this.graph.snap(S)}}this.reset();if(O){if(mxEvent.isAltDown(N.getEvent())&&this.graph.isToggleEvent(N.getEvent())){var P=new mxRectangle(this.x,this.y,this.width,this.height);var R=this.graph.getCells(P.x,P.y,P.width,P.height);this.graph.removeSelectionCells(R)}else{if(this.isSpaceEvent(N)){this.graph.model.beginUpdate();try{var R=this.graph.getCellsBeyond(I,Q,this.graph.getDefaultParent(),true,true);for(var L=0;L<R.length;L++){if(this.graph.isCellMovable(R[L])){var K=this.graph.view.getState(R[L]);var J=this.graph.getCellGeometry(R[L]);if(K!=null&&J!=null){J=J.clone();J.translate(T,S);this.graph.model.setGeometry(R[L],J)}}}}finally{this.graph.model.endUpdate()}}else{var P=new mxRectangle(this.x,this.y,this.width,this.height);this.graph.selectRegion(P,N.getEvent())}}N.consume()}};mxRubberband.prototype.mouseMove=function(L,M){if(!M.isConsumed()&&this.first!=null){var P=mxUtils.getScrollOrigin(this.graph.container);var K=mxUtils.getOffset(this.graph.container);P.x-=K.x;P.y-=K.y;var O=M.getX()+P.x;var N=M.getY()+P.y;var T=this.first.x-O;var S=this.first.y-N;var R=this.graph.tolerance;if(this.div!=null||Math.abs(T)>R||Math.abs(S)>R){if(this.div==null){this.div=this.createShape()}mxUtils.clearSelection();this.update(O,N);if(this.isSpaceEvent(M)){var Q=this.x+this.width;var I=this.y+this.height;var J=this.graph.view.scale;if(!mxEvent.isAltDown(M.getEvent())){this.width=this.graph.snap(this.width/J)*J;this.height=this.graph.snap(this.height/J)*J;if(!this.graph.isGridEnabled()){if(this.width<this.graph.tolerance){this.width=0}if(this.height<this.graph.tolerance){this.height=0}}if(this.x<this.first.x){this.x=Q-this.width}if(this.y<this.first.y){this.y=I-this.height}}this.div.style.borderStyle="dashed";this.div.style.backgroundColor="white";this.div.style.left=this.x+"px";this.div.style.top=this.y+"px";this.div.style.width=Math.max(0,this.width)+"px";this.div.style.height=this.graph.container.clientHeight+"px";this.div.style.borderWidth=(this.width<=0)?"0px 1px 0px 0px":"0px 1px 0px 1px";if(this.secondDiv==null){this.secondDiv=this.div.cloneNode(true);this.div.parentNode.appendChild(this.secondDiv)}this.secondDiv.style.left=this.x+"px";this.secondDiv.style.top=this.y+"px";this.secondDiv.style.width=this.graph.container.clientWidth+"px";this.secondDiv.style.height=Math.max(0,this.height)+"px";this.secondDiv.style.borderWidth=(this.height<=0)?"1px 0px 0px 0px":"1px 0px 1px 0px"}else{this.div.style.backgroundColor="";this.div.style.borderWidth="";this.div.style.borderStyle="";if(this.secondDiv!=null){this.secondDiv.parentNode.removeChild(this.secondDiv);this.secondDiv=null}}M.consume()}}};var l=mxRubberband.prototype.reset;mxRubberband.prototype.reset=function(){if(this.secondDiv!=null){this.secondDiv.parentNode.removeChild(this.secondDiv);this.secondDiv=null}l.apply(this,arguments)};var x=new Date().getTime();var a=0;var D=mxEdgeHandler.prototype.updatePreviewState;mxEdgeHandler.prototype.updatePreviewState=function(L,I,K,J){D.apply(this,arguments);if(K!=this.currentTerminalState){x=new Date().getTime();a=0}else{a=new Date().getTime()-x}this.currentTerminalState=K};var B=mxEdgeHandler.prototype.isOutlineConnectEvent;mxEdgeHandler.prototype.isOutlineConnectEvent=function(I){return(this.currentTerminalState!=null&&I.getState()==this.currentTerminalState&&a>2000)||((this.currentTerminalState==null||mxUtils.getValue(this.currentTerminalState.style,"outlineConnect","1")!="0")&&B.apply(this,arguments))};mxVertexHandler.prototype.isCustomHandleEvent=function(I){return !mxEvent.isShiftDown(I.getEvent())};mxEdgeHandler.prototype.createHandleShape=function(M,K){var I=M!=null&&M==0;var J=this.state.getVisibleTerminalState(I);var O=(M!=null&&(M==0||M>=this.state.absolutePoints.length-1||(this.constructor==mxElbowEdgeHandler&&M==2)))?this.graph.getConnectionConstraint(this.state,J,I):null;var Q=(O!=null)?this.graph.getConnectionPoint(this.state.getVisibleTerminalState(I),O):null;var L=(Q!=null)?this.fixedHandleImage:((O!=null&&J!=null)?this.terminalHandleImage:this.handleImage);if(L!=null){var N=new mxImageShape(new mxRectangle(0,0,L.width,L.height),L.src);N.preserveImageAspect=false;return N}else{var P=mxConstants.HANDLE_SIZE;if(this.preferHtml){P-=1}return new mxRectangleShape(new mxRectangle(0,0,P,P),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR)}};var i=mxVertexHandler.prototype.createSizerShape;mxVertexHandler.prototype.createSizerShape=function(J,I,K){this.handleImage=(I==mxEvent.ROTATION_HANDLE)?HoverIcons.prototype.rotationHandle:(I==mxEvent.LABEL_HANDLE)?this.secondaryHandleImage:this.handleImage;return i.apply(this,arguments)};var g=mxGraphHandler.prototype.getBoundingBox;mxGraphHandler.prototype.getBoundingBox=function(J){if(J!=null&&J.length==1){var I=this.graph.getModel();var K=I.getParent(J[0]);var M=this.graph.getCellGeometry(J[0]);if(I.isEdge(K)&&M!=null&&M.relative){var L=this.graph.view.getState(J[0]);if(L!=null&&L.width<2&&L.height<2&&L.text!=null&&L.text.boundingBox!=null){return mxRectangle.fromRectangle(L.text.boundingBox)}}}return g.apply(this,arguments)};var n=mxVertexHandler.prototype.getSelectionBounds;mxVertexHandler.prototype.getSelectionBounds=function(K){var I=this.graph.getModel();var J=I.getParent(K.cell);var L=this.graph.getCellGeometry(K.cell);if(I.isEdge(J)&&L!=null&&L.relative&&K.width<2&&K.height<2&&K.text!=null&&K.text.boundingBox!=null){var M=K.text.unrotatedBoundingBox||K.text.boundingBox;return new mxRectangle(Math.round(M.x),Math.round(M.y),Math.round(M.width),Math.round(M.height))}else{return n.apply(this,arguments)}};var C=mxVertexHandler.prototype.mouseDown;mxVertexHandler.prototype.mouseDown=function(J,L){var I=this.graph.getModel();var K=I.getParent(this.state.cell);var N=this.graph.getCellGeometry(this.state.cell);var M=this.getHandleForEvent(L);if(M==mxEvent.ROTATION_HANDLE||!I.isEdge(K)||N==null||!N.relative||this.state==null||this.state.width>=2||this.state.height>=2){C.apply(this,arguments)}};mxVertexHandler.prototype.isRotationHandleVisible=function(){return this.graph.isEnabled()&&this.rotationEnabled&&this.graph.isCellRotatable(this.state.cell)&&(mxGraphHandler.prototype.maxCells<=0||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells)};mxVertexHandler.prototype.rotateClick=function(){this.state.view.graph.turnShapes([this.state.cell])};var s=mxVertexHandler.prototype.mouseMove;mxVertexHandler.prototype.mouseMove=function(I,J){s.apply(this,arguments);if(this.graph.graphHandler.first!=null){if(this.rotationShape!=null&&this.rotationShape.node!=null){this.rotationShape.node.style.display="none"}}};var c=mxVertexHandler.prototype.mouseUp;mxVertexHandler.prototype.mouseUp=function(I,J){c.apply(this,arguments);if(this.rotationShape!=null&&this.rotationShape.node!=null){this.rotationShape.node.style.display=(this.graph.getSelectionCount()==1)?"":"none"}};var v=mxVertexHandler.prototype.init;mxVertexHandler.prototype.init=function(){v.apply(this,arguments);var K=false;if(this.rotationShape!=null){this.rotationShape.node.setAttribute("title",mxResources.get("rotateTooltip"))}var J=mxUtils.bind(this,function(){if(this.rotationShape!=null&&this.rotationShape.node!=null){this.rotationShape.node.style.display=(this.graph.getSelectionCount()==1)?"":"none"}if(this.specialHandle!=null){this.specialHandle.node.style.display=(this.graph.isEnabled()&&this.graph.getSelectionCount()<this.graph.graphHandler.maxCells)?"":"none"}this.redrawHandles()});this.selectionHandler=mxUtils.bind(this,function(M,L){J()});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.selectionHandler);this.changeHandler=mxUtils.bind(this,function(M,L){this.updateLinkHint(this.graph.getLinkForCell(this.state.cell));J()});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);this.editingHandler=mxUtils.bind(this,function(M,L){this.redrawHandles()});this.graph.addListener(mxEvent.EDITING_STOPPED,this.editingHandler);var I=this.graph.getLinkForCell(this.state.cell);this.updateLinkHint(I);if(I!=null){K=true}if(K){this.redrawHandles()}};mxVertexHandler.prototype.updateLinkHint=function(O){if(O==null||this.graph.getSelectionCount()>1){if(this.linkHint!=null){this.linkHint.parentNode.removeChild(this.linkHint);this.linkHint=null}}else{if(O!=null){if(this.linkHint==null){this.linkHint=F();this.linkHint.style.padding="4px 10px 6px 10px";this.linkHint.style.fontSize="90%";this.linkHint.style.opacity="1";this.linkHint.style.filter="";this.updateLinkHint(O);this.graph.container.appendChild(this.linkHint)}var M=O;var I=60;var N=36;var L=20;if(M.length>I){M=M.substring(0,N)+"..."+M.substring(M.length-L)}var K=document.createElement("a");K.setAttribute("href",this.graph.getAbsoluteUrl(O));K.setAttribute("title",O);if(this.graph.linkTarget!=null){K.setAttribute("target",this.graph.linkTarget)}mxUtils.write(K,M);this.linkHint.innerHTML="";this.linkHint.appendChild(K);if(this.graph.isEnabled()&&typeof this.graph.editLink==="function"){var J=document.createElement("img");J.setAttribute("src",IMAGE_PATH+"/edit.gif");J.setAttribute("title",mxResources.get("editLink"));J.setAttribute("width","11");J.setAttribute("height","11");J.style.marginLeft="10px";J.style.marginBottom="-1px";J.style.cursor="pointer";this.linkHint.appendChild(J);mxEvent.addListener(J,"click",mxUtils.bind(this,function(P){this.graph.setSelectionCell(this.state.cell);this.graph.editLink();mxEvent.consume(P)}))}}}};mxEdgeHandler.prototype.updateLinkHint=mxVertexHandler.prototype.updateLinkHint;var z=mxEdgeHandler.prototype.init;mxEdgeHandler.prototype.init=function(){z.apply(this,arguments);this.constraintHandler.isEnabled=mxUtils.bind(this,function(){return this.state.view.graph.connectionHandler.isEnabled()});var J=mxUtils.bind(this,function(){if(this.linkHint!=null){this.linkHint.style.display=(this.graph.getSelectionCount()==1)?"":"none"}if(this.labelShape!=null){this.labelShape.node.style.display=(this.graph.isEnabled()&&this.graph.getSelectionCount()<this.graph.graphHandler.maxCells)?"":"none"}});this.selectionHandler=mxUtils.bind(this,function(L,K){J()});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.selectionHandler);this.changeHandler=mxUtils.bind(this,function(L,K){this.updateLinkHint(this.graph.getLinkForCell(this.state.cell));J();this.redrawHandles()});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);var I=this.graph.getLinkForCell(this.state.cell);if(I!=null){this.updateLinkHint(I);this.redrawHandles()}};var p=mxConnectionHandler.prototype.init;mxConnectionHandler.prototype.init=function(){p.apply(this,arguments);this.constraintHandler.isEnabled=mxUtils.bind(this,function(){return this.graph.connectionHandler.isEnabled()})};var r=mxVertexHandler.prototype.redrawHandles;mxVertexHandler.prototype.redrawHandles=function(){r.apply(this);if(this.state!=null&&this.linkHint!=null){var L=new mxPoint(this.state.getCenterX(),this.state.getCenterY());var J=new mxRectangle(this.state.x,this.state.y-22,this.state.width+24,this.state.height+22);var K=mxUtils.getBoundingBox(J,this.state.style[mxConstants.STYLE_ROTATION]||"0",L);var I=(K!=null)?mxUtils.getBoundingBox(this.state,this.state.style[mxConstants.STYLE_ROTATION]||"0"):this.state;if(K==null){K=this.state}this.linkHint.style.left=Math.round(I.x+(I.width-this.linkHint.clientWidth)/2)+"px";this.linkHint.style.top=Math.round(K.y+K.height+this.verticalOffset/2+6+this.state.view.graph.tolerance)+"px"}};var H=mxVertexHandler.prototype.reset;mxVertexHandler.prototype.reset=function(){H.apply(this,arguments);if(this.rotationShape!=null&&this.rotationShape.node!=null){this.rotationShape.node.style.display=(this.graph.getSelectionCount()==1)?"":"none"}};var y=mxVertexHandler.prototype.destroy;mxVertexHandler.prototype.destroy=function(){y.apply(this,arguments);if(this.linkHint!=null){this.linkHint.parentNode.removeChild(this.linkHint);this.linkHint=null}if(this.selectionHandler!=null){this.graph.getSelectionModel().removeListener(this.selectionHandler);this.selectionHandler=null}if(this.changeHandler!=null){this.graph.getModel().removeListener(this.changeHandler);this.changeHandler=null}if(this.editingHandler!=null){this.graph.removeListener(this.editingHandler);this.editingHandler=null}};var f=mxEdgeHandler.prototype.redrawHandles;mxEdgeHandler.prototype.redrawHandles=function(){if(this.marker!=null){f.apply(this);if(this.state!=null&&this.linkHint!=null){var I=this.state;if(this.state.text!=null&&this.state.text.bounds!=null){I=new mxRectangle(I.x,I.y,I.width,I.height);I.add(this.state.text.bounds)}this.linkHint.style.left=Math.round(I.x+(I.width-this.linkHint.clientWidth)/2)+"px";this.linkHint.style.top=Math.round(I.y+I.height+6+this.state.view.graph.tolerance)+"px"}}};var h=mxEdgeHandler.prototype.reset;mxEdgeHandler.prototype.reset=function(){h.apply(this,arguments);if(this.linkHint!=null){this.linkHint.style.visibility=""}};var o=mxEdgeHandler.prototype.destroy;mxEdgeHandler.prototype.destroy=function(){o.apply(this,arguments);if(this.linkHint!=null){this.linkHint.parentNode.removeChild(this.linkHint);this.linkHint=null}if(this.selectionHandler!=null){this.graph.getSelectionModel().removeListener(this.selectionHandler);this.selectionHandler=null}if(this.changeHandler!=null){this.graph.getModel().removeListener(this.changeHandler);this.changeHandler=null}}})()}Menus=function(a){this.editorUi=a;this.menus=new Object();this.init();if(!mxClient.IS_SVG){new Image().src=this.checkmarkImage}};Menus.prototype.defaultFont="Helvetica";Menus.prototype.defaultFontSize="12";Menus.prototype.defaultMenuItems=["file","edit","view","arrange","extras","help"];Menus.prototype.defaultFonts=["Helvetica","Verdana","Times New Roman","Garamond","Comic Sans MS","Courier New","Georgia","Lucida Console","Tahoma"];Menus.prototype.init=function(){var b=this.editorUi.editor.graph;var a=mxUtils.bind(b,b.isEnabled);this.customFonts=[];this.customFontSizes=[];this.put("fontFamily",new Menu(mxUtils.bind(this,function(f,d){var e=mxUtils.bind(this,function(h){var g=this.styleChange(f,h,[mxConstants.STYLE_FONTFAMILY],[h],null,d,function(){document.execCommand("fontname",false,h)});g.firstChild.nextSibling.style.fontFamily=h});for(var c=0;c<this.defaultFonts.length;c++){e(this.defaultFonts[c])}f.addSeparator(d);if(this.customFonts.length>0){for(var c=0;c<this.customFonts.length;c++){e(this.customFonts[c])}f.addSeparator(d);f.addItem(mxResources.get("reset"),null,mxUtils.bind(this,function(){this.customFonts=[]}),d);f.addSeparator(d)}this.promptChange(f,mxResources.get("custom")+"...","",mxConstants.DEFAULT_FONTFAMILY,mxConstants.STYLE_FONTFAMILY,d,true,mxUtils.bind(this,function(g){this.customFonts.push(g)}))})));this.put("formatBlock",new Menu(mxUtils.bind(this,function(e,c){function d(g,f){return e.addItem(g,null,mxUtils.bind(this,function(){b.cellEditor.textarea.focus();document.execCommand("formatBlock",false,"<"+f+">")}),c)}d(mxResources.get("normal"),"p");d("","h1").firstChild.nextSibling.innerHTML='<h1 style="margin:0px;">'+mxResources.get("heading")+" 1</h1>";d("","h2").firstChild.nextSibling.innerHTML='<h2 style="margin:0px;">'+mxResources.get("heading")+" 2</h2>";d("","h3").firstChild.nextSibling.innerHTML='<h3 style="margin:0px;">'+mxResources.get("heading")+" 3</h3>";d("","h4").firstChild.nextSibling.innerHTML='<h4 style="margin:0px;">'+mxResources.get("heading")+" 4</h4>";d("","h5").firstChild.nextSibling.innerHTML='<h5 style="margin:0px;">'+mxResources.get("heading")+" 5</h5>";d("","h6").firstChild.nextSibling.innerHTML='<h6 style="margin:0px;">'+mxResources.get("heading")+" 6</h6>";d("","pre").firstChild.nextSibling.innerHTML='<pre style="margin:0px;">'+mxResources.get("formatted")+"</pre>";d("","blockquote").firstChild.nextSibling.innerHTML='<blockquote style="margin-top:0px;margin-bottom:0px;">'+mxResources.get("blockquote")+"</blockquote>"})));this.put("fontSize",new Menu(mxUtils.bind(this,function(g,d){var e=[6,8,9,10,11,12,14,18,24,36,48,72];var f=mxUtils.bind(this,function(h){this.styleChange(g,h,[mxConstants.STYLE_FONTSIZE],[h],null,d,function(){document.execCommand("fontSize",false,"3");var k=b.cellEditor.textarea.getElementsByTagName("font");for(var j=0;j<k.length;j++){if(k[j].getAttribute("size")=="3"){k[j].removeAttribute("size");k[j].style.fontSize=h+"px";break}}})});for(var c=0;c<e.length;c++){f(e[c])}g.addSeparator(d);if(this.customFontSizes.length>0){for(var c=0;c<this.customFontSizes.length;c++){f(this.customFontSizes[c])}g.addSeparator(d);g.addItem(mxResources.get("reset"),null,mxUtils.bind(this,function(){this.customFontSizes=[]}),d);g.addSeparator(d)}this.promptChange(g,mxResources.get("custom")+"...","(pt)","12",mxConstants.STYLE_FONTSIZE,d,true,mxUtils.bind(this,function(h){this.customFontSizes.push(h)}))})));this.put("direction",new Menu(mxUtils.bind(this,function(d,c){d.addItem(mxResources.get("flipH"),null,function(){b.toggleCellStyles(mxConstants.STYLE_FLIPH,false)},c);d.addItem(mxResources.get("flipV"),null,function(){b.toggleCellStyles(mxConstants.STYLE_FLIPV,false)},c);this.addMenuItems(d,["-","rotation"],c)})));this.put("align",new Menu(mxUtils.bind(this,function(d,c){d.addItem(mxResources.get("leftAlign"),null,function(){b.alignCells(mxConstants.ALIGN_LEFT)},c);d.addItem(mxResources.get("center"),null,function(){b.alignCells(mxConstants.ALIGN_CENTER)},c);d.addItem(mxResources.get("rightAlign"),null,function(){b.alignCells(mxConstants.ALIGN_RIGHT)},c);d.addSeparator(c);d.addItem(mxResources.get("topAlign"),null,function(){b.alignCells(mxConstants.ALIGN_TOP)},c);d.addItem(mxResources.get("middle"),null,function(){b.alignCells(mxConstants.ALIGN_MIDDLE)},c);d.addItem(mxResources.get("bottomAlign"),null,function(){b.alignCells(mxConstants.ALIGN_BOTTOM)},c)})));this.put("distribute",new Menu(mxUtils.bind(this,function(d,c){d.addItem(mxResources.get("horizontal"),null,function(){b.distributeCells(true)},c);d.addItem(mxResources.get("vertical"),null,function(){b.distributeCells(false)},c)})));this.put("layout",new Menu(mxUtils.bind(this,function(e,c){var d=mxUtils.bind(this,function(f,g){var h=new FilenameDialog(this.editorUi,f,mxResources.get("apply"),function(i){g(parseFloat(i))},mxResources.get("spacing"));this.editorUi.showDialog(h.container,300,80,true,true);h.init()});e.addItem(mxResources.get("horizontalFlow"),null,mxUtils.bind(this,function(){var f=new mxHierarchicalLayout(b,mxConstants.DIRECTION_WEST);this.editorUi.executeLayout(function(){var g=b.getSelectionCells();f.execute(b.getDefaultParent(),g.length==0?null:g)},true)}),c);e.addItem(mxResources.get("verticalFlow"),null,mxUtils.bind(this,function(){var f=new mxHierarchicalLayout(b,mxConstants.DIRECTION_NORTH);this.editorUi.executeLayout(function(){var g=b.getSelectionCells();f.execute(b.getDefaultParent(),g.length==0?null:g)},true)}),c);e.addSeparator(c);e.addItem(mxResources.get("horizontalTree"),null,mxUtils.bind(this,function(){var g=b.getSelectionCell();var f=null;if(g==null||b.getModel().getChildCount(g)==0){if(b.getModel().getEdgeCount(g)==0){f=b.findTreeRoots(b.getDefaultParent())}}else{f=b.findTreeRoots(g)}if(f!=null&&f.length>0){g=f[0]}if(g!=null){var h=new mxCompactTreeLayout(b,true);h.edgeRouting=false;h.levelDistance=30;d(h.levelDistance,mxUtils.bind(this,function(i){h.levelDistance=i;this.editorUi.executeLayout(function(){h.execute(b.getDefaultParent(),g)},true)}))}}),c);e.addItem(mxResources.get("verticalTree"),null,mxUtils.bind(this,function(){var g=b.getSelectionCell();var f=null;if(g==null||b.getModel().getChildCount(g)==0){if(b.getModel().getEdgeCount(g)==0){f=b.findTreeRoots(b.getDefaultParent())}}else{f=b.findTreeRoots(g)}if(f!=null&&f.length>0){g=f[0]}if(g!=null){var h=new mxCompactTreeLayout(b,false);h.edgeRouting=false;h.levelDistance=30;d(h.levelDistance,mxUtils.bind(this,function(i){h.levelDistance=i;this.editorUi.executeLayout(function(){h.execute(b.getDefaultParent(),g)},true)}))}}),c);e.addItem(mxResources.get("radialTree"),null,mxUtils.bind(this,function(){var g=b.getSelectionCell();var f=null;if(g==null||b.getModel().getChildCount(g)==0){if(b.getModel().getEdgeCount(g)==0){f=b.findTreeRoots(b.getDefaultParent())}}else{f=b.findTreeRoots(g)}if(f!=null&&f.length>0){g=f[0]}if(g!=null){var h=new mxRadialTreeLayout(b,false);h.levelDistance=80;h.autoRadius=true;d(h.levelDistance,mxUtils.bind(this,function(i){h.levelDistance=i;this.editorUi.executeLayout(function(){h.execute(b.getDefaultParent(),g);if(!b.isSelectionEmpty()){g=b.getModel().getParent(g);if(b.getModel().isVertex(g)){b.updateGroupBounds([g],b.gridSize*2,true)}}},true)}))}}),c);e.addSeparator(c);e.addItem(mxResources.get("organic"),null,mxUtils.bind(this,function(){var f=new mxFastOrganicLayout(b);d(f.forceConstant,mxUtils.bind(this,function(g){f.forceConstant=g;this.editorUi.executeLayout(function(){var h=b.getSelectionCell();if(h==null||b.getModel().getChildCount(h)==0){h=b.getDefaultParent()}f.execute(h);if(b.getModel().isVertex(h)){b.updateGroupBounds([h],b.gridSize*2,true)}},true)}))}),c);e.addItem(mxResources.get("circle"),null,mxUtils.bind(this,function(){var f=new mxCircleLayout(b);this.editorUi.executeLayout(function(){var g=b.getSelectionCell();if(g==null||b.getModel().getChildCount(g)==0){g=b.getDefaultParent()}f.execute(g);if(b.getModel().isVertex(g)){b.updateGroupBounds([g],b.gridSize*2,true)}},true)}),c)})));this.put("navigation",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["home","-","exitGroup","enterGroup","-","expand","collapse","-","collapsible"],c)})));this.put("arrange",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["toFront","toBack","-"],c);this.addSubmenu("direction",d,c);this.addMenuItems(d,["turn","-"],c);this.addSubmenu("align",d,c);this.addSubmenu("distribute",d,c);d.addSeparator(c);this.addSubmenu("navigation",d,c);this.addSubmenu("insert",d,c);this.addSubmenu("layout",d,c);this.addMenuItems(d,["-","group","ungroup","removeFromGroup","-","clearWaypoints","autosize"],c)}))).isEnabled=a;this.put("insert",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["insertLink","insertImage"],c)})));this.put("view",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,((this.editorUi.format!=null)?["formatPanel"]:[]).concat(["outline","layers","-","pageView","pageScale","-","scrollbars","tooltips","-","grid","guides","-","connectionArrows","connectionPoints","-","resetView","zoomIn","zoomOut"],c))})));this.put("viewPanels",new Menu(mxUtils.bind(this,function(d,c){if(this.editorUi.format!=null){this.addMenuItems(d,["formatPanel"],c)}this.addMenuItems(d,["outline","layers"],c)})));this.put("viewZoom",new Menu(mxUtils.bind(this,function(f,d){this.addMenuItems(f,["resetView","-"],d);var e=[0.25,0.5,0.75,1,1.25,1.5,2,3,4];for(var c=0;c<e.length;c++){(function(g){f.addItem((g*100)+"%",null,function(){b.zoomTo(g)},d)})(e[c])}this.addMenuItems(f,["-","fitWindow","fitPageWidth","fitPage","fitTwoPages","-","customZoom"],d)})));this.put("file",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["new","open","-","save","saveAs","-","import","export","-","pageSetup","print"],c)})));this.put("edit",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["undo","redo","-","cut","copy","paste","delete","-","duplicate","-","editData","editTooltip","editStyle","-","edit","-","editLink","openLink","-","selectVertices","selectEdges","selectAll","selectNone","-","lockUnlock"])})));this.put("extras",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["copyConnect","collapseExpand","-","editDiagram"])})));this.put("help",new Menu(mxUtils.bind(this,function(d,c){this.addMenuItems(d,["help","-","about"])})))};Menus.prototype.put=function(a,b){this.menus[a]=b;return b};Menus.prototype.get=function(a){return this.menus[a]};Menus.prototype.addSubmenu=function(b,e,d){var a=this.get(b).isEnabled();if(e.showDisabled||a){var c=e.addItem(mxResources.get(b),null,null,d,null,a);this.addMenu(b,e,c)}};Menus.prototype.addMenu=function(b,a,c){var d=this.get(b);if(d!=null&&(a.showDisabled||d.isEnabled())){this.get(b).execute(a,c)}};Menus.prototype.addInsertTableItem=function(a){var h=this.editorUi.editor.graph;function g(n,o){var m=["<table>"];for(var l=0;l<n;l++){m.push("<tr>");for(var k=0;k<o;k++){m.push("<td><br></td>")}m.push("</tr>")}m.push("</table>");return m.join("")}var e=a.addItem("",null,mxUtils.bind(this,function(j){var p=h.getParentByName(mxEvent.getSource(j),"TD");if(p!=null){var o=h.getParentByName(p,"TR");var m=h.cellEditor.textarea.getElementsByTagName("table");var k=[];for(var l=0;l<m.length;l++){k.push(m[l])}h.container.focus();h.pasteHtmlAtCaret(g(o.sectionRowIndex+1,p.cellIndex+1));var n=h.cellEditor.textarea.getElementsByTagName("table");if(n.length==k.length+1){for(var l=n.length-1;l>=0;l--){if(l==0||n[l]!=k[l-1]){h.selectNode(n[l].rows[0].cells[0]);break}}}}}));var b='<img src="'+mxClient.imageBasePath+'/transparent.gif" width="16" height="16"/>';function i(o,p){var m=document.createElement("table");m.setAttribute("border","1");m.style.borderCollapse="collapse";if(!mxClient.IS_QUIRKS){m.setAttribute("cellPadding","8")}for(var n=0;n<o;n++){var q=m.insertRow(n);for(var l=0;l<p;l++){var k=q.insertCell(-1);if(mxClient.IS_QUIRKS){k.innerHTML=b}}}return m}function c(m,o,p){for(var n=m.rows.length;n<o;n++){var q=m.insertRow(n);for(var l=0;l<m.rows[0].cells.length;l++){var k=q.insertCell(-1);if(mxClient.IS_QUIRKS){k.innerHTML=b}}}for(var n=0;n<m.rows.length;n++){var q=m.rows[n];for(var l=q.cells.length;l<p;l++){var k=q.insertCell(-1);if(mxClient.IS_QUIRKS){k.innerHTML=b}}}}e.firstChild.innerHTML="";var d=i(5,5);e.firstChild.appendChild(d);var f=document.createElement("div");f.style.padding="4px";f.style.fontSize=Menus.prototype.defaultFontSize+"px";f.innerHTML="1x1";e.firstChild.appendChild(f);mxEvent.addListener(d,"mouseover",function(p){var q=h.getParentByName(mxEvent.getSource(p),"TD");if(q!=null){var o=h.getParentByName(q,"TR");c(d,Math.min(20,o.sectionRowIndex+2),Math.min(20,q.cellIndex+2));f.innerHTML=(q.cellIndex+1)+"x"+(o.sectionRowIndex+1);for(var m=0;m<d.rows.length;m++){var n=d.rows[m];for(var l=0;l<n.cells.length;l++){var k=n.cells[l];if(m<=o.sectionRowIndex&&l<=q.cellIndex){k.style.backgroundColor="blue"}else{k.style.backgroundColor="white"}}}mxEvent.consume(p)}})};Menus.prototype.edgeStyleChange=function(g,b,f,a,c,d,e){return g.addItem(b,null,mxUtils.bind(this,function(){var o=this.editorUi.editor.graph;o.stopEditing(false);o.getModel().beginUpdate();try{var m=o.getSelectionCells();var k=[];for(var n=0;n<m.length;n++){var h=m[n];if(o.getModel().isEdge(h)){if(e){var p=o.getCellGeometry(h);if(p!=null){p=p.clone();p.points=null;o.getModel().setGeometry(h,p)}}for(var l=0;l<f.length;l++){o.setCellStyles(f[l],a[l],[h])}k.push(h)}}this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",f,"values",a,"cells",k))}finally{o.getModel().endUpdate()}}),d,c)};Menus.prototype.styleChange=function(h,c,g,b,d,f,e){var a=this.createStyleChangeFunction(g,b);return h.addItem(c,null,mxUtils.bind(this,function(){var i=this.editorUi.editor.graph;if(e!=null&&i.cellEditor.isContentEditing()){e()}else{a()}}),f,d)};Menus.prototype.createStyleChangeFunction=function(b,a){return mxUtils.bind(this,function(){var d=this.editorUi.editor.graph;d.stopEditing(false);d.getModel().beginUpdate();try{for(var c=0;c<b.length;c++){d.setCellStyles(b[c],a[c])}this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",b,"values",a,"cells",d.getSelectionCells()))}finally{d.getModel().endUpdate()}})};Menus.prototype.promptChange=function(a,f,b,d,i,g,c,e,h){return a.addItem(f,null,mxUtils.bind(this,function(){var l=this.editorUi.editor.graph;var k=d;var j=l.getView().getState(l.getSelectionCell());if(j!=null){k=j.style[i]||k}var m=new FilenameDialog(this.editorUi,k,mxResources.get("apply"),mxUtils.bind(this,function(n){if(n!=null&&n.length>0){l.getModel().beginUpdate();try{l.stopEditing(false);l.setCellStyles(i,n)}finally{l.getModel().endUpdate()}if(e!=null){e(n)}}}),mxResources.get("enterValue")+((b.length>0)?(" "+b):""));this.editorUi.showDialog(m.container,300,80,true,true);m.init()}),g,h,c)};Menus.prototype.pickColor=function(c,g,a){var f=this.editorUi.editor.graph;if(g!=null&&f.cellEditor.isContentEditing()){var d=f.cellEditor.saveSelection();var h=new ColorDialog(this.editorUi,a||"000000",mxUtils.bind(this,function(i){f.cellEditor.restoreSelection(d);document.execCommand(g,false,(i!=mxConstants.NONE)?i:"transparent")}),function(){f.cellEditor.restoreSelection(d)});this.editorUi.showDialog(h.container,220,430,true,true);h.init()}else{if(this.colorDialog==null){this.colorDialog=new ColorDialog(this.editorUi)}this.colorDialog.currentColorKey=c;var e=f.getView().getState(f.getSelectionCell());var b="none";if(e!=null){b=e.style[c]||b}if(b=="none"){b="ffffff";this.colorDialog.picker.fromString("ffffff");this.colorDialog.colorInput.value="none"}else{this.colorDialog.picker.fromString(b)}this.editorUi.showDialog(this.colorDialog.container,220,430,true,true);this.colorDialog.init()}};Menus.prototype.toggleStyle=function(b,a){var d=this.editorUi.editor.graph;var c=d.toggleCellStyles(b,a);this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",[b],"values",[c],"cells",d.getSelectionCells()))};Menus.prototype.addMenuItem=function(g,c,d,a,b){var f=this.editorUi.actions.get(c);if(f!=null&&(g.showDisabled||f.isEnabled())&&f.visible){var e=g.addItem(f.label,null,function(){f.funct(a)},d,b,f.isEnabled());if(f.toggleAction&&f.isSelected()){g.addCheckmark(e,Editor.checkmarkImage)}this.addShortcut(e,f);return e}return null};Menus.prototype.addShortcut=function(b,c){if(c.shortcut!=null){var d=b.firstChild.nextSibling.nextSibling;var a=document.createElement("span");a.style.color="gray";mxUtils.write(a,c.shortcut);d.appendChild(a)}};Menus.prototype.addMenuItems=function(f,d,c,a,e){for(var b=0;b<d.length;b++){if(d[b]=="-"){f.addSeparator(c)}else{this.addMenuItem(f,d[b],c,a,(e!=null)?e[b]:null)}}};Menus.prototype.createPopupMenu=function(b,i,h){var j=this.editorUi.editor.graph;b.smartSeparators=true;if(j.isSelectionEmpty()){this.addMenuItems(b,["undo","redo","-","pasteHere"],null,h)}else{this.addMenuItems(b,["delete","-","cut","copy","-","duplicate"],null,h)}if(!j.isSelectionEmpty()){if(j.getSelectionCount()==1){this.addMenuItems(b,["setAsDefaultStyle"],null,h)}b.addSeparator();i=j.getSelectionCell();var a=j.view.getState(i);if(a!=null){var e=false;this.addMenuItems(b,["toFront","toBack","-"],null,h);if(j.getModel().isEdge(i)&&mxUtils.getValue(a.style,mxConstants.STYLE_EDGE,null)!="entityRelationEdgeStyle"&&mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE,null)!="arrow"){var k=j.selectionCellsHandler.getHandler(i);var f=false;if(k instanceof mxEdgeHandler&&k.bends!=null&&k.bends.length>2){var d=k.getHandleForEvent(j.updateMouseEvent(new mxMouseEvent(h)));var g=this.editorUi.actions.get("removeWaypoint");g.handler=k;g.index=d;f=d>0&&d<k.bends.length-1}this.addMenuItems(b,["-",(f)?"removeWaypoint":"addWaypoint"],null,h);var c=j.getModel().getGeometry(i);e=c!=null&&c.points!=null&&c.points.length>0}if(j.getSelectionCount()==1&&(e||(j.getModel().isVertex(i)&&j.getModel().getEdgeCount(i)>0))){this.addMenuItems(b,["clearWaypoints"],null,h)}if(j.getSelectionCount()>1){b.addSeparator();this.addMenuItems(b,["group"],null,h)}else{if(j.getSelectionCount()==1&&!j.getModel().isEdge(i)&&!j.isSwimlane(i)&&j.getModel().getChildCount(i)>0){b.addSeparator();this.addMenuItems(b,["ungroup"],null,h)}}if(j.getSelectionCount()==1){b.addSeparator();this.addMenuItems(b,["edit","-","editData","editLink"],null,h);if(j.getModel().isVertex(i)&&mxUtils.getValue(a.style,mxConstants.STYLE_IMAGE,null)!=null){b.addSeparator();this.addMenuItem(b,"image",null,h).firstChild.nextSibling.innerHTML=mxResources.get("editImage")+"..."}}}}else{this.addMenuItems(b,["-","selectVertices","selectEdges","-","selectAll"],null,h)}};Menus.prototype.createMenubar=function(a){var d=new Menubar(this.editorUi,a);var c=this.defaultMenuItems;for(var b=0;b<c.length;b++){(mxUtils.bind(this,function(f){var e=d.addMenu(mxResources.get(c[b]),mxUtils.bind(this,function(){f.funct.apply(this,arguments)}));if(e!=null){f.addListener("stateChanged",function(){e.enabled=f.enabled;if(!f.enabled){e.className="geItem mxDisabled";if(document.documentMode==8){e.style.color="#c3c3c3"}}else{e.className="geItem";if(document.documentMode==8){e.style.color=""}}})}}))(this.get(c[b]))}return d};function Menubar(b,a){this.editorUi=b;this.container=a}Menubar.prototype.hideMenu=function(){this.editorUi.hideCurrentMenu()};Menubar.prototype.addMenu=function(c,a){var b=document.createElement("a");b.setAttribute("href","javascript:void(0);");b.className="geItem";mxUtils.write(b,c);this.addMenuHandler(b,a);this.container.appendChild(b);return b};Menubar.prototype.addMenuHandler=function(c,b){if(b!=null){var a=true;var d=mxUtils.bind(this,function(e){if(a&&c.enabled==null||c.enabled){this.editorUi.editor.graph.popupMenuHandler.hideMenu();var g=new mxPopupMenu(b);g.div.className+=" geMenubarMenu";g.smartSeparators=true;g.showDisabled=true;g.autoExpand=true;g.hideMenu=mxUtils.bind(this,function(){mxPopupMenu.prototype.hideMenu.apply(g,arguments);this.editorUi.resetCurrentMenu();g.destroy()});var f=mxUtils.getOffset(c);g.popup(f.x,f.y+c.offsetHeight,null,e);this.editorUi.setCurrentMenu(g,c)}mxEvent.consume(e)});mxEvent.addListener(c,"mousemove",mxUtils.bind(this,function(e){if(this.editorUi.currentMenu!=null&&this.editorUi.currentMenuElt!=c){this.editorUi.hideCurrentMenu();d(e)}}));mxEvent.addListener(c,"mousedown",mxUtils.bind(this,function(){a=this.currentElt!=c}));mxEvent.addListener(c,"click",mxUtils.bind(this,function(e){d(e);a=true}))}};Menubar.prototype.destroy=function(){};function Menu(a,b){mxEventSource.call(this);this.funct=a;this.enabled=(b!=null)?b:true}mxUtils.extend(Menu,mxEventSource);Menu.prototype.isEnabled=function(){return this.enabled};Menu.prototype.setEnabled=function(a){if(this.enabled!=a){this.enabled=a;this.fireEvent(new mxEventObject("stateChanged"))}};Menu.prototype.execute=function(b,a){this.funct(b,a)};EditorUi.prototype.createMenus=function(){return new Menus(this)};(function(){function T(){mxCylinder.call(this)}mxUtils.extend(T,mxCylinder);T.prototype.size=20;T.prototype.redrawPath=function(aP,aK,aQ,aL,aO,aM){var aN=Math.max(0,Math.min(aL,Math.min(aO,parseFloat(mxUtils.getValue(this.style,"size",this.size)))));if(aM){aP.moveTo(aN,aO);aP.lineTo(aN,aN);aP.lineTo(0,0);aP.moveTo(aN,aN);aP.lineTo(aL,aN);aP.end()}else{aP.moveTo(0,0);aP.lineTo(aL-aN,0);aP.lineTo(aL,aN);aP.lineTo(aL,aO);aP.lineTo(aN,aO);aP.lineTo(0,aO-aN);aP.lineTo(0,0);aP.close();aP.end()}};mxCellRenderer.prototype.defaultShapes.cube=T;var af=Math.tan(mxUtils.toRadians(30));var at=(0.5-af)/2;function aa(){mxActor.call(this)}mxUtils.extend(aa,mxActor);aa.prototype.size=20;aa.prototype.redrawPath=function(aO,aL,aP,aM,aN){var aK=Math.min(aM,aN/af);aO.translate((aM-aK)/2,(aN-aK)/2+aK/4);aO.moveTo(0,0.25*aK);aO.lineTo(0.5*aK,aK*at);aO.lineTo(aK,0.25*aK);aO.lineTo(0.5*aK,(0.5-at)*aK);aO.lineTo(0,0.25*aK);aO.close();aO.end()};mxCellRenderer.prototype.defaultShapes.isoRectangle=aa;function j(){mxCylinder.call(this)}mxUtils.extend(j,mxCylinder);j.prototype.size=20;j.prototype.redrawPath=function(aP,aL,aQ,aM,aO,aN){var aK=Math.min(aM,aO/(0.5+af));if(aN){aP.moveTo(0,0.25*aK);aP.lineTo(0.5*aK,(0.5-at)*aK);aP.lineTo(aK,0.25*aK);aP.moveTo(0.5*aK,(0.5-at)*aK);aP.lineTo(0.5*aK,(1-at)*aK);aP.end()}else{aP.translate((aM-aK)/2,(aO-aK)/2);aP.moveTo(0,0.25*aK);aP.lineTo(0.5*aK,aK*at);aP.lineTo(aK,0.25*aK);aP.lineTo(aK,0.75*aK);aP.lineTo(0.5*aK,(1-at)*aK);aP.lineTo(0,0.75*aK);aP.close();aP.end()}};mxCellRenderer.prototype.defaultShapes.isoCube=j;function aD(){mxCylinder.call(this)}mxUtils.extend(aD,mxCylinder);aD.prototype.redrawPath=function(aQ,aK,aP,aM,aO,aN){var aL=Math.min(aO/2,Math.round(aO/8)+this.strokewidth-1);if((aN&&this.fill!=null)||(!aN&&this.fill==null)){aQ.moveTo(0,aL);aQ.curveTo(0,2*aL,aM,2*aL,aM,aL);if(!aN){aQ.stroke();aQ.begin()}aQ.translate(0,aL/2);aQ.moveTo(0,aL);aQ.curveTo(0,2*aL,aM,2*aL,aM,aL);if(!aN){aQ.stroke();aQ.begin()}aQ.translate(0,aL/2);aQ.moveTo(0,aL);aQ.curveTo(0,2*aL,aM,2*aL,aM,aL);if(!aN){aQ.stroke();aQ.begin()}aQ.translate(0,-aL)}if(!aN){aQ.moveTo(0,aL);aQ.curveTo(0,-aL/3,aM,-aL/3,aM,aL);aQ.lineTo(aM,aO-aL);aQ.curveTo(aM,aO+aL/3,0,aO+aL/3,0,aO-aL);aQ.close()}};aD.prototype.getLabelBounds=function(aL){var aK=2.5*Math.min(aL.height/2,Math.round(aL.height/8)+this.strokewidth-1);if((!this.flipV&&(this.direction==null||this.direction==mxConstants.DIRECTION_EAST)||(this.flipV&&this.direction==mxConstants.DIRECTION_WEST))){aL.y+=aK;aL.height-=aK}else{if((!this.flipV&&this.direction==mxConstants.DIRECTION_SOUTH)||((this.flipV&&this.direction==mxConstants.DIRECTION_NORTH))){aL.width-=aK}else{if((!this.flipV&&this.direction==mxConstants.DIRECTION_WEST)||(this.flipV&&(this.direction==null||this.direction==mxConstants.DIRECTION_EAST))){aL.height-=aK}else{if((!this.flipV&&this.direction==mxConstants.DIRECTION_NORTH)||(this.flipV&&this.direction==mxConstants.DIRECTION_SOUTH)){aL.x+=aK;aL.width-=aK}}}}return aL};mxCellRenderer.prototype.defaultShapes.datastore=aD;function ap(){mxCylinder.call(this)}mxUtils.extend(ap,mxCylinder);ap.prototype.size=30;ap.prototype.redrawPath=function(aP,aK,aQ,aL,aO,aM){var aN=Math.max(0,Math.min(aL,Math.min(aO,parseFloat(mxUtils.getValue(this.style,"size",this.size)))));if(aM){aP.moveTo(aL-aN,0);aP.lineTo(aL-aN,aN);aP.lineTo(aL,aN);aP.end()}else{aP.moveTo(0,0);aP.lineTo(aL-aN,0);aP.lineTo(aL,aN);aP.lineTo(aL,aO);aP.lineTo(0,aO);aP.lineTo(0,0);aP.close();aP.end()}};mxCellRenderer.prototype.defaultShapes.note=ap;function aB(){mxActor.call(this)}mxUtils.extend(aB,mxActor);aB.prototype.redrawPath=function(aP,aK,aO,aL,aM){var aN=0.5;aP.moveTo(0,0);aP.quadTo(aL/2,aM*aN,aL,0);aP.quadTo(aL*(1-aN),aM/2,aL,aM);aP.quadTo(aL/2,aM*(1-aN),0,aM);aP.quadTo(aL*aN,aM/2,0,0);aP.end()};mxCellRenderer.prototype.defaultShapes["switch"]=aB;function am(){mxCylinder.call(this)}mxUtils.extend(am,mxCylinder);am.prototype.tabWidth=60;am.prototype.tabHeight=20;am.prototype.tabPosition="right";am.prototype.redrawPath=function(aR,aO,aM,aP,aL,aK){var aS=Math.max(0,Math.min(aP,parseFloat(mxUtils.getValue(this.style,"tabWidth",this.tabWidth))));var aQ=Math.max(0,Math.min(aL,parseFloat(mxUtils.getValue(this.style,"tabHeight",this.tabHeight))));var aN=mxUtils.getValue(this.style,"tabPosition",this.tabPosition);if(aK){if(aN=="left"){aR.moveTo(0,aQ);aR.lineTo(aS,aQ)}else{aR.moveTo(aP-aS,aQ);aR.lineTo(aP,aQ)}aR.end()}else{if(aN=="left"){aR.moveTo(0,0);aR.lineTo(aS,0);aR.lineTo(aS,aQ);aR.lineTo(aP,aQ)}else{aR.moveTo(0,aQ);aR.lineTo(aP-aS,aQ);aR.lineTo(aP-aS,0);aR.lineTo(aP,0)}aR.lineTo(aP,aL);aR.lineTo(0,aL);aR.lineTo(0,aQ);aR.close();aR.end()}};mxCellRenderer.prototype.defaultShapes.folder=am;function x(){mxActor.call(this)}mxUtils.extend(x,mxActor);x.prototype.size=30;x.prototype.redrawPath=function(aQ,aK,aP,aL,aN){var aM=Math.max(0,Math.min(aL,Math.min(aN,parseFloat(mxUtils.getValue(this.style,"size",this.size)))));var aO=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aQ,[new mxPoint(aM,0),new mxPoint(aL,0),new mxPoint(aL,aN),new mxPoint(0,aN),new mxPoint(0,aM)],this.isRounded,aO,true);aQ.end()};mxCellRenderer.prototype.defaultShapes.card=x;function ao(){mxActor.call(this)}mxUtils.extend(ao,mxActor);ao.prototype.size=0.4;ao.prototype.redrawPath=function(aQ,aK,aP,aM,aO){var aL=aO*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aN=1.4;aQ.moveTo(0,aL/2);aQ.quadTo(aM/4,aL*aN,aM/2,aL/2);aQ.quadTo(aM*3/4,aL*(1-aN),aM,aL/2);aQ.lineTo(aM,aO-aL/2);aQ.quadTo(aM*3/4,aO-aL*aN,aM/2,aO-aL/2);aQ.quadTo(aM/4,aO-aL*(1-aN),0,aO-aL/2);aQ.lineTo(0,aL/2);aQ.close();aQ.end()};mxCellRenderer.prototype.defaultShapes.tape=ao;function W(){mxActor.call(this)}mxUtils.extend(W,mxActor);W.prototype.size=0.3;W.prototype.redrawPath=function(aQ,aK,aP,aM,aO){var aL=aO*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aN=1.4;aQ.moveTo(0,0);aQ.lineTo(aM,0);aQ.lineTo(aM,aO-aL/2);aQ.quadTo(aM*3/4,aO-aL*aN,aM/2,aO-aL/2);aQ.quadTo(aM/4,aO-aL*(1-aN),0,aO-aL/2);aQ.lineTo(0,aL/2);aQ.close();aQ.end()};mxCellRenderer.prototype.defaultShapes.document=W;function s(){mxActor.call(this)}mxUtils.extend(s,mxActor);s.prototype.size=0.2;s.prototype.redrawPath=function(aQ,aK,aP,aL,aN){var aM=aL*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aO=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aQ,[new mxPoint(0,aN),new mxPoint(aM,0),new mxPoint(aL,0),new mxPoint(aL-aM,aN)],this.isRounded,aO,true);aQ.end()};mxCellRenderer.prototype.defaultShapes.parallelogram=s;function y(){mxActor.call(this)}mxUtils.extend(y,mxActor);y.prototype.size=0.2;y.prototype.redrawPath=function(aQ,aK,aP,aL,aN){var aM=aL*Math.max(0,Math.min(0.5,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aO=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aQ,[new mxPoint(0,aN),new mxPoint(aM,0),new mxPoint(aL-aM,0),new mxPoint(aL,aN)],this.isRounded,aO,true)};mxCellRenderer.prototype.defaultShapes.trapezoid=y;function aH(){mxActor.call(this)}mxUtils.extend(aH,mxActor);aH.prototype.size=0.5;aH.prototype.redrawPath=function(aQ,aK,aP,aL,aN){aQ.setFillColor(null);var aM=aL*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aO=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aQ,[new mxPoint(aL,0),new mxPoint(aM,0),new mxPoint(aM,aN/2),new mxPoint(0,aN/2),new mxPoint(aM,aN/2),new mxPoint(aM,aN),new mxPoint(aL,aN)],this.isRounded,aO,false);aQ.end()};mxCellRenderer.prototype.defaultShapes.curlyBracket=aH;function aC(){mxActor.call(this)}mxUtils.extend(aC,mxActor);aC.prototype.redrawPath=function(aP,aL,aO,aM,aN){aP.setStrokeWidth(1);aP.setFillColor(this.stroke);var aK=aM/5;aP.rect(0,0,aK,aN);aP.fillAndStroke();aP.rect(2*aK,0,aK,aN);aP.fillAndStroke();aP.rect(4*aK,0,aK,aN);aP.fillAndStroke()};mxCellRenderer.prototype.defaultShapes.parallelMarker=aC;function q(aL,aK){this.canvas=aL;this.canvas.setLineJoin("round");this.canvas.setLineCap("round");this.defaultVariation=aK;this.originalLineTo=this.canvas.lineTo;this.canvas.lineTo=mxUtils.bind(this,q.prototype.lineTo);this.originalMoveTo=this.canvas.moveTo;this.canvas.moveTo=mxUtils.bind(this,q.prototype.moveTo);this.originalClose=this.canvas.close;this.canvas.close=mxUtils.bind(this,q.prototype.close);this.originalQuadTo=this.canvas.quadTo;this.canvas.quadTo=mxUtils.bind(this,q.prototype.quadTo);this.originalCurveTo=this.canvas.curveTo;this.canvas.curveTo=mxUtils.bind(this,q.prototype.curveTo);this.originalArcTo=this.canvas.arcTo;this.canvas.arcTo=mxUtils.bind(this,q.prototype.arcTo)}q.prototype.moveTo=function(aL,aK){this.originalMoveTo.apply(this.canvas,arguments);this.lastX=aL;this.lastY=aK;this.firstX=aL;this.firstY=aK};q.prototype.close=function(){if(this.firstX!=null&&this.firstY!=null){this.lineTo(this.firstX,this.firstY);this.originalClose.apply(this.canvas,arguments)}this.originalClose.apply(this.canvas,arguments)};q.prototype.quadTo=function(aL,aN,aK,aM){this.originalQuadTo.apply(this.canvas,arguments);this.lastX=aK;this.lastY=aM};q.prototype.curveTo=function(aN,aP,aL,aO,aK,aM){this.originalCurveTo.apply(this.canvas,arguments);this.lastX=aK;this.lastY=aM};q.prototype.arcTo=function(aO,aM,aP,aN,aL,aK,aQ){this.originalArcTo.apply(this.canvas,arguments);this.lastX=aK;this.lastY=aQ};q.prototype.lineTo=function(aW,aV){if(this.lastX!=null&&this.lastY!=null){var aZ=Math.abs(aW-this.lastX);var aX=Math.abs(aV-this.lastY);var aQ=Math.sqrt(aZ*aZ+aX*aX);if(aQ<2){this.originalLineTo.apply(this.canvas,arguments);this.lastX=aW;this.lastY=aV;return}var aK=Math.round(aQ/10);var aO=this.defaultVariation;if(aK<5){aK=5;aO/=3}function aL(a0){return typeof a0==="number"?a0?a0<0?-1:1:a0===a0?0:NaN:NaN}var aU=aL(aW-this.lastX)*aZ/aK;var aT=aL(aV-this.lastY)*aX/aK;var aN=aZ/aQ;var aM=aX/aQ;for(var aY=0;aY<aK;aY++){var aS=aU*aY+this.lastX;var aR=aT*aY+this.lastY;var aP=(Math.random()-0.5)*aO;this.originalLineTo.call(this.canvas,aS-aP*aM,aR-aP*aN)}this.originalLineTo.call(this.canvas,aW,aV);this.lastX=aW;this.lastY=aV}else{this.originalLineTo.apply(this.canvas,arguments);this.lastX=aW;this.lastY=aV}};q.prototype.destroy=function(){this.canvas.lineTo=this.originalLineTo;this.canvas.moveTo=this.originalMoveTo;this.canvas.close=this.originalClose;this.canvas.quadTo=this.originalQuadTo;this.canvas.curveTo=this.originalCurveTo;this.canvas.arcTo=this.originalArcTo};var ae=mxShape.prototype.paint;mxShape.prototype.defaultJiggle=1.5;mxShape.prototype.paint=function(aK){if(this.style!=null&&mxUtils.getValue(this.style,"comic","0")!="0"&&aK.handHiggle==null){aK.handJiggle=new q(aK,mxUtils.getValue(this.style,"jiggle",this.defaultJiggle))}ae.apply(this,arguments);if(aK.handJiggle!=null){aK.handJiggle.destroy();delete aK.handJiggle}};mxRhombus.prototype.defaultJiggle=2;var al=mxRectangleShape.prototype.isHtmlAllowed;mxRectangleShape.prototype.isHtmlAllowed=function(){return(this.style==null||mxUtils.getValue(this.style,"comic","0")=="0")&&al.apply(this,arguments)};var C=mxRectangleShape.prototype.paintBackground;mxRectangleShape.prototype.paintBackground=function(aR,aK,aQ,aL,aN){if(aR.handJiggle==null){C.apply(this,arguments)}else{var aM=true;if(this.style!=null){aM=mxUtils.getValue(this.style,mxConstants.STYLE_POINTER_EVENTS,"1")=="1"}if(aM||(this.fill!=null&&this.fill!=mxConstants.NONE)||(this.stroke!=null&&this.stroke!=mxConstants.NONE)){if(!aM&&(this.fill==null||this.fill==mxConstants.NONE)){aR.pointerEvents=false}aR.begin();if(this.isRounded){var aP=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;var aO=Math.min(aL*aP,aN*aP);aR.moveTo(aK+aO,aQ);aR.lineTo(aK+aL-aO,aQ);aR.quadTo(aK+aL,aQ,aK+aL,aQ+aO);aR.lineTo(aK+aL,aQ+aN-aO);aR.quadTo(aK+aL,aQ+aN,aK+aL-aO,aQ+aN);aR.lineTo(aK+aO,aQ+aN);aR.quadTo(aK,aQ+aN,aK,aQ+aN-aO);aR.lineTo(aK,aQ+aO);aR.quadTo(aK,aQ,aK+aO,aQ)}else{aR.moveTo(aK,aQ);aR.lineTo(aK+aL,aQ);aR.lineTo(aK+aL,aQ+aN);aR.lineTo(aK,aQ+aN);aR.lineTo(aK,aQ)}aR.close();aR.end();aR.fillAndStroke()}}};var ad=mxRectangleShape.prototype.paintForeground;mxRectangleShape.prototype.paintForeground=function(aO,aK,aN,aL,aM){if(aO.handJiggle==null){ad.apply(this,arguments)}};function n(){mxRectangleShape.call(this)}mxUtils.extend(n,mxRectangleShape);n.prototype.size=0.1;n.prototype.isHtmlAllowed=function(){return false};n.prototype.getLabelBounds=function(aO){if(mxUtils.getValue(this.state.style,mxConstants.STYLE_HORIZONTAL,true)==(this.direction==null||this.direction==mxConstants.DIRECTION_EAST||this.direction==mxConstants.DIRECTION_WEST)){var aK=aO.width;var aM=aO.height;var aN=new mxRectangle(aO.x,aO.y,aK,aM);var aL=aK*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));if(this.isRounded){var aP=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;aL=Math.max(aL,Math.min(aK*aP,aM*aP))}aN.x+=aL;aN.width-=2*aL;return aN}return aO};n.prototype.paintForeground=function(aQ,aK,aP,aL,aN){var aM=aL*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));if(this.isRounded){var aO=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;aM=Math.max(aM,Math.min(aL*aO,aN*aO))}aQ.begin();aQ.moveTo(aK+aM,aP);aQ.lineTo(aK+aM,aP+aN);aQ.moveTo(aK+aL-aM,aP);aQ.lineTo(aK+aL-aM,aP+aN);aQ.end();aQ.stroke();mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxCellRenderer.prototype.defaultShapes.process=n;function aq(){mxActor.call(this)}mxUtils.extend(aq,mxActor);aq.prototype.size=0.2;aq.prototype.redrawPath=function(aQ,aK,aP,aL,aN){var aM=aL*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aO=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aQ,[new mxPoint(0,0),new mxPoint(aL-aM,0),new mxPoint(aL,aN/2),new mxPoint(aL-aM,aN),new mxPoint(0,aN),new mxPoint(aM,aN/2)],this.isRounded,aO,true);aQ.end()};mxCellRenderer.prototype.defaultShapes.step=aq;function aj(){mxActor.call(this)}mxUtils.extend(aj,mxHexagon);aj.prototype.size=0.25;aj.prototype.redrawPath=function(aQ,aK,aP,aL,aN){var aM=aL*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aO=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aQ,[new mxPoint(aM,0),new mxPoint(aL-aM,0),new mxPoint(aL,0.5*aN),new mxPoint(aL-aM,aN),new mxPoint(aM,aN),new mxPoint(0,0.5*aN)],this.isRounded,aO,true)};mxCellRenderer.prototype.defaultShapes.hexagon=aj;function v(){mxRectangleShape.call(this)}mxUtils.extend(v,mxRectangleShape);v.prototype.isHtmlAllowed=function(){return false};v.prototype.paintForeground=function(aP,aK,aO,aL,aN){var aM=Math.min(aL/5,aN/5)+1;aP.begin();aP.moveTo(aK+aL/2,aO+aM);aP.lineTo(aK+aL/2,aO+aN-aM);aP.moveTo(aK+aM,aO+aN/2);aP.lineTo(aK+aL-aM,aO+aN/2);aP.end();aP.stroke();mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxCellRenderer.prototype.defaultShapes.plus=v;var z=mxRhombus.prototype.paintVertexShape;mxRhombus.prototype.getLabelBounds=function(aK){if(this.style["double"]==1){var aL=(Math.max(2,this.strokewidth+1)*2+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0))*this.scale;return new mxRectangle(aK.x+aL,aK.y+aL,aK.width-2*aL,aK.height-2*aL)}return aK};mxRhombus.prototype.paintVertexShape=function(aP,aK,aO,aL,aM){z.apply(this,arguments);if(!this.outline&&this.style["double"]==1){var aN=Math.max(2,this.strokewidth+1)*2+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0);aK+=aN;aO+=aN;aL-=2*aN;aM-=2*aN;if(aL>0&&aM>0){aP.setShadow(false);z.apply(this,[aP,aK,aO,aL,aM])}}};function N(){mxRectangleShape.call(this)}mxUtils.extend(N,mxRectangleShape);N.prototype.isHtmlAllowed=function(){return false};N.prototype.getLabelBounds=function(aK){if(this.style["double"]==1){var aL=(Math.max(2,this.strokewidth+1)+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0))*this.scale;return new mxRectangle(aK.x+aL,aK.y+aL,aK.width-2*aL,aK.height-2*aL)}return aK};N.prototype.paintForeground=function(aT,aX,aV,aY,aP){if(this.style!=null){if(!this.outline&&this.style["double"]==1){var aN=Math.max(2,this.strokewidth+1)+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0);aX+=aN;aV+=aN;aY-=2*aN;aP-=2*aN;if(aY>0&&aP>0){mxRectangleShape.prototype.paintBackground.apply(this,arguments)}}aT.setDashed(false);var aK=0;var aR=null;do{aR=mxCellRenderer.prototype.defaultShapes[this.style["symbol"+aK]];if(aR!=null){var aQ=this.style["symbol"+aK+"Align"];var aW=this.style["symbol"+aK+"VerticalAlign"];var aM=this.style["symbol"+aK+"Width"];var aZ=this.style["symbol"+aK+"Height"];var aS=this.style["symbol"+aK+"Spacing"]||0;var a0=this.style["symbol"+aK+"ArcSpacing"];if(a0!=null){aS+=this.getArcSize(aY+this.strokewidth,aP+this.strokewidth)*a0}var aL=aX;var aU=aV;if(aQ==mxConstants.ALIGN_CENTER){aL+=(aY-aM)/2}else{if(aQ==mxConstants.ALIGN_RIGHT){aL+=aY-aM-aS}else{aL+=aS}}if(aW==mxConstants.ALIGN_MIDDLE){aU+=(aP-aZ)/2}else{if(aW==mxConstants.ALIGN_BOTTOM){aU+=aP-aZ-aS}else{aU+=aS}}aT.save();var aO=new aR();aO.style=this.style;aR.prototype.paintVertexShape.call(aO,aT,aL,aU,aM,aZ);aT.restore()}aK++}while(aR!=null)}mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxCellRenderer.prototype.defaultShapes.ext=N;function aG(){mxCylinder.call(this)}mxUtils.extend(aG,mxCylinder);aG.prototype.redrawPath=function(aO,aK,aP,aL,aN,aM){if(aM){aO.moveTo(0,0);aO.lineTo(aL/2,aN/2);aO.lineTo(aL,0);aO.end()}else{aO.moveTo(0,0);aO.lineTo(aL,0);aO.lineTo(aL,aN);aO.lineTo(0,aN);aO.close()}};mxCellRenderer.prototype.defaultShapes.message=aG;function f(){mxShape.call(this)}mxUtils.extend(f,mxShape);f.prototype.paintBackground=function(aO,aK,aN,aL,aM){aO.translate(aK,aN);aO.ellipse(aL/4,0,aL/2,aM/4);aO.fillAndStroke();aO.begin();aO.moveTo(aL/2,aM/4);aO.lineTo(aL/2,2*aM/3);aO.moveTo(aL/2,aM/3);aO.lineTo(0,aM/3);aO.moveTo(aL/2,aM/3);aO.lineTo(aL,aM/3);aO.moveTo(aL/2,2*aM/3);aO.lineTo(0,aM);aO.moveTo(aL/2,2*aM/3);aO.lineTo(aL,aM);aO.end();aO.stroke()};mxCellRenderer.prototype.defaultShapes.umlActor=f;function ac(){mxShape.call(this)}mxUtils.extend(ac,mxShape);ac.prototype.getLabelBounds=function(aK){return new mxRectangle(aK.x+aK.width/6,aK.y,aK.width*5/6,aK.height)};ac.prototype.paintBackground=function(aO,aK,aN,aL,aM){aO.translate(aK,aN);aO.begin();aO.moveTo(0,aM/4);aO.lineTo(0,aM*3/4);aO.end();aO.stroke();aO.begin();aO.moveTo(0,aM/2);aO.lineTo(aL/6,aM/2);aO.end();aO.stroke();aO.ellipse(aL/6,0,aL*5/6,aM);aO.fillAndStroke()};mxCellRenderer.prototype.defaultShapes.umlBoundary=ac;function r(){mxEllipse.call(this)}mxUtils.extend(r,mxEllipse);r.prototype.paintVertexShape=function(aO,aK,aN,aL,aM){mxEllipse.prototype.paintVertexShape.apply(this,arguments);aO.begin();aO.moveTo(aK+aL/8,aN+aM);aO.lineTo(aK+aL*7/8,aN+aM);aO.end();aO.stroke()};mxCellRenderer.prototype.defaultShapes.umlEntity=r;function ak(){mxShape.call(this)}mxUtils.extend(ak,mxShape);ak.prototype.paintVertexShape=function(aO,aK,aN,aL,aM){aO.translate(aK,aN);aO.begin();aO.moveTo(aL,0);aO.lineTo(0,aM);aO.moveTo(0,0);aO.lineTo(aL,aM);aO.end();aO.stroke()};mxCellRenderer.prototype.defaultShapes.umlDestroy=ak;function an(){mxShape.call(this)}mxUtils.extend(an,mxShape);an.prototype.getLabelBounds=function(aK){return new mxRectangle(aK.x,aK.y+aK.height/8,aK.width,aK.height*7/8)};an.prototype.paintBackground=function(aO,aK,aN,aL,aM){aO.translate(aK,aN);aO.begin();aO.moveTo(aL*3/8,aM/8*1.1);aO.lineTo(aL*5/8,0);aO.end();aO.stroke();aO.ellipse(0,aM/8,aL,aM*7/8);aO.fillAndStroke()};an.prototype.paintForeground=function(aO,aK,aN,aL,aM){aO.begin();aO.moveTo(aL*3/8,aM/8*1.1);aO.lineTo(aL*5/8,aM/4);aO.end();aO.stroke()};mxCellRenderer.prototype.defaultShapes.umlControl=an;function Q(){mxRectangleShape.call(this)}mxUtils.extend(Q,mxRectangleShape);Q.prototype.size=40;Q.prototype.isHtmlAllowed=function(){return false};Q.prototype.getLabelBounds=function(aL){var aK=Math.max(0,Math.min(aL.height,parseFloat(mxUtils.getValue(this.style,"size",this.size))*this.scale));return new mxRectangle(aL.x,aL.y,aL.width,aK)};Q.prototype.paintBackground=function(aM,aO,aN,aQ,aK){var aS=Math.max(0,Math.min(aK,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aR=mxUtils.getValue(this.style,"participant");if(aR==null||this.state==null){mxRectangleShape.prototype.paintBackground.call(this,aM,aO,aN,aQ,aS)}else{var aP=this.state.view.graph.cellRenderer.getShape(aR);if(aP!=null&&aP!=Q){var aL=new aP();aL.apply(this.state);aM.save();aL.paintVertexShape(aM,aO,aN,aQ,aS);aM.restore()}}if(aS<aK){aM.setDashed(true);aM.begin();aM.moveTo(aO+aQ/2,aN+aS);aM.lineTo(aO+aQ/2,aN+aK);aM.end();aM.stroke()}};Q.prototype.paintForeground=function(aP,aK,aO,aL,aN){var aM=Math.max(0,Math.min(aN,parseFloat(mxUtils.getValue(this.style,"size",this.size))));mxRectangleShape.prototype.paintForeground.call(this,aP,aK,aO,aL,Math.min(aN,aM))};mxCellRenderer.prototype.defaultShapes.umlLifeline=Q;function R(){mxShape.call(this)}mxUtils.extend(R,mxShape);R.prototype.width=60;R.prototype.height=30;R.prototype.corner=10;R.prototype.getLabelBounds=function(aM){var aK=Math.max(0,Math.min(aM.width,parseFloat(mxUtils.getValue(this.style,"width",this.width))*this.scale));var aL=Math.max(0,Math.min(aM.height,parseFloat(mxUtils.getValue(this.style,"height",this.height))*this.scale));return new mxRectangle(aM.x,aM.y,aK,aL)};R.prototype.paintBackground=function(aR,aK,aQ,aL,aO){var aP=this.corner;var aM=Math.min(aL,Math.max(aP,parseFloat(mxUtils.getValue(this.style,"width",this.width))));var aN=Math.min(aO,Math.max(aP*1.5,parseFloat(mxUtils.getValue(this.style,"height",this.height))));aR.begin();aR.moveTo(aK,aQ);aR.lineTo(aK+aM,aQ);aR.lineTo(aK+aM,aQ+Math.max(0,aN-aP*1.5));aR.lineTo(aK+Math.max(0,aM-aP),aQ+aN);aR.lineTo(aK,aQ+aN);aR.close();aR.fillAndStroke();aR.begin();aR.moveTo(aK+aM,aQ);aR.lineTo(aK+aL,aQ);aR.lineTo(aK+aL,aQ+aO);aR.lineTo(aK,aQ+aO);aR.lineTo(aK,aQ+aN);aR.stroke()};mxCellRenderer.prototype.defaultShapes.umlFrame=R;mxPerimeter.LifelinePerimeter=function(aN,aP,aM,aO){var aL=Q.prototype.size;if(aP!=null){aL=mxUtils.getValue(aP.style,"size",aL)*aP.view.scale}var aK=(parseFloat(aP.style[mxConstants.STYLE_STROKEWIDTH]||1)*aP.view.scale/2)-1;if(aM.x<aN.getCenterX()){aK+=1;aK*=-1}return new mxPoint(aN.getCenterX()+aK,Math.min(aN.y+aN.height,Math.max(aN.y+aL,aM.y)))};mxStyleRegistry.putValue("lifelinePerimeter",mxPerimeter.LifelinePerimeter);mxPerimeter.OrthogonalPerimeter=function(aL,aN,aK,aM){aM=true;return mxPerimeter.RectanglePerimeter.apply(this,arguments)};mxStyleRegistry.putValue("orthogonalPerimeter",mxPerimeter.OrthogonalPerimeter);mxPerimeter.BackbonePerimeter=function(aM,aO,aL,aN){var aK=(parseFloat(aO.style[mxConstants.STYLE_STROKEWIDTH]||1)*aO.view.scale/2)-1;if(aO.style.backboneSize!=null){aK+=(parseFloat(aO.style.backboneSize)*aO.view.scale/2)-1}if(aO.style[mxConstants.STYLE_DIRECTION]=="south"||aO.style[mxConstants.STYLE_DIRECTION]=="north"){if(aL.x<aM.getCenterX()){aK+=1;aK*=-1}return new mxPoint(aM.getCenterX()+aK,Math.min(aM.y+aM.height,Math.max(aM.y,aL.y)))}else{if(aL.y<aM.getCenterY()){aK+=1;aK*=-1}return new mxPoint(Math.min(aM.x+aM.width,Math.max(aM.x,aL.x)),aM.getCenterY()+aK)}};mxStyleRegistry.putValue("backbonePerimeter",mxPerimeter.BackbonePerimeter);function w(){mxShape.call(this)}mxUtils.extend(w,mxShape);w.prototype.size=10;w.prototype.paintBackground=function(aP,aK,aO,aL,aM){var aN=parseFloat(mxUtils.getValue(this.style,"size",this.size));aP.translate(aK,aO);aP.ellipse((aL-aN)/2,0,aN,aN);aP.fillAndStroke();aP.begin();aP.moveTo(aL/2,aN);aP.lineTo(aL/2,aM);aP.end();aP.stroke()};mxCellRenderer.prototype.defaultShapes.lollipop=w;function k(){mxShape.call(this)}mxUtils.extend(k,mxShape);k.prototype.size=10;k.prototype.inset=2;k.prototype.paintBackground=function(aQ,aK,aP,aL,aN){var aO=parseFloat(mxUtils.getValue(this.style,"size",this.size));var aM=parseFloat(mxUtils.getValue(this.style,"inset",this.inset))+this.strokewidth;aQ.translate(aK,aP);aQ.begin();aQ.moveTo(aL/2,aO+aM);aQ.lineTo(aL/2,aN);aQ.end();aQ.stroke();aQ.begin();aQ.moveTo((aL-aO)/2-aM,aO/2);aQ.quadTo((aL-aO)/2-aM,aO+aM,aL/2,aO+aM);aQ.quadTo((aL+aO)/2+aM,aO+aM,(aL+aO)/2+aM,aO/2);aQ.end();aQ.stroke()};mxCellRenderer.prototype.defaultShapes.requires=k;function L(){mxCylinder.call(this)}mxUtils.extend(L,mxCylinder);L.prototype.jettyWidth=32;L.prototype.jettyHeight=12;L.prototype.redrawPath=function(aU,aQ,aO,aS,aN,aM){var aV=parseFloat(mxUtils.getValue(this.style,"jettyWidth",this.jettyWidth));var aT=parseFloat(mxUtils.getValue(this.style,"jettyHeight",this.jettyHeight));var aL=aV/2;var aK=aL+aV/2;var aR=0.3*aN-aT/2;var aP=0.7*aN-aT/2;if(aM){aU.moveTo(aL,aR);aU.lineTo(aK,aR);aU.lineTo(aK,aR+aT);aU.lineTo(aL,aR+aT);aU.moveTo(aL,aP);aU.lineTo(aK,aP);aU.lineTo(aK,aP+aT);aU.lineTo(aL,aP+aT);aU.end()}else{aU.moveTo(aL,0);aU.lineTo(aS,0);aU.lineTo(aS,aN);aU.lineTo(aL,aN);aU.lineTo(aL,aP+aT);aU.lineTo(0,aP+aT);aU.lineTo(0,aP);aU.lineTo(aL,aP);aU.lineTo(aL,aR+aT);aU.lineTo(0,aR+aT);aU.lineTo(0,aR);aU.lineTo(aL,aR);aU.close();aU.end()}};mxCellRenderer.prototype.defaultShapes.component=L;function aA(){mxDoubleEllipse.call(this)}mxUtils.extend(aA,mxDoubleEllipse);aA.prototype.outerStroke=true;aA.prototype.paintVertexShape=function(aP,aK,aO,aL,aN){var aM=Math.min(4,Math.min(aL/5,aN/5));if(aL>0&&aN>0){aP.ellipse(aK+aM,aO+aM,aL-2*aM,aN-2*aM);aP.fillAndStroke()}aP.setShadow(false);if(this.outerStroke){aP.ellipse(aK,aO,aL,aN);aP.stroke()}};mxCellRenderer.prototype.defaultShapes.endState=aA;function ay(){aA.call(this)}mxUtils.extend(ay,aA);ay.prototype.outerStroke=false;mxCellRenderer.prototype.defaultShapes.startState=ay;function aE(){mxArrowConnector.call(this);this.spacing=0}mxUtils.extend(aE,mxArrowConnector);aE.prototype.defaultWidth=4;aE.prototype.isOpenEnded=function(){return true};aE.prototype.getEdgeWidth=function(){return mxUtils.getNumber(this.style,"width",this.defaultWidth)+Math.max(0,this.strokewidth-1)};aE.prototype.isArrowRounded=function(){return this.isRounded};mxCellRenderer.prototype.defaultShapes.link=aE;function aw(){mxArrowConnector.call(this);this.spacing=0}mxUtils.extend(aw,mxArrowConnector);aw.prototype.defaultWidth=10;aw.prototype.defaultArrowWidth=20;aw.prototype.getStartArrowWidth=function(){return this.getEdgeWidth()+mxUtils.getNumber(this.style,"startWidth",this.defaultArrowWidth)};aw.prototype.getEndArrowWidth=function(){return this.getEdgeWidth()+mxUtils.getNumber(this.style,"endWidth",this.defaultArrowWidth)};aw.prototype.getEdgeWidth=function(){return mxUtils.getNumber(this.style,"width",this.defaultWidth)+Math.max(0,this.strokewidth-1)};mxCellRenderer.prototype.defaultShapes.flexArrow=aw;function M(){mxActor.call(this)}mxUtils.extend(M,mxActor);M.prototype.size=30;M.prototype.redrawPath=function(aQ,aK,aP,aL,aN){var aM=Math.min(aN,parseFloat(mxUtils.getValue(this.style,"size",this.size)));var aO=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aQ,[new mxPoint(0,aN),new mxPoint(0,aM),new mxPoint(aL,0),new mxPoint(aL,aN)],this.isRounded,aO,true);aQ.end()};mxCellRenderer.prototype.defaultShapes.manualInput=M;function B(){mxRectangleShape.call(this)}mxUtils.extend(B,mxRectangleShape);B.prototype.dx=20;B.prototype.dy=20;B.prototype.isHtmlAllowed=function(){return false};B.prototype.paintForeground=function(aM,aO,aN,aP,aK){mxRectangleShape.prototype.paintForeground.apply(this,arguments);var aR=0;if(this.isRounded){var aL=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;aR=Math.max(aR,Math.min(aP*aL,aK*aL))}var aS=Math.max(aR,Math.min(aP,parseFloat(mxUtils.getValue(this.style,"dx",this.dx))));var aQ=Math.max(aR,Math.min(aK,parseFloat(mxUtils.getValue(this.style,"dy",this.dy))));aM.begin();aM.moveTo(aO,aN+aQ);aM.lineTo(aO+aP,aN+aQ);aM.end();aM.stroke();aM.begin();aM.moveTo(aO+aS,aN);aM.lineTo(aO+aS,aN+aK);aM.end();aM.stroke()};mxCellRenderer.prototype.defaultShapes.internalStorage=B;function aJ(){mxActor.call(this)}mxUtils.extend(aJ,mxActor);aJ.prototype.dx=20;aJ.prototype.dy=20;aJ.prototype.redrawPath=function(aM,aO,aN,aP,aL){var aS=Math.max(0,Math.min(aP,parseFloat(mxUtils.getValue(this.style,"dx",this.dx))));var aQ=Math.max(0,Math.min(aL,parseFloat(mxUtils.getValue(this.style,"dy",this.dy))));var aR=Math.min(aP/2,Math.min(aL,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aK=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aM,[new mxPoint(0,0),new mxPoint(aP,0),new mxPoint(aP,aQ),new mxPoint(aS,aQ),new mxPoint(aS,aL),new mxPoint(0,aL)],this.isRounded,aK,true);aM.end()};mxCellRenderer.prototype.defaultShapes.corner=aJ;function u(){mxActor.call(this)}mxUtils.extend(u,mxActor);u.prototype.dx=20;u.prototype.dy=20;u.prototype.redrawPath=function(aN,aP,aO,aQ,aM){var aT=Math.max(0,Math.min(aQ,parseFloat(mxUtils.getValue(this.style,"dx",this.dx))));var aR=Math.max(0,Math.min(aM,parseFloat(mxUtils.getValue(this.style,"dy",this.dy))));var aL=Math.abs(aQ-aT)/2;var aS=Math.min(aQ/2,Math.min(aM,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aK=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aN,[new mxPoint(0,0),new mxPoint(aQ,0),new mxPoint(aQ,aR),new mxPoint((aQ+aT)/2,aR),new mxPoint((aQ+aT)/2,aM),new mxPoint((aQ-aT)/2,aM),new mxPoint((aQ-aT)/2,aR),new mxPoint(0,aR)],this.isRounded,aK,true);aN.end()};mxCellRenderer.prototype.defaultShapes.tee=u;function ag(){mxActor.call(this)}mxUtils.extend(ag,mxActor);ag.prototype.arrowWidth=0.3;ag.prototype.arrowSize=0.2;ag.prototype.redrawPath=function(aP,aR,aQ,aS,aO){var aK=aO*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowWidth",this.arrowWidth))));var aM=aS*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowSize",this.arrowSize))));var aL=(aO-aK)/2;var aT=aL+aK;var aN=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aP,[new mxPoint(0,aL),new mxPoint(aS-aM,aL),new mxPoint(aS-aM,0),new mxPoint(aS,aO/2),new mxPoint(aS-aM,aO),new mxPoint(aS-aM,aT),new mxPoint(0,aT)],this.isRounded,aN,true);aP.end()};mxCellRenderer.prototype.defaultShapes.singleArrow=ag;function b(){mxActor.call(this)}mxUtils.extend(b,mxActor);b.prototype.redrawPath=function(aP,aR,aQ,aS,aO){var aK=aO*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowWidth",ag.prototype.arrowWidth))));var aM=aS*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowSize",ag.prototype.arrowSize))));var aL=(aO-aK)/2;var aT=aL+aK;var aN=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aP,[new mxPoint(0,aO/2),new mxPoint(aM,0),new mxPoint(aM,aL),new mxPoint(aS-aM,aL),new mxPoint(aS-aM,0),new mxPoint(aS,aO/2),new mxPoint(aS-aM,aO),new mxPoint(aS-aM,aT),new mxPoint(aM,aT),new mxPoint(aM,aO)],this.isRounded,aN,true);aP.end()};mxCellRenderer.prototype.defaultShapes.doubleArrow=b;function X(){mxActor.call(this)}mxUtils.extend(X,mxActor);X.prototype.size=0.1;X.prototype.redrawPath=function(aP,aK,aO,aL,aN){var aM=aL*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));aP.moveTo(aM,0);aP.lineTo(aL,0);aP.quadTo(aL-aM*2,aN/2,aL,aN);aP.lineTo(aM,aN);aP.quadTo(aM-aM*2,aN/2,aM,0);aP.close();aP.end()};mxCellRenderer.prototype.defaultShapes.dataStorage=X;function aF(){mxActor.call(this)}mxUtils.extend(aF,mxActor);aF.prototype.redrawPath=function(aO,aK,aN,aL,aM){aO.moveTo(0,0);aO.quadTo(aL,0,aL,aM/2);aO.quadTo(aL,aM,0,aM);aO.close();aO.end()};mxCellRenderer.prototype.defaultShapes.or=aF;function F(){mxActor.call(this)}mxUtils.extend(F,mxActor);F.prototype.redrawPath=function(aO,aK,aN,aL,aM){aO.moveTo(0,0);aO.quadTo(aL,0,aL,aM/2);aO.quadTo(aL,aM,0,aM);aO.quadTo(aL/2,aM/2,0,0);aO.close();aO.end()};mxCellRenderer.prototype.defaultShapes.xor=F;function g(){mxActor.call(this)}mxUtils.extend(g,mxActor);g.prototype.size=20;g.prototype.redrawPath=function(aQ,aK,aP,aL,aN){var aM=Math.min(aL/2,Math.min(aN,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aO=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aQ,[new mxPoint(aM,0),new mxPoint(aL-aM,0),new mxPoint(aL,aM*0.8),new mxPoint(aL,aN),new mxPoint(0,aN),new mxPoint(0,aM*0.8)],this.isRounded,aO,true);aQ.end()};mxCellRenderer.prototype.defaultShapes.loopLimit=g;function aI(){mxActor.call(this)}mxUtils.extend(aI,mxActor);aI.prototype.size=3/8;aI.prototype.redrawPath=function(aQ,aK,aP,aL,aN){var aM=aN*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aO=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(aQ,[new mxPoint(0,0),new mxPoint(aL,0),new mxPoint(aL,aN-aM),new mxPoint(aL/2,aN),new mxPoint(0,aN-aM)],this.isRounded,aO,true);aQ.end()};mxCellRenderer.prototype.defaultShapes.offPageConnector=aI;function J(){mxEllipse.call(this)}mxUtils.extend(J,mxEllipse);J.prototype.paintVertexShape=function(aO,aK,aN,aL,aM){mxEllipse.prototype.paintVertexShape.apply(this,arguments);aO.begin();aO.moveTo(aK+aL/2,aN+aM);aO.lineTo(aK+aL,aN+aM);aO.end();aO.stroke()};mxCellRenderer.prototype.defaultShapes.tapeData=J;function I(){mxEllipse.call(this)}mxUtils.extend(I,mxEllipse);I.prototype.paintVertexShape=function(aO,aK,aN,aL,aM){mxEllipse.prototype.paintVertexShape.apply(this,arguments);aO.setShadow(false);aO.begin();aO.moveTo(aK,aN+aM/2);aO.lineTo(aK+aL,aN+aM/2);aO.end();aO.stroke();aO.begin();aO.moveTo(aK+aL/2,aN);aO.lineTo(aK+aL/2,aN+aM);aO.end();aO.stroke()};mxCellRenderer.prototype.defaultShapes.orEllipse=I;function a(){mxEllipse.call(this)}mxUtils.extend(a,mxEllipse);a.prototype.paintVertexShape=function(aP,aK,aO,aL,aN){mxEllipse.prototype.paintVertexShape.apply(this,arguments);var aM=0.145;aP.setShadow(false);aP.begin();aP.moveTo(aK+aL*aM,aO+aN*aM);aP.lineTo(aK+aL*(1-aM),aO+aN*(1-aM));aP.end();aP.stroke();aP.begin();aP.moveTo(aK+aL*(1-aM),aO+aN*aM);aP.lineTo(aK+aL*aM,aO+aN*(1-aM));aP.end();aP.stroke()};mxCellRenderer.prototype.defaultShapes.sumEllipse=a;function ar(){mxRhombus.call(this)}mxUtils.extend(ar,mxRhombus);ar.prototype.paintVertexShape=function(aO,aK,aN,aL,aM){mxRhombus.prototype.paintVertexShape.apply(this,arguments);aO.setShadow(false);aO.begin();aO.moveTo(aK,aN+aM/2);aO.lineTo(aK+aL,aN+aM/2);aO.end();aO.stroke()};mxCellRenderer.prototype.defaultShapes.sortShape=ar;function t(){mxEllipse.call(this)}mxUtils.extend(t,mxEllipse);t.prototype.paintVertexShape=function(aO,aK,aN,aL,aM){aO.begin();aO.moveTo(aK,aN);aO.lineTo(aK+aL,aN);aO.lineTo(aK+aL/2,aN+aM/2);aO.close();aO.fillAndStroke();aO.begin();aO.moveTo(aK,aN+aM);aO.lineTo(aK+aL,aN+aM);aO.lineTo(aK+aL/2,aN+aM/2);aO.close();aO.fillAndStroke()};mxCellRenderer.prototype.defaultShapes.collate=t;function d(){mxEllipse.call(this)}mxUtils.extend(d,mxEllipse);d.prototype.paintVertexShape=function(aQ,aK,aP,aL,aM){var aN=10;var aO=aP+aM-aN/2;aQ.begin();aQ.moveTo(aK,aP);aQ.lineTo(aK,aP+aM);aQ.moveTo(aK,aO);aQ.lineTo(aK+aN,aO-aN/2);aQ.moveTo(aK,aO);aQ.lineTo(aK+aN,aO+aN/2);aQ.moveTo(aK,aO);aQ.lineTo(aK+aL,aO);aQ.moveTo(aK+aL,aP);aQ.lineTo(aK+aL,aP+aM);aQ.moveTo(aK+aL,aO);aQ.lineTo(aK+aL-aN,aO-aN/2);aQ.moveTo(aK+aL,aO);aQ.lineTo(aK+aL-aN,aO+aN/2);aQ.end();aQ.stroke()};mxCellRenderer.prototype.defaultShapes.dimension=d;function az(){mxEllipse.call(this)}mxUtils.extend(az,mxEllipse);az.prototype.paintVertexShape=function(aO,aK,aN,aL,aM){if(!this.outline){aO.setStrokeColor(null)}mxRectangleShape.prototype.paintBackground.apply(this,arguments);if(this.style!=null){aO.setStrokeColor(this.stroke);aO.rect(aK,aN,aL,aM);aO.fill();if(mxUtils.getValue(this.style,"top","1")=="1"){aO.begin();aO.moveTo(aK,aN);aO.lineTo(aK+aL,aN);aO.end();aO.stroke()}if(mxUtils.getValue(this.style,"right","1")=="1"){aO.begin();aO.moveTo(aK+aL,aN);aO.lineTo(aK+aL,aN+aM);aO.end();aO.stroke()}if(mxUtils.getValue(this.style,"bottom","1")=="1"){aO.begin();aO.moveTo(aK+aL,aN+aM);aO.lineTo(aK,aN+aM);aO.end();aO.stroke()}if(mxUtils.getValue(this.style,"left","1")=="1"){aO.begin();aO.moveTo(aK,aN+aM);aO.lineTo(aK,aN);aO.end();aO.stroke()}}};mxCellRenderer.prototype.defaultShapes.partialRectangle=az;function P(){mxEllipse.call(this)}mxUtils.extend(P,mxEllipse);P.prototype.paintVertexShape=function(aO,aK,aN,aL,aM){mxEllipse.prototype.paintVertexShape.apply(this,arguments);aO.setShadow(false);aO.begin();if(mxUtils.getValue(this.style,"line")=="vertical"){aO.moveTo(aK+aL/2,aN);aO.lineTo(aK+aL/2,aN+aM)}else{aO.moveTo(aK,aN+aM/2);aO.lineTo(aK+aL,aN+aM/2)}aO.end();aO.stroke()};mxCellRenderer.prototype.defaultShapes.lineEllipse=P;function O(){mxActor.call(this)}mxUtils.extend(O,mxActor);O.prototype.redrawPath=function(aP,aK,aO,aL,aN){var aM=Math.min(aL,aN/2);aP.moveTo(0,0);aP.lineTo(aL-aM,0);aP.quadTo(aL,0,aL,aN/2);aP.quadTo(aL,aN,aL-aM,aN);aP.lineTo(0,aN);aP.close();aP.end()};mxCellRenderer.prototype.defaultShapes.delay=O;function E(){mxActor.call(this)}mxUtils.extend(E,mxActor);E.prototype.size=0.2;E.prototype.redrawPath=function(aO,aR,aQ,aS,aN){var aL=Math.min(aN,aS);var aU=Math.max(0,Math.min(aL,aL*parseFloat(mxUtils.getValue(this.style,"size",this.size))));var aT=(aN-aU)/2;var aP=aT+aU;var aM=(aS-aU)/2;var aK=aM+aU;aO.moveTo(0,aT);aO.lineTo(aM,aT);aO.lineTo(aM,0);aO.lineTo(aK,0);aO.lineTo(aK,aT);aO.lineTo(aS,aT);aO.lineTo(aS,aP);aO.lineTo(aK,aP);aO.lineTo(aK,aN);aO.lineTo(aM,aN);aO.lineTo(aM,aP);aO.lineTo(0,aP);aO.close();aO.end()};mxCellRenderer.prototype.defaultShapes.cross=E;function D(){mxActor.call(this)}mxUtils.extend(D,mxActor);D.prototype.size=0.25;D.prototype.redrawPath=function(aQ,aK,aP,aL,aO){var aM=Math.min(aL,aO/2);var aN=Math.min(aL-aM,Math.max(0,parseFloat(mxUtils.getValue(this.style,"size",this.size)))*aL);aQ.moveTo(0,aO/2);aQ.lineTo(aN,0);aQ.lineTo(aL-aM,0);aQ.quadTo(aL,0,aL,aO/2);aQ.quadTo(aL,aO,aL-aM,aO);aQ.lineTo(aN,aO);aQ.close();aQ.end()};mxCellRenderer.prototype.defaultShapes.display=D;mxMarker.addMarker("dash",function(aP,aN,aQ,aO,aS,aR,aV,aK,aT,aU){var aM=aS*(aV+aT+1);var aL=aR*(aV+aT+1);return function(){aP.begin();aP.moveTo(aO.x-aM/2-aL/2,aO.y-aL/2+aM/2);aP.lineTo(aO.x+aL/2-3*aM/2,aO.y-3*aL/2-aM/2);aP.stroke()}});mxMarker.addMarker("cross",function(aP,aN,aQ,aO,aS,aR,aV,aK,aT,aU){var aM=aS*(aV+aT+1);var aL=aR*(aV+aT+1);return function(){aP.begin();aP.moveTo(aO.x-aM/2-aL/2,aO.y-aL/2+aM/2);aP.lineTo(aO.x+aL/2-3*aM/2,aO.y-3*aL/2-aM/2);aP.moveTo(aO.x-aM/2+aL/2,aO.y-aL/2-aM/2);aP.lineTo(aO.x-aL/2-3*aM/2,aO.y-3*aL/2+aM/2);aP.stroke()}});function Y(aN,aL,aO,aM,aR,aP,aV,aK,aS,aU){var aQ=aV/2;var aV=aV+aS;var aT=aM.clone();aM.x-=aR*(2*aV+aS);aM.y-=aP*(2*aV+aS);aR=aR*(aV+aS);aP=aP*(aV+aS);return function(){aN.ellipse(aT.x-aR-aV,aT.y-aP-aV,2*aV,2*aV);if(aU){aN.fillAndStroke()}else{aN.stroke()}}}mxMarker.addMarker("circle",Y);mxMarker.addMarker("circlePlus",function(aP,aN,aQ,aO,aT,aS,aX,aK,aU,aW){var aV=aO.clone();var aR=Y.apply(this,arguments);var aM=aT*(aX+2*aU);var aL=aS*(aX+2*aU);return function(){aR.apply(this,arguments);aP.begin();aP.moveTo(aV.x-aT*(aU),aV.y-aS*(aU));aP.lineTo(aV.x-2*aM+aT*(aU),aV.y-2*aL+aS*(aU));aP.moveTo(aV.x-aM-aL+aS*aU,aV.y-aL+aM-aT*aU);aP.lineTo(aV.x+aL-aM-aS*aU,aV.y-aL-aM+aT*aU);aP.stroke()}});mxMarker.addMarker("async",function(aQ,aO,aR,aP,aT,aS,aX,aK,aU,aW){var aM=aT*aU*1.118;var aL=aS*aU*1.118;aT=aT*(aX+aU);aS=aS*(aX+aU);var aV=aP.clone();aV.x-=aM;aV.y-=aL;var aN=1;aP.x+=-aT*aN-aM;aP.y+=-aS*aN-aL;return function(){aQ.begin();aQ.moveTo(aV.x,aV.y);if(aK){aQ.lineTo(aV.x-aT-aS/2,aV.y-aS+aT/2)}else{aQ.lineTo(aV.x+aS/2-aT,aV.y-aS-aT/2)}aQ.lineTo(aV.x-aT,aV.y-aS);aQ.close();if(aW){aQ.fillAndStroke()}else{aQ.stroke()}}});function i(aK){aK=(aK!=null)?aK:2;return function(aO,aM,aP,aN,aR,aQ,aV,aL,aS,aU){aR=aR*(aV+aS);aQ=aQ*(aV+aS);var aT=aN.clone();return function(){aO.begin();aO.moveTo(aT.x,aT.y);if(aL){aO.lineTo(aT.x-aR-aQ/aK,aT.y-aQ+aR/aK)}else{aO.lineTo(aT.x+aQ/aK-aR,aT.y-aQ-aR/aK)}aO.stroke()}}}mxMarker.addMarker("openAsync",i(2));function K(aM,aP,aR,aQ,aT,aS,aX,aK,aU,aW){var aN=aT*aU*1.118;var aL=aS*aU*1.118;aT=aT*(aX+aU);aS=aS*(aX+aU);var aV=aQ.clone();aV.x-=aN;aV.y-=aL;var aO=(aR!=mxConstants.ARROW_CLASSIC&&aR!=mxConstants.ARROW_CLASSIC_THIN)?1:3/4;aQ.x+=-aT*aO-aN;aQ.y+=-aS*aO-aL;return function(){aM.begin();aM.moveTo(aV.x,aV.y);aM.lineTo(aV.x-aT-aS/widthFactor,aV.y-aS+aT/widthFactor);if(aR==mxConstants.ARROW_CLASSIC||aR==mxConstants.ARROW_CLASSIC_THIN){aM.lineTo(aV.x-aT*3/4,aV.y-aS*3/4)}aM.lineTo(aV.x+aS/widthFactor-aT,aV.y-aS-aT/widthFactor);aM.close();if(aW){aM.fillAndStroke()}else{aM.stroke()}}}if(typeof mxVertexHandler!=="undefined"){function A(aP,aN,aL,aM,aK){var aO=new mxHandle(aP,null,mxVertexHandler.prototype.secondaryHandleImage);aO.execute=function(){for(var aQ=0;aQ<aN.length;aQ++){this.copyStyle(aN[aQ])}};aO.getPosition=aL;aO.setPosition=aM;aO.ignoreGrid=(aK!=null)?aK:true;return aO}function l(aK,aL){return A(aK,[mxConstants.STYLE_ARCSIZE],function(aN){var aO=Math.max(0,parseFloat(mxUtils.getValue(aK.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)))/100;var aM=(aL!=null)?aL:aN.height/8;return new mxPoint(aN.x+aN.width-Math.min(Math.max(aN.width/2,aN.height/2),Math.min(aN.width,aN.height)*aO),aN.y+aM)},function(aN,aP,aM){var aO=Math.min(50,Math.max(0,(aN.width-aP.x+aN.x)*100/Math.min(aN.width,aN.height)));this.state.style[mxConstants.STYLE_ARCSIZE]=Math.round(aO)})}function ab(){return function(aL){var aK=[];if(mxUtils.getValue(aL.style,mxConstants.STYLE_ROUNDED,false)){aK.push(l(aL))}return aK}}function p(aK){return function(aM){var aL=[A(aM,["size"],function(aO){var aN=Math.max(0,Math.min(aK,parseFloat(mxUtils.getValue(this.state.style,"size",y.prototype.size))));return new mxPoint(aO.x+aN*aO.width*0.75,aO.y+aO.height/4)},function(aN,aO){this.state.style.size=Math.max(0,Math.min(aK,(aO.x-aN.x)/(aN.width*0.75)))})];if(mxUtils.getValue(aM.style,mxConstants.STYLE_ROUNDED,false)){aL.push(l(aM))}return aL}}function Z(aL,aM,aK){aK=(aK!=null)?aK:1;return function(aO){var aN=[A(aO,["size"],function(aQ){var aP=parseFloat(mxUtils.getValue(this.state.style,"size",aL));return new mxPoint(aQ.x+aP*aQ.width,aQ.getCenterY())},function(aP,aQ){this.state.style.size=Math.max(0,Math.min(aK,(aQ.x-aP.x)/aP.width))})];if(aM&&mxUtils.getValue(aO.style,mxConstants.STYLE_ROUNDED,false)){aN.push(l(aO))}return aN}}function av(aL,aK,aM){return function(aO){var aN=[A(aO,["size"],function(aQ){var aP=Math.max(0,Math.min(aQ.width,Math.min(aQ.height,parseFloat(mxUtils.getValue(this.state.style,"size",aK)))))*aL;return new mxPoint(aQ.x+aP,aQ.y+aP)},function(aP,aQ){this.state.style.size=Math.round(Math.max(0,Math.min(Math.min(aP.width,aQ.x-aP.x),Math.min(aP.height,aQ.y-aP.y)))/aL)})];if(aM&&mxUtils.getValue(aO.style,mxConstants.STYLE_ROUNDED,false)){aN.push(l(aO))}return aN}}function e(aK){return function(aL){return[A(aL,["arrowWidth","arrowSize"],function(aN){var aO=Math.max(0,Math.min(1,mxUtils.getValue(this.state.style,"arrowWidth",ag.prototype.arrowWidth)));var aM=Math.max(0,Math.min(aK,mxUtils.getValue(this.state.style,"arrowSize",ag.prototype.arrowSize)));return new mxPoint(aN.x+(1-aM)*aN.width,aN.y+(1-aO)*aN.height/2)},function(aM,aN){this.state.style.arrowWidth=Math.max(0,Math.min(1,Math.abs(aM.y+aM.height/2-aN.y)/aM.height*2));this.state.style.arrowSize=Math.max(0,Math.min(aK,(aM.x+aM.width-aN.x)/(aM.width)))})]}}function ah(aK,aT,aL,aU,aP){var aX=aK.absolutePoints;var aM=aX.length-1;var aO=aK.view.translate;var aW=aK.view.scale;var aS=(aL)?aX[0]:aX[aM];var aQ=(aL)?aX[1]:aX[aM-1];var aV=(aL)?aQ.x-aS.x:aQ.x-aS.x;var aR=(aL)?aQ.y-aS.y:aQ.y-aS.y;var aN=Math.sqrt(aV*aV+aR*aR);return A(aK,aT,function(aY){var aZ=aU.call(this,aN,aV/aN,aR/aN,aS,aQ);return new mxPoint(aZ.x/aW-aO.x,aZ.y/aW-aO.y)},function(aZ,a0,aY){var a1=Math.sqrt(aV*aV+aR*aR);a0.x=(a0.x+aO.x)*aW;a0.y=(a0.y+aO.y)*aW;aP.call(this,a1,aV/a1,aR/a1,aS,aQ,a0,aY)})}function ax(aK,aM,aL){return ah(aK,["width"],aM,function(aQ,aN,aS,aR,aP){var aO=aK.shape.getEdgeWidth()*aK.view.scale+aL;return new mxPoint(aR.x+aN*aQ/4+aS*aO/2,aR.y+aS*aQ/4-aN*aO/2)},function(aR,aN,aT,aS,aQ,aP){var aO=Math.sqrt(mxUtils.ptSegDistSq(aS.x,aS.y,aQ.x,aQ.y,aP.x,aP.y));aK.style.width=Math.round(aO*2)/aK.view.scale-aL})}function au(aL,aO,aK,aN,aM,aP){return Math.abs((aN-aO)*aM-(aK-aL)*aP+aK*aO-aN*aL)/Math.sqrt((aN-aO)*(aN-aO)+(aK-aL)*(aK-aL))}var ai={link:function(aK){var aL=10;return[ax(aK,true,aL),ax(aK,false,aL)]},flexArrow:function(aM){var aK=aM.view.graph.gridSize/aM.view.scale;var aL=[];if(mxUtils.getValue(aM.style,mxConstants.STYLE_STARTARROW,mxConstants.NONE)!=mxConstants.NONE){aL.push(ah(aM,["width",mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE],true,function(aR,aN,aT,aS,aQ){var aP=(aM.shape.getEdgeWidth()-aM.shape.strokewidth)*aM.view.scale;var aO=mxUtils.getNumber(aM.style,mxConstants.STYLE_STARTSIZE,mxConstants.ARROW_SIZE/5)*3*aM.view.scale;return new mxPoint(aS.x+aN*(aO+aM.shape.strokewidth*aM.view.scale)+aT*aP/2,aS.y+aT*(aO+aM.shape.strokewidth*aM.view.scale)-aN*aP/2)},function(aQ,aP,aO,aU,aT,aV,aR){var aS=Math.sqrt(mxUtils.ptSegDistSq(aU.x,aU.y,aT.x,aT.y,aV.x,aV.y));var aN=mxUtils.ptLineDist(aU.x,aU.y,aU.x+aO,aU.y-aP,aV.x,aV.y);aM.style[mxConstants.STYLE_STARTSIZE]=Math.round((aN-aM.shape.strokewidth)*100/3)/100/aM.view.scale;aM.style.width=Math.round(aS*2)/aM.view.scale;if(mxEvent.isControlDown(aR.getEvent())){aM.style[mxConstants.STYLE_ENDSIZE]=aM.style[mxConstants.STYLE_STARTSIZE]}if(!mxEvent.isAltDown(aR.getEvent())){if(Math.abs(parseFloat(aM.style[mxConstants.STYLE_STARTSIZE])-parseFloat(aM.style[mxConstants.STYLE_ENDSIZE]))<aK/6){aM.style[mxConstants.STYLE_STARTSIZE]=aM.style[mxConstants.STYLE_ENDSIZE]}}}));aL.push(ah(aM,["startWidth","endWidth",mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE],true,function(aR,aN,aT,aS,aQ){var aP=(aM.shape.getStartArrowWidth()-aM.shape.strokewidth)*aM.view.scale;var aO=mxUtils.getNumber(aM.style,mxConstants.STYLE_STARTSIZE,mxConstants.ARROW_SIZE/5)*3*aM.view.scale;return new mxPoint(aS.x+aN*(aO+aM.shape.strokewidth*aM.view.scale)+aT*aP/2,aS.y+aT*(aO+aM.shape.strokewidth*aM.view.scale)-aN*aP/2)},function(aQ,aP,aO,aU,aT,aV,aR){var aS=Math.sqrt(mxUtils.ptSegDistSq(aU.x,aU.y,aT.x,aT.y,aV.x,aV.y));var aN=mxUtils.ptLineDist(aU.x,aU.y,aU.x+aO,aU.y-aP,aV.x,aV.y);aM.style[mxConstants.STYLE_STARTSIZE]=Math.round((aN-aM.shape.strokewidth)*100/3)/100/aM.view.scale;aM.style.startWidth=Math.max(0,Math.round(aS*2)-aM.shape.getEdgeWidth())/aM.view.scale;if(mxEvent.isControlDown(aR.getEvent())){aM.style[mxConstants.STYLE_ENDSIZE]=aM.style[mxConstants.STYLE_STARTSIZE];aM.style.endWidth=aM.style.startWidth}if(!mxEvent.isAltDown(aR.getEvent())){if(Math.abs(parseFloat(aM.style[mxConstants.STYLE_STARTSIZE])-parseFloat(aM.style[mxConstants.STYLE_ENDSIZE]))<aK/6){aM.style[mxConstants.STYLE_STARTSIZE]=aM.style[mxConstants.STYLE_ENDSIZE]}if(Math.abs(parseFloat(aM.style.startWidth)-parseFloat(aM.style.endWidth))<aK){aM.style.startWidth=aM.style.endWidth}}}))}if(mxUtils.getValue(aM.style,mxConstants.STYLE_ENDARROW,mxConstants.NONE)!=mxConstants.NONE){aL.push(ah(aM,["width",mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE],false,function(aR,aN,aT,aS,aQ){var aP=(aM.shape.getEdgeWidth()-aM.shape.strokewidth)*aM.view.scale;var aO=mxUtils.getNumber(aM.style,mxConstants.STYLE_ENDSIZE,mxConstants.ARROW_SIZE/5)*3*aM.view.scale;return new mxPoint(aS.x+aN*(aO+aM.shape.strokewidth*aM.view.scale)-aT*aP/2,aS.y+aT*(aO+aM.shape.strokewidth*aM.view.scale)+aN*aP/2)},function(aQ,aP,aO,aU,aT,aV,aR){var aS=Math.sqrt(mxUtils.ptSegDistSq(aU.x,aU.y,aT.x,aT.y,aV.x,aV.y));var aN=mxUtils.ptLineDist(aU.x,aU.y,aU.x+aO,aU.y-aP,aV.x,aV.y);aM.style[mxConstants.STYLE_ENDSIZE]=Math.round((aN-aM.shape.strokewidth)*100/3)/100/aM.view.scale;aM.style.width=Math.round(aS*2)/aM.view.scale;if(mxEvent.isControlDown(aR.getEvent())){aM.style[mxConstants.STYLE_STARTSIZE]=aM.style[mxConstants.STYLE_ENDSIZE]}if(!mxEvent.isAltDown(aR.getEvent())){if(Math.abs(parseFloat(aM.style[mxConstants.STYLE_ENDSIZE])-parseFloat(aM.style[mxConstants.STYLE_STARTSIZE]))<aK/6){aM.style[mxConstants.STYLE_ENDSIZE]=aM.style[mxConstants.STYLE_STARTSIZE]}}}));aL.push(ah(aM,["startWidth","endWidth",mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE],false,function(aR,aN,aT,aS,aQ){var aP=(aM.shape.getEndArrowWidth()-aM.shape.strokewidth)*aM.view.scale;var aO=mxUtils.getNumber(aM.style,mxConstants.STYLE_ENDSIZE,mxConstants.ARROW_SIZE/5)*3*aM.view.scale;return new mxPoint(aS.x+aN*(aO+aM.shape.strokewidth*aM.view.scale)-aT*aP/2,aS.y+aT*(aO+aM.shape.strokewidth*aM.view.scale)+aN*aP/2)},function(aQ,aP,aO,aU,aT,aV,aR){var aS=Math.sqrt(mxUtils.ptSegDistSq(aU.x,aU.y,aT.x,aT.y,aV.x,aV.y));var aN=mxUtils.ptLineDist(aU.x,aU.y,aU.x+aO,aU.y-aP,aV.x,aV.y);aM.style[mxConstants.STYLE_ENDSIZE]=Math.round((aN-aM.shape.strokewidth)*100/3)/100/aM.view.scale;aM.style.endWidth=Math.max(0,Math.round(aS*2)-aM.shape.getEdgeWidth())/aM.view.scale;if(mxEvent.isControlDown(aR.getEvent())){aM.style[mxConstants.STYLE_STARTSIZE]=aM.style[mxConstants.STYLE_ENDSIZE];aM.style.startWidth=aM.style.endWidth}if(!mxEvent.isAltDown(aR.getEvent())){if(Math.abs(parseFloat(aM.style[mxConstants.STYLE_ENDSIZE])-parseFloat(aM.style[mxConstants.STYLE_STARTSIZE]))<aK/6){aM.style[mxConstants.STYLE_ENDSIZE]=aM.style[mxConstants.STYLE_STARTSIZE]}if(Math.abs(parseFloat(aM.style.endWidth)-parseFloat(aM.style.startWidth))<aK){aM.style.endWidth=aM.style.startWidth}}}))}return aL},swimlane:function(aM){var aL=[A(aM,[mxConstants.STYLE_STARTSIZE],function(aO){var aN=parseFloat(mxUtils.getValue(aM.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));if(mxUtils.getValue(aM.style,mxConstants.STYLE_HORIZONTAL,1)==1){return new mxPoint(aO.getCenterX(),aO.y+Math.max(0,Math.min(aO.height,aN)))}else{return new mxPoint(aO.x+Math.max(0,Math.min(aO.width,aN)),aO.getCenterY())}},function(aN,aO){aM.style[mxConstants.STYLE_STARTSIZE]=(mxUtils.getValue(this.state.style,mxConstants.STYLE_HORIZONTAL,1)==1)?Math.round(Math.max(0,Math.min(aN.height,aO.y-aN.y))):Math.round(Math.max(0,Math.min(aN.width,aO.x-aN.x)))})];if(mxUtils.getValue(aM.style,mxConstants.STYLE_ROUNDED)){var aK=parseFloat(mxUtils.getValue(aM.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));aL.push(l(aM,aK/2))}return aL},label:ab(),ext:ab(),rectangle:ab(),triangle:ab(),rhombus:ab(),umlLifeline:function(aK){return[A(aK,["size"],function(aM){var aL=Math.max(0,Math.min(aM.height,parseFloat(mxUtils.getValue(this.state.style,"size",Q.prototype.size))));return new mxPoint(aM.getCenterX(),aM.y+aL)},function(aL,aM){this.state.style.size=Math.round(Math.max(0,Math.min(aL.height,aM.y-aL.y)))},false)]},umlFrame:function(aL){var aK=[A(aL,["width","height"],function(aO){var aM=Math.max(R.prototype.corner,Math.min(aO.width,mxUtils.getValue(this.state.style,"width",R.prototype.width)));var aN=Math.max(R.prototype.corner*1.5,Math.min(aO.height,mxUtils.getValue(this.state.style,"height",R.prototype.height)));return new mxPoint(aO.x+aM,aO.y+aN)},function(aM,aN){this.state.style.width=Math.round(Math.max(R.prototype.corner,Math.min(aM.width,aN.x-aM.x)));this.state.style.height=Math.round(Math.max(R.prototype.corner*1.5,Math.min(aM.height,aN.y-aM.y)))},false)];if(mxUtils.getValue(aL.style,mxConstants.STYLE_ROUNDED,false)){aK.push(l(aL))}return aK},process:function(aL){var aK=[A(aL,["size"],function(aN){var aM=Math.max(0,Math.min(0.5,parseFloat(mxUtils.getValue(this.state.style,"size",n.prototype.size))));return new mxPoint(aN.x+aN.width*aM,aN.y+aN.height/4)},function(aM,aN){this.state.style.size=Math.max(0,Math.min(0.5,(aN.x-aM.x)/aM.width))})];if(mxUtils.getValue(aL.style,mxConstants.STYLE_ROUNDED,false)){aK.push(l(aL))}return aK},cross:function(aK){return[A(aK,["size"],function(aN){var aL=Math.min(aN.width,aN.height);var aM=Math.max(0,Math.min(1,mxUtils.getValue(this.state.style,"size",E.prototype.size)))*aL/2;return new mxPoint(aN.getCenterX()-aM,aN.getCenterY()-aM)},function(aM,aN){var aL=Math.min(aM.width,aM.height);this.state.style.size=Math.max(0,Math.min(1,Math.min((Math.max(0,aM.getCenterY()-aN.y)/aL)*2,(Math.max(0,aM.getCenterX()-aN.x)/aL)*2)))})]},note:function(aK){return[A(aK,["size"],function(aM){var aL=Math.max(0,Math.min(aM.width,Math.min(aM.height,parseFloat(mxUtils.getValue(this.state.style,"size",ap.prototype.size)))));return new mxPoint(aM.x+aM.width-aL,aM.y+aL)},function(aL,aM){this.state.style.size=Math.round(Math.max(0,Math.min(Math.min(aL.width,aL.x+aL.width-aM.x),Math.min(aL.height,aM.y-aL.y))))})]},manualInput:function(aL){var aK=[A(aL,["size"],function(aN){var aM=Math.max(0,Math.min(aN.height,mxUtils.getValue(this.state.style,"size",M.prototype.size)));return new mxPoint(aN.x+aN.width/4,aN.y+aM*3/4)},function(aM,aN){this.state.style.size=Math.round(Math.max(0,Math.min(aM.height,(aN.y-aM.y)*4/3)))})];if(mxUtils.getValue(aL.style,mxConstants.STYLE_ROUNDED,false)){aK.push(l(aL))}return aK},dataStorage:function(aK){return[A(aK,["size"],function(aM){var aL=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",X.prototype.size))));return new mxPoint(aM.x+(1-aL)*aM.width,aM.getCenterY())},function(aL,aM){this.state.style.size=Math.max(0,Math.min(1,(aL.x+aL.width-aM.x)/aL.width))})]},internalStorage:function(aL){var aK=[A(aL,["dx","dy"],function(aO){var aN=Math.max(0,Math.min(aO.width,mxUtils.getValue(this.state.style,"dx",B.prototype.dx)));var aM=Math.max(0,Math.min(aO.height,mxUtils.getValue(this.state.style,"dy",B.prototype.dy)));return new mxPoint(aO.x+aN,aO.y+aM)},function(aM,aN){this.state.style.dx=Math.round(Math.max(0,Math.min(aM.width,aN.x-aM.x)));this.state.style.dy=Math.round(Math.max(0,Math.min(aM.height,aN.y-aM.y)))})];if(mxUtils.getValue(aL.style,mxConstants.STYLE_ROUNDED,false)){aK.push(l(aL))}return aK},corner:function(aK){return[A(aK,["dx","dy"],function(aN){var aM=Math.max(0,Math.min(aN.width,mxUtils.getValue(this.state.style,"dx",aJ.prototype.dx)));var aL=Math.max(0,Math.min(aN.height,mxUtils.getValue(this.state.style,"dy",aJ.prototype.dy)));return new mxPoint(aN.x+aM,aN.y+aL)},function(aL,aM){this.state.style.dx=Math.round(Math.max(0,Math.min(aL.width,aM.x-aL.x)));this.state.style.dy=Math.round(Math.max(0,Math.min(aL.height,aM.y-aL.y)))})]},tee:function(aK){return[A(aK,["dx","dy"],function(aN){var aM=Math.max(0,Math.min(aN.width,mxUtils.getValue(this.state.style,"dx",u.prototype.dx)));var aL=Math.max(0,Math.min(aN.height,mxUtils.getValue(this.state.style,"dy",u.prototype.dy)));return new mxPoint(aN.x+(aN.width+aM)/2,aN.y+aL)},function(aL,aM){this.state.style.dx=Math.round(Math.max(0,Math.min(aL.width/2,(aM.x-aL.x-aL.width/2))*2));this.state.style.dy=Math.round(Math.max(0,Math.min(aL.height,aM.y-aL.y)))})]},singleArrow:e(1),doubleArrow:e(0.5),folder:function(aK){return[A(aK,["tabWidth","tabHeight"],function(aN){var aL=Math.max(0,Math.min(aN.width,mxUtils.getValue(this.state.style,"tabWidth",am.prototype.tabWidth)));var aM=Math.max(0,Math.min(aN.height,mxUtils.getValue(this.state.style,"tabHeight",am.prototype.tabHeight)));if(mxUtils.getValue(this.state.style,"tabPosition",am.prototype.tabPosition)==mxConstants.ALIGN_RIGHT){aL=aN.width-aL}return new mxPoint(aN.x+aL,aN.y+aM)},function(aM,aN){var aL=Math.max(0,Math.min(aM.width,aN.x-aM.x));if(mxUtils.getValue(this.state.style,"tabPosition",am.prototype.tabPosition)==mxConstants.ALIGN_RIGHT){aL=aM.width-aL}this.state.style.tabWidth=Math.round(aL);this.state.style.tabHeight=Math.round(Math.max(0,Math.min(aM.height,aN.y-aM.y)))})]},document:function(aK){return[A(aK,["size"],function(aM){var aL=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",W.prototype.size))));return new mxPoint(aM.x+3*aM.width/4,aM.y+(1-aL)*aM.height)},function(aL,aM){this.state.style.size=Math.max(0,Math.min(1,(aL.y+aL.height-aM.y)/aL.height))})]},tape:function(aK){return[A(aK,["size"],function(aM){var aL=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",ao.prototype.size))));return new mxPoint(aM.getCenterX(),aM.y+aL*aM.height/2)},function(aL,aM){this.state.style.size=Math.max(0,Math.min(1,((aM.y-aL.y)/aL.height)*2))})]},offPageConnector:function(aK){return[A(aK,["size"],function(aM){var aL=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",aI.prototype.size))));return new mxPoint(aM.getCenterX(),aM.y+(1-aL)*aM.height)},function(aL,aM){this.state.style.size=Math.max(0,Math.min(1,(aL.y+aL.height-aM.y)/aL.height))})]},step:Z(aq.prototype.size,true),hexagon:Z(aj.prototype.size,true,0.5),curlyBracket:Z(aH.prototype.size,false),display:Z(D.prototype.size,false),cube:av(1,T.prototype.size,false),card:av(0.5,x.prototype.size,true),loopLimit:av(0.5,g.prototype.size,true),trapezoid:p(0.5),parallelogram:p(1)};Graph.createHandle=A;Graph.handleFactory=ai;mxVertexHandler.prototype.createCustomHandles=function(){if(this.state.view.graph.getSelectionCount()==1){if(this.graph.isCellRotatable(this.state.cell)){var aK=this.state.style.shape;if(this.state.view.graph.cellRenderer.defaultShapes[aK]==null){aK=mxConstants.SHAPE_RECTANGLE}var aL=ai[aK];if(aL!=null){return aL(this.state)}}}return null};mxEdgeHandler.prototype.createCustomHandles=function(){if(this.state.view.graph.getSelectionCount()==1){var aK=this.state.style.shape;if(this.state.view.graph.cellRenderer.defaultShapes[aK]==null){aK=mxConstants.SHAPE_CONNECTOR}var aL=ai[aK];if(aL!=null){return aL(this.state)}}return null}}else{Graph.createHandle=function(){};Graph.handleFactory={}}var h=new mxPoint(1,0);var V=new mxPoint(1,0);var H=mxUtils.toRadians(-30);var o=Math.cos(H);var U=Math.sin(H);h=mxUtils.getRotatedPoint(h,o,U);var G=mxUtils.toRadians(-150);var m=Math.cos(G);var S=Math.sin(G);V=mxUtils.getRotatedPoint(V,m,S);mxEdgeStyle.IsometricConnector=function(aM,aK,aQ,aW,a0){var aT=aM.view;var aZ=(aW!=null&&aW.length>0)?aW[0]:null;var aY=aM.absolutePoints;var aX=aY[0];var aR=aY[aY.length-1];if(aZ!=null){aZ=aT.transformControlPoint(aM,aZ)}if(aX==null){if(aK!=null){aX=new mxPoint(aK.getCenterX(),aK.getCenterY())}}if(aR==null){if(aQ!=null){aR=new mxPoint(aQ.getCenterX(),aQ.getCenterY())}}var aN=h.x;var aL=h.y;var aU=V.x;var aS=V.y;var aP=mxUtils.getValue(aM.style,"elbow","horizontal")=="horizontal";if(aR!=null&&aX!=null){var aV=aX;function aO(a1,a7,a4){var a6=a1-aV.x;var a3=a7-aV.y;var a5=(aS*a6-aU*a3)/(aN*aS-aL*aU);var a2=(aL*a6-aN*a3)/(aL*aU-aN*aS);if(aP){if(a4){aV=new mxPoint(aV.x+aN*a5,aV.y+aL*a5);a0.push(aV)}aV=new mxPoint(aV.x+aU*a2,aV.y+aS*a2);a0.push(aV)}else{if(a4){aV=new mxPoint(aV.x+aU*a2,aV.y+aS*a2);a0.push(aV)}aV=new mxPoint(aV.x+aN*a5,aV.y+aL*a5);a0.push(aV)}}if(aZ==null){aZ=new mxPoint(aX.x+(aR.x-aX.x)/2,aX.y+(aR.y-aX.y)/2)}aO(aZ.x,aZ.y,true);aO(aR.x,aR.y,false)}};mxStyleRegistry.putValue("isometricEdgeStyle",mxEdgeStyle.IsometricConnector);var c=Graph.prototype.createEdgeHandler;Graph.prototype.createEdgeHandler=function(aL,aM){if(aM==mxEdgeStyle.IsometricConnector){var aK=new mxElbowEdgeHandler(aL);aK.snapToTerminals=false;return aK}return c.apply(this,arguments)};aa.prototype.constraints=[];j.prototype.constraints=[];mxRectangleShape.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.75,0),true),new mxConnectionConstraint(new mxPoint(0,0.25),true),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(0,0.75),true),new mxConnectionConstraint(new mxPoint(1,0.25),true),new mxConnectionConstraint(new mxPoint(1,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.75),true),new mxConnectionConstraint(new mxPoint(0.25,1),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.75,1),true)];mxEllipse.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0),true),new mxConnectionConstraint(new mxPoint(1,0),true),new mxConnectionConstraint(new mxPoint(0,1),true),new mxConnectionConstraint(new mxPoint(1,1),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.5))];mxLabel.prototype.constraints=mxRectangleShape.prototype.constraints;mxImageShape.prototype.constraints=mxRectangleShape.prototype.constraints;mxSwimlane.prototype.constraints=mxRectangleShape.prototype.constraints;v.prototype.constraints=mxRectangleShape.prototype.constraints;ap.prototype.constraints=mxRectangleShape.prototype.constraints;x.prototype.constraints=mxRectangleShape.prototype.constraints;T.prototype.constraints=mxRectangleShape.prototype.constraints;am.prototype.constraints=mxRectangleShape.prototype.constraints;B.prototype.constraints=mxRectangleShape.prototype.constraints;X.prototype.constraints=mxRectangleShape.prototype.constraints;J.prototype.constraints=mxEllipse.prototype.constraints;I.prototype.constraints=mxEllipse.prototype.constraints;a.prototype.constraints=mxEllipse.prototype.constraints;P.prototype.constraints=mxEllipse.prototype.constraints;M.prototype.constraints=mxRectangleShape.prototype.constraints;O.prototype.constraints=mxRectangleShape.prototype.constraints;D.prototype.constraints=mxRectangleShape.prototype.constraints;g.prototype.constraints=mxRectangleShape.prototype.constraints;aI.prototype.constraints=mxRectangleShape.prototype.constraints;mxCylinder.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.15,0.05),false),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.85,0.05),false),new mxConnectionConstraint(new mxPoint(0,0.3),true),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(0,0.7),true),new mxConnectionConstraint(new mxPoint(1,0.3),true),new mxConnectionConstraint(new mxPoint(1,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.7),true),new mxConnectionConstraint(new mxPoint(0.15,0.95),false),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.85,0.95),false)];f.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0.1),false),new mxConnectionConstraint(new mxPoint(0.5,0),false),new mxConnectionConstraint(new mxPoint(0.75,0.1),false),new mxConnectionConstraint(new mxPoint(0,1/3),false),new mxConnectionConstraint(new mxPoint(0,1),false),new mxConnectionConstraint(new mxPoint(1,1/3),false),new mxConnectionConstraint(new mxPoint(1,1),false),new mxConnectionConstraint(new mxPoint(0.5,0.5),false)];L.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.75,0),true),new mxConnectionConstraint(new mxPoint(0,0.3),true),new mxConnectionConstraint(new mxPoint(0,0.7),true),new mxConnectionConstraint(new mxPoint(1,0.25),true),new mxConnectionConstraint(new mxPoint(1,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.75),true),new mxConnectionConstraint(new mxPoint(0.25,1),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.75,1),true)];mxActor.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.25,0.2),false),new mxConnectionConstraint(new mxPoint(0.1,0.5),false),new mxConnectionConstraint(new mxPoint(0,0.75),true),new mxConnectionConstraint(new mxPoint(0.75,0.25),false),new mxConnectionConstraint(new mxPoint(0.9,0.5),false),new mxConnectionConstraint(new mxPoint(1,0.75),true),new mxConnectionConstraint(new mxPoint(0.25,1),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.75,1),true)];aB.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0),false),new mxConnectionConstraint(new mxPoint(0.5,0.25),false),new mxConnectionConstraint(new mxPoint(1,0),false),new mxConnectionConstraint(new mxPoint(0.25,0.5),false),new mxConnectionConstraint(new mxPoint(0.75,0.5),false),new mxConnectionConstraint(new mxPoint(0,1),false),new mxConnectionConstraint(new mxPoint(0.5,0.75),false),new mxConnectionConstraint(new mxPoint(1,1),false)];ao.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.35),false),new mxConnectionConstraint(new mxPoint(0,0.5),false),new mxConnectionConstraint(new mxPoint(0,0.65),false),new mxConnectionConstraint(new mxPoint(1,0.35),false),new mxConnectionConstraint(new mxPoint(1,0.5),false),new mxConnectionConstraint(new mxPoint(1,0.65),false),new mxConnectionConstraint(new mxPoint(0.25,1),false),new mxConnectionConstraint(new mxPoint(0.75,0),false)];aq.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.75,0),true),new mxConnectionConstraint(new mxPoint(0.25,1),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.75,1),true),new mxConnectionConstraint(new mxPoint(0.1,0.25),false),new mxConnectionConstraint(new mxPoint(0.2,0.5),false),new mxConnectionConstraint(new mxPoint(0.1,0.75),false),new mxConnectionConstraint(new mxPoint(0.9,0.25),false),new mxConnectionConstraint(new mxPoint(1,0.5),false),new mxConnectionConstraint(new mxPoint(0.9,0.75),false)];mxLine.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.5),false),new mxConnectionConstraint(new mxPoint(0.25,0.5),false),new mxConnectionConstraint(new mxPoint(0.75,0.5),false),new mxConnectionConstraint(new mxPoint(1,0.5),false)];w.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.5,0),false),new mxConnectionConstraint(new mxPoint(0.5,1),false)];mxDoubleEllipse.prototype.constraints=mxEllipse.prototype.constraints;mxRhombus.prototype.constraints=mxEllipse.prototype.constraints;mxTriangle.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.25),true),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(0,0.75),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(1,0.5),true)];mxHexagon.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.375,0),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.625,0),true),new mxConnectionConstraint(new mxPoint(0.125,0.25),false),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(0.125,0.75),false),new mxConnectionConstraint(new mxPoint(0.875,0.25),false),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.5),true),new mxConnectionConstraint(new mxPoint(0.875,0.75),false),new mxConnectionConstraint(new mxPoint(0.375,1),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.625,1),true)];mxCloud.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0.25),false),new mxConnectionConstraint(new mxPoint(0.4,0.1),false),new mxConnectionConstraint(new mxPoint(0.16,0.55),false),new mxConnectionConstraint(new mxPoint(0.07,0.4),false),new mxConnectionConstraint(new mxPoint(0.31,0.8),false),new mxConnectionConstraint(new mxPoint(0.13,0.77),false),new mxConnectionConstraint(new mxPoint(0.8,0.8),false),new mxConnectionConstraint(new mxPoint(0.55,0.95),false),new mxConnectionConstraint(new mxPoint(0.875,0.5),false),new mxConnectionConstraint(new mxPoint(0.96,0.7),false),new mxConnectionConstraint(new mxPoint(0.625,0.2),false),new mxConnectionConstraint(new mxPoint(0.88,0.25),false)];s.prototype.constraints=mxRectangleShape.prototype.constraints;y.prototype.constraints=mxRectangleShape.prototype.constraints;W.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.75,0),true),new mxConnectionConstraint(new mxPoint(0,0.25),true),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(0,0.75),true),new mxConnectionConstraint(new mxPoint(1,0.25),true),new mxConnectionConstraint(new mxPoint(1,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.75),true)];mxArrow.prototype.constraints=null;u.prototype.constraints=null;aJ.prototype.constraints=null;ag.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.5),false),new mxConnectionConstraint(new mxPoint(1,0.5),false)];b.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.5),false),new mxConnectionConstraint(new mxPoint(1,0.5),false)];E.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.5),false),new mxConnectionConstraint(new mxPoint(1,0.5),false),new mxConnectionConstraint(new mxPoint(0.5,0),false),new mxConnectionConstraint(new mxPoint(0.5,1),false)];Q.prototype.constraints=null;aF.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.25),false),new mxConnectionConstraint(new mxPoint(0,0.5),false),new mxConnectionConstraint(new mxPoint(0,0.75),false),new mxConnectionConstraint(new mxPoint(1,0.5),false),new mxConnectionConstraint(new mxPoint(0.7,0.1),false),new mxConnectionConstraint(new mxPoint(0.7,0.9),false)];F.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.175,0.25),false),new mxConnectionConstraint(new mxPoint(0.25,0.5),false),new mxConnectionConstraint(new mxPoint(0.175,0.75),false),new mxConnectionConstraint(new mxPoint(1,0.5),false),new mxConnectionConstraint(new mxPoint(0.7,0.1),false),new mxConnectionConstraint(new mxPoint(0.7,0.9),false)]})();function Sidebar(b,a){this.editorUi=b;this.container=a;this.palettes=new Object();this.taglist=new Object();this.showTooltips=true;this.graph=b.createTemporaryGraph(this.editorUi.editor.graph.getStylesheet());this.graph.cellRenderer.antiAlias=false;this.graph.foldingEnabled=false;if(!mxClient.IS_IE&&!mxClient.IS_IE11){this.graph.container.style.display="none"}document.body.appendChild(this.graph.container);this.pointerUpHandler=mxUtils.bind(this,function(){this.showTooltips=true});mxEvent.addListener(document,(mxClient.IS_POINTER)?"pointerup":"mouseup",this.pointerUpHandler);this.pointerDownHandler=mxUtils.bind(this,function(){this.showTooltips=false;this.hideTooltip()});mxEvent.addListener(document,(mxClient.IS_POINTER)?"pointerdown":"mousedown",this.pointerDownHandler);this.pointerMoveHandler=mxUtils.bind(this,function(c){var d=mxEvent.getSource(c);while(d!=null){if(d==this.currentElt){return}d=d.parentNode}this.hideTooltip()});mxEvent.addListener(document,(mxClient.IS_POINTER)?"pointermove":"mousemove",this.pointerMoveHandler);this.pointerOutHandler=mxUtils.bind(this,function(c){if(c.toElement==null&&c.relatedTarget==null){this.hideTooltip()}});mxEvent.addListener(document,(mxClient.IS_POINTER)?"pointerout":"mouseout",this.pointerOutHandler);mxEvent.addListener(a,"scroll",mxUtils.bind(this,function(){this.showTooltips=true}));this.init();if(!mxClient.IS_SVG){new Image().src=IMAGE_PATH+"/tooltip.png"}}Sidebar.prototype.init=function(){var a=STENCIL_PATH;this.addSearchPalette(true);this.addGeneralPalette(true);this.addMiscPalette(false);this.addAdvancedPalette(false);this.addBasicPalette(a);this.addStencilPalette("arrows",mxResources.get("arrows"),a+"/arrows.xml",";whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addUmlPalette(false);this.addBpmnPalette(a,false);this.addStencilPalette("flowchart","Flowchart",a+"/flowchart.xml",";whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addImagePalette("clipart",mxResources.get("clipart"),a+"/clipart/","_128x128.png",["Earth_globe","Empty_Folder","Full_Folder","Gear","Lock","Software","Virus","Email","Database","Router_Icon","iPad","iMac","Laptop","MacBook","Monitor_Tower","Printer","Server_Tower","Workstation","Firewall_02","Wireless_Router_N","Credit_Card","Piggy_Bank","Graph","Safe","Shopping_Cart","Suit1","Suit2","Suit3","Pilot1","Worker1","Soldier1","Doctor1","Tech1","Security1","Telesales1"],null,{Wireless_Router_N:"wireless router switch wap wifi access point wlan",Router_Icon:"router switch"})};Sidebar.prototype.collapsedImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/collapsed.gif":"data:image/gif;base64,R0lGODlhDQANAIABAJmZmf///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNUQyRTJFNjZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNUQyRTJFNzZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFERjc3MEUxNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFERjc3MEUyNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhSMj6lrwAjcC1GyahV+dcZJgeIIFgA7";Sidebar.prototype.expandedImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/expanded.gif":"data:image/gif;base64,R0lGODlhDQANAIABAJmZmf///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxREY3NzBERjZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxREY3NzBFMDZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFERjc3MERENkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFERjc3MERFNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7";Sidebar.prototype.tooltipImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/tooltip.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAbCAMAAAB7jU7LAAAACVBMVEX///+ZmZn///9Y2COLAAAAA3RSTlP//wDXyg1BAAAAOElEQVR42mXQMQ4AMAgDsWv//+iutcJmIQSk+9dJpVKpVCqVSqVSqZTdncWzF8/NeP7FkxWenPEDOnUBiL3jWx0AAAAASUVORK5CYII=";Sidebar.prototype.searchImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/search.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAEaSURBVHjabNGxS5VxFIfxz71XaWuQUJCG/gCHhgTD9VpEETg4aMOlQRp0EoezObgcd220KQiXmpretTAHQRBdojlQEJyukPdt+b1ywfvAGc7wnHP4nlZd1yKijQW8xzNc4Su+ZOYfQ3T6/f4YNvEJYzjELXp4VVXVz263+7cR2niBxAFeZ2YPi3iHR/gYERPDwhpOsd6sz8x/mfkNG3iOlWFhFj8y89J9KvzGXER0GuEaD42mgwHqUtoljbcRsTBCeINpfM/MgZLKPpaxFxGbOCqDXmILN7hoJrTKH+axhxmcYRxP0MIDnOBDZv5q1XUNIuJxifJp+UNV7t7BFM6xeic0RMQ4Bpl5W/ol7GISx/eEUUTECrbx+f8A8xhiZht9zsgAAAAASUVORK5CYII=";Sidebar.prototype.enableTooltips=true;Sidebar.prototype.tooltipBorder=16;Sidebar.prototype.tooltipDelay=300;Sidebar.prototype.dropTargetDelay=200;Sidebar.prototype.gearImage=STENCIL_PATH+"/clipart/Gear_128x128.png";Sidebar.prototype.thumbWidth=36;Sidebar.prototype.thumbHeight=36;Sidebar.prototype.thumbPadding=(document.documentMode>=5)?0:1;Sidebar.prototype.thumbBorder=2;Sidebar.prototype.sidebarTitleSize=9;Sidebar.prototype.sidebarTitles=false;Sidebar.prototype.tooltipTitles=true;Sidebar.prototype.maxTooltipWidth=400;Sidebar.prototype.maxTooltipHeight=400;Sidebar.prototype.addStencilsToIndex=true;Sidebar.prototype.defaultImageWidth=80;Sidebar.prototype.defaultImageHeight=80;Sidebar.prototype.showTooltip=function(e,d,c,f,g,b){if(this.enableTooltips&&this.showTooltips){if(this.currentElt!=e){if(this.thread!=null){window.clearTimeout(this.thread);this.thread=null}var a=mxUtils.bind(this,function(){if(this.tooltip==null){this.tooltip=document.createElement("div");this.tooltip.className="geSidebarTooltip";this.tooltip.style.zIndex=mxPopupMenu.prototype.zIndex-1;document.body.appendChild(this.tooltip);this.graph2=new Graph(this.tooltip,null,null,this.editorUi.editor.graph.getStylesheet());this.graph2.resetViewOnRootChange=false;this.graph2.foldingEnabled=false;this.graph2.gridEnabled=false;this.graph2.autoScroll=false;this.graph2.setTooltips(false);this.graph2.setConnectable(false);this.graph2.setEnabled(false);if(!mxClient.IS_SVG){this.graph2.view.canvas.style.position="relative"}this.tooltipImage=mxUtils.createImage(this.tooltipImage);this.tooltipImage.className="geSidebarTooltipImage";this.tooltipImage.style.zIndex=mxPopupMenu.prototype.zIndex-1;this.tooltipImage.style.position="absolute";this.tooltipImage.style.width="14px";this.tooltipImage.style.height="27px";document.body.appendChild(this.tooltipImage)}this.graph2.model.clear();this.graph2.view.setTranslate(this.tooltipBorder,this.tooltipBorder);if(c>this.maxTooltipWidth||f>this.maxTooltipHeight){this.graph2.view.scale=Math.round(Math.min(this.maxTooltipWidth/c,this.maxTooltipHeight/f)*100)/100}else{this.graph2.view.scale=1}this.tooltip.style.display="block";this.graph2.labelsVisible=(b==null||b);this.graph2.addCells(d);var i=this.graph2.getGraphBounds();var j=i.width+2*this.tooltipBorder+4;var r=i.height+2*this.tooltipBorder;if(mxClient.IS_QUIRKS){r+=4;this.tooltip.style.overflow="hidden"}else{this.tooltip.style.overflow="visible"}this.tooltipImage.style.visibility="visible";this.tooltip.style.width=j+"px";if(this.tooltipTitles&&g!=null&&g.length>0){if(this.tooltipTitle==null){this.tooltipTitle=document.createElement("div");this.tooltipTitle.style.borderTop="1px solid gray";this.tooltipTitle.style.textAlign="center";this.tooltipTitle.style.width="100%";this.tooltipTitle.style.overflow="hidden";if(mxClient.IS_SVG){this.tooltipTitle.style.paddingTop="6px"}else{this.tooltipTitle.style.position="absolute";this.tooltipTitle.style.paddingTop="6px"}this.tooltip.appendChild(this.tooltipTitle)}else{this.tooltipTitle.innerHTML=""}this.tooltipTitle.style.display="";mxUtils.write(this.tooltipTitle,g);var n=this.tooltipTitle.offsetHeight+10;r+=n;if(mxClient.IS_SVG){this.tooltipTitle.style.marginTop=(2-n)+"px"}else{r-=6;this.tooltipTitle.style.top=(r-n)+"px"}}else{if(this.tooltipTitle!=null&&this.tooltipTitle.parentNode!=null){this.tooltipTitle.style.display="none"}}this.tooltip.style.height=r+"px";var k=-Math.round(i.x-this.tooltipBorder);var q=-Math.round(i.y-this.tooltipBorder);var p=document.body;var m=document.documentElement;var h=Math.max(p.clientHeight||0,m.clientHeight);var l=this.container.clientWidth+this.editorUi.splitSize+3+this.editorUi.container.offsetLeft;var o=Math.min(h-r-20,Math.max(0,(this.editorUi.container.offsetTop+this.container.offsetTop+e.offsetTop-this.container.scrollTop-r/2+16)));if(mxClient.IS_SVG){if(k!=0||q!=0){this.graph2.view.canvas.setAttribute("transform","translate("+k+","+q+")")}else{this.graph2.view.canvas.removeAttribute("transform")}}else{this.graph2.view.drawPane.style.left=k+"px";this.graph2.view.drawPane.style.top=q+"px"}this.tooltip.style.position="absolute";this.tooltip.style.left=l+"px";this.tooltip.style.top=o+"px";this.tooltipImage.style.left=(l-13)+"px";this.tooltipImage.style.top=(o+r/2-13)+"px"});if(this.tooltip!=null&&this.tooltip.style.display!="none"){a()}else{this.thread=window.setTimeout(a,this.tooltipDelay)}this.currentElt=e}}};Sidebar.prototype.hideTooltip=function(){if(this.thread!=null){window.clearTimeout(this.thread);this.thread=null}if(this.tooltip!=null){this.tooltip.style.display="none";this.tooltipImage.style.visibility="hidden";this.currentElt=null}};Sidebar.prototype.addEntry=function(b,e){if(this.taglist!=null&&b!=null&&b.length>0){var d=b.toLowerCase().replace(/[\/\,\(\)]/g," ").split(" ");var a=mxUtils.bind(this,function(g){if(g.length>1){var h=this.taglist[g];if(typeof h!=="object"){h={entries:[],dict:new mxDictionary()};this.taglist[g]=h}if(h.dict.get(e)==null){h.dict.put(e,e);h.entries.push(e)}}});for(var c=0;c<d.length;c++){a(d[c]);var f=d[c].replace(/\.*\d*$/,"");if(f!=d[c]){a(f)}}}return e};Sidebar.prototype.searchEntries=function(n,l,m,r,o){if(this.taglist!=null&&n!=null){var f=n.toLowerCase().split(" ");var b=new mxDictionary();var p=(m+1)*l;var e=[];var k=0;for(var d=0;d<f.length;d++){if(f[d].length>0){var q=this.taglist[f[d]];var a=new mxDictionary();if(q!=null){var g=q.entries;e=[];for(var c=0;c<g.length;c++){var q=g[c];if((k==0)==(b.get(q)==null)){a.put(q,q);e.push(q);if(d==f.length-1&&e.length==p){r(e.slice(m*l,p),p,true,f);return}}}}else{e=[]}b=a;k++}}var h=e.length;r(e.slice(m*l,(m+1)*l),h,false,f)}else{r([],null,null,f)}};Sidebar.prototype.filterTags=function(c){if(c!=null){var b=c.split(" ");var a=[];var e={};for(var d=0;d<b.length;d++){if(e[b[d]]==null){e[b[d]]="1";a.push(b[d])}}return a.join(" ")}return null};Sidebar.prototype.cloneCell=function(a,b){var c=a.clone();if(b!=null){c.value=b}return c};Sidebar.prototype.addSearchPalette=function(o){var f=document.createElement("div");f.style.visibility="hidden";this.container.appendChild(f);var b=document.createElement("div");b.className="geSidebar";b.style.boxSizing="border-box";b.style.overflow="hidden";b.style.width="100%";b.style.padding="8px";b.style.paddingTop="14px";b.style.paddingBottom="0px";if(!o){b.style.display="none"}var q=document.createElement("div");q.style.whiteSpace="nowrap";q.style.textOverflow="clip";q.style.paddingBottom="8px";q.style.cursor="default";var n=document.createElement("input");n.setAttribute("placeholder",mxResources.get("searchShapes"));n.setAttribute("type","text");n.style.fontSize="12px";n.style.overflow="hidden";n.style.boxSizing="border-box";n.style.border="solid 1px #d5d5d5";n.style.borderRadius="4px";n.style.width="100%";n.style.outline="none";n.style.padding="6px";q.appendChild(n);var m=document.createElement("img");m.setAttribute("src",Sidebar.prototype.searchImage);m.setAttribute("title",mxResources.get("search"));m.style.position="relative";m.style.left="-18px";if(mxClient.IS_QUIRKS){n.style.height="28px";m.style.top="-4px"}else{m.style.top="1px"}m.style.background="url('"+this.editorUi.editor.transparentImage+"')";var j;q.appendChild(m);b.appendChild(q);var a=document.createElement("center");var h=mxUtils.button(mxResources.get("moreResults"),function(){j()});h.style.display="none";h.style.lineHeight="normal";h.style.marginTop="4px";h.style.marginBottom="8px";a.style.paddingTop="4px";a.style.paddingBottom="8px";a.appendChild(h);b.appendChild(a);var e="";var d=false;var c=false;var k=0;var g=new Object();var i=12;var l=mxUtils.bind(this,function(){d=false;this.currentSearch=null;var s=b.firstChild;while(s!=null){var r=s.nextSibling;if(s!=q&&s!=a){s.parentNode.removeChild(s)}s=r}});mxEvent.addListener(m,"click",function(){if(m.getAttribute("src")==Dialog.prototype.closeImage){m.setAttribute("src",Sidebar.prototype.searchImage);m.setAttribute("title",mxResources.get("search"));h.style.display="none";n.value="";e="";l()}n.focus()});j=mxUtils.bind(this,function(){i=4*Math.max(1,Math.floor(this.container.clientWidth/(this.thumbWidth+10)));this.hideTooltip();if(n.value!=""){if(a.parentNode!=null){if(e!=n.value){l();e=n.value;g=new Object();c=false;k=0}if(!d&&!c){h.setAttribute("disabled","true");h.style.display="";h.style.cursor="wait";h.innerHTML=mxResources.get("loading")+"...";d=true;var r=new Object();this.currentSearch=r;this.searchEntries(e,i,k,mxUtils.bind(this,function(w,s,v,x){if(this.currentSearch==r){w=(w!=null)?w:[];d=false;k++;a.parentNode.removeChild(a);this.insertSearchHint(b,e,i,k,w,s,v,x);for(var u=0;u<w.length;u++){var t=w[u]();if(g[t.innerHTML]==null){g[t.innerHTML]="1";b.appendChild(w[u]())}}if(v){h.removeAttribute("disabled");h.innerHTML=mxResources.get("moreResults")}else{h.innerHTML=mxResources.get("reset");h.style.display="none";c=true}h.style.cursor="";b.appendChild(a)}}),mxUtils.bind(this,function(){h.style.cursor=""}))}}}else{l();n.value="";e="";g=new Object();h.style.display="none";c=false;n.focus()}});mxEvent.addListener(n,"keydown",mxUtils.bind(this,function(r){if(r.keyCode==13){j()}}));mxEvent.addListener(n,"focus",function(){n.style.paddingRight=""});mxEvent.addListener(n,"blur",function(){n.style.paddingRight="20px"});n.style.paddingRight="20px";mxEvent.addListener(n,"keyup",mxUtils.bind(this,function(r){if(n.value==""){m.setAttribute("src",Sidebar.prototype.searchImage);m.setAttribute("title",mxResources.get("search"))}else{m.setAttribute("src",Dialog.prototype.closeImage);m.setAttribute("title",mxResources.get("reset"))}if(n.value==""){c=true;h.style.display="none"}else{if(n.value!=e){h.style.display="none";c=false}else{if(!d){if(c){h.style.display="none"}else{h.style.display=""}}}}}));mxEvent.addListener(n,"mousedown",function(r){if(r.stopPropagation){r.stopPropagation()}r.cancelBubble=true});mxEvent.addListener(n,"selectstart",function(r){if(r.stopPropagation){r.stopPropagation()}r.cancelBubble=true});var p=document.createElement("div");p.appendChild(b);this.container.appendChild(p);this.palettes.search=[f,p]};Sidebar.prototype.insertSearchHint=function(a,b,f,h,e,g,i,d){if(e.length==0&&h==1){var c=document.createElement("div");c.className="geTitle";c.style.cssText="background-color:transparent;border-color:transparent;color:gray;padding:6px 0px 0px 0px !important;margin:4px 8px 4px 8px;text-align:center;cursor:default !important";mxUtils.write(c,mxResources.get("noResultsFor",[b]));a.appendChild(c)}};Sidebar.prototype.addGeneralPalette=function(b){var a=[this.createVertexTemplateEntry("whiteSpace=wrap;html=1;",120,60,"","Rectangle",null,null,"rect rectangle box"),this.createVertexTemplateEntry("rounded=1;whiteSpace=wrap;html=1;",120,60,"","Rounded Rectangle",null,null,"rounded rect rectangle box"),this.createVertexTemplateEntry("ellipse;whiteSpace=wrap;html=1;",120,80,"","Ellipse",null,null,"oval ellipse state"),this.createVertexTemplateEntry("text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;",40,20,"Text","Text",null,null,"text textbox textarea label"),this.createVertexTemplateEntry("shape=ext;double=1;whiteSpace=wrap;html=1;",120,60,"","Double Rectangle",null,null,"rect rectangle box double"),this.createVertexTemplateEntry("shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;",120,60,"","Double Rounded Rectangle",null,null,"rounded rect rectangle box double"),this.createVertexTemplateEntry("ellipse;shape=doubleEllipse;whiteSpace=wrap;html=1;",120,80,"","Double Ellipse",null,null,"oval ellipse start end state double"),this.createVertexTemplateEntry("rhombus;whiteSpace=wrap;html=1;",80,80,"","Diamond",null,null,"diamond rhombus if condition decision conditional question test"),this.createVertexTemplateEntry("shape=parallelogram;whiteSpace=wrap;html=1;",120,60,"","Parallelogram"),this.createVertexTemplateEntry("triangle;whiteSpace=wrap;html=1;",60,80,"","Triangle",null,null,"triangle logic inverter buffer"),this.createVertexTemplateEntry("shape=cylinder;whiteSpace=wrap;html=1;",60,80,"","Cylinder",null,null,"cylinder data database"),this.createVertexTemplateEntry("shape=hexagon;perimeter=hexagonPerimeter;whiteSpace=wrap;html=1;",120,80,"","Hexagon",null,null,"hexagon preparation"),this.createVertexTemplateEntry("shape=process;whiteSpace=wrap;html=1;",120,60,"","Process",null,null,"process task"),this.createVertexTemplateEntry("ellipse;shape=cloud;whiteSpace=wrap;html=1;",120,80,"","Cloud",null,null,"cloud network"),this.createVertexTemplateEntry("shape=document;whiteSpace=wrap;html=1;",120,80,"","Document"),this.createVertexTemplateEntry("shape=internalStorage;whiteSpace=wrap;html=1;",80,80,"","Internal Storage"),this.createVertexTemplateEntry("shape=cube;whiteSpace=wrap;html=1;",120,80,"","Cube"),this.createVertexTemplateEntry("shape=step;whiteSpace=wrap;html=1;",120,80,"","Step"),this.createVertexTemplateEntry("shape=trapezoid;whiteSpace=wrap;html=1;",120,60,"","Trapezoid"),this.createVertexTemplateEntry("shape=tape;whiteSpace=wrap;html=1;",120,100,"","Tape"),this.createVertexTemplateEntry("shape=note;whiteSpace=wrap;html=1;",80,100,"","Note"),this.createVertexTemplateEntry("shape=card;whiteSpace=wrap;html=1;",80,100,"","Card"),this.createEdgeTemplateEntry("endArrow=classic;html=1;",50,50,"","Connection"),this.createEdgeTemplateEntry("endArrow=classic;startArrow=classic;html=1;",50,50,"","Connection")];this.addPaletteFunctions("general",mxResources.get("general"),(b!=null)?b:true,a)};Sidebar.prototype.addBasicPalette=function(a){this.addStencilPalette("basic",mxResources.get("basic"),a+"/basic.xml",";whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;strokeWidth=2",null,null,null,null,[this.createVertexTemplateEntry("whiteSpace=wrap;html=1;aspect=fixed;",80,80,"","Square",null,null,"square"),this.createVertexTemplateEntry("ellipse;whiteSpace=wrap;html=1;aspect=fixed;",80,80,"","Circle",null,null,"circle"),this.createVertexTemplateEntry("shape=ext;double=1;whiteSpace=wrap;html=1;aspect=fixed;",80,80,"","Double Square",null,null,"double square"),this.createVertexTemplateEntry("ellipse;shape=doubleEllipse;whiteSpace=wrap;html=1;aspect=fixed;",80,80,"","Double Circle",null,null,"double circle")])};Sidebar.prototype.addMiscPalette=function(b){var a=[this.createVertexTemplateEntry("text;html=1;fontSize=24;fontStyle=1;verticalAlign=middle;align=center;",100,40,"Title","Title",null,null,"text heading title"),this.createVertexTemplateEntry("text;html=1;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;",190,120,"<h1>Heading</h1><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>","Textbox",null,null,"text textbox textarea"),this.createVertexTemplateEntry("text;html=1;whiteSpace=wrap;verticalAlign=middle;overflow=hidden;",100,80,"<ul><li>Value 1</li><li>Value 2</li><li>Value 3</li></ul>","Unordered List"),this.createVertexTemplateEntry("text;html=1;whiteSpace=wrap;verticalAlign=middle;overflow=hidden;",100,80,"<ol><li>Value 1</li><li>Value 2</li><li>Value 3</li></ol>","Ordered List"),this.createVertexTemplateEntry("text;html=1;fillColor=#ffffff;overflow=fill;rounded=0;",280,160,'<table border="1" width="100%" height="100%" cellpadding="4" style="width:100%;height:100%;border-collapse:collapse;"><tr style="background-color:#A7C942;color:#ffffff;border:1px solid #98bf21;"><th align="left">Title 1</th><th align="left">Title 2</th><th align="left">Title 3</th></tr><tr style="border:1px solid #98bf21;"><td>Value 1</td><td>Value 2</td><td>Value 3</td></tr><tr style="background-color:#EAF2D3;border:1px solid #98bf21;"><td>Value 4</td><td>Value 5</td><td>Value 6</td></tr><tr style="border:1px solid #98bf21;"><td>Value 7</td><td>Value 8</td><td>Value 9</td></tr><tr style="background-color:#EAF2D3;border:1px solid #98bf21;"><td>Value 10</td><td>Value 11</td><td>Value 12</td></tr></table>',"Table 1"),this.createVertexTemplateEntry("text;html=1;strokeColor=#c0c0c0;overflow=fill;",180,140,'<table border="0" width="100%" height="100%" style="width:100%;height:100%;border-collapse:collapse;"><tr><td align="center">Value 1</td><td align="center">Value 2</td><td align="center">Value 3</td></tr><tr><td align="center">Value 4</td><td align="center">Value 5</td><td align="center">Value 6</td></tr><tr><td align="center">Value 7</td><td align="center">Value 8</td><td align="center">Value 9</td></tr></table>',"Table 2"),this.createVertexTemplateEntry("text;html=1;overflow=fill;",180,140,'<table border="1" width="100%" height="100%" style="width:100%;height:100%;border-collapse:collapse;"><tr><td align="center">Value 1</td><td align="center">Value 2</td><td align="center">Value 3</td></tr><tr><td align="center">Value 4</td><td align="center">Value 5</td><td align="center">Value 6</td></tr><tr><td align="center">Value 7</td><td align="center">Value 8</td><td align="center">Value 9</td></tr></table>',"Table 3"),this.createVertexTemplateEntry("text;html=1;overflow=fill;",160,140,'<table border="1" width="100%" height="100%" cellpadding="4" style="width:100%;height:100%;border-collapse:collapse;"><tr><th align="center"><b>Title</b></th></tr><tr><td align="center">Section 1.1\nSection 1.2\nSection 1.3</td></tr><tr><td align="center">Section 2.1\nSection 2.2\nSection 2.3</td></tr></table>',"Table 4"),this.addEntry("link hyperlink",mxUtils.bind(this,function(){var c=new mxCell("Link",new mxGeometry(0,0,60,40),"text;html=1;whiteSpace=wrap;align=center;verticalAlign=middle;fontColor=#0000EE;fontStyle=4;");c.vertex=true;this.graph.setLinkForCell(c,"https://www.draw.io");return this.createVertexTemplateFromCells([c],c.geometry.width,c.geometry.height,"Link")})),this.addEntry("timestamp date time text label",mxUtils.bind(this,function(){var c=new mxCell("%date{ddd mmm dd yyyy HH:MM:ss}%",new mxGeometry(0,0,160,20),"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;overflow=hidden;");c.vertex=true;this.graph.setAttributeForCell(c,"placeholders","1");return this.createVertexTemplateFromCells([c],c.geometry.width,c.geometry.height,"Timestamp")})),this.addEntry("variable placeholder metadata hello world text label",mxUtils.bind(this,function(){var c=new mxCell("%name% Text",new mxGeometry(0,0,80,20),"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;overflow=hidden;");c.vertex=true;this.graph.setAttributeForCell(c,"placeholders","1");this.graph.setAttributeForCell(c,"name","Variable");return this.createVertexTemplateFromCells([c],c.geometry.width,c.geometry.height,"Variable")})),this.createVertexTemplateEntry("shape=umlActor;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;html=1;",30,60,"Actor","Actor",false,null,"user person human stickman"),this.createVertexTemplateEntry("html=1;whiteSpace=wrap;comic=1;strokeWidth=2;fontFamily=Comic Sans MS;fontStyle=1;",120,60,"RECTANGLE","Comic Rectangle",true,null,"comic rectangle rect box text retro"),this.createVertexTemplateEntry("rhombus;html=1;align=center;whiteSpace=wrap;comic=1;strokeWidth=2;fontFamily=Comic Sans MS;fontStyle=1;",100,100,"DIAMOND","Comic Diamond",true,null,"comic diamond rhombus if condition decision conditional question test retro"),this.createEdgeTemplateEntry("edgeStyle=segmentEdgeStyle;rounded=0;comic=1;strokeWidth=2;endArrow=blockThin;html=1;fontFamily=Comic Sans MS;fontStyle=1;",50,50,"","Comic Arrow 1"),this.createEdgeTemplateEntry("rounded=0;comic=1;strokeWidth=2;endArrow=blockThin;html=1;fontFamily=Comic Sans MS;fontStyle=1;",50,50,"","Comic Arrow 2"),this.createVertexTemplateEntry("html=1;whiteSpace=wrap;aspect=fixed;shape=isoRectangle;",150,90,"","Isometric Square",true,null,"rectangle rect box iso isometric"),this.createVertexTemplateEntry("html=1;whiteSpace=wrap;aspect=fixed;shape=isoCube;",90,100,"","Isometric Cube",true,null,"cube box iso isometric"),this.createEdgeTemplateEntry("edgeStyle=isometricEdgeStyle;endArrow=none;html=1;",50,100,"","Isometric Edge 1"),this.createEdgeTemplateEntry("edgeStyle=isometricEdgeStyle;endArrow=none;html=1;elbow=vertical;",50,100,"","Isometric Edge 2"),this.createVertexTemplateEntry("line;strokeWidth=2;html=1;",160,10,"","Horizontal Line"),this.createVertexTemplateEntry("line;strokeWidth=2;direction=south;html=1;",10,160,"","Vertical Line"),this.createVertexTemplateEntry("line;strokeWidth=4;html=1;perimeter=backbonePerimeter;points=[];outlineConnect=0;",160,10,"","Horizontal Backbone",false,null,"backbone bus network"),this.createVertexTemplateEntry("line;strokeWidth=4;direction=south;html=1;perimeter=backbonePerimeter;points=[];outlineConnect=0;",10,160,"","Vertical Backbone",false,null,"backbone bus network"),this.createVertexTemplateEntry("shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;",20,120,"","Curly Bracket"),this.createVertexTemplateEntry("shape=image;html=1;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;imageAspect=1;aspect=fixed;image="+this.gearImage,52,61,"","Image (Fixed Aspect)",false,null,"fixed image icon symbol"),this.createVertexTemplateEntry("shape=image;html=1;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;imageAspect=0;image="+this.gearImage,50,60,"","Image (Variable Aspect)",false,null,"strechted image icon symbol"),this.createVertexTemplateEntry("icon;html=1;image="+this.gearImage,60,60,"Icon","Icon",false,null,"icon image symbol"),this.createVertexTemplateEntry("label;whiteSpace=wrap;html=1;image="+this.gearImage,140,60,"Label","Label 1",null,null,"label image icon symbol"),this.createVertexTemplateEntry("label;whiteSpace=wrap;html=1;align=center;verticalAlign=bottom;spacingLeft=0;spacingBottom=4;imageAlign=center;imageVerticalAlign=top;image="+this.gearImage,120,80,"Label","Label 2",null,null,"label image icon symbol"),this.createEdgeTemplateEntry("shape=flexArrow;endArrow=classic;html=1;fillColor=#ffffff;",50,50,"","Arrow"),this.createEdgeTemplateEntry("shape=flexArrow;endArrow=classic;startArrow=classic;html=1;fillColor=#ffffff;",50,50,"","Arrow"),this.createEdgeTemplateEntry("endArrow=none;html=1;dashed=1;dashPattern=1 4;",50,50,"","Dotted Line"),this.createEdgeTemplateEntry("endArrow=none;dashed=1;html=1;",50,50,"","Dashed Line"),this.createEdgeTemplateEntry("endArrow=none;html=1;",50,50,"","Line"),this.createEdgeTemplateEntry("edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;",50,50,"","Manual Line"),this.createEdgeTemplateEntry("edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;",50,50,"","Horizontal Elbow"),this.createEdgeTemplateEntry("edgeStyle=elbowEdgeStyle;elbow=vertical;endArrow=classic;html=1;",50,50,"","Vertical Elbow"),this.addEntry("curve",mxUtils.bind(this,function(){var c=new mxCell("",new mxGeometry(0,0,50,50),"curved=1;endArrow=classic;html=1;");c.geometry.setTerminalPoint(new mxPoint(0,50),true);c.geometry.setTerminalPoint(new mxPoint(50,0),false);c.geometry.points=[new mxPoint(50,50),new mxPoint(0,0)];c.geometry.relative=true;c.edge=true;return this.createEdgeTemplateFromCells([c],c.geometry.width,c.geometry.height,"Curve")})),this.createEdgeTemplateEntry("shape=link;html=1;",50,50,"","Link")];this.addPaletteFunctions("misc",mxResources.get("misc"),(b!=null)?b:true,a)};Sidebar.prototype.addAdvancedPalette=function(a){this.addPaletteFunctions("advanced",mxResources.get("advanced"),(a!=null)?a:false,this.createAdvancedShapes())};Sidebar.prototype.createAdvancedShapes=function(){var b=this;var a=new mxCell("List Item",new mxGeometry(0,0,60,26),"text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;");a.vertex=true;return[this.createVertexTemplateEntry("shape=xor;whiteSpace=wrap;html=1;",60,80,"","Or",null,null,"logic or"),this.createVertexTemplateEntry("shape=or;whiteSpace=wrap;html=1;",60,80,"","And",null,null,"logic and"),this.createVertexTemplateEntry("shape=dataStorage;whiteSpace=wrap;html=1;",100,80,"","Data Storage"),this.createVertexTemplateEntry("shape=tapeData;whiteSpace=wrap;html=1;perimeter=ellipsePerimeter;",80,80,"","Tape Data"),this.createVertexTemplateEntry("shape=manualInput;whiteSpace=wrap;html=1;",80,80,"","Manual Input"),this.createVertexTemplateEntry("shape=loopLimit;whiteSpace=wrap;html=1;",100,80,"","Loop Limit"),this.createVertexTemplateEntry("shape=offPageConnector;whiteSpace=wrap;html=1;",80,80,"","Off Page Connector"),this.createVertexTemplateEntry("shape=delay;whiteSpace=wrap;html=1;",80,40,"","Delay"),this.createVertexTemplateEntry("shape=display;whiteSpace=wrap;html=1;",80,40,"","Display"),this.createVertexTemplateEntry("shape=singleArrow;direction=west;whiteSpace=wrap;html=1;",100,60,"","Arrow Left"),this.createVertexTemplateEntry("shape=singleArrow;whiteSpace=wrap;html=1;",100,60,"","Arrow Right"),this.createVertexTemplateEntry("shape=singleArrow;direction=north;whiteSpace=wrap;html=1;",60,100,"","Arrow Up"),this.createVertexTemplateEntry("shape=singleArrow;direction=south;whiteSpace=wrap;html=1;",60,100,"","Arrow Down"),this.createVertexTemplateEntry("shape=doubleArrow;whiteSpace=wrap;html=1;",100,60,"","Double Arrow"),this.createVertexTemplateEntry("shape=doubleArrow;direction=south;whiteSpace=wrap;html=1;",60,100,"","Double Arrow Vertical",null,null,"double arrow"),this.createVertexTemplateEntry("shape=actor;whiteSpace=wrap;html=1;",40,60,"","User",null,null,"user person human"),this.createVertexTemplateEntry("shape=cross;whiteSpace=wrap;html=1;",80,80,"","Cross"),this.createVertexTemplateEntry("shape=corner;whiteSpace=wrap;html=1;",80,80,"","Corner"),this.createVertexTemplateEntry("shape=tee;whiteSpace=wrap;html=1;",80,80,"","Tee"),this.createVertexTemplateEntry("shape=datastore;whiteSpace=wrap;html=1;",60,60,"","Data Store",null,null,"data store cylinder database"),this.createVertexTemplateEntry("shape=orEllipse;perimeter=ellipsePerimeter;whiteSpace=wrap;html=1;",80,80,"","Or",null,null,"or circle oval ellipse"),this.createVertexTemplateEntry("shape=sumEllipse;perimeter=ellipsePerimeter;whiteSpace=wrap;html=1;",80,80,"","Sum",null,null,"sum circle oval ellipse"),this.createVertexTemplateEntry("shape=lineEllipse;perimeter=ellipsePerimeter;whiteSpace=wrap;html=1;",80,80,"","Ellipse with horizontal divider",null,null,"circle oval ellipse"),this.createVertexTemplateEntry("shape=lineEllipse;line=vertical;perimeter=ellipsePerimeter;whiteSpace=wrap;html=1;",80,80,"","Ellipse with vertical divider",null,null,"circle oval ellipse"),this.createVertexTemplateEntry("shape=sortShape;perimeter=rhombusPerimeter;whiteSpace=wrap;html=1;",80,80,"","Sort",null,null,"sort"),this.createVertexTemplateEntry("shape=collate;whiteSpace=wrap;html=1;",80,80,"","Collate",null,null,"collate"),this.createVertexTemplateEntry("shape=switch;whiteSpace=wrap;html=1;",60,60,"","Switch",null,null,"switch router"),this.createVertexTemplateEntry("shape=dimension;whiteSpace=wrap;html=1;align=center;points=[];verticalAlign=bottom;spacingBottom=-5;labelBackgroundColor=#ffffff",100,40,"Label","Horizontal Dimension",null,null,"horizontal dimension measure"),this.createVertexTemplateEntry("shape=dimension;direction=north;whiteSpace=wrap;html=1;align=right;points=[];verticalAlign=middle;labelBackgroundColor=#ffffff",40,100,"Label","Vertical Dimension",null,null,"vertical dimension measure"),this.createVertexTemplateEntry("swimlane;whiteSpace=wrap;html=1;",200,200,"Container","Container",null,null,"container swimlane lane pool"),this.addEntry("list",function(){var c=new mxCell("List",new mxGeometry(0,0,140,110),"swimlane;html=1;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=none;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;");c.vertex=true;c.insert(b.cloneCell(a,"Item 1"));c.insert(b.cloneCell(a,"Item 2"));c.insert(b.cloneCell(a,"Item 3"));return b.createVertexTemplateFromCells([c],c.geometry.width,c.geometry.height,"List")}),this.addEntry("list item entry value",function(){return b.createVertexTemplateFromCells([b.cloneCell(a,"List Item")],a.geometry.width,a.geometry.height,"List Item")})]};Sidebar.prototype.addUmlPalette=function(b){var f=this;var e=new mxCell("+ field: type",new mxGeometry(0,0,100,26),"text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;");e.vertex=true;var d=new mxCell("",new mxGeometry(0,0,40,8),"line;html=1;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;");d.vertex=true;var c="uml static class ";var a=[this.createVertexTemplateEntry("html=1;",110,50,"Object","Object",null,null,c+"object instance"),this.createVertexTemplateEntry("html=1;",110,50,"&laquo;interface&raquo;<br><b>Name</b>","Interface",null,null,c+"interface object instance annotated annotation"),this.addEntry(c+"object instance",function(){var g=new mxCell("Classname",new mxGeometry(0,0,160,90),"swimlane;html=1;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;");g.vertex=true;g.insert(e.clone());g.insert(d.clone());g.insert(f.cloneCell(e,"+ method(type): type"));return f.createVertexTemplateFromCells([g],g.geometry.width,g.geometry.height,"Class")}),this.addEntry(c+"section subsection",function(){var g=new mxCell("Classname",new mxGeometry(0,0,140,110),"swimlane;html=1;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=none;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;");g.vertex=true;g.insert(e.clone());g.insert(e.clone());g.insert(e.clone());return f.createVertexTemplateFromCells([g],g.geometry.width,g.geometry.height,"Class 2")}),this.addEntry(c+"item member method function variable field attribute label",function(){return f.createVertexTemplateFromCells([f.cloneCell(e,"+ item: attribute")],e.geometry.width,e.geometry.height,"Item 1")}),this.addEntry(c+"item member method function variable field attribute label",function(){var g=new mxCell("item: attribute",new mxGeometry(0,0,120,e.geometry.height),"label;html=1;fontStyle=0;strokeColor=none;fillColor=none;align=left;verticalAlign=top;overflow=hidden;spacingLeft=28;spacingRight=4;whiteSpace=wrap;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;imageWidth=16;imageHeight=16;image="+f.gearImage);g.vertex=true;return f.createVertexTemplateFromCells([g],g.geometry.width,g.geometry.height,"Item 2")}),this.addEntry(c+"divider hline line separator",function(){return f.createVertexTemplateFromCells([d.clone()],d.geometry.width,d.geometry.height,"Divider")}),this.addEntry(c+"spacer space gap separator",function(){var g=new mxCell("",new mxGeometry(0,0,20,14),"text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=4;spacingRight=4;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;");g.vertex=true;return f.createVertexTemplateFromCells([g.clone()],g.geometry.width,g.geometry.height,"Spacer")}),this.createVertexTemplateEntry("text;html=1;align=center;fontStyle=1;verticalAlign=middle;spacingLeft=3;spacingRight=3;strokeColor=none;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;",80,26,"Title","Title",null,null,c+"title label"),this.addEntry(c+"component",function(){var g=new mxCell("&laquo;Annotation&raquo;<br/><b>Component</b>",new mxGeometry(0,0,180,90),"html=1;");g.vertex=true;var h=new mxCell("",new mxGeometry(1,0,20,20),"shape=component;jettyWidth=8;jettyHeight=4;");h.vertex=true;h.geometry.relative=true;h.geometry.offset=new mxPoint(-27,7);g.insert(h);return f.createVertexTemplateFromCells([g],g.geometry.width,g.geometry.height,"Component")}),this.addEntry(c+"component",function(){var g=new mxCell('<p style="margin:0px;margin-top:6px;text-align:center;"><b>Component</b></p><hr/><p style="margin:0px;margin-left:8px;">+ Attribute1: Type<br/>+ Attribute2: Type</p>',new mxGeometry(0,0,180,90),"align=left;overflow=fill;html=1;");g.vertex=true;var h=new mxCell("",new mxGeometry(1,0,20,20),"shape=component;jettyWidth=8;jettyHeight=4;");h.vertex=true;h.geometry.relative=true;h.geometry.offset=new mxPoint(-24,4);g.insert(h);return f.createVertexTemplateFromCells([g],g.geometry.width,g.geometry.height,"Component with Attributes")}),this.createVertexTemplateEntry("verticalAlign=top;align=left;spacingTop=8;spacingLeft=2;spacingRight=12;shape=cube;size=10;direction=south;fontStyle=4;html=1;",180,120,"Block","Block",null,null,c+"block"),this.createVertexTemplateEntry("shape=component;align=left;spacingLeft=36;",120,60,"Module","Module",null,null,c+"module"),this.createVertexTemplateEntry("shape=folder;fontStyle=1;spacingTop=10;tabWidth=40;tabHeight=14;tabPosition=left;html=1;",70,50,"package","Package",null,null,c+"package"),this.createVertexTemplateEntry("verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;",160,90,'<p style="margin:0px;margin-top:4px;text-align:center;text-decoration:underline;"><b>Object:Type</b></p><hr/><p style="margin:0px;margin-left:8px;">field1 = value1<br/>field2 = value2<br>field3 = value3</p>',"Object",null,null,c+"object instance"),this.createVertexTemplateEntry("verticalAlign=top;align=left;overflow=fill;html=1;",180,90,'<div style="box-sizing:border-box;width:100%;background:#e4e4e4;padding:2px;">Tablename</div><table style="width:100%;font-size:1em;" cellpadding="2" cellspacing="0"><tr><td>PK</td><td>uniqueId</td></tr><tr><td>FK1</td><td>foreignKey</td></tr><tr><td></td><td>fieldname</td></tr></table>',"Entity",null,null,"er entity table"),this.addEntry(c+"object instance",function(){var g=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;"><b>Class</b></p><hr size="1"/><div style="height:2px;"></div>',new mxGeometry(0,0,140,60),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;");g.vertex=true;return f.createVertexTemplateFromCells([g.clone()],g.geometry.width,g.geometry.height,"Class 3")}),this.addEntry(c+"object instance",function(){var g=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;"><b>Class</b></p><hr size="1"/><div style="height:2px;"></div><hr size="1"/><div style="height:2px;"></div>',new mxGeometry(0,0,140,60),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;");g.vertex=true;return f.createVertexTemplateFromCells([g.clone()],g.geometry.width,g.geometry.height,"Class 4")}),this.addEntry(c+"object instance",function(){var g=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;"><b>Class</b></p><hr size="1"/><p style="margin:0px;margin-left:4px;">+ field: Type</p><hr size="1"/><p style="margin:0px;margin-left:4px;">+ method(): Type</p>',new mxGeometry(0,0,160,90),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;");g.vertex=true;return f.createVertexTemplateFromCells([g.clone()],g.geometry.width,g.geometry.height,"Class 5")}),this.addEntry(c+"object instance",function(){var g=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;"><i>&lt;&lt;Interface&gt;&gt;</i><br/><b>Interface</b></p><hr size="1"/><p style="margin:0px;margin-left:4px;">+ field1: Type<br/>+ field2: Type</p><hr size="1"/><p style="margin:0px;margin-left:4px;">+ method1(Type): Type<br/>+ method2(Type, Type): Type</p>',new mxGeometry(0,0,190,140),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;");g.vertex=true;return f.createVertexTemplateFromCells([g.clone()],g.geometry.width,g.geometry.height,"Interface 2")}),this.createVertexTemplateEntry("shape=lollipop;direction=south;html=1;",30,10,"","Provided Interface",null,null,c+"provided interface"),this.createVertexTemplateEntry("shape=requires;direction=north;html=1;",30,20,"","Required Interface",null,null,c+"required interface"),this.createVertexTemplateEntry("shape=umlBoundary;whiteSpace=wrap;html=1;",100,80,"Boundary Object","Boundary Object",null,null,"uml boundary object"),this.createVertexTemplateEntry("ellipse;shape=umlEntity;whiteSpace=wrap;html=1;",80,80,"Entity Object","Entity Object",null,null,"uml entity object"),this.createVertexTemplateEntry("ellipse;shape=umlControl;whiteSpace=wrap;html=1;",70,80,"Control Object","Control Object",null,null,"uml control object"),this.createVertexTemplateEntry("shape=umlActor;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;html=1;",30,60,"Actor","Actor",false,null,"uml actor"),this.createVertexTemplateEntry("ellipse;whiteSpace=wrap;html=1;",140,70,"Use Case","Use Case",null,null,"uml use case usecase"),this.addEntry("uml activity state start",function(){var g=new mxCell("",new mxGeometry(0,0,30,30),"ellipse;html=1;shape=startState;fillColor=#000000;strokeColor=#ff0000;");g.vertex=true;var h=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=orthogonalEdgeStyle;html=1;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");h.geometry.setTerminalPoint(new mxPoint(15,90),false);h.geometry.relative=true;h.edge=true;g.insertEdge(h,true);return f.createVertexTemplateFromCells([g,h],30,90,"Start")}),this.addEntry("uml activity state",function(){var g=new mxCell("Activity",new mxGeometry(0,0,120,40),"rounded=1;whiteSpace=wrap;html=1;arcSize=40;fillColor=#ffffc0;strokeColor=#ff0000;");g.vertex=true;var h=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=orthogonalEdgeStyle;html=1;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");h.geometry.setTerminalPoint(new mxPoint(60,100),false);h.geometry.relative=true;h.edge=true;g.insertEdge(h,true);return f.createVertexTemplateFromCells([g,h],120,100,"Activity")}),this.addEntry("uml activity composite state",function(){var g=new mxCell("Composite State",new mxGeometry(0,0,160,60),"swimlane;html=1;fontStyle=1;align=center;verticalAlign=middle;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=0;resizeLast=1;container=0;collapsible=0;rounded=1;arcSize=30;strokeColor=#ff0000;fillColor=#ffffc0;swimlaneFillColor=#ffffc0;");g.vertex=true;var h=new mxCell("Subtitle",new mxGeometry(0,0,200,26),"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;");h.vertex=true;g.insert(h);var i=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=orthogonalEdgeStyle;html=1;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");i.geometry.setTerminalPoint(new mxPoint(80,120),false);i.geometry.relative=true;i.edge=true;g.insertEdge(i,true);return f.createVertexTemplateFromCells([g,i],160,120,"Composite State")}),this.addEntry("uml activity condition",function(){var g=new mxCell("Condition",new mxGeometry(0,0,80,40),"rhombus;whiteSpace=wrap;html=1;fillColor=#ffffc0;strokeColor=#ff0000;");g.vertex=true;var i=new mxCell("no",new mxGeometry(0,0,0,0),"edgeStyle=orthogonalEdgeStyle;html=1;align=left;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");i.geometry.setTerminalPoint(new mxPoint(180,20),false);i.geometry.relative=true;i.geometry.x=-1;i.edge=true;g.insertEdge(i,true);var h=new mxCell("yes",new mxGeometry(0,0,0,0),"edgeStyle=orthogonalEdgeStyle;html=1;align=left;verticalAlign=top;endArrow=open;endSize=8;strokeColor=#ff0000;");h.geometry.setTerminalPoint(new mxPoint(40,100),false);h.geometry.relative=true;h.geometry.x=-1;h.edge=true;g.insertEdge(h,true);return f.createVertexTemplateFromCells([g,i,h],180,100,"Condition")}),this.addEntry("uml activity fork join",function(){var g=new mxCell("",new mxGeometry(0,0,200,10),"shape=line;html=1;strokeWidth=6;strokeColor=#ff0000;");g.vertex=true;var h=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=orthogonalEdgeStyle;html=1;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");h.geometry.setTerminalPoint(new mxPoint(100,80),false);h.geometry.relative=true;h.edge=true;g.insertEdge(h,true);return f.createVertexTemplateFromCells([g,h],200,80,"Fork/Join")}),this.createVertexTemplateEntry("ellipse;html=1;shape=endState;fillColor=#000000;strokeColor=#ff0000;",30,30,"","End",null,null,"uml activity state end"),this.createVertexTemplateEntry("shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;",100,300,":Object","Lifeline",null,null,"uml sequence participant lifeline"),this.createVertexTemplateEntry("shape=umlLifeline;participant=umlActor;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;verticalAlign=top;spacingTop=36;labelBackgroundColor=#ffffff;outlineConnect=0;",20,300,"","Actor Lifeline",null,null,"uml sequence participant lifeline actor"),this.createVertexTemplateEntry("shape=umlLifeline;participant=umlBoundary;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;verticalAlign=top;spacingTop=36;labelBackgroundColor=#ffffff;outlineConnect=0;",50,300,"","Boundary Lifeline",null,null,"uml sequence participant lifeline boundary"),this.createVertexTemplateEntry("shape=umlLifeline;participant=umlEntity;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;verticalAlign=top;spacingTop=36;labelBackgroundColor=#ffffff;outlineConnect=0;",40,300,"","Entity Lifeline",null,null,"uml sequence participant lifeline entity"),this.createVertexTemplateEntry("shape=umlLifeline;participant=umlControl;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;verticalAlign=top;spacingTop=36;labelBackgroundColor=#ffffff;outlineConnect=0;",40,300,"","Control Lifeline",null,null,"uml sequence participant lifeline control"),this.createVertexTemplateEntry("shape=umlFrame;whiteSpace=wrap;html=1;",300,200,"frame","Frame",null,null,"uml sequence frame"),this.createVertexTemplateEntry("shape=umlDestroy;whiteSpace=wrap;html=1;strokeWidth=3;",30,30,"","Destruction",null,null,"uml sequence destruction destroy"),this.createVertexTemplateEntry("shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;",100,70,"Note","Note",null,null,"uml note"),this.addEntry("uml sequence invoke invocation call activation",function(){var g=new mxCell("",new mxGeometry(0,0,10,80),"html=1;points=[];perimeter=orthogonalPerimeter;");g.vertex=true;var h=new mxCell("dispatch",new mxGeometry(0,0,0,0),"html=1;verticalAlign=bottom;startArrow=oval;endArrow=block;startSize=8;");h.geometry.setTerminalPoint(new mxPoint(-60,0),true);h.geometry.relative=true;h.edge=true;g.insertEdge(h,false);return f.createVertexTemplateFromCells([g,h],10,80,"Found Message")}),this.addEntry("uml sequence invoke call delegation synchronous invocation activation",function(){var g=new mxCell("",new mxGeometry(0,0,10,80),"html=1;points=[];perimeter=orthogonalPerimeter;");g.vertex=true;var i=new mxCell("dispatch",new mxGeometry(0,0,0,0),"html=1;verticalAlign=bottom;endArrow=block;entryX=0;entryY=0;");i.geometry.setTerminalPoint(new mxPoint(-70,0),true);i.geometry.relative=true;i.edge=true;g.insertEdge(i,false);var h=new mxCell("return",new mxGeometry(0,0,0,0),"html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;exitX=0;exitY=0.95;");h.geometry.setTerminalPoint(new mxPoint(-70,76),false);h.geometry.relative=true;h.edge=true;g.insertEdge(h,true);return f.createVertexTemplateFromCells([g,i,h],10,80,"Synchronous Invocation")}),this.addEntry("uml sequence self call recursion delegation activation",function(){var g=new mxCell("",new mxGeometry(0,20,10,40),"html=1;points=[];perimeter=orthogonalPerimeter;");g.vertex=true;var h=new mxCell("self call",new mxGeometry(0,0,0,0),"edgeStyle=orthogonalEdgeStyle;html=1;align=left;spacingLeft=2;endArrow=block;rounded=0;entryX=1;entryY=0;");h.geometry.setTerminalPoint(new mxPoint(5,0),true);h.geometry.points=[new mxPoint(30,0)];h.geometry.relative=true;h.edge=true;g.insertEdge(h,false);return f.createVertexTemplateFromCells([g,h],10,60,"Self Call")}),this.addEntry("uml sequence invoke call delegation callback activation",function(){var g=new mxCell("",new mxGeometry(0,0,10,60),"html=1;points=[];perimeter=orthogonalPerimeter;");g.vertex=true;var i=new mxCell("callback",new mxGeometry(0,0,0,0),"html=1;verticalAlign=bottom;endArrow=block;entryX=1;entryY=0;");i.geometry.setTerminalPoint(new mxPoint(70,0),true);i.geometry.relative=true;i.edge=true;g.insertEdge(i,false);var h=new mxCell("return",new mxGeometry(0,0,0,0),"html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;exitX=1;exitY=0.95;");h.geometry.setTerminalPoint(new mxPoint(70,57),false);h.geometry.relative=true;h.edge=true;g.insertEdge(h,true);return f.createVertexTemplateFromCells([g,i,h],10,60,"Callback")}),this.createVertexTemplateEntry("html=1;points=[];perimeter=orthogonalPerimeter;",10,80,"","Activation",null,null,"uml sequence activation"),this.createEdgeTemplateEntry("html=1;verticalAlign=bottom;startArrow=oval;startFill=1;endArrow=block;startSize=8;",60,0,"dispatch","Found Message 1",null,"uml sequence message call invoke dispatch"),this.createEdgeTemplateEntry("html=1;verticalAlign=bottom;startArrow=circle;startFill=1;endArrow=open;startSize=6;endSize=8;",80,0,"dispatch","Found Message 2",null,"uml sequence message call invoke dispatch"),this.createEdgeTemplateEntry("html=1;verticalAlign=bottom;endArrow=block;",80,0,"dispatch","Message",null,"uml sequence message call invoke dispatch"),this.addEntry("uml sequence return message",function(){var g=new mxCell("return",new mxGeometry(0,0,0,0),"html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;");g.geometry.setTerminalPoint(new mxPoint(80,0),true);g.geometry.setTerminalPoint(new mxPoint(0,0),false);g.geometry.relative=true;g.edge=true;return f.createEdgeTemplateFromCells([g],80,0,"Return")}),this.addEntry("uml relation",function(){var h=new mxCell("name",new mxGeometry(0,0,0,0),"endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;");h.geometry.setTerminalPoint(new mxPoint(0,0),true);h.geometry.setTerminalPoint(new mxPoint(160,0),false);h.geometry.relative=true;h.geometry.x=-1;h.edge=true;var g=new mxCell("1",new mxGeometry(-1,0,0,0),"resizable=0;html=1;align=left;verticalAlign=bottom;labelBackgroundColor=#ffffff;fontSize=10;");g.geometry.relative=true;g.setConnectable(false);g.vertex=true;h.insert(g);return f.createEdgeTemplateFromCells([h],160,0,"Relation 1")}),this.addEntry("uml association",function(){var i=new mxCell("",new mxGeometry(0,0,0,0),"endArrow=none;html=1;edgeStyle=orthogonalEdgeStyle;");i.geometry.setTerminalPoint(new mxPoint(0,0),true);i.geometry.setTerminalPoint(new mxPoint(160,0),false);i.geometry.relative=true;i.edge=true;var h=new mxCell("parent",new mxGeometry(-1,0,0,0),"resizable=0;html=1;align=left;verticalAlign=bottom;labelBackgroundColor=#ffffff;fontSize=10;");h.geometry.relative=true;h.setConnectable(false);h.vertex=true;i.insert(h);var g=new mxCell("child",new mxGeometry(1,0,0,0),"resizable=0;html=1;align=right;verticalAlign=bottom;labelBackgroundColor=#ffffff;fontSize=10;");g.geometry.relative=true;g.setConnectable(false);g.vertex=true;i.insert(g);return f.createEdgeTemplateFromCells([i],160,0,"Association 1")}),this.addEntry("uml aggregation",function(){var g=new mxCell("1",new mxGeometry(0,0,0,0),"endArrow=open;html=1;endSize=12;startArrow=diamondThin;startSize=14;startFill=0;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=bottom;");g.geometry.setTerminalPoint(new mxPoint(0,0),true);g.geometry.setTerminalPoint(new mxPoint(160,0),false);g.geometry.relative=true;g.geometry.x=-1;g.geometry.y=3;g.edge=true;return f.createEdgeTemplateFromCells([g],160,0,"Aggregation")}),this.addEntry("uml composition",function(){var g=new mxCell("1",new mxGeometry(0,0,0,0),"endArrow=open;html=1;endSize=12;startArrow=diamondThin;startSize=14;startFill=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=bottom;");g.geometry.setTerminalPoint(new mxPoint(0,0),true);g.geometry.setTerminalPoint(new mxPoint(160,0),false);g.geometry.relative=true;g.geometry.x=-1;g.geometry.y=3;g.edge=true;return f.createEdgeTemplateFromCells([g],160,0,"Composition")}),this.addEntry("uml relation",function(){var i=new mxCell("Relation",new mxGeometry(0,0,0,0),"endArrow=open;html=1;endSize=12;startArrow=diamondThin;startSize=14;startFill=0;edgeStyle=orthogonalEdgeStyle;");i.geometry.setTerminalPoint(new mxPoint(0,0),true);i.geometry.setTerminalPoint(new mxPoint(160,0),false);i.geometry.relative=true;i.edge=true;var h=new mxCell("0..n",new mxGeometry(-1,0,0,0),"resizable=0;html=1;align=left;verticalAlign=top;labelBackgroundColor=#ffffff;fontSize=10;");h.geometry.relative=true;h.setConnectable(false);h.vertex=true;i.insert(h);var g=new mxCell("1",new mxGeometry(1,0,0,0),"resizable=0;html=1;align=right;verticalAlign=top;labelBackgroundColor=#ffffff;fontSize=10;");g.geometry.relative=true;g.setConnectable(false);g.vertex=true;i.insert(g);return f.createEdgeTemplateFromCells([i],160,0,"Relation 2")}),this.createEdgeTemplateEntry("endArrow=open;endSize=12;dashed=1;html=1;",160,0,"Use","Dependency",null,"uml dependency use"),this.createEdgeTemplateEntry("endArrow=block;endSize=16;endFill=0;html=1;",160,0,"Extends","Generalization",null,"uml generalization extend"),this.createEdgeTemplateEntry("endArrow=block;startArrow=block;endFill=1;startFill=1;html=1;",160,0,"","Association 2",null,"uml association"),this.createEdgeTemplateEntry("endArrow=open;startArrow=circlePlus;endFill=0;startFill=0;endSize=8;html=1;",160,0,"","Inner Class",null,"inner class"),this.createEdgeTemplateEntry("endArrow=open;startArrow=cross;endFill=0;startFill=0;endSize=8;startSize=10;html=1;",160,0,"","Terminate",null,"terminate")];this.addPaletteFunctions("uml",mxResources.get("uml"),b||false,a)};Sidebar.prototype.addBpmnPalette=function(a,c){var d=this;var b=[this.createVertexTemplateEntry("shape=ext;rounded=1;html=1;whiteSpace=wrap;",120,80,"Task","Process",null,null,"bpmn task process"),this.createVertexTemplateEntry("shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;",120,80,"Transaction","Transaction",null,null,"bpmn transaction"),this.createVertexTemplateEntry("shape=ext;rounded=1;html=1;whiteSpace=wrap;dashed=1;dashPattern=1 4;",120,80,"Event\nSub-Process","Event Sub-Process",null,null,"bpmn event subprocess sub process sub-process"),this.createVertexTemplateEntry("shape=ext;rounded=1;html=1;whiteSpace=wrap;strokeWidth=3;",120,80,"Call Activity","Call Activity",null,null,"bpmn call activity"),this.addEntry("bpmn subprocess sub process sub-process",function(){var e=new mxCell("Sub-Process",new mxGeometry(0,0,120,80),"html=1;whiteSpace=wrap;rounded=1;");e.vertex=true;var f=new mxCell("",new mxGeometry(0.5,1,14,14),"html=1;shape=plus;");f.vertex=true;f.geometry.relative=true;f.geometry.offset=new mxPoint(-7,-14);e.insert(f);return d.createVertexTemplateFromCells([e],e.geometry.width,e.geometry.height,"Sub-Process")}),this.addEntry(this.getTagsForStencil("mxgraph.bpmn","loop","subprocess sub process sub-process looped").join(" "),function(){var e=new mxCell("Looped\nSub-Process",new mxGeometry(0,0,120,80),"html=1;whiteSpace=wrap;rounded=1");e.vertex=true;var g=new mxCell("",new mxGeometry(0.5,1,14,14),"html=1;shape=mxgraph.bpmn.loop;");g.vertex=true;g.geometry.relative=true;g.geometry.offset=new mxPoint(-15,-14);e.insert(g);var f=new mxCell("",new mxGeometry(0.5,1,14,14),"html=1;shape=plus;");f.vertex=true;f.geometry.relative=true;f.geometry.offset=new mxPoint(1,-14);e.insert(f);return d.createVertexTemplateFromCells([e],e.geometry.width,e.geometry.height,"Looped Sub-Process")}),this.addEntry("bpmn receive task",function(){var e=new mxCell("Receive",new mxGeometry(0,0,120,80),"html=1;whiteSpace=wrap;rounded=1;");e.vertex=true;var f=new mxCell("",new mxGeometry(0,0,20,14),"html=1;shape=message;");f.vertex=true;f.geometry.relative=true;f.geometry.offset=new mxPoint(7,7);e.insert(f);return d.createVertexTemplateFromCells([e],e.geometry.width,e.geometry.height,"Receive Task")}),this.addEntry(this.getTagsForStencil("mxgraph.bpmn","user_task").join(" "),function(){var e=new mxCell("User",new mxGeometry(0,0,120,80),"html=1;whiteSpace=wrap;rounded=1;");e.vertex=true;var g=new mxCell("",new mxGeometry(0,0,14,14),"html=1;shape=mxgraph.bpmn.user_task;");g.vertex=true;g.geometry.relative=true;g.geometry.offset=new mxPoint(7,7);e.insert(g);var f=new mxCell("",new mxGeometry(0.5,1,14,14),"html=1;shape=plus;");f.vertex=true;f.geometry.relative=true;f.geometry.offset=new mxPoint(-7,-14);e.insert(f);return d.createVertexTemplateFromCells([e],e.geometry.width,e.geometry.height,"User Task")}),this.addEntry(this.getTagsForStencil("mxgraph.bpmn","timer_start","attached").join(" "),function(){var e=new mxCell("Process",new mxGeometry(0,0,120,80),"html=1;whiteSpace=wrap;rounded=1;");e.vertex=true;var f=new mxCell("",new mxGeometry(1,1,30,30),"shape=mxgraph.bpmn.timer_start;perimeter=ellipsePerimeter;html=1;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;");f.vertex=true;f.geometry.relative=true;f.geometry.offset=new mxPoint(-40,-15);e.insert(f);return d.createVertexTemplateFromCells([e],120,95,"Attached Timer Event 1")}),this.addEntry(this.getTagsForStencil("mxgraph.bpmn","timer_start","attached").join(" "),function(){var e=new mxCell("Process",new mxGeometry(0,0,120,80),"html=1;whiteSpace=wrap;rounded=1;");e.vertex=true;var f=new mxCell("",new mxGeometry(1,0,30,30),"shape=mxgraph.bpmn.timer_start;perimeter=ellipsePerimeter;html=1;labelPosition=right;labelBackgroundColor=#ffffff;align=left;");f.vertex=true;f.geometry.relative=true;f.geometry.offset=new mxPoint(-15,10);e.insert(f);return d.createVertexTemplateFromCells([e],135,80,"Attached Timer Event 2")}),this.createVertexTemplateEntry("swimlane;html=1;horizontal=0;startSize=20;",320,240,"Pool","Pool",null,null,"bpmn pool"),this.createVertexTemplateEntry("swimlane;html=1;horizontal=0;swimlaneFillColor=white;swimlaneLine=0;",300,120,"Lane","Lane",null,null,"bpmn lane"),this.createVertexTemplateEntry("shape=hexagon;html=1;whiteSpace=wrap;perimeter=hexagonPerimeter;",60,50,"","Conversation",null,null,"bpmn conversation"),this.createVertexTemplateEntry("shape=hexagon;html=1;whiteSpace=wrap;perimeter=hexagonPerimeter;strokeWidth=4",60,50,"","Call Conversation",null,null,"bpmn call conversation"),this.addEntry("bpmn subconversation sub conversation sub-conversation",function(){var e=new mxCell("",new mxGeometry(0,0,60,50),"shape=hexagon;whiteSpace=wrap;html=1;perimeter=hexagonPerimeter;");e.vertex=true;var f=new mxCell("",new mxGeometry(0.5,1,14,14),"html=1;shape=plus;");f.vertex=true;f.geometry.relative=true;f.geometry.offset=new mxPoint(-7,-14);e.insert(f);return d.createVertexTemplateFromCells([e],e.geometry.width,e.geometry.height,"Sub-Conversation")}),this.addEntry("bpmn data object",function(){var e=new mxCell("",new mxGeometry(0,0,40,60),"shape=note;whiteSpace=wrap;size=16;html=1;");e.vertex=true;var g=new mxCell("",new mxGeometry(0,0,14,14),"html=1;shape=singleArrow;arrowWidth=0.4;arrowSize=0.4;");g.vertex=true;g.geometry.relative=true;g.geometry.offset=new mxPoint(2,2);e.insert(g);var f=new mxCell("",new mxGeometry(0.5,1,14,14),"html=1;whiteSpace=wrap;shape=parallelMarker;");f.vertex=true;f.geometry.relative=true;f.geometry.offset=new mxPoint(-7,-14);e.insert(f);return d.createVertexTemplateFromCells([e],e.geometry.width,e.geometry.height,"Data Object")}),this.createVertexTemplateEntry("shape=datastore;whiteSpace=wrap;html=1;",60,60,"","Data Store",null,null,"bpmn data store"),this.createVertexTemplateEntry("shape=plus;html=1;",14,14,"","Sub-Process Marker",null,null,"bpmn subprocess sub process sub-process marker"),this.createVertexTemplateEntry("shape=mxgraph.bpmn.loop;html=1;",14,14,"","Loop Marker",null,null,"bpmn loop marker"),this.createVertexTemplateEntry("shape=parallelMarker;html=1;",14,14,"","Parallel MI Marker",null,null,"bpmn parallel mi marker"),this.createVertexTemplateEntry("shape=parallelMarker;direction=south;html=1;",14,14,"","Sequential MI Marker",null,null,"bpmn sequential mi marker"),this.createVertexTemplateEntry("shape=mxgraph.bpmn.ad_hoc;fillColor=#000000;html=1;",14,14,"","Ad Hoc Marker",null,null,"bpmn ad hoc marker"),this.createVertexTemplateEntry("shape=mxgraph.bpmn.compensation;html=1;",14,14,"","Compensation Marker",null,null,"bpmn compensation marker"),this.createVertexTemplateEntry("shape=message;whiteSpace=wrap;html=1;fillColor=#000000;strokeColor=#ffffff;strokeWidth=2;",40,30,"","Send Task",null,null,"bpmn send task"),this.createVertexTemplateEntry("shape=message;whiteSpace=wrap;html=1;",40,30,"","Receive Task",null,null,"bpmn receive task"),this.createVertexTemplateEntry("shape=mxgraph.bpmn.user_task;html=1;",14,14,"","User Task",null,null,this.getTagsForStencil("mxgraph.bpmn","user_task").join(" ")),this.createVertexTemplateEntry("shape=mxgraph.bpmn.manual_task;html=1;",14,14,"","Manual Task",null,null,this.getTagsForStencil("mxgraph.bpmn","user_task").join(" ")),this.createVertexTemplateEntry("shape=mxgraph.bpmn.business_rule_task;html=1;",14,14,"","Business Rule Task",null,null,this.getTagsForStencil("mxgraph.bpmn","business_rule_task").join(" ")),this.createVertexTemplateEntry("shape=mxgraph.bpmn.service_task;html=1;",14,14,"","Service Task",null,null,this.getTagsForStencil("mxgraph.bpmn","service_task").join(" ")),this.createVertexTemplateEntry("shape=mxgraph.bpmn.script_task;html=1;",14,14,"","Script Task",null,null,this.getTagsForStencil("mxgraph.bpmn","script_task").join(" ")),this.createEdgeTemplateEntry("endArrow=block;endFill=1;endSize=6;html=1;",100,0,"","Sequence Flow",null,"bpmn sequence flow"),this.createEdgeTemplateEntry("startArrow=dash;startSize=8;endArrow=block;endFill=1;endSize=6;html=1;",100,0,"","Default Flow",null,"bpmn default flow"),this.createEdgeTemplateEntry("startArrow=diamondThin;startFill=0;startSize=14;endArrow=block;endFill=1;endSize=6;html=1;",100,0,"","Conditional Flow",null,"bpmn conditional flow"),this.createEdgeTemplateEntry("startArrow=oval;startFill=0;startSize=7;endArrow=block;endFill=0;endSize=10;dashed=1;html=1;",100,0,"","Message Flow 1",null,"bpmn message flow"),this.addEntry("bpmn message flow",function(){var f=new mxCell("",new mxGeometry(0,0,0,0),"startArrow=oval;startFill=0;startSize=7;endArrow=block;endFill=0;endSize=10;dashed=1;html=1;");f.geometry.setTerminalPoint(new mxPoint(0,0),true);f.geometry.setTerminalPoint(new mxPoint(100,0),false);f.geometry.relative=true;f.edge=true;var e=new mxCell("",new mxGeometry(0,0,20,14),"shape=message;html=1;");e.geometry.relative=true;e.setConnectable(false);e.vertex=true;e.geometry.offset=new mxPoint(-10,-7);f.insert(e);return d.createEdgeTemplateFromCells([f],100,0,"Message Flow 2")}),this.createEdgeTemplateEntry("shape=link;html=1;",100,0,"","Link",null,"bpmn link")];this.addPaletteFunctions("bpmn","BPMN "+mxResources.get("general"),false,b)};Sidebar.prototype.createTitle=function(b){var a=document.createElement("a");a.setAttribute("href","javascript:void(0);");a.setAttribute("title",mxResources.get("sidebarTooltip"));a.className="geTitle";mxUtils.write(a,b);return a};Sidebar.prototype.createThumb=function(n,c,m,l,j,g,f,k,h){this.graph.labelsVisible=(g==null||g);var i=mxClient.NO_FO;mxClient.NO_FO=Editor.prototype.originalNoForeignObject;this.graph.view.scaleAndTranslate(1,0,0);this.graph.addCells(n);var a=this.graph.getGraphBounds();var o=Math.floor(Math.min((c-2*this.thumbBorder)/a.width,(m-2*this.thumbBorder)/a.height)*100)/100;this.graph.view.scaleAndTranslate(o,Math.floor((c-a.width*o)/2/o-a.x),Math.floor((m-a.height*o)/2/o-a.y));var d=null;if(this.graph.dialect==mxConstants.DIALECT_SVG&&!mxClient.NO_FO){d=this.graph.view.getCanvas().ownerSVGElement.cloneNode(true)}else{d=this.graph.container.cloneNode(false);d.innerHTML=this.graph.container.innerHTML}this.graph.getModel().clear();mxClient.NO_FO=i;if(mxClient.IS_IE6){l.style.backgroundImage="url("+this.editorUi.editor.transparentImage+")"}d.style.position="relative";d.style.overflow="hidden";d.style.cursor="move";d.style.left=this.thumbBorder+"px";d.style.top=this.thumbBorder+"px";d.style.width=c+"px";d.style.height=m+"px";d.style.visibility="";d.style.minWidth="";d.style.minHeight="";l.appendChild(d);if(this.sidebarTitles&&j!=null&&f!=false){var e=(mxClient.IS_QUIRKS)?2*this.thumbPadding+2:0;l.style.height=(this.thumbHeight+e+this.sidebarTitleSize+8)+"px";var b=document.createElement("div");b.style.fontSize=this.sidebarTitleSize+"px";b.style.color="#303030";b.style.textAlign="center";b.style.whiteSpace="nowrap";if(mxClient.IS_IE){b.style.height=(this.sidebarTitleSize+12)+"px"}b.style.paddingTop="4px";mxUtils.write(b,j);l.appendChild(b)}return a};Sidebar.prototype.createItem=function(k,i,g,f,b,j,h){var e=document.createElement("a");e.setAttribute("href","javascript:void(0);");e.className="geItem";e.style.overflow="hidden";var d=(mxClient.IS_QUIRKS)?8+2*this.thumbPadding:2*this.thumbBorder;e.style.width=(this.thumbWidth+d)+"px";e.style.height=(this.thumbHeight+d)+"px";e.style.padding=this.thumbPadding+"px";if(mxClient.IS_IE6){e.style.border="none"}mxEvent.addListener(e,"click",function(l){mxEvent.consume(l)});this.createThumb(k,this.thumbWidth,this.thumbHeight,e,i,g,f,b,j);var a=new mxRectangle(0,0,b,j);if(k.length>1||k[0].vertex){var c=this.createDragSource(e,this.createDropHandler(k,true,h,a),this.createDragPreview(b,j),k,a);this.addClickHandler(e,c,k);c.isGuidesEnabled=mxUtils.bind(this,function(){return this.editorUi.editor.graph.graphHandler.guidesEnabled})}else{if(k[0]!=null&&k[0].edge){var c=this.createDragSource(e,this.createDropHandler(k,false,h,a),this.createDragPreview(b,j),k,a);this.addClickHandler(e,c,k)}}if(!mxClient.IS_IOS){mxEvent.addGestureListeners(e,null,mxUtils.bind(this,function(l){if(mxEvent.isMouseEvent(l)){this.showTooltip(e,k,a.width,a.height,i,g)}}))}return e};Sidebar.prototype.updateShapes=function(a,k){var m=this.editorUi.editor.graph;var n=m.getCellStyle(a);var p=[];m.model.beginUpdate();try{var e=m.getModel().getStyle(a);var o=["shadow","dashed","dashPattern","fontFamily","fontSize","fontColor","align","startFill","startSize","endFill","endSize","strokeColor","strokeWidth","fillColor","gradientColor","html","part","noEdgeStyle","edgeStyle","elbow","childLayout"];for(var h=0;h<k.length;h++){var d=k[h];if((m.getModel().isVertex(d)==m.getModel().isVertex(a))||(m.getModel().isEdge(d)==m.getModel().isEdge(a))){var c=m.view.getState(d);var b=(c!=null)?c.style:m.getCellStyle(k[h]);m.getModel().setStyle(d,e);if(c!=null&&mxUtils.getValue(c.style,"composite","0")=="1"){var g=m.model.getChildCount(d);for(var f=g;f>=0;f--){m.model.remove(m.model.getChildAt(d,f))}}if(b!=null){if(b[mxConstants.STYLE_SHAPE]=="umlLifeline"&&n[mxConstants.STYLE_SHAPE]!="umlLifeline"){m.setCellStyles(mxConstants.STYLE_SHAPE,"umlLifeline",[d]);m.setCellStyles("participant",n[mxConstants.STYLE_SHAPE],[d])}for(var f=0;f<o.length;f++){var l=b[o[f]];if(l!=null){m.setCellStyles(o[f],l,[d])}}}p.push(d)}}}finally{m.model.endUpdate()}return p};Sidebar.prototype.createDropHandler=function(a,d,b,c){b=(b!=null)?b:true;return mxUtils.bind(this,function(r,q,j,n,m){if(r.isEnabled()){a=r.getImportableCells(a);if(a.length>0){r.stopEditing();var k=(j!=null&&!mxEvent.isAltDown(q))?r.isValidDropTarget(j,a,q):false;var o=null;if(j!=null&&!k){j=null}if(!r.isCellLocked(j||r.getDefaultParent())){r.model.beginUpdate();try{n=Math.round(n);m=Math.round(m);if(d&&r.isSplitTarget(j,a,q)){var p=r.cloneCells(a);r.splitEdge(j,p,null,n-c.width/2,m-c.height/2);o=p}else{if(a.length>0){o=r.importCells(a,n,m,j)}}if(r.layoutManager!=null){var h=r.layoutManager.getLayout(j);if(h!=null){var t=r.view.scale;var l=r.view.translate;var g=(n+l.x)*t;var e=(m+l.y)*t;for(var f=0;f<o.length;f++){h.moveCell(o[f],g,e)}}}if(b){r.fireEvent(new mxEventObject("cellsInserted","cells",o))}}finally{r.model.endUpdate()}if(o!=null&&o.length>0){r.scrollCellToVisible(o[0]);r.setSelectionCells(o)}}}mxEvent.consume(q)}})};Sidebar.prototype.createDragPreview=function(c,a){var b=document.createElement("div");b.style.border="1px dashed black";b.style.width=c+"px";b.style.height=a+"px";return b};Sidebar.prototype.dropAndConnect=function(k,q,p,o){var s=this.getDropAndConnectGeometry(k,q[o],p,q);if(s!=null){var a=this.editorUi.editor.graph;var m=[];a.model.beginUpdate();try{var h=a.getCellGeometry(k);var r=a.getCellGeometry(q[o]);var b=a.model.getParent(k);var e=true;if(a.layoutManager!=null){var l=a.layoutManager.getLayout(b);if(l!=null&&l.constructor==mxStackLayout){e=false;var m=a.view.getState(b);if(m!=null){var c=new mxPoint((m.x/a.view.scale-a.view.translate.x),(m.y/a.view.scale-a.view.translate.y));s.x+=c.x;s.y+=c.y;var j=s.getTerminalPoint(false);if(j!=null){j.x+=c.x;j.y+=c.y}}}}var f=r.x;var d=r.y;if(a.model.isEdge(q[o])){f=0;d=0}var g=a.model.isEdge(k)||(h!=null&&!h.relative&&e);q=a.importCells(q,(s.x-(g?f:0)),(s.y-(g?d:0)),(g)?b:null);m=q;if(a.model.isEdge(k)){a.model.setTerminal(k,q[o],p==mxConstants.DIRECTION_NORTH)}else{if(a.model.isEdge(q[o])){a.model.setTerminal(q[o],k,true);var n=a.getCellGeometry(q[o]);n.points=null;if(n.getTerminalPoint(false)!=null){n.setTerminalPoint(s.getTerminalPoint(false),false)}else{if(g&&a.model.isVertex(b)){var i=a.view.getState(b);var c=new mxPoint((i.x/a.view.scale-a.view.translate.x),(i.y/a.view.scale-a.view.translate.y));a.cellsMoved(q,c.x,c.y,null,null,true)}}}else{r=a.getCellGeometry(q[o]);f=s.x-Math.round(r.x);d=s.y-Math.round(r.y);s.x=Math.round(r.x);s.y=Math.round(r.y);a.model.setGeometry(q[o],s);a.cellsMoved(q,f,d,null,null,true);m=q.slice();q.push(a.insertEdge(null,null,"",k,q[o],a.createCurrentEdgeStyle()))}}a.fireEvent(new mxEventObject("cellsInserted","cells",q))}finally{a.model.endUpdate()}a.setSelectionCells(m)}};Sidebar.prototype.getDropAndConnectGeometry=function(a,i,l,g){var m=this.editorUi.editor.graph;var k=m.view;var b=g.length>1;var f=m.getCellGeometry(a);var e=m.getCellGeometry(i);if(f!=null&&e!=null){e=e.clone();if(m.model.isEdge(a)){var c=m.view.getState(a);var q=c.absolutePoints;var o=q[0];var j=q[q.length-1];if(l==mxConstants.DIRECTION_NORTH){e.x=o.x/k.scale-k.translate.x-e.width/2;e.y=o.y/k.scale-k.translate.y-e.height/2}else{e.x=j.x/k.scale-k.translate.x-e.width/2;e.y=j.y/k.scale-k.translate.y-e.height/2}}else{if(f.relative){var c=m.view.getState(a);f=f.clone();f.x=(c.x-k.translate.x)/k.scale;f.y=(c.y-k.translate.y)/k.scale}var d=m.defaultEdgeLength;if(m.model.isEdge(i)&&e.getTerminalPoint(true)!=null&&e.getTerminalPoint(false)!=null){var o=e.getTerminalPoint(true);var j=e.getTerminalPoint(false);var p=j.x-o.x;var n=j.y-o.y;d=Math.sqrt(p*p+n*n);e.x=f.getCenterX();e.y=f.getCenterY();e.width=1;e.height=1;if(l==mxConstants.DIRECTION_NORTH){e.height=d;e.y=f.y-d;e.setTerminalPoint(new mxPoint(e.x,e.y),false)}else{if(l==mxConstants.DIRECTION_EAST){e.width=d;e.x=f.x+f.width;e.setTerminalPoint(new mxPoint(e.x+e.width,e.y),false)}else{if(l==mxConstants.DIRECTION_SOUTH){e.height=d;e.y=f.y+f.height;e.setTerminalPoint(new mxPoint(e.x,e.y+e.height),false)}else{if(l==mxConstants.DIRECTION_WEST){e.width=d;e.x=f.x-d;e.setTerminalPoint(new mxPoint(e.x,e.y),false)}}}}}else{if(!b&&e.width>45&&e.height>45&&f.width>45&&f.height>45){e.width=e.width*(f.height/e.height);e.height=f.height}e.x=f.x+f.width/2-e.width/2;e.y=f.y+f.height/2-e.height/2;if(l==mxConstants.DIRECTION_NORTH){e.y=e.y-f.height/2-e.height/2-d}else{if(l==mxConstants.DIRECTION_EAST){e.x=e.x+f.width/2+e.width/2+d}else{if(l==mxConstants.DIRECTION_SOUTH){e.y=e.y+f.height/2+e.height/2+d}else{if(l==mxConstants.DIRECTION_WEST){e.x=e.x-f.width/2-e.width/2-d}}}}if(m.model.isEdge(i)&&e.getTerminalPoint(true)!=null&&i.getTerminal(false)!=null){var h=m.getCellGeometry(i.getTerminal(false));if(h!=null){if(l==mxConstants.DIRECTION_NORTH){e.x-=h.getCenterX();e.y-=h.getCenterY()+h.height/2}else{if(l==mxConstants.DIRECTION_EAST){e.x-=h.getCenterX()-h.width/2;e.y-=h.getCenterY()}else{if(l==mxConstants.DIRECTION_SOUTH){e.x-=h.getCenterX();e.y-=h.getCenterY()-h.height/2}else{if(l==mxConstants.DIRECTION_WEST){e.x-=h.getCenterX()+h.width/2;e.y-=h.getCenterY()}}}}}}}}}return e};Sidebar.prototype.createDragSource=function(E,I,u,r,z){var A=this.editorUi;var B=A.editor.graph;var p=null;var d=null;var q=this;for(var F=0;F<r.length;F++){if(d==null&&this.editorUi.editor.graph.model.isVertex(r[F])){d=F}else{if(p==null&&this.editorUi.editor.graph.model.isEdge(r[F])&&this.editorUi.editor.graph.model.getTerminal(r[F],true)==null){p=F}}if(d!=null&&p!=null){break}}var e=mxUtils.makeDraggable(E,this.editorUi.editor.graph,mxUtils.bind(this,function(O,L,P,i,R){if(this.updateThread!=null){window.clearTimeout(this.updateThread)}if(r!=null&&j!=null&&n==c){var N=O.isCellSelected(j.cell)?O.getSelectionCells():[j.cell];var Q=this.updateShapes((O.model.isEdge(j.cell))?r[0]:r[d],N);O.setSelectionCells(Q)}else{if(r!=null&&n!=null&&t!=null&&n!=c){var M=(O.model.isEdge(t.cell)||p==null)?d:p;this.dropAndConnect(t.cell,r,h,M)}else{I.apply(this,arguments)}}if(this.editorUi.hoverIcons!=null){this.editorUi.hoverIcons.update(O.view.getState(O.getSelectionCell()))}}),u,0,0,this.editorUi.editor.graph.autoscroll,true,true);this.editorUi.editor.graph.addListener(mxEvent.ESCAPE,function(L,i){if(e.isActive()){e.reset()}});var g=e.mouseDown;e.mouseDown=function(i){if(!mxEvent.isPopupTrigger(i)&&!mxEvent.isMultiTouchEvent(i)){B.stopEditing();g.apply(this,arguments)}};function l(i,M){var L=null;if(mxClient.IS_IE&&!mxClient.IS_SVG){if(mxClient.IS_IE6&&document.compatMode!="CSS1Compat"){L=document.createElement(mxClient.VML_PREFIX+":image");L.setAttribute("src",i.src);L.style.borderStyle="none"}else{L=document.createElement("div");L.style.backgroundImage="url("+i.src+")";L.style.backgroundPosition="center";L.style.backgroundRepeat="no-repeat"}L.style.width=(i.width+4)+"px";L.style.height=(i.height+4)+"px";L.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block"}else{L=mxUtils.createImage(i.src);L.style.width=i.width+"px";L.style.height=i.height+"px"}if(M!=null){L.setAttribute("title",M)}mxUtils.setOpacity(L,(i==this.refreshTarget)?30:20);L.style.position="absolute";L.style.cursor="crosshair";return L}var t=null;var a=null;var j=null;var m=false;var C=l(this.triangleUp,mxResources.get("connect"));var G=l(this.triangleRight,mxResources.get("connect"));var o=l(this.triangleDown,mxResources.get("connect"));var k=l(this.triangleLeft,mxResources.get("connect"));var c=l(this.refreshTarget,mxResources.get("replace"));var D=null;var s=l(this.roundDrop);var b=l(this.roundDrop);var h=mxConstants.DIRECTION_NORTH;var n=null;function v(i,N,L,M){if(M.parentNode!=null){if(mxUtils.contains(L,i,N)){mxUtils.setOpacity(M,100);n=M}else{mxUtils.setOpacity(M,(M==c)?30:20)}}return L}var y=e.createPreviewElement;e.createPreviewElement=function(L){var i=y.apply(this,arguments);if(mxClient.IS_SVG){i.style.pointerEvents="none"}this.previewElementWidth=i.style.width;this.previewElementHeight=i.style.height;return i};var x=e.dragEnter;e.dragEnter=function(L,i){if(A.hoverIcons!=null){A.hoverIcons.setDisplay("none")}x.apply(this,arguments)};var H=e.dragExit;e.dragExit=function(L,i){if(A.hoverIcons!=null){A.hoverIcons.setDisplay("")}H.apply(this,arguments)};e.dragOver=function(U,T){mxDragSource.prototype.dragOver.apply(this,arguments);if(this.currentGuide!=null&&n!=null){this.currentGuide.hide()}if(this.previewElement!=null){var Q=U.view;if(j!=null&&n==c){this.previewElement.style.display=(U.model.isEdge(j.cell))?"none":"";this.previewElement.style.left=j.x+"px";this.previewElement.style.top=j.y+"px";this.previewElement.style.width=j.width+"px";this.previewElement.style.height=j.height+"px"}else{if(t!=null&&n!=null){var P=(U.model.isEdge(t.cell)||p==null)?d:p;var N=q.getDropAndConnectGeometry(t.cell,r[P],h,r);var M=(!U.model.isEdge(t.cell))?U.getCellGeometry(t.cell):null;var L=U.getCellGeometry(r[P]);var S=U.model.getParent(t.cell);var W=Q.translate.x*Q.scale;var V=Q.translate.y*Q.scale;if(M!=null&&!M.relative&&U.model.isVertex(S)){var i=Q.getState(S);W=i.x;V=i.y}var R=L.x;var O=L.y;if(U.model.isEdge(r[P])){R=0;O=0}this.previewElement.style.left=((N.x-R)*Q.scale+W)+"px";this.previewElement.style.top=((N.y-O)*Q.scale+V)+"px";if(r.length==1){this.previewElement.style.width=(N.width*Q.scale)+"px";this.previewElement.style.height=(N.height*Q.scale)+"px"}this.previewElement.style.display=""}else{if(e.currentHighlight.state!=null&&U.model.isEdge(e.currentHighlight.state.cell)){this.previewElement.style.left=Math.round(parseInt(this.previewElement.style.left)-z.width*Q.scale/2)+"px";this.previewElement.style.top=Math.round(parseInt(this.previewElement.style.top)-z.height*Q.scale/2)+"px"}else{this.previewElement.style.width=this.previewElementWidth;this.previewElement.style.height=this.previewElementHeight;this.previewElement.style.display=""}}}}};var f=new Date().getTime();var J=0;var w=null;var K=this.editorUi.editor.graph.getCellStyle(r[0]);e.getDropTarget=mxUtils.bind(this,function(P,V,T,X){var N=(!mxEvent.isAltDown(X)&&r!=null)?P.getCellAt(V,T):null;if(N!=null&&!this.graph.isCellConnectable(N)){var S=this.graph.getModel().getParent(N);if(this.graph.getModel().isVertex(S)&&this.graph.isCellConnectable(S)){N=S}}if(P.isCellLocked(N)){N=null}var R=P.view.getState(N);n=null;var L=null;if(w!=R){w=R;f=new Date().getTime();J=0;if(this.updateThread!=null){window.clearTimeout(this.updateThread)}if(R!=null){this.updateThread=window.setTimeout(function(){if(n==null){w=R;e.getDropTarget(P,V,T,X)}},this.dropTargetDelay+10)}}else{J=new Date().getTime()-f}if(J<2500&&R!=null&&!mxEvent.isShiftDown(X)&&(((mxUtils.getValue(R.style,mxConstants.STYLE_SHAPE)!=mxUtils.getValue(K,mxConstants.STYLE_SHAPE)&&mxUtils.getValue(R.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE)!=mxConstants.NONE)||mxUtils.getValue(K,mxConstants.STYLE_SHAPE)=="image")||J>1500||P.model.isEdge(R.cell))&&(J>this.dropTargetDelay)&&((P.model.isVertex(R.cell)&&d!=null)||(P.model.isEdge(R.cell)&&P.model.isEdge(r[0])))){j=R;var ac=(P.model.isEdge(R.cell))?P.view.getPoint(R):new mxPoint(R.getCenterX(),R.getCenterY());ac=new mxRectangle(ac.x-this.refreshTarget.width/2,ac.y-this.refreshTarget.height/2,this.refreshTarget.width,this.refreshTarget.height);c.style.left=Math.floor(ac.x)+"px";c.style.top=Math.floor(ac.y)+"px";if(D==null){P.container.appendChild(c);D=c.parentNode}v(V,T,ac,c)}else{if(j==null||!mxUtils.contains(j,V,T)||(J>1500&&!mxEvent.isShiftDown(X))){j=null;if(D!=null){c.parentNode.removeChild(c);D=null}}else{if(j!=null&&D!=null){var ac=(P.model.isEdge(j.cell))?P.view.getPoint(j):new mxPoint(j.getCenterX(),j.getCenterY());ac=new mxRectangle(ac.x-this.refreshTarget.width/2,ac.y-this.refreshTarget.height/2,this.refreshTarget.width,this.refreshTarget.height);v(V,T,ac,c)}}}if(m&&t!=null&&!mxEvent.isAltDown(X)&&n==null){L=mxRectangle.fromRectangle(t);if(P.model.isEdge(t.cell)){var af=t.absolutePoints;if(s.parentNode!=null){var O=af[0];L.add(v(V,T,new mxRectangle(O.x-this.roundDrop.width/2,O.y-this.roundDrop.height/2,this.roundDrop.width,this.roundDrop.height),s))}if(b.parentNode!=null){var ae=af[af.length-1];L.add(v(V,T,new mxRectangle(ae.x-this.roundDrop.width/2,ae.y-this.roundDrop.height/2,this.roundDrop.width,this.roundDrop.height),b))}}else{var aa=mxRectangle.fromRectangle(t);if(t.shape!=null&&t.shape.boundingBox!=null){aa=mxRectangle.fromRectangle(t.shape.boundingBox)}aa.grow(this.graph.tolerance);aa.grow(HoverIcons.prototype.arrowSpacing);var M=this.graph.selectionCellsHandler.getHandler(t.cell);if(M!=null){aa.x-=M.horizontalOffset/2;aa.y-=M.verticalOffset/2;aa.width+=M.horizontalOffset;aa.height+=M.verticalOffset;if(M.rotationShape!=null&&M.rotationShape.node!=null&&M.rotationShape.node.style.visibility!="hidden"&&M.rotationShape.node.style.display!="none"&&M.rotationShape.boundingBox!=null){aa.add(M.rotationShape.boundingBox)}}L.add(v(V,T,new mxRectangle(t.getCenterX()-this.triangleUp.width/2,aa.y-this.triangleUp.height,this.triangleUp.width,this.triangleUp.height),C));L.add(v(V,T,new mxRectangle(aa.x+aa.width,t.getCenterY()-this.triangleRight.height/2,this.triangleRight.width,this.triangleRight.height),G));L.add(v(V,T,new mxRectangle(t.getCenterX()-this.triangleDown.width/2,aa.y+aa.height,this.triangleDown.width,this.triangleDown.height),o));L.add(v(V,T,new mxRectangle(aa.x-this.triangleLeft.width,t.getCenterY()-this.triangleLeft.height/2,this.triangleLeft.width,this.triangleLeft.height),k))}if(L!=null){L.grow(10)}}h=mxConstants.DIRECTION_NORTH;if(n==G){h=mxConstants.DIRECTION_EAST}else{if(n==o||n==b){h=mxConstants.DIRECTION_SOUTH}else{if(n==k){h=mxConstants.DIRECTION_WEST}}}if(j!=null&&n==c){R=j}var W=(d==null||P.isCellConnectable(r[d]))&&((P.model.isEdge(N)&&d!=null)||(P.model.isVertex(N)&&P.isCellConnectable(N)));if((t!=null&&J>=5000)||(t!=R&&(L==null||!mxUtils.contains(L,V,T)||(J>500&&n==null&&W)))){m=false;t=((J<5000&&J>this.dropTargetDelay)||P.model.isEdge(N))?R:null;if(t!=null&&W){var ab=[s,b,C,G,o,k];for(var Z=0;Z<ab.length;Z++){if(ab[Z].parentNode!=null){ab[Z].parentNode.removeChild(ab[Z])}}if(P.model.isEdge(N)){var af=R.absolutePoints;if(af!=null){var O=af[0];var ae=af[af.length-1];var Y=P.tolerance;var U=new mxRectangle(V-Y,T-Y,2*Y,2*Y);s.style.left=Math.floor(O.x-this.roundDrop.width/2)+"px";s.style.top=Math.floor(O.y-this.roundDrop.height/2)+"px";b.style.left=Math.floor(ae.x-this.roundDrop.width/2)+"px";b.style.top=Math.floor(ae.y-this.roundDrop.height/2)+"px";if(P.model.getTerminal(N,true)==null){P.container.appendChild(s)}if(P.model.getTerminal(N,false)==null){P.container.appendChild(b)}}}else{var aa=mxRectangle.fromRectangle(R);if(R.shape!=null&&R.shape.boundingBox!=null){aa=mxRectangle.fromRectangle(R.shape.boundingBox)}aa.grow(this.graph.tolerance);aa.grow(HoverIcons.prototype.arrowSpacing);var M=this.graph.selectionCellsHandler.getHandler(R.cell);if(M!=null){aa.x-=M.horizontalOffset/2;aa.y-=M.verticalOffset/2;aa.width+=M.horizontalOffset;aa.height+=M.verticalOffset;if(M.rotationShape!=null&&M.rotationShape.node!=null&&M.rotationShape.node.style.visibility!="hidden"&&M.rotationShape.node.style.display!="none"&&M.rotationShape.boundingBox!=null){aa.add(M.rotationShape.boundingBox)}}C.style.left=Math.floor(R.getCenterX()-this.triangleUp.width/2)+"px";C.style.top=Math.floor(aa.y-this.triangleUp.height)+"px";G.style.left=Math.floor(aa.x+aa.width)+"px";G.style.top=Math.floor(R.getCenterY()-this.triangleRight.height/2)+"px";o.style.left=C.style.left;o.style.top=Math.floor(aa.y+aa.height)+"px";k.style.left=Math.floor(aa.x-this.triangleLeft.width)+"px";k.style.top=G.style.top;if(R.style.portConstraint!="eastwest"){P.container.appendChild(C);P.container.appendChild(o)}P.container.appendChild(G);P.container.appendChild(k)}if(R!=null){a=P.selectionCellsHandler.getHandler(R.cell);if(a!=null&&a.setHandlesVisible!=null){a.setHandlesVisible(false)}}m=true}else{var ab=[s,b,C,G,o,k];for(var Z=0;Z<ab.length;Z++){if(ab[Z].parentNode!=null){ab[Z].parentNode.removeChild(ab[Z])}}}}if(!m&&a!=null){a.setHandlesVisible(true)}var ad=((!mxEvent.isAltDown(X)||mxEvent.isShiftDown(X))&&!(j!=null&&n==c))?mxDragSource.prototype.getDropTarget.apply(this,arguments):null;var Q=P.getModel();if(ad!=null){if(n!=null||!P.isSplitTarget(ad,r,X)){while(ad!=null&&!P.isValidDropTarget(ad,r,X)&&Q.isVertex(Q.getParent(ad))){ad=Q.getParent(ad)}if(P.view.currentRoot==ad||(!P.isValidRoot(ad)&&P.getModel().getChildCount(ad)==0)||P.isCellLocked(ad)||Q.isEdge(ad)){ad=null}}}return ad});e.stopDrag=function(){mxDragSource.prototype.stopDrag.apply(this,arguments);var M=[s,b,c,C,G,o,k];for(var L=0;L<M.length;L++){if(M[L].parentNode!=null){M[L].parentNode.removeChild(M[L])}}if(t!=null&&a!=null){a.reset()}a=null;t=null;j=null;D=null;n=null};return e};Sidebar.prototype.itemClicked=function(c,f,a,b){var e=this.editorUi.editor.graph;if(mxEvent.isAltDown(a)){if(e.getSelectionCount()==1&&e.model.isVertex(e.getSelectionCell())){var h=null;for(var d=0;d<c.length&&h==null;d++){if(e.model.isVertex(c[d])){h=d}}if(h!=null){this.dropAndConnect(e.getSelectionCell(),c,(mxEvent.isMetaDown(a)||mxEvent.isControlDown(a))?(mxEvent.isShiftDown(a)?mxConstants.DIRECTION_WEST:mxConstants.DIRECTION_NORTH):(mxEvent.isShiftDown(a)?mxConstants.DIRECTION_EAST:mxConstants.DIRECTION_SOUTH),h);e.scrollCellToVisible(e.getSelectionCell())}}}else{if(mxEvent.isShiftDown(a)){if(!e.isSelectionEmpty()){this.updateShapes(c[0],e.getSelectionCells());e.scrollCellToVisible(e.getSelectionCell())}}else{var g=e.getFreeInsertPoint();f.drop(e,a,null,g.x,g.y);if(this.editorUi.hoverIcons!=null&&mxEvent.isTouchEvent(a)){this.editorUi.hoverIcons.update(e.view.getState(e.getSelectionCell()))}}}};Sidebar.prototype.addClickHandler=function(b,d,a){var c=this.editorUi.editor.graph;var f=d.mouseUp;var e=null;mxEvent.addGestureListeners(b,function(g){e=new mxPoint(mxEvent.getClientX(g),mxEvent.getClientY(g))});d.mouseUp=mxUtils.bind(this,function(h){if(!mxEvent.isPopupTrigger(h)&&this.currentGraph==null&&e!=null){var g=c.tolerance;if(Math.abs(e.x-mxEvent.getClientX(h))<=g&&Math.abs(e.y-mxEvent.getClientY(h))<=g){this.itemClicked(a,d,h,b)}}f.apply(d,arguments);e=null;this.currentElt=b})};Sidebar.prototype.createVertexTemplateEntry=function(e,d,a,g,h,b,f,c){c=(c!=null&&c.length>0)?c:h.toLowerCase();return this.addEntry(c,mxUtils.bind(this,function(){return this.createVertexTemplate(e,d,a,g,h,b,f)}))};Sidebar.prototype.createVertexTemplate=function(a,b,h,g,f,d,c,e){var i=[new mxCell((g!=null)?g:"",new mxGeometry(0,0,b,h),a)];i[0].vertex=true;return this.createVertexTemplateFromCells(i,b,h,f,d,c,e)};Sidebar.prototype.createVertexTemplateFromCells=function(c,e,a,g,b,f,d){return this.createItem(c,g,b,f,e,a,d)};Sidebar.prototype.createEdgeTemplateEntry=function(f,e,a,g,h,b,c,d){c=(c!=null&&c.length>0)?c:h.toLowerCase();return this.addEntry(c,mxUtils.bind(this,function(){return this.createEdgeTemplate(f,e,a,g,h,b,d)}))};Sidebar.prototype.createEdgeTemplate=function(f,e,b,g,h,c,d){var a=new mxCell((g!=null)?g:"",new mxGeometry(0,0,e,b),f);a.geometry.setTerminalPoint(new mxPoint(0,b),true);a.geometry.setTerminalPoint(new mxPoint(e,0),false);a.geometry.relative=true;a.edge=true;return this.createEdgeTemplateFromCells([a],e,b,h,c,d)};Sidebar.prototype.createEdgeTemplateFromCells=function(c,e,a,f,b,d){return this.createItem(c,f,b,true,e,a,d)};Sidebar.prototype.addPaletteFunctions=function(d,c,a,b){this.addPalette(d,c,a,mxUtils.bind(this,function(f){for(var e=0;e<b.length;e++){f.appendChild(b[e](f))}}))};Sidebar.prototype.addPalette=function(g,e,a,d){var b=this.createTitle(e);this.container.appendChild(b);var f=document.createElement("div");f.className="geSidebar";if(mxClient.IS_POINTER){f.style.touchAction="none"}mxEvent.addListener(f,"mousemove",mxUtils.bind(this,function(h){if(mxEvent.getSource(h)==f){f.setAttribute("title",mxResources.get("sidebarTooltip"))}else{f.removeAttribute("title")}}));if(a){d(f);d=null}else{f.style.display="none"}this.addFoldingHandler(b,f,d);var c=document.createElement("div");c.appendChild(f);this.container.appendChild(c);if(g!=null){this.palettes[g]=[b,c]}return f};Sidebar.prototype.addFoldingHandler=function(d,b,a){var c=false;if(!mxClient.IS_IE||document.documentMode>=8){d.style.backgroundImage=(b.style.display=="none")?"url('"+this.collapsedImage+"')":"url('"+this.expandedImage+"')"}d.style.backgroundRepeat="no-repeat";d.style.backgroundPosition="0% 50%";mxEvent.addListener(d,"click",mxUtils.bind(this,function(e){if(b.style.display=="none"){if(!c){c=true;if(a!=null){d.style.cursor="wait";var f=d.innerHTML;d.innerHTML=mxResources.get("loading")+"...";window.setTimeout(function(){var g=mxClient.NO_FO;mxClient.NO_FO=Editor.prototype.originalNoForeignObject;a(b);mxClient.NO_FO=g;b.style.display="block";d.style.cursor="";d.innerHTML=f},0)}else{b.style.display="block"}}else{b.style.display="block"}d.style.backgroundImage="url('"+this.expandedImage+"')"}else{d.style.backgroundImage="url('"+this.collapsedImage+"')";b.style.display="none"}mxEvent.consume(e)}))};Sidebar.prototype.removePalette=function(c){var b=this.palettes[c];if(b!=null){this.palettes[c]=null;for(var a=0;a<b.length;a++){this.container.removeChild(b[a])}return true}return false};Sidebar.prototype.addImagePalette=function(a,g,d,j,f,c,k){var e=c!=null;var h=[];for(var b=0;b<f.length;b++){(mxUtils.bind(this,function(n,o,l){if(l==null){var m=n.lastIndexOf("/");var i=n.lastIndexOf(".");l=n.substring((m>=0)?m+1:0,(i>=0)?i:n.length).replace(/[-_]/g," ")}h.push(this.createVertexTemplateEntry("image;html=1;labelBackgroundColor=#ffffff;image="+d+n+j,this.defaultImageWidth,this.defaultImageHeight,"",o,o!=null,null,this.filterTags(l)))}))(f[b],(c!=null)?c[b]:null,(k!=null)?k[f[b]]:null)}this.addPaletteFunctions(a,g,false,h)};Sidebar.prototype.getTagsForStencil=function(a,c,e){var b=a.split(".");for(var d=1;d<b.length;d++){b[d]=b[d].replace(/_/g," ")}b.push(c.replace(/_/g," "));if(e!=null){b.push(e)}return b.slice(1,b.length)};Sidebar.prototype.addStencilPalette=function(b,h,e,a,g,j,c,l,f){c=(c!=null)?c:1;if(this.addStencilsToIndex){var k=[];if(f!=null){for(var d=0;d<f.length;d++){k.push(f[d])}}mxStencilRegistry.loadStencilSet(e,mxUtils.bind(this,function(n,p,m,i,r){if(g==null||mxUtils.indexOf(g,p)<0){var q=this.getTagsForStencil(n,p);var o=(l!=null)?l[p]:null;if(o!=null){q.push(o)}k.push(this.createVertexTemplateEntry("shape="+n+p.toLowerCase()+a,Math.round(i*c),Math.round(r*c),"",p.replace(/_/g," "),null,null,this.filterTags(q.join(" "))))}}),true,true);this.addPaletteFunctions(b,h,false,k)}else{this.addPalette(b,h,false,mxUtils.bind(this,function(n){if(a==null){a=""}if(j!=null){j.call(this,n)}if(f!=null){for(var m=0;m<f.length;m++){f[m](n)}}mxStencilRegistry.loadStencilSet(e,mxUtils.bind(this,function(p,q,o,i,r){if(g==null||mxUtils.indexOf(g,q)<0){n.appendChild(this.createVertexTemplate("shape="+p+q.toLowerCase()+a,Math.round(i*c),Math.round(r*c),"",q.replace(/_/g," "),true))}}),true)}))}};Sidebar.prototype.destroy=function(){if(this.graph!=null){if(this.graph.container!=null&&this.graph.container.parentNode!=null){this.graph.container.parentNode.removeChild(this.graph.container)}this.graph.destroy();this.graph=null}if(this.pointerUpHandler!=null){mxEvent.removeListener(document,(mxClient.IS_POINTER)?"pointerup":"mouseup",this.pointerUpHandler);this.pointerUpHandler=null}if(this.pointerDownHandler!=null){mxEvent.removeListener(document,(mxClient.IS_POINTER)?"pointerdown":"mousedown",this.pointerDownHandler);this.pointerDownHandler=null}if(this.pointerMoveHandler!=null){mxEvent.removeListener(document,(mxClient.IS_POINTER)?"pointermove":"mousemove",this.pointerMoveHandler);this.pointerMoveHandler=null}if(this.pointerOutHandler!=null){mxEvent.removeListener(document,(mxClient.IS_POINTER)?"pointerout":"mouseout",this.pointerOutHandler);this.pointerOutHandler=null}};function Toolbar(b,a){this.editorUi=b;this.container=a;this.staticElements=[];this.init();this.gestureHandler=mxUtils.bind(this,function(c){if(this.editorUi.currentMenu!=null&&mxEvent.getSource(c)!=this.editorUi.currentMenu.div){this.hideMenu()}});mxEvent.addGestureListeners(document,this.gestureHandler)}Toolbar.prototype.dropdownImage=(!mxClient.IS_SVG)?IMAGE_PATH+"/dropdown.gif":"data:image/gif;base64,R0lGODlhDQANAIABAHt7e////yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCREM1NkJFMjE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCREM1NkJFMzE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkQzOUMzMjZCMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkQzOUMzMjZDMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7";Toolbar.prototype.dropdownImageHtml='<img border="0" style="position:absolute;right:4px;top:'+((!EditorUi.compactUi)?8:6)+'px;" src="'+Toolbar.prototype.dropdownImage+'" valign="middle"/>';Toolbar.prototype.selectedBackground="#d0d0d0";Toolbar.prototype.unselectedBackground="none";Toolbar.prototype.staticElements=null;Toolbar.prototype.init=function(){var b=screen.width;b-=(screen.height>740)?56:0;if(b>=700){var a=this.addMenu("",mxResources.get("view")+" ("+mxResources.get("panTooltip")+")",true,"viewPanels",null,true);this.addDropDownArrow(a,"geSprite-formatpanel",38,50,-4,-3,36,-8);this.addSeparator()}var c=this.addMenu("",mxResources.get("zoom")+" (Alt+Mousewheel)",true,"viewZoom",null,true);c.showDisabled=true;c.style.whiteSpace="nowrap";c.style.position="relative";c.style.overflow="hidden";if(EditorUi.compactUi){c.style.width=(mxClient.IS_QUIRKS)?"58px":"50px"}else{c.style.width=(mxClient.IS_QUIRKS)?"62px":"36px"}if(b>=420){this.addSeparator();var e=this.addItems(["zoomIn","zoomOut"]);e[0].setAttribute("title",mxResources.get("zoomIn")+" ("+this.editorUi.actions.get("zoomIn").shortcut+")");e[1].setAttribute("title",mxResources.get("zoomOut")+" ("+this.editorUi.actions.get("zoomOut").shortcut+")")}this.updateZoom=mxUtils.bind(this,function(){c.innerHTML=Math.round(this.editorUi.editor.graph.view.scale*100)+"%"+this.dropdownImageHtml;if(EditorUi.compactUi){c.getElementsByTagName("img")[0].style.right="1px";c.getElementsByTagName("img")[0].style.top="5px"}});this.editorUi.editor.graph.view.addListener(mxEvent.EVENT_SCALE,this.updateZoom);this.editorUi.editor.addListener("resetGraphView",this.updateZoom);var e=this.addItems(["-","undo","redo"]);e[1].setAttribute("title",mxResources.get("undo")+" ("+this.editorUi.actions.get("undo").shortcut+")");e[2].setAttribute("title",mxResources.get("redo")+" ("+this.editorUi.actions.get("redo").shortcut+")");if(b>=470){var e=this.addItems(["-","delete"]);e[1].setAttribute("title",mxResources.get("delete")+" ("+this.editorUi.actions.get("delete").shortcut+")")}if(b>=550){this.addItems(["-","toFront","toBack"])}if(b>=640){this.addItems(["-","fillColor","strokeColor","shadow"])}if(b>=320){this.addSeparator();this.edgeShapeMenu=this.addMenuFunction("",mxResources.get("connection"),false,mxUtils.bind(this,function(f){this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_SHAPE,"width"],[null,null],"geIcon geSprite geSprite-connection",null,true).setAttribute("title",mxResources.get("line"));this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_SHAPE,"width"],["link",null],"geIcon geSprite geSprite-linkedge",null,true).setAttribute("title",mxResources.get("link"));this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_SHAPE,"width"],["flexArrow",null],"geIcon geSprite geSprite-arrow",null,true).setAttribute("title",mxResources.get("arrow"));this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_SHAPE,"width"],["arrow",null],"geIcon geSprite geSprite-simplearrow",null,true).setAttribute("title",mxResources.get("simpleArrow"))}));this.addDropDownArrow(this.edgeShapeMenu,"geSprite-connection",44,50,0,0,22,-4);this.edgeStyleMenu=this.addMenuFunction("geSprite-orthogonal",mxResources.get("waypoints"),false,mxUtils.bind(this,function(f){this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",null,true).setAttribute("title",mxResources.get("straight"));this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",null,true).setAttribute("title",mxResources.get("orthogonal"));this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",null,true).setAttribute("title",mxResources.get("simple"));this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",null,true).setAttribute("title",mxResources.get("simple"));this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",null,true).setAttribute("title",mxResources.get("isometric"));this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",null,true).setAttribute("title",mxResources.get("isometric"));this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",null,true).setAttribute("title",mxResources.get("curved"));this.editorUi.menus.edgeStyleChange(f,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",null,true).setAttribute("title",mxResources.get("entityRelation"))}));this.addDropDownArrow(this.edgeStyleMenu,"geSprite-orthogonal",44,50,0,0,22,-4)}this.addSeparator();var d=this.addMenu("",mxResources.get("insert")+" ("+mxResources.get("doubleClickTooltip")+")",true,"insert",null,true);this.addDropDownArrow(d,"geSprite-plus",38,48,-4,-3,36,-8)};Toolbar.prototype.addDropDownArrow=function(g,c,d,h,f,e,b,a){b=(b!=null)?b:32;f=(EditorUi.compactUi)?f:a;g.style.whiteSpace="nowrap";g.style.overflow="hidden";g.style.position="relative";g.innerHTML='<div class="geSprite '+c+'" style="margin-left:'+f+"px;margin-top:"+e+'px;"></div>'+this.dropdownImageHtml;g.style.width=(mxClient.IS_QUIRKS)?h+"px":(h-b)+"px";if(mxClient.IS_QUIRKS){g.style.height=(EditorUi.compactUi)?"24px":"26px"}if(EditorUi.compactUi){g.getElementsByTagName("img")[0].style.left="24px";g.getElementsByTagName("img")[0].style.top="5px";g.style.width=(mxClient.IS_QUIRKS)?d+"px":(d-10)+"px"}};Toolbar.prototype.setFontName=function(a){if(this.fontMenu!=null){this.fontMenu.innerHTML='<div style="width:60px;overflow:hidden;display:inline-block;">'+mxUtils.htmlEntities(a)+"</div>"+this.dropdownImageHtml}};Toolbar.prototype.setFontSize=function(a){if(this.sizeMenu!=null){this.sizeMenu.innerHTML='<div style="width:24px;overflow:hidden;display:inline-block;">'+a+"</div>"+this.dropdownImageHtml}};Toolbar.prototype.createTextToolbar=function(){var f=this.editorUi.editor.graph;var c=this.addMenu("",mxResources.get("style"),true,"formatBlock");c.style.position="relative";c.style.whiteSpace="nowrap";c.style.overflow="hidden";c.innerHTML=mxResources.get("style")+this.dropdownImageHtml;if(EditorUi.compactUi){c.style.paddingRight="18px";c.getElementsByTagName("img")[0].style.right="1px";c.getElementsByTagName("img")[0].style.top="5px"}this.addSeparator();this.fontMenu=this.addMenu("",mxResources.get("fontFamily"),true,"fontFamily");this.fontMenu.style.position="relative";this.fontMenu.style.whiteSpace="nowrap";this.fontMenu.style.overflow="hidden";this.fontMenu.style.width=(mxClient.IS_QUIRKS)?"80px":"60px";this.setFontName(Menus.prototype.defaultFont);if(EditorUi.compactUi){this.fontMenu.style.paddingRight="18px";this.fontMenu.getElementsByTagName("img")[0].style.right="1px";this.fontMenu.getElementsByTagName("img")[0].style.top="5px"}this.addSeparator();this.sizeMenu=this.addMenu(Menus.prototype.defaultFontSize,mxResources.get("fontSize"),true,"fontSize");this.sizeMenu.style.position="relative";this.sizeMenu.style.whiteSpace="nowrap";this.sizeMenu.style.overflow="hidden";this.sizeMenu.style.width=(mxClient.IS_QUIRKS)?"44px":"24px";this.setFontSize(Menus.prototype.defaultFontSize);if(EditorUi.compactUi){this.sizeMenu.style.paddingRight="18px";this.sizeMenu.getElementsByTagName("img")[0].style.right="1px";this.sizeMenu.getElementsByTagName("img")[0].style.top="5px"}var g=this.addItems(["-","undo","redo","-","bold","italic","underline"]);g[1].setAttribute("title",mxResources.get("undo")+" ("+this.editorUi.actions.get("undo").shortcut+")");g[2].setAttribute("title",mxResources.get("redo")+" ("+this.editorUi.actions.get("redo").shortcut+")");g[4].setAttribute("title",mxResources.get("bold")+" ("+this.editorUi.actions.get("bold").shortcut+")");g[5].setAttribute("title",mxResources.get("italic")+" ("+this.editorUi.actions.get("italic").shortcut+")");g[6].setAttribute("title",mxResources.get("underline")+" ("+this.editorUi.actions.get("underline").shortcut+")");var d=this.addMenuFunction("",mxResources.get("align"),false,mxUtils.bind(this,function(h){b=h.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifyleft",false,null)}),null,"geIcon geSprite geSprite-left");b.setAttribute("title",mxResources.get("left"));b=h.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifycenter",false,null)}),null,"geIcon geSprite geSprite-center");b.setAttribute("title",mxResources.get("center"));b=h.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifyright",false,null)}),null,"geIcon geSprite geSprite-right");b.setAttribute("title",mxResources.get("right"));b=h.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifyfull",false,null)}),null,"geIcon geSprite geSprite-justifyfull");b.setAttribute("title",mxResources.get("justifyfull"));b=h.addItem("",null,mxUtils.bind(this,function(){document.execCommand("insertorderedlist",false,null)}),null,"geIcon geSprite geSprite-orderedlist");b.setAttribute("title",mxResources.get("numberedList"));b=h.addItem("",null,mxUtils.bind(this,function(){document.execCommand("insertunorderedlist",false,null)}),null,"geIcon geSprite geSprite-unorderedlist");b.setAttribute("title",mxResources.get("bulletedList"));b=h.addItem("",null,mxUtils.bind(this,function(){document.execCommand("outdent",false,null)}),null,"geIcon geSprite geSprite-outdent");b.setAttribute("title",mxResources.get("decreaseIndent"));b=h.addItem("",null,mxUtils.bind(this,function(){document.execCommand("indent",false,null)}),null,"geIcon geSprite geSprite-indent");b.setAttribute("title",mxResources.get("increaseIndent"))}));d.style.position="relative";d.style.whiteSpace="nowrap";d.style.overflow="hidden";d.innerHTML='<div class="geSprite geSprite-left" style="margin-left:-2px;"></div>'+this.dropdownImageHtml;d.style.width=(mxClient.IS_QUIRKS)?"50px":"30px";if(EditorUi.compactUi){d.getElementsByTagName("img")[0].style.left="22px";d.getElementsByTagName("img")[0].style.top="5px"}var a=this.addMenuFunction("",mxResources.get("format"),false,mxUtils.bind(this,function(h){b=h.addItem("",null,this.editorUi.actions.get("subscript").funct,null,"geIcon geSprite geSprite-subscript");b.setAttribute("title",mxResources.get("subscript")+" (Ctrl+,)");b=h.addItem("",null,this.editorUi.actions.get("superscript").funct,null,"geIcon geSprite geSprite-superscript");b.setAttribute("title",mxResources.get("superscript")+" (Ctrl+.)");b=h.addItem("",null,this.editorUi.actions.get("fontColor").funct,null,"geIcon geSprite geSprite-fontcolor");b.setAttribute("title",mxResources.get("fontColor"));b=h.addItem("",null,this.editorUi.actions.get("backgroundColor").funct,null,"geIcon geSprite geSprite-fontbackground");b.setAttribute("title",mxResources.get("backgroundColor"));b=h.addItem("",null,mxUtils.bind(this,function(){document.execCommand("removeformat",false,null)}),null,"geIcon geSprite geSprite-removeformat");b.setAttribute("title",mxResources.get("removeFormat"))}));a.style.position="relative";a.style.whiteSpace="nowrap";a.style.overflow="hidden";a.innerHTML='<div class="geSprite geSprite-dots" style="margin-left:-2px;"></div>'+this.dropdownImageHtml;a.style.width=(mxClient.IS_QUIRKS)?"50px":"30px";if(EditorUi.compactUi){a.getElementsByTagName("img")[0].style.left="22px";a.getElementsByTagName("img")[0].style.top="5px"}this.addSeparator();this.addButton("geIcon geSprite geSprite-code",mxResources.get("html"),function(){f.cellEditor.toggleViewMode();if(f.cellEditor.textarea.innerHTML.length>0&&(f.cellEditor.textarea.innerHTML!="&nbsp;"||!f.cellEditor.clearOnChange)){window.setTimeout(function(){document.execCommand("selectAll",false,null)})}});this.addSeparator();var e=this.addMenuFunction("",mxResources.get("insert"),true,mxUtils.bind(this,function(h){h.addItem(mxResources.get("insertLink"),null,mxUtils.bind(this,function(){this.editorUi.actions.get("link").funct()}));h.addItem(mxResources.get("insertImage"),null,mxUtils.bind(this,function(){this.editorUi.actions.get("image").funct()}));h.addItem(mxResources.get("insertHorizontalRule"),null,mxUtils.bind(this,function(){document.execCommand("inserthorizontalrule",false,null)}))}));e.style.whiteSpace="nowrap";e.style.overflow="hidden";e.style.position="relative";e.innerHTML='<div class="geSprite geSprite-plus" style="margin-left:-4px;margin-top:-3px;"></div>'+this.dropdownImageHtml;e.style.width=(mxClient.IS_QUIRKS)?"36px":"16px";if(EditorUi.compactUi){e.getElementsByTagName("img")[0].style.left="24px";e.getElementsByTagName("img")[0].style.top="5px";e.style.width=(mxClient.IS_QUIRKS)?"50px":"30px"}this.addSeparator();var b=this.addMenuFunction("geIcon geSprite geSprite-table",mxResources.get("table"),false,mxUtils.bind(this,function(l){var i=f.getSelectedElement();var h=f.getParentByName(i,"TD",f.cellEditor.text2);var k=f.getParentByName(i,"TR",f.cellEditor.text2);if(k==null){this.editorUi.menus.addInsertTableItem(l)}else{var j=f.getParentByName(k,"TABLE",f.cellEditor.text2);i=l.addItem("",null,mxUtils.bind(this,function(){try{f.selectNode(f.insertColumn(j,(h!=null)?h.cellIndex:0))}catch(m){mxUtils.alert(mxResources.get("error")+": "+m.message)}}),null,"geIcon geSprite geSprite-insertcolumnbefore");i.setAttribute("title",mxResources.get("insertColumnBefore"));i=l.addItem("",null,mxUtils.bind(this,function(){try{f.selectNode(f.insertColumn(j,(h!=null)?h.cellIndex+1:-1))}catch(m){mxUtils.alert(mxResources.get("error")+": "+m.message)}}),null,"geIcon geSprite geSprite-insertcolumnafter");i.setAttribute("title",mxResources.get("insertColumnAfter"));i=l.addItem("Delete column",null,mxUtils.bind(this,function(){if(h!=null){try{f.deleteColumn(j,h.cellIndex)}catch(m){mxUtils.alert(mxResources.get("error")+": "+m.message)}}}),null,"geIcon geSprite geSprite-deletecolumn");i.setAttribute("title",mxResources.get("deleteColumn"));i=l.addItem("",null,mxUtils.bind(this,function(){try{f.selectNode(f.insertRow(j,k.sectionRowIndex))}catch(m){mxUtils.alert(mxResources.get("error")+": "+m.message)}}),null,"geIcon geSprite geSprite-insertrowbefore");i.setAttribute("title",mxResources.get("insertRowBefore"));i=l.addItem("",null,mxUtils.bind(this,function(){try{f.selectNode(f.insertRow(j,k.sectionRowIndex+1))}catch(m){mxUtils.alert(mxResources.get("error")+": "+m.message)}}),null,"geIcon geSprite geSprite-insertrowafter");i.setAttribute("title",mxResources.get("insertRowAfter"));i=l.addItem("",null,mxUtils.bind(this,function(){try{f.deleteRow(j,k.sectionRowIndex)}catch(m){mxUtils.alert(mxResources.get("error")+": "+m.message)}}),null,"geIcon geSprite geSprite-deleterow");i.setAttribute("title",mxResources.get("deleteRow"));i=l.addItem("",null,mxUtils.bind(this,function(){var m=j.style.borderColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(o,n,q,p){return"#"+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(q).toString(16)).substr(-2)+("0"+Number(p).toString(16)).substr(-2)});this.editorUi.pickColor(m,function(n){if(n==null||n==mxConstants.NONE){j.removeAttribute("border");j.style.border="";j.style.borderCollapse=""}else{j.setAttribute("border","1");j.style.border="1px solid "+n;j.style.borderCollapse="collapse"}})}),null,"geIcon geSprite geSprite-strokecolor");i.setAttribute("title",mxResources.get("borderColor"));i=l.addItem("",null,mxUtils.bind(this,function(){var m=j.style.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(o,n,q,p){return"#"+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(q).toString(16)).substr(-2)+("0"+Number(p).toString(16)).substr(-2)});this.editorUi.pickColor(m,function(n){if(n==null||n==mxConstants.NONE){j.style.backgroundColor=""}else{j.style.backgroundColor=n}})}),null,"geIcon geSprite geSprite-fillcolor");i.setAttribute("title",mxResources.get("backgroundColor"));i=l.addItem("",null,mxUtils.bind(this,function(){var m=j.getAttribute("cellPadding")||0;var n=new FilenameDialog(this.editorUi,m,mxResources.get("apply"),mxUtils.bind(this,function(o){if(o!=null&&o.length>0){j.setAttribute("cellPadding",o)}else{j.removeAttribute("cellPadding")}}),mxResources.get("spacing"));this.editorUi.showDialog(n.container,300,80,true,true);n.init()}),null,"geIcon geSprite geSprite-fit");i.setAttribute("title",mxResources.get("spacing"));i=l.addItem("",null,mxUtils.bind(this,function(){j.setAttribute("align","left")}),null,"geIcon geSprite geSprite-left");i.setAttribute("title",mxResources.get("left"));i=l.addItem("",null,mxUtils.bind(this,function(){j.setAttribute("align","center")}),null,"geIcon geSprite geSprite-center");i.setAttribute("title",mxResources.get("center"));i=l.addItem("",null,mxUtils.bind(this,function(){j.setAttribute("align","right")}),null,"geIcon geSprite geSprite-right");i.setAttribute("title",mxResources.get("right"))}}));b.style.position="relative";b.style.whiteSpace="nowrap";b.style.overflow="hidden";b.innerHTML='<div class="geSprite geSprite-table" style="margin-left:-2px;"></div>'+this.dropdownImageHtml;b.style.width=(mxClient.IS_QUIRKS)?"50px":"30px";if(EditorUi.compactUi){b.getElementsByTagName("img")[0].style.left="22px";b.getElementsByTagName("img")[0].style.top="5px"}};Toolbar.prototype.hideMenu=function(){this.editorUi.hideCurrentMenu()};Toolbar.prototype.addMenu=function(d,g,f,b,i,e){var h=this.editorUi.menus.get(b);var a=this.addMenuFunction(d,g,f,function(){h.funct.apply(h,arguments)},i,e);h.addListener("stateChanged",function(){a.setEnabled(h.enabled)});return a};Toolbar.prototype.addMenuFunction=function(b,f,e,a,g,d){return this.addMenuFunctionInContainer((g!=null)?g:this.container,b,f,e,a,d)};Toolbar.prototype.addMenuFunctionInContainer=function(b,d,g,f,a,e){var c=(f)?this.createLabel(d):this.createButton(d);this.initElement(c,g);this.addMenuHandler(c,f,a,e);b.appendChild(c);return c};Toolbar.prototype.addSeparator=function(b){b=(b!=null)?b:this.container;var a=document.createElement("div");a.className="geSeparator";b.appendChild(a);return a};Toolbar.prototype.addItems=function(e,g,f){var a=[];for(var d=0;d<e.length;d++){var b=e[d];if(b=="-"){a.push(this.addSeparator(g))}else{a.push(this.addItem("geSprite-"+b.toLowerCase(),b,g,f))}}return a};Toolbar.prototype.addItem=function(d,b,h,g){var f=this.editorUi.actions.get(b);var a=null;if(f!=null){var e=f.label;if(f.shortcut!=null){e+=" ("+f.shortcut+")"}a=this.addButton(d,e,f.funct,h);if(!g){a.setEnabled(f.enabled);f.addListener("stateChanged",function(){a.setEnabled(f.enabled)})}}return a};Toolbar.prototype.addButton=function(e,d,a,f){var b=this.createButton(e);f=(f!=null)?f:this.container;this.initElement(b,d);this.addClickHandler(b,a);f.appendChild(b);return b};Toolbar.prototype.initElement=function(a,b){if(b!=null){a.setAttribute("title",b)}this.addEnabledState(a)};Toolbar.prototype.addEnabledState=function(a){var b=a.className;a.setEnabled=function(c){a.enabled=c;if(c){a.className=b}else{a.className=b+" mxDisabled"}};a.setEnabled(true)};Toolbar.prototype.addClickHandler=function(b,a){if(a!=null){mxEvent.addListener(b,"click",function(c){if(b.enabled){a(c)}mxEvent.consume(c)});if(document.documentMode!=null&&document.documentMode>=9){mxEvent.addListener(b,"mousedown",function(c){c.preventDefault()})}}};Toolbar.prototype.createButton=function(c){var b=document.createElement("a");b.setAttribute("href","javascript:void(0);");b.className="geButton";var a=document.createElement("div");if(c!=null){a.className="geSprite "+c}b.appendChild(a);return b};Toolbar.prototype.createLabel=function(b,c){var a=document.createElement("a");a.setAttribute("href","javascript:void(0);");a.className="geLabel";mxUtils.write(a,b);return a};Toolbar.prototype.addMenuHandler=function(c,f,b,d){if(b!=null){var e=this.editorUi.editor.graph;var g=null;var a=true;mxEvent.addListener(c,"click",mxUtils.bind(this,function(h){if(a&&(c.enabled==null||c.enabled)){e.popupMenuHandler.hideMenu();g=new mxPopupMenu(b);g.div.className+=" geToolbarMenu";g.showDisabled=d;g.labels=f;g.autoExpand=true;var i=mxUtils.getOffset(c);g.popup(i.x,i.y+c.offsetHeight,null,h);this.editorUi.setCurrentMenu(g,c);if(!f&&g.div.scrollHeight>g.div.clientHeight){g.div.style.width="40px"}g.addListener(mxEvent.EVENT_HIDE,mxUtils.bind(this,function(){this.currentElt=null}))}a=true;mxEvent.consume(h)}));mxEvent.addListener(c,"mousedown",mxUtils.bind(this,function(h){a=this.currentElt!=c;if(document.documentMode!=null&&document.documentMode>=9){h.preventDefault()}}))}};Toolbar.prototype.destroy=function(){if(this.gestureHandler!=null){mxEvent.removeGestureListeners(document,this.gestureHandler);this.gestureHandler=null}};